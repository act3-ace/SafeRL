{"episode_reward_max": -3.801279160038309, "episode_reward_min": -3.906790602502561, "episode_reward_mean": -3.868041636231275, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7860437416030971, "reward_component_totals/dist_change_reward_min": -0.8221965123810681, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0819978946281843, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.0715022702018433, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.19978946281765, "delta_v_total_min": 207.15022702018368, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1262.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 984, "constraint_violation.max_vel_constraint.steps_max": 1657, "constraint_violation.max_vel_constraint.ratio_mean": 0.630767949358654, "constraint_violation.max_vel_constraint.ratio_min": 0.4917541229385307, "constraint_violation.max_vel_constraint.ratio_max": 0.8280859570214892}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6556912071896206, "mean_inference_ms": 9.663511525381814, "mean_action_processing_ms": 0.5026230842242271, "mean_env_wait_ms": 12.108588750625188, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 12006, "agent_timesteps_total": 12006, "timers": {"sample_time_ms": 67715.584, "sample_throughput": 177.3, "load_time_ms": 435.722, "load_throughput": 27554.259, "learn_time_ms": 46630.301, "learn_throughput": 257.472, "update_time_ms": 48.165}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005038109607994556, "policy_loss": -8.796327892923728e-05, "vf_loss": 0.005126073490828276, "vf_explained_var": 0.3883783221244812, "kl": -7.700935888976801e-09, "entropy": 2.7273213863372803, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 12006, "num_agent_steps_sampled": 12006, "num_steps_trained": 12006, "num_agent_steps_trained": 12006}, "done": false, "episodes_total": 6, "training_iteration": 1, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-16-52", "timestamp": 1690838212, "time_this_iter_s": 115.38462805747986, "time_total_s": 115.38462805747986, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 115.38462805747986, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 99.98121212121211, "ram_util_percent": 62.258787878787885}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.801279160038309, "episode_reward_min": -4.03758528426509, "episode_reward_mean": -3.9101175348462895, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8380579880378912, "reward_component_totals/dist_change_reward_min": -0.977071112098498, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0720595468084055, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.037595267345511, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.20595468083982, "delta_v_total_min": 203.75952673455052, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1314.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 702, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6567549558554057, "constraint_violation.max_vel_constraint.ratio_min": 0.35082458770614694, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.210417864981999, "mean_inference_ms": 9.66615017238138, "mean_action_processing_ms": 0.5012631112362628, "mean_env_wait_ms": 12.084497801054889, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 24012, "agent_timesteps_total": 24012, "timers": {"sample_time_ms": 59079.206, "sample_throughput": 203.219, "load_time_ms": 221.631, "load_throughput": 54171.227, "learn_time_ms": 42982.569, "learn_throughput": 279.323, "update_time_ms": 46.014}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006095734890550375, "policy_loss": 0.0006641317158937454, "vf_loss": 0.00543160131201148, "vf_explained_var": 0.17376087605953217, "kl": -5.78321257549419e-09, "entropy": 2.704603672027588, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 24012, "num_agent_steps_sampled": 24012, "num_steps_trained": 24012, "num_agent_steps_trained": 24012}, "done": false, "episodes_total": 12, "training_iteration": 2, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-18-22", "timestamp": 1690838302, "time_this_iter_s": 89.86614108085632, "time_total_s": 205.25076913833618, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 205.25076913833618, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 99.97131782945736, "ram_util_percent": 62.8891472868217}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7890088527328043, "episode_reward_min": -4.042159022952561, "episode_reward_mean": -3.9069380564702647, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8381490685726558, "reward_component_totals/dist_change_reward_min": -0.977071112098498, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0687889878976162, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.87889878976088, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1306.611111111111, "constraint_violation.max_vel_constraint.steps_min": 702, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6529790660225443, "constraint_violation.max_vel_constraint.ratio_min": 0.35082458770614694, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.971180801941641, "mean_inference_ms": 9.684785698679091, "mean_action_processing_ms": 0.49799280613197766, "mean_env_wait_ms": 12.048143706204023, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 36018, "agent_timesteps_total": 36018, "timers": {"sample_time_ms": 56748.758, "sample_throughput": 211.564, "load_time_ms": 149.951, "load_throughput": 80066.207, "learn_time_ms": 42535.841, "learn_throughput": 282.256, "update_time_ms": 47.707}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999960041972e-12, "total_loss": 0.00432363199070096, "policy_loss": -0.0001610319595783949, "vf_loss": 0.0044846623204648495, "vf_explained_var": 0.24351200461387634, "kl": -5.084720644532581e-09, "entropy": 2.7477986812591553, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 36018, "num_agent_steps_sampled": 36018, "num_steps_trained": 36018, "num_agent_steps_trained": 36018}, "done": false, "episodes_total": 18, "training_iteration": 3, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-19-56", "timestamp": 1690838396, "time_this_iter_s": 93.83251786231995, "time_total_s": 299.0832870006561, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 299.0832870006561, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 99.97894736842106, "ram_util_percent": 62.962406015037594}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7890088527328043, "episode_reward_min": -4.042159022952561, "episode_reward_mean": -3.90893608096861, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8354651546010382, "reward_component_totals/dist_change_reward_min": -0.977071112098498, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.073470926367578, "reward_component_totals/delta_v_min": -2.11875662694375, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.34709263675708, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 211.87566269437426, "constraint_violation.max_vel_constraint.steps_mean": 1246.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6227719473596535, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8191455577692346, "mean_inference_ms": 9.681556871727315, "mean_action_processing_ms": 0.4955102515857132, "mean_env_wait_ms": 12.050241573003177, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 48024, "agent_timesteps_total": 48024, "timers": {"sample_time_ms": 55772.361, "sample_throughput": 215.268, "load_time_ms": 115.479, "load_throughput": 103966.586, "learn_time_ms": 41924.427, "learn_throughput": 286.372, "update_time_ms": 49.327}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003054188098758459, "policy_loss": -0.0004180603427812457, "vf_loss": 0.0034722513519227505, "vf_explained_var": 0.11165517568588257, "kl": -7.966312942642162e-09, "entropy": 2.798319101333618, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 48024, "num_agent_steps_sampled": 48024, "num_steps_trained": 48024, "num_agent_steps_trained": 48024}, "done": false, "episodes_total": 24, "training_iteration": 4, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-21-29", "timestamp": 1690838489, "time_this_iter_s": 93.03917455673218, "time_total_s": 392.1224615573883, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 392.1224615573883, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 99.97089552238805, "ram_util_percent": 62.94850746268656}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7890088527328043, "episode_reward_min": -4.084506327658776, "episode_reward_mean": -3.917350760991499, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8432548258703243, "reward_component_totals/dist_change_reward_min": -0.9910339589415877, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0740959351211825, "reward_component_totals/delta_v_min": -2.11875662694375, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.40959351211748, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 211.87566269437426, "constraint_violation.max_vel_constraint.steps_mean": 1189.3, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.594352823588206, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7132482620427307, "mean_inference_ms": 9.69441782423934, "mean_action_processing_ms": 0.4936105735542548, "mean_env_wait_ms": 12.051891259609905, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 60030, "agent_timesteps_total": 60030, "timers": {"sample_time_ms": 54798.921, "sample_throughput": 219.092, "load_time_ms": 93.77, "load_throughput": 128037.3, "learn_time_ms": 42434.168, "learn_throughput": 282.932, "update_time_ms": 45.866}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005378179717808962, "policy_loss": 0.0005581575096584857, "vf_loss": 0.0048200227320194244, "vf_explained_var": 0.33571043610572815, "kl": -6.316470013700837e-09, "entropy": 2.7233753204345703, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 60030, "num_agent_steps_sampled": 60030, "num_steps_trained": 60030, "num_agent_steps_trained": 60030}, "done": false, "episodes_total": 30, "training_iteration": 5, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-23-05", "timestamp": 1690838585, "time_this_iter_s": 95.47815775871277, "time_total_s": 487.6006193161011, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 487.6006193161011, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 99.97537313432835, "ram_util_percent": 62.94776119402984}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7890088527328043, "episode_reward_min": -4.084506327658776, "episode_reward_mean": -3.908799029267304, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8348520971090472, "reward_component_totals/dist_change_reward_min": -0.9910339589415877, "reward_component_totals/dist_change_reward_max": -0.7221796721310842, "reward_component_totals/delta_v_mean": -2.0739469321582638, "reward_component_totals/delta_v_min": -2.11875662694375, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.39469321582567, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 211.87566269437426, "constraint_violation.max_vel_constraint.steps_mean": 1189.3055555555557, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5943555999777889, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6325319548639734, "mean_inference_ms": 9.705782928529697, "mean_action_processing_ms": 0.49158715372932055, "mean_env_wait_ms": 12.050734126467123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 72036, "agent_timesteps_total": 72036, "timers": {"sample_time_ms": 54211.958, "sample_throughput": 221.464, "load_time_ms": 79.956, "load_throughput": 150157.932, "learn_time_ms": 42205.489, "learn_throughput": 284.465, "update_time_ms": 42.441}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005221226718276739, "policy_loss": 0.0003962104965467006, "vf_loss": 0.0048250178806483746, "vf_explained_var": 0.23645947873592377, "kl": -3.6551908166870817e-09, "entropy": 2.7357897758483887, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 72036, "num_agent_steps_sampled": 72036, "num_steps_trained": 72036, "num_agent_steps_trained": 72036}, "done": false, "episodes_total": 36, "training_iteration": 6, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-24-37", "timestamp": 1690838677, "time_this_iter_s": 92.48837661743164, "time_total_s": 580.0889959335327, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 580.0889959335327, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 99.98030303030303, "ram_util_percent": 62.93787878787878}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7890088527328043, "episode_reward_min": -4.084506327658776, "episode_reward_mean": -3.9135977189056526, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8394128771365738, "reward_component_totals/dist_change_reward_min": -0.9910339589415877, "reward_component_totals/dist_change_reward_max": -0.7221796721310842, "reward_component_totals/delta_v_mean": -2.0741848417690854, "reward_component_totals/delta_v_min": -2.11875662694375, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.41848417690778, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 211.87566269437426, "constraint_violation.max_vel_constraint.steps_mean": 1184.142857142857, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.591775540801028, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5692801919870427, "mean_inference_ms": 9.71204735357172, "mean_action_processing_ms": 0.4896035475718876, "mean_env_wait_ms": 12.037661330742168, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 84042, "agent_timesteps_total": 84042, "timers": {"sample_time_ms": 53368.752, "sample_throughput": 224.963, "load_time_ms": 69.489, "load_throughput": 172776.643, "learn_time_ms": 42294.136, "learn_throughput": 283.869, "update_time_ms": 44.71}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 9.999999960041972e-12, "total_loss": 0.002837481675669551, "policy_loss": -0.0014874651096761227, "vf_loss": 0.0043249474838376045, "vf_explained_var": 0.19756177067756653, "kl": -5.1247779353502665e-09, "entropy": 2.7481465339660645, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 84042, "num_agent_steps_sampled": 84042, "num_steps_trained": 84042, "num_agent_steps_trained": 84042}, "done": false, "episodes_total": 42, "training_iteration": 7, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-26-09", "timestamp": 1690838769, "time_this_iter_s": 91.38847732543945, "time_total_s": 671.4774732589722, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 671.4774732589722, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 99.96999999999998, "ram_util_percent": 62.95153846153846}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7890088527328043, "episode_reward_min": -4.084506327658776, "episode_reward_mean": -3.917354248514767, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8412116086813715, "reward_component_totals/dist_change_reward_min": -0.9910339589415877, "reward_component_totals/dist_change_reward_max": -0.7221796721310842, "reward_component_totals/delta_v_mean": -2.0761426398334026, "reward_component_totals/delta_v_min": -2.1304055284957117, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6142639833395, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.04055284957025, "constraint_violation.max_vel_constraint.steps_mean": 1170.7916666666667, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.585103281692487, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5175454352685125, "mean_inference_ms": 9.71367673269022, "mean_action_processing_ms": 0.48805928103610546, "mean_env_wait_ms": 12.027764580979754, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 96048, "agent_timesteps_total": 96048, "timers": {"sample_time_ms": 52934.544, "sample_throughput": 226.808, "load_time_ms": 61.443, "load_throughput": 195399.948, "learn_time_ms": 42382.593, "learn_throughput": 283.277, "update_time_ms": 42.818}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0034214784391224384, "policy_loss": -0.0002687899977900088, "vf_loss": 0.0036902667488902807, "vf_explained_var": 0.1488659828901291, "kl": -5.665545810273898e-09, "entropy": 2.783592700958252, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 96048, "num_agent_steps_sampled": 96048, "num_steps_trained": 96048, "num_agent_steps_trained": 96048}, "done": false, "episodes_total": 48, "training_iteration": 8, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-27-42", "timestamp": 1690838862, "time_this_iter_s": 93.02804636955261, "time_total_s": 764.5055196285248, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 764.5055196285248, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 99.97293233082706, "ram_util_percent": 63.0}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7890088527328043, "episode_reward_min": -4.084506327658776, "episode_reward_mean": -3.9178677982701857, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.840392847937121, "reward_component_totals/dist_change_reward_min": -0.9910339589415877, "reward_component_totals/dist_change_reward_max": -0.7221796721310842, "reward_component_totals/delta_v_mean": -2.077474950333072, "reward_component_totals/delta_v_min": -2.1304055284957117, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.74749503330645, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.04055284957025, "constraint_violation.max_vel_constraint.steps_mean": 1146.388888888889, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5729079904492198, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4751830253022784, "mean_inference_ms": 9.712512369333501, "mean_action_processing_ms": 0.48702990437972343, "mean_env_wait_ms": 12.021701392323441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 108054, "agent_timesteps_total": 108054, "timers": {"sample_time_ms": 52668.638, "sample_throughput": 227.953, "load_time_ms": 55.726, "load_throughput": 215448.859, "learn_time_ms": 42247.763, "learn_throughput": 284.181, "update_time_ms": 40.162}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003815901465713978, "policy_loss": -0.00044358609011396766, "vf_loss": 0.004259485751390457, "vf_explained_var": 0.1409323364496231, "kl": -6.206313685197529e-09, "entropy": 2.7559292316436768, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 108054, "num_agent_steps_sampled": 108054, "num_steps_trained": 108054, "num_agent_steps_trained": 108054}, "done": false, "episodes_total": 54, "training_iteration": 9, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-29-14", "timestamp": 1690838954, "time_this_iter_s": 91.7868959903717, "time_total_s": 856.2924156188965, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 856.2924156188965, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 99.97862595419846, "ram_util_percent": 63.0}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7890088527328043, "episode_reward_min": -4.084506327658776, "episode_reward_mean": -3.9222622281551573, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8424308395351215, "reward_component_totals/dist_change_reward_min": -0.9910339589415877, "reward_component_totals/dist_change_reward_max": -0.7221796721310842, "reward_component_totals/delta_v_mean": -2.0798313886200424, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9831388620035, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1127.6833333333334, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5635598867233048, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.440976277419624, "mean_inference_ms": 9.710968052367338, "mean_action_processing_ms": 0.4860736127281674, "mean_env_wait_ms": 12.017344537207638, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 120060, "agent_timesteps_total": 120060, "timers": {"sample_time_ms": 52435.441, "sample_throughput": 228.967, "load_time_ms": 51.005, "load_throughput": 235390.751, "learn_time_ms": 42144.705, "learn_throughput": 284.876, "update_time_ms": 41.438}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0032164286822080612, "policy_loss": -0.0002470748731866479, "vf_loss": 0.003463501576334238, "vf_explained_var": 0.07710340619087219, "kl": -3.953113836274724e-09, "entropy": 2.8052315711975098, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 120060, "num_agent_steps_sampled": 120060, "num_steps_trained": 120060, "num_agent_steps_trained": 120060}, "done": false, "episodes_total": 60, "training_iteration": 10, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-30-46", "timestamp": 1690839046, "time_this_iter_s": 91.67144393920898, "time_total_s": 947.9638595581055, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 947.9638595581055, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 99.97938931297709, "ram_util_percent": 63.03969465648856}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.084506327658776, "episode_reward_mean": -3.9161742089909315, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.834828209675553, "reward_component_totals/dist_change_reward_min": -0.9910339589415877, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.0813459993153844, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1345999315377, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1153.939393939394, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5766813562915513, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4267731747076486, "mean_inference_ms": 9.70985028854454, "mean_action_processing_ms": 0.48514138256887707, "mean_env_wait_ms": 12.011371037081993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 132066, "agent_timesteps_total": 132066, "timers": {"sample_time_ms": 52315.429, "sample_throughput": 229.493, "load_time_ms": 8.08, "load_throughput": 1485977.745, "learn_time_ms": 41572.327, "learn_throughput": 288.798, "update_time_ms": 41.333}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004486535210162401, "policy_loss": 5.673144551110454e-05, "vf_loss": 0.004429804626852274, "vf_explained_var": 0.11588311940431595, "kl": -2.1130006633285348e-09, "entropy": 2.7632105350494385, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 132066, "num_agent_steps_sampled": 132066, "num_steps_trained": 132066, "num_agent_steps_trained": 132066}, "done": false, "episodes_total": 66, "training_iteration": 11, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-32-34", "timestamp": 1690839154, "time_this_iter_s": 107.61555123329163, "time_total_s": 1055.579410791397, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1055.579410791397, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 99.97532467532467, "ram_util_percent": 63.10000000000001}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.085586848662028, "episode_reward_mean": -3.9160701051147413, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8367757096327831, "reward_component_totals/dist_change_reward_min": -0.9910339589415877, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.079294395481964, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.92943954819566, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1146.4583333333333, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5729426953190072, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.412906431130329, "mean_inference_ms": 9.712500128349781, "mean_action_processing_ms": 0.484398161138413, "mean_env_wait_ms": 12.007332207841355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 144072, "agent_timesteps_total": 144072, "timers": {"sample_time_ms": 52411.59, "sample_throughput": 229.071, "load_time_ms": 7.995, "load_throughput": 1501659.917, "learn_time_ms": 41798.458, "learn_throughput": 287.235, "update_time_ms": 43.458}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005919733550399542, "policy_loss": 0.0005962617578916252, "vf_loss": 0.0053234705701470375, "vf_explained_var": 0.266231894493103, "kl": -2.861563652700738e-09, "entropy": 2.7085516452789307, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 144072, "num_agent_steps_sampled": 144072, "num_steps_trained": 144072, "num_agent_steps_trained": 144072}, "done": false, "episodes_total": 72, "training_iteration": 12, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-34-08", "timestamp": 1690839248, "time_this_iter_s": 93.18318319320679, "time_total_s": 1148.7625939846039, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1148.7625939846039, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 99.97938931297709, "ram_util_percent": 63.100000000000016}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.085586848662028, "episode_reward_mean": -3.920154125987834, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8411047898799594, "reward_component_totals/dist_change_reward_min": -0.9910339589415877, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.0790493361078806, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90493361078737, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1160.5, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.579960019990005, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.399076152064956, "mean_inference_ms": 9.714352004988521, "mean_action_processing_ms": 0.48394144711148185, "mean_env_wait_ms": 12.004152873968406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 156078, "agent_timesteps_total": 156078, "timers": {"sample_time_ms": 52188.734, "sample_throughput": 230.05, "load_time_ms": 7.969, "load_throughput": 1506574.893, "learn_time_ms": 42116.836, "learn_throughput": 285.064, "update_time_ms": 41.394}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006115433759987354, "policy_loss": 0.00038176958332769573, "vf_loss": 0.00573366554453969, "vf_explained_var": 0.2814882695674896, "kl": -4.876925530084009e-09, "entropy": 2.6946725845336914, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 156078, "num_agent_steps_sampled": 156078, "num_steps_trained": 156078, "num_agent_steps_trained": 156078}, "done": false, "episodes_total": 78, "training_iteration": 13, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-35-43", "timestamp": 1690839343, "time_this_iter_s": 94.80626964569092, "time_total_s": 1243.5688636302948, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1243.5688636302948, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 99.98088235294118, "ram_util_percent": 63.12132352941177}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.085586848662028, "episode_reward_mean": -3.916113806858757, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8371112049286861, "reward_component_totals/dist_change_reward_min": -0.9910339589415877, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.079002601930077, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9002601930069, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1151.9166666666667, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5756704980842912, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3854498704429443, "mean_inference_ms": 9.714078547575408, "mean_action_processing_ms": 0.4836395543206096, "mean_env_wait_ms": 11.999847311498941, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 168084, "agent_timesteps_total": 168084, "timers": {"sample_time_ms": 51732.675, "sample_throughput": 232.078, "load_time_ms": 7.437, "load_throughput": 1614378.166, "learn_time_ms": 42466.16, "learn_throughput": 282.719, "update_time_ms": 40.112}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004289803095161915, "policy_loss": 0.0007669386686757207, "vf_loss": 0.0035228643100708723, "vf_explained_var": 0.019065523520112038, "kl": 1.9202268664031408e-09, "entropy": 2.8114216327667236, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 168084, "num_agent_steps_sampled": 168084, "num_steps_trained": 168084, "num_agent_steps_trained": 168084}, "done": false, "episodes_total": 84, "training_iteration": 14, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-37-15", "timestamp": 1690839435, "time_this_iter_s": 92.05953192710876, "time_total_s": 1335.6283955574036, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1335.6283955574036, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 99.9763358778626, "ram_util_percent": 63.19999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.9167712348792154, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.838109130424913, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.078662104454309, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.86621044543023, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1155.0222222222221, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5772224998611805, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.372812092992827, "mean_inference_ms": 9.714503104271634, "mean_action_processing_ms": 0.48343453987414026, "mean_env_wait_ms": 11.997229408993325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 180090, "agent_timesteps_total": 180090, "timers": {"sample_time_ms": 51770.561, "sample_throughput": 231.908, "load_time_ms": 7.284, "load_throughput": 1648265.344, "learn_time_ms": 42381.74, "learn_throughput": 283.282, "update_time_ms": 41.199}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0035601758863776922, "policy_loss": -0.0004136652569286525, "vf_loss": 0.003973840270191431, "vf_explained_var": 0.25076666474342346, "kl": -2.919145591917527e-09, "entropy": 2.7673726081848145, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 180090, "num_agent_steps_sampled": 180090, "num_steps_trained": 180090, "num_agent_steps_trained": 180090}, "done": false, "episodes_total": 90, "training_iteration": 15, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-38-50", "timestamp": 1690839530, "time_this_iter_s": 95.06520080566406, "time_total_s": 1430.6935963630676, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1430.6935963630676, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 99.97426470588235, "ram_util_percent": 63.19999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.9144090148559556, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8360149763810473, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.0783940384749156, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.83940384749076, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1153.3020833333333, "constraint_violation.max_vel_constraint.steps_min": 400, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5763628602365484, "constraint_violation.max_vel_constraint.ratio_min": 0.19990004997501248, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.360832721247118, "mean_inference_ms": 9.715842636384975, "mean_action_processing_ms": 0.48340794635215395, "mean_env_wait_ms": 11.99733982512212, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 192096, "agent_timesteps_total": 192096, "timers": {"sample_time_ms": 51783.048, "sample_throughput": 231.852, "load_time_ms": 11.052, "load_throughput": 1086346.117, "learn_time_ms": 42817.637, "learn_throughput": 280.398, "update_time_ms": 43.348}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006234197877347469, "policy_loss": 0.00048294951557181776, "vf_loss": 0.005751245655119419, "vf_explained_var": 0.1966594159603119, "kl": -4.2435264191453825e-09, "entropy": 2.695220708847046, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 192096, "num_agent_steps_sampled": 192096, "num_steps_trained": 192096, "num_agent_steps_trained": 192096}, "done": false, "episodes_total": 96, "training_iteration": 16, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-40-27", "timestamp": 1690839627, "time_this_iter_s": 97.18223977088928, "time_total_s": 1527.875836133957, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1527.875836133957, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 99.9705035971223, "ram_util_percent": 63.199999999999996}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.915007168787785, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8369800420463789, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.078027126741413, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.80271267414057, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1145.62, "constraint_violation.max_vel_constraint.steps_min": 400, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5725237381309344, "constraint_violation.max_vel_constraint.ratio_min": 0.19990004997501248, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.03758528426509, -3.984185223196265, -4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.25150238173643, "mean_inference_ms": 9.735451355971966, "mean_action_processing_ms": 0.48275991041900596, "mean_env_wait_ms": 11.991000191897617, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 204102, "agent_timesteps_total": 204102, "timers": {"sample_time_ms": 52348.296, "sample_throughput": 229.348, "load_time_ms": 11.201, "load_throughput": 1071832.06, "learn_time_ms": 42888.865, "learn_throughput": 279.933, "update_time_ms": 41.083}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003075693966820836, "policy_loss": -0.0007095924811437726, "vf_loss": 0.003785288194194436, "vf_explained_var": 0.15365219116210938, "kl": -6.51925802230835e-09, "entropy": 2.772233486175537, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 204102, "num_agent_steps_sampled": 204102, "num_steps_trained": 204102, "num_agent_steps_trained": 204102}, "done": false, "episodes_total": 102, "training_iteration": 17, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-42-05", "timestamp": 1690839725, "time_this_iter_s": 97.62253856658936, "time_total_s": 1625.4983747005463, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1625.4983747005463, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 99.97338129496403, "ram_util_percent": 63.199999999999996}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.912887572464501, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.835256349960624, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.077631222503884, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.76312225038768, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1135.84, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5676361819090454, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-4.009924561970637, -3.9194985892655754, -3.8713541814036114, -3.890612760666647, -3.9060894208633545, -4.042159022952561, -3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2167979269185105, "mean_inference_ms": 9.727780813459242, "mean_action_processing_ms": 0.48178110038606276, "mean_env_wait_ms": 11.99585684005351, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 216108, "agent_timesteps_total": 216108, "timers": {"sample_time_ms": 52655.274, "sample_throughput": 228.011, "load_time_ms": 11.288, "load_throughput": 1063625.423, "learn_time_ms": 42859.99, "learn_throughput": 280.121, "update_time_ms": 42.973}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0033017038367688656, "policy_loss": -0.0009408009937033057, "vf_loss": 0.0042425054125487804, "vf_explained_var": 0.12655161321163177, "kl": -1.3994874148437475e-09, "entropy": 2.7482166290283203, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 216108, "num_agent_steps_sampled": 216108, "num_steps_trained": 216108, "num_agent_steps_trained": 216108}, "done": false, "episodes_total": 108, "training_iteration": 18, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-43-42", "timestamp": 1690839822, "time_this_iter_s": 95.86847710609436, "time_total_s": 1721.3668518066406, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1721.3668518066406, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 99.97279411764707, "ram_util_percent": 63.19999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.9167401459151887, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8384203907081903, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.078319755207006, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.0275097478429536, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8319755206998, "delta_v_total_min": 202.75097478429444, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1125.13, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5622838580709645, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8911449232671287, -3.7890088527328043, -3.7950660423561806, -3.9800063361372624, -3.845786575083072, -3.908616383885886, -3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1962690360387995, "mean_inference_ms": 9.727314415450627, "mean_action_processing_ms": 0.48121087712814337, "mean_env_wait_ms": 11.996852264807012, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 228114, "agent_timesteps_total": 228114, "timers": {"sample_time_ms": 52519.12, "sample_throughput": 228.602, "load_time_ms": 10.805, "load_throughput": 1111109.455, "learn_time_ms": 43048.813, "learn_throughput": 278.893, "update_time_ms": 44.662}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005352768115699291, "policy_loss": 0.0008791082655079663, "vf_loss": 0.0044736615382134914, "vf_explained_var": 0.20329970121383667, "kl": -2.623725903205809e-09, "entropy": 2.758993148803711, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 228114, "num_agent_steps_sampled": 228114, "num_steps_trained": 228114, "num_agent_steps_trained": 228114}, "done": false, "episodes_total": 114, "training_iteration": 19, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-45-14", "timestamp": 1690839914, "time_this_iter_s": 92.3870050907135, "time_total_s": 1813.7538568973541, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1813.7538568973541, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 99.96818181818182, "ram_util_percent": 63.25530303030303}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.922957088712063, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8440307998038424, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.0789262889082267, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.028095628718533, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89262889082195, "delta_v_total_min": 202.8095628718531, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1114.42, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5569315342328836, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8854272714030156, -4.018674191685972, -3.890246060651736, -3.9408304440721857, -4.01499339845932, -3.8568877647786515, -4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.182879767815644, "mean_inference_ms": 9.733252713120631, "mean_action_processing_ms": 0.48137372734949013, "mean_env_wait_ms": 12.005339899818171, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 240120, "agent_timesteps_total": 240120, "timers": {"sample_time_ms": 52678.058, "sample_throughput": 227.913, "load_time_ms": 10.552, "load_throughput": 1137824.526, "learn_time_ms": 43377.727, "learn_throughput": 276.778, "update_time_ms": 41.929}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0038575702346861362, "policy_loss": -0.0005064075230620801, "vf_loss": 0.004363979212939739, "vf_explained_var": 0.20250371098518372, "kl": -6.166256838469053e-09, "entropy": 2.7497072219848633, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 240120, "num_agent_steps_sampled": 240120, "num_steps_trained": 240120, "num_agent_steps_trained": 240120}, "done": false, "episodes_total": 120, "training_iteration": 20, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-46-51", "timestamp": 1690840011, "time_this_iter_s": 96.61467790603638, "time_total_s": 1910.3685348033905, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1910.3685348033905, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 99.97753623188406, "ram_util_percent": 63.10000000000002}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.9230008673251113, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8444006662846074, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.07860020104051, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.028095628718533, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.86002010405028, "delta_v_total_min": 202.8095628718531, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1116.66, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5580509745127437, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-4.084506327658776, -4.031584993204449, -3.838026825872679, -3.880057576524475, -3.9519146139952497, -3.842537732334118, -3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1778149063649233, "mean_inference_ms": 9.737556234547396, "mean_action_processing_ms": 0.48153728768334253, "mean_env_wait_ms": 12.004934738247181, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 252126, "agent_timesteps_total": 252126, "timers": {"sample_time_ms": 52055.417, "sample_throughput": 230.639, "load_time_ms": 10.452, "load_throughput": 1148702.355, "learn_time_ms": 43401.168, "learn_throughput": 276.629, "update_time_ms": 39.632}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0036504471208900213, "policy_loss": -0.0010521262884140015, "vf_loss": 0.004702575039118528, "vf_explained_var": 0.2996504008769989, "kl": -2.8315210176543815e-09, "entropy": 2.732022285461426, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 252126, "num_agent_steps_sampled": 252126, "num_steps_trained": 252126, "num_agent_steps_trained": 252126}, "done": false, "episodes_total": 126, "training_iteration": 21, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-48-33", "timestamp": 1690840113, "time_this_iter_s": 101.66148066520691, "time_total_s": 2012.0300154685974, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2012.0300154685974, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 99.97862068965517, "ram_util_percent": 63.100000000000016}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.923377473345215, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8454897505375913, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.07788772280763, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.028095628718533, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.78877228076223, "delta_v_total_min": 202.8095628718531, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1119.77, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5596051974012993, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8935306409019175, -3.805128183771312, -3.8640573786673285, -3.8390736742080325, -3.991308642384097, -3.8545383997124505, -3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.175086795352222, "mean_inference_ms": 9.736881783713871, "mean_action_processing_ms": 0.4816998244152865, "mean_env_wait_ms": 12.005468848615738, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 264132, "agent_timesteps_total": 264132, "timers": {"sample_time_ms": 51755.198, "sample_throughput": 231.977, "load_time_ms": 10.587, "load_throughput": 1134050.09, "learn_time_ms": 43293.432, "learn_throughput": 277.317, "update_time_ms": 35.535}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004553813487291336, "policy_loss": 0.0006396571989171207, "vf_loss": 0.003914156462997198, "vf_explained_var": 0.10049749165773392, "kl": -5.4652611325423095e-09, "entropy": 2.7804617881774902, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 264132, "num_agent_steps_sampled": 264132, "num_steps_trained": 264132, "num_agent_steps_trained": 264132}, "done": false, "episodes_total": 132, "training_iteration": 22, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-50-02", "timestamp": 1690840202, "time_this_iter_s": 89.08007335662842, "time_total_s": 2101.110088825226, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2101.110088825226, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 99.9732283464567, "ram_util_percent": 63.15354330708662}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.929512525736958, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8516270726453975, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.077885453091566, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.028095628718533, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7885453091558, "delta_v_total_min": 202.8095628718531, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1101.9, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5506746626686657, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.851329566349107, -3.989191097606156, -3.939138017956293, -4.028833416406362, -3.9403968086704957, -3.8794811035069094, -3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1747051096692407, "mean_inference_ms": 9.734627688276667, "mean_action_processing_ms": 0.4819920570195431, "mean_env_wait_ms": 12.004110938369417, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 276138, "agent_timesteps_total": 276138, "timers": {"sample_time_ms": 51588.273, "sample_throughput": 232.727, "load_time_ms": 10.753, "load_throughput": 1116566.492, "learn_time_ms": 42917.489, "learn_throughput": 279.746, "update_time_ms": 34.777}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0028829548973590136, "policy_loss": -0.0011515136575326324, "vf_loss": 0.0040344661101698875, "vf_explained_var": 0.16218161582946777, "kl": -7.16016801405317e-09, "entropy": 2.7714476585388184, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 276138, "num_agent_steps_sampled": 276138, "num_steps_trained": 276138, "num_agent_steps_trained": 276138}, "done": false, "episodes_total": 138, "training_iteration": 23, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-51-32", "timestamp": 1690840292, "time_this_iter_s": 89.43774485588074, "time_total_s": 2190.5478336811066, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2190.5478336811066, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 99.97500000000002, "ram_util_percent": 59.74140625}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.931749509831345, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.852884627931394, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.078864881899957, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.028095628718533, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.88648818999494, "delta_v_total_min": 202.8095628718531, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1085.21, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5423338330834582, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.911934617960303, -3.8602492504876906, -4.05201738506044, -4.017820568985586, -3.869843376949358, -3.89389999476188, -3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.174707390829501, "mean_inference_ms": 9.730898207489696, "mean_action_processing_ms": 0.4821407570893891, "mean_env_wait_ms": 12.000450658998401, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 288144, "agent_timesteps_total": 288144, "timers": {"sample_time_ms": 51152.349, "sample_throughput": 234.711, "load_time_ms": 10.556, "load_throughput": 1137349.1, "learn_time_ms": 42111.084, "learn_throughput": 285.103, "update_time_ms": 33.369}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003951027523726225, "policy_loss": 0.0002017172664636746, "vf_loss": 0.0037493095733225346, "vf_explained_var": 0.1578625589609146, "kl": -4.273569054191739e-09, "entropy": 2.7904751300811768, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 288144, "num_agent_steps_sampled": 288144, "num_steps_trained": 288144, "num_agent_steps_trained": 288144}, "done": false, "episodes_total": 144, "training_iteration": 24, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-52-52", "timestamp": 1690840372, "time_this_iter_s": 79.57680296897888, "time_total_s": 2270.1246366500854, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2270.1246366500854, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 99.98333333333333, "ram_util_percent": 55.43070175438596}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.9296533827847115, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8521270117273819, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.0775263710573353, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.028095628718533, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.75263710573276, "delta_v_total_min": 202.8095628718531, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1078.54, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.539000499750125, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8962503894234404, -3.957697067000005, -3.981907308900145, -3.9322590408464064, -3.794147415329861, -3.999189188354629, -3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.175025563434452, "mean_inference_ms": 9.72514604664138, "mean_action_processing_ms": 0.48223409121606586, "mean_env_wait_ms": 11.99389414274731, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 300150, "agent_timesteps_total": 300150, "timers": {"sample_time_ms": 50342.849, "sample_throughput": 238.485, "load_time_ms": 10.828, "load_throughput": 1108841.43, "learn_time_ms": 41342.181, "learn_throughput": 290.406, "update_time_ms": 30.331}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004760068375617266, "policy_loss": 0.0002872280892916024, "vf_loss": 0.004472839646041393, "vf_explained_var": 0.2372584342956543, "kl": -3.762843814314465e-09, "entropy": 2.7382521629333496, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 300150, "num_agent_steps_sampled": 300150, "num_steps_trained": 300150, "num_agent_steps_trained": 300150}, "done": false, "episodes_total": 150, "training_iteration": 25, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-54-11", "timestamp": 1690840451, "time_this_iter_s": 79.23123025894165, "time_total_s": 2349.355866909027, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2349.355866909027, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 99.97946428571429, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.927994339198338, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8503200816501861, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.0776742575481575, "reward_component_totals/delta_v_min": -2.1359345216552503, "reward_component_totals/delta_v_max": -2.028095628718533, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.76742575481498, "delta_v_total_min": 202.8095628718531, "delta_v_total_max": 213.5934521655235, "constraint_violation.max_vel_constraint.steps_mean": 1073.15, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5363068465767116, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9006779576403776, -4.0101902342474585, -4.03112193923471, -4.035545847912369, -3.9439351786013677, -3.9866947563153246, -3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.175028866589147, "mean_inference_ms": 9.716540812805313, "mean_action_processing_ms": 0.4820683978585113, "mean_env_wait_ms": 11.981398583327962, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 312156, "agent_timesteps_total": 312156, "timers": {"sample_time_ms": 49408.641, "sample_throughput": 242.994, "load_time_ms": 6.916, "load_throughput": 1735956.985, "learn_time_ms": 40370.2, "learn_throughput": 297.398, "update_time_ms": 30.061}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0033662542700767517, "policy_loss": -0.00048480700934305787, "vf_loss": 0.0038510621525347233, "vf_explained_var": 0.08461190015077591, "kl": -3.782872237678703e-09, "entropy": 2.7852957248687744, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 312156, "num_agent_steps_sampled": 312156, "num_steps_trained": 312156, "num_agent_steps_trained": 312156}, "done": false, "episodes_total": 156, "training_iteration": 26, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-55-30", "timestamp": 1690840530, "time_this_iter_s": 77.91084456443787, "time_total_s": 2427.266711473465, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2427.266711473465, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 99.98035714285716, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.391855134884801, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.9236504615469134, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8465134504371266, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.3145950394076984, "reward_component_totals/delta_v_mean": -2.0771370111097927, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.028095628718533, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.71370111097855, "delta_v_total_min": 202.8095628718531, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1100.51, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5499972672652156, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.935236368021947, -3.847659822322356, -4.026382843946214, -3.391855134884801, -3.9123587629897925, -3.967321808734443, -3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.16412428549935, "mean_inference_ms": 9.706569850021694, "mean_action_processing_ms": 0.48183006906898, "mean_env_wait_ms": 11.965759316844608, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 324158, "agent_timesteps_total": 324158, "timers": {"sample_time_ms": 48335.508, "sample_throughput": 248.381, "load_time_ms": 6.874, "load_throughput": 1746453.21, "learn_time_ms": 39695.555, "learn_throughput": 302.442, "update_time_ms": 29.208}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006396448705345392, "policy_loss": -1.5061548765515909e-05, "vf_loss": 0.006411510985344648, "vf_explained_var": 0.2738851010799408, "kl": -2.4009094712340584e-09, "entropy": 2.6762278079986572, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 324158, "num_agent_steps_sampled": 324158, "num_steps_trained": 324158, "num_agent_steps_trained": 324158}, "done": false, "episodes_total": 162, "training_iteration": 27, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-56-50", "timestamp": 1690840610, "time_this_iter_s": 80.15276217460632, "time_total_s": 2507.4194736480713, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2507.4194736480713, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 99.98508771929824, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.924247959900183, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8469644474946308, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.077283512405558, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.028095628718533, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7283512405551, "delta_v_total_min": 202.8095628718531, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1076.35, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.537923304246725, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.787574575858015, -4.085586848662028, -3.961240957951974, -3.7754668206636306, -3.854852356747833, -4.036366691094657, -3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.153937634098727, "mean_inference_ms": 9.689131112781551, "mean_action_processing_ms": 0.48155052394878717, "mean_env_wait_ms": 11.947071238444979, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 336164, "agent_timesteps_total": 336164, "timers": {"sample_time_ms": 47151.786, "sample_throughput": 254.616, "load_time_ms": 6.969, "load_throughput": 1722685.682, "learn_time_ms": 39116.145, "learn_throughput": 306.922, "update_time_ms": 27.5}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005372420884668827, "policy_loss": 0.0011227712966501713, "vf_loss": 0.004249649588018656, "vf_explained_var": 0.24093541502952576, "kl": -3.842957507771416e-09, "entropy": 2.763897657394409, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 336164, "num_agent_steps_sampled": 336164, "num_steps_trained": 336164, "num_agent_steps_trained": 336164}, "done": false, "episodes_total": 168, "training_iteration": 28, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-58-09", "timestamp": 1690840689, "time_this_iter_s": 78.19443416595459, "time_total_s": 2585.613907814026, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2585.613907814026, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.922125942833726, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8436284554352425, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.0784974873984887, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0315328096350043, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8497487398482, "delta_v_total_min": 203.15328096349978, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1081.44, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5404670323826568, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.99192831321652, -3.9204108398243784, -4.060724124915972, -3.9506919329903294, -3.853660647849116, -3.8477286537901216, -3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1442025575454835, "mean_inference_ms": 9.667658001062067, "mean_action_processing_ms": 0.48102078239543006, "mean_env_wait_ms": 11.92437426207079, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 348170, "agent_timesteps_total": 348170, "timers": {"sample_time_ms": 46388.171, "sample_throughput": 258.807, "load_time_ms": 7.187, "load_throughput": 1670403.082, "learn_time_ms": 38398.304, "learn_throughput": 312.66, "update_time_ms": 26.657}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004950643051415682, "policy_loss": 0.0005805742111988366, "vf_loss": 0.004370068199932575, "vf_explained_var": 0.14399129152297974, "kl": -5.407679637414731e-09, "entropy": 2.748190402984619, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 348170, "num_agent_steps_sampled": 348170, "num_steps_trained": 348170, "num_agent_steps_trained": 348170}, "done": false, "episodes_total": 174, "training_iteration": 29, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_14-59-26", "timestamp": 1690840766, "time_this_iter_s": 77.53366494178772, "time_total_s": 2663.1475727558136, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2663.1475727558136, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 99.97927927927927, "ram_util_percent": 55.300000000000004}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.089390876825011, "episode_reward_mean": -3.922852707680324, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8446203077731153, "reward_component_totals/dist_change_reward_min": -0.999747365897264, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.0782323999072143, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0315328096350043, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8232399907208, "delta_v_total_min": 203.15328096349978, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1065.41, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5324560378799084, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.90503490058916, -3.82559046533591, -3.806735519426004, -3.9427877620941945, -4.089390876825011, -3.8840572896813645, -3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1350269995177014, "mean_inference_ms": 9.645908437545243, "mean_action_processing_ms": 0.480238537259988, "mean_env_wait_ms": 11.89828851128611, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 360176, "agent_timesteps_total": 360176, "timers": {"sample_time_ms": 45595.323, "sample_throughput": 263.308, "load_time_ms": 7.107, "load_throughput": 1689248.155, "learn_time_ms": 37557.027, "learn_throughput": 319.663, "update_time_ms": 26.965}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 9.999999960041972e-12, "total_loss": 0.00558537058532238, "policy_loss": 0.0008098597754724324, "vf_loss": 0.004775512497872114, "vf_explained_var": 0.19634515047073364, "kl": -2.661279197013755e-09, "entropy": 2.7309494018554688, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 360176, "num_agent_steps_sampled": 360176, "num_steps_trained": 360176, "num_agent_steps_trained": 360176}, "done": false, "episodes_total": 180, "training_iteration": 30, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-00-47", "timestamp": 1690840847, "time_this_iter_s": 80.26586151123047, "time_total_s": 2743.413434267044, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2743.413434267044, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 99.98086956521739, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.087158267057628, "episode_reward_mean": -3.920958448219981, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8435109380286818, "reward_component_totals/dist_change_reward_min": -0.9968870606700871, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.077447510191305, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0315328096350043, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.74475101912975, "delta_v_total_min": 203.15328096349978, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1094.91, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5471986665655655, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8446823929472025, -3.8410278673071656, -3.971897753668438, -3.9247951825646785, -3.8504497130593824, -3.9217160792413046, -3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.129077560090156, "mean_inference_ms": 9.62130383999753, "mean_action_processing_ms": 0.4792797664858629, "mean_env_wait_ms": 11.869343537133958, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 372182, "agent_timesteps_total": 372182, "timers": {"sample_time_ms": 44744.932, "sample_throughput": 268.312, "load_time_ms": 7.232, "load_throughput": 1659951.809, "learn_time_ms": 37208.946, "learn_throughput": 322.654, "update_time_ms": 27.472}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005246743559837341, "policy_loss": 0.0008537749527022243, "vf_loss": 0.004392966628074646, "vf_explained_var": 0.036347970366477966, "kl": -2.6036974798415713e-09, "entropy": 2.7519443035125732, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 372182, "num_agent_steps_sampled": 372182, "num_steps_trained": 372182, "num_agent_steps_trained": 372182}, "done": false, "episodes_total": 186, "training_iteration": 31, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-02-17", "timestamp": 1690840937, "time_this_iter_s": 89.60139203071594, "time_total_s": 2833.01482629776, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2833.01482629776, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 99.97734375000002, "ram_util_percent": 55.29999999999998}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.087158267057628, "episode_reward_mean": -3.921059840497857, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8448534763375792, "reward_component_totals/dist_change_reward_min": -0.9968870606700871, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.0762063641602824, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.62063641602762, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1078.06, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5387778769603682, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.7997012387846207, -3.7922976527263765, -4.044767629832992, -3.864921973397676, -4.061137538235432, -3.80219557278191, -3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.122794790270131, "mean_inference_ms": 9.593690644747772, "mean_action_processing_ms": 0.47812287181823676, "mean_env_wait_ms": 11.835583526080198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 384188, "agent_timesteps_total": 384188, "timers": {"sample_time_ms": 44183.921, "sample_throughput": 271.719, "load_time_ms": 7.091, "load_throughput": 1692968.128, "learn_time_ms": 36858.977, "learn_throughput": 325.717, "update_time_ms": 28.261}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003852504538372159, "policy_loss": -0.0004244263982400298, "vf_loss": 0.004276931285858154, "vf_explained_var": 0.29799148440361023, "kl": -5.542871495123336e-09, "entropy": 2.7410476207733154, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 384188, "num_agent_steps_sampled": 384188, "num_steps_trained": 384188, "num_agent_steps_trained": 384188}, "done": false, "episodes_total": 192, "training_iteration": 32, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-03-37", "timestamp": 1690841017, "time_this_iter_s": 79.98505091667175, "time_total_s": 2912.9998772144318, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2912.9998772144318, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 99.97589285714285, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.087158267057628, "episode_reward_mean": -3.9214057594007534, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.845766769320895, "reward_component_totals/dist_change_reward_min": -0.9968870606700871, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.075638990079863, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.56389900798564, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1084.54, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5420162577699633, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.7819522236553453, -3.8638268440885355, -4.037736912766306, -3.8670018227216305, -3.97601743110543, -3.941607333284643, -3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.116716974424535, "mean_inference_ms": 9.56311322449133, "mean_action_processing_ms": 0.47675494954584124, "mean_env_wait_ms": 11.796012630549855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 396194, "agent_timesteps_total": 396194, "timers": {"sample_time_ms": 43532.293, "sample_throughput": 275.786, "load_time_ms": 7.343, "load_throughput": 1634901.708, "learn_time_ms": 36450.96, "learn_throughput": 329.363, "update_time_ms": 31.779}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005562904756516218, "policy_loss": 0.0003821105638053268, "vf_loss": 0.00518079474568367, "vf_explained_var": 0.1458706557750702, "kl": -6.4842082814209334e-09, "entropy": 2.7212655544281006, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 396194, "num_agent_steps_sampled": 396194, "num_steps_trained": 396194, "num_agent_steps_trained": 396194}, "done": false, "episodes_total": 198, "training_iteration": 33, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-04-56", "timestamp": 1690841096, "time_this_iter_s": 78.87375617027283, "time_total_s": 2991.8736333847046, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2991.8736333847046, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 99.98053097345132, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.087158267057628, "episode_reward_mean": -3.9199397821544952, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.844975732716359, "reward_component_totals/dist_change_reward_min": -0.9968870606700871, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.074964049438142, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.49640494381347, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1082.84, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5411666825575695, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.909698924616488, -3.8345061740777986, -3.814950620532525, -3.8448807472613544, -3.9988127097553905, -3.9892705056053708, -4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.110416924957913, "mean_inference_ms": 9.528445391463913, "mean_action_processing_ms": 0.47509803881321494, "mean_env_wait_ms": 11.750735739548647, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 408200, "agent_timesteps_total": 408200, "timers": {"sample_time_ms": 43325.381, "sample_throughput": 277.103, "load_time_ms": 7.899, "load_throughput": 1519815.531, "learn_time_ms": 36691.643, "learn_throughput": 327.203, "update_time_ms": 31.947}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005423873197287321, "policy_loss": 0.00017232532263733447, "vf_loss": 0.005251546856015921, "vf_explained_var": 0.2760011553764343, "kl": -7.445573491082769e-09, "entropy": 2.6995198726654053, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 408200, "num_agent_steps_sampled": 408200, "num_steps_trained": 408200, "num_agent_steps_trained": 408200}, "done": false, "episodes_total": 204, "training_iteration": 34, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-06-16", "timestamp": 1690841176, "time_this_iter_s": 79.96255993843079, "time_total_s": 3071.8361933231354, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3071.8361933231354, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 99.98157894736842, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.087158267057628, "episode_reward_mean": -3.919720476398364, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8452652398397504, "reward_component_totals/dist_change_reward_min": -0.9968870606700871, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.0744552365586197, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.44552365586117, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1102.7, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5510917200388288, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-4.052554441472376, -3.9334876471148137, -4.00305257181812, -4.047718006425118, -4.0194115228202865, -3.8782979664625703, -4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1041981520230637, "mean_inference_ms": 9.490857042928148, "mean_action_processing_ms": 0.47326219469942904, "mean_env_wait_ms": 11.70070634391054, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 420206, "agent_timesteps_total": 420206, "timers": {"sample_time_ms": 43177.768, "sample_throughput": 278.051, "load_time_ms": 7.656, "load_throughput": 1568202.407, "learn_time_ms": 36727.396, "learn_throughput": 326.884, "update_time_ms": 34.643}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003936668857932091, "policy_loss": -0.0001321744784945622, "vf_loss": 0.0040688421577215195, "vf_explained_var": 0.09403063356876373, "kl": -4.949528786823976e-09, "entropy": 2.770660161972046, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 420206, "num_agent_steps_sampled": 420206, "num_steps_trained": 420206, "num_agent_steps_trained": 420206}, "done": false, "episodes_total": 210, "training_iteration": 35, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-07-34", "timestamp": 1690841254, "time_this_iter_s": 78.18509101867676, "time_total_s": 3150.021284341812, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3150.021284341812, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 99.97767857142857, "ram_util_percent": 55.33749999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.087158267057628, "episode_reward_mean": -3.917173699527518, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8434658307065953, "reward_component_totals/dist_change_reward_min": -0.9968870606700871, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.0737078688209287, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.37078688209215, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1079.61, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5395524896540213, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-4.005118998832093, -4.082172762372133, -3.8259492693449597, -4.0203728733176485, -4.028490045081099, -4.061439681452569, -3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.097715090989815, "mean_inference_ms": 9.450544884459223, "mean_action_processing_ms": 0.4712824642199444, "mean_env_wait_ms": 11.64841502759733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 432212, "agent_timesteps_total": 432212, "timers": {"sample_time_ms": 43009.749, "sample_throughput": 279.137, "load_time_ms": 7.679, "load_throughput": 1563406.547, "learn_time_ms": 36904.679, "learn_throughput": 325.314, "update_time_ms": 32.093}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005160223226994276, "policy_loss": 0.0008538405527360737, "vf_loss": 0.004306383430957794, "vf_explained_var": 0.18972139060497284, "kl": -3.9055461087400545e-09, "entropy": 2.7573583126068115, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 432212, "num_agent_steps_sampled": 432212, "num_steps_trained": 432212, "num_agent_steps_trained": 432212}, "done": false, "episodes_total": 216, "training_iteration": 36, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-08-53", "timestamp": 1690841333, "time_this_iter_s": 77.97824573516846, "time_total_s": 3227.9995300769806, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3227.9995300769806, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 99.98125, "ram_util_percent": 55.33482142857141}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.087158267057628, "episode_reward_mean": -3.9123636405492976, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8383502197375086, "reward_component_totals/dist_change_reward_min": -0.9968466991499592, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.0740134208117955, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.40134208117885, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1075.02, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5372586365805581, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.867951349490064, -3.867994688086245, -3.885401404573817, -3.9001598236719053, -4.059689986309142, -3.983878948625457, -3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0864790039198993, "mean_inference_ms": 9.410335097490917, "mean_action_processing_ms": 0.46924530616433635, "mean_env_wait_ms": 11.594599483937156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 444218, "agent_timesteps_total": 444218, "timers": {"sample_time_ms": 42913.154, "sample_throughput": 279.774, "load_time_ms": 8.831, "load_throughput": 1359492.178, "learn_time_ms": 36978.198, "learn_throughput": 324.678, "update_time_ms": 33.424}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0036302327644079924, "policy_loss": -0.0007725016912445426, "vf_loss": 0.004402732010930777, "vf_explained_var": 0.21518604457378387, "kl": -4.939514575141857e-09, "entropy": 2.7428934574127197, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 444218, "num_agent_steps_sampled": 444218, "num_steps_trained": 444218, "num_agent_steps_trained": 444218}, "done": false, "episodes_total": 222, "training_iteration": 37, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-10-13", "timestamp": 1690841413, "time_this_iter_s": 79.9470853805542, "time_total_s": 3307.946615457535, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3307.946615457535, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 99.98333333333332, "ram_util_percent": 55.36315789473684}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.087158267057628, "episode_reward_mean": -3.9100135276801704, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8356771297690625, "reward_component_totals/dist_change_reward_min": -0.9968466991499592, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.0743363979111145, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.43363979111075, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1072.26, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5358793262357304, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.900887592832091, -3.798622376840995, -4.024093430179557, -3.8991163368128925, -3.951459416905167, -4.087158267057628, -3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.075539084931514, "mean_inference_ms": 9.36972326614462, "mean_action_processing_ms": 0.46712564109377086, "mean_env_wait_ms": 11.538861022177073, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 456224, "agent_timesteps_total": 456224, "timers": {"sample_time_ms": 42924.011, "sample_throughput": 279.704, "load_time_ms": 8.862, "load_throughput": 1354795.862, "learn_time_ms": 37244.698, "learn_throughput": 322.355, "update_time_ms": 32.159}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 9.999999960041972e-12, "total_loss": 0.002828589640557766, "policy_loss": -0.0013100720243528485, "vf_loss": 0.00413866201415658, "vf_explained_var": 0.1349378228187561, "kl": -7.65837526728319e-09, "entropy": 2.766507387161255, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 456224, "num_agent_steps_sampled": 456224, "num_steps_trained": 456224, "num_agent_steps_trained": 456224}, "done": false, "episodes_total": 228, "training_iteration": 38, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-11-34", "timestamp": 1690841494, "time_this_iter_s": 80.984450340271, "time_total_s": 3388.931065797806, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3388.931065797806, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 99.97844827586205, "ram_util_percent": 55.3}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.9100885954550217, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8351996425788945, "reward_component_totals/dist_change_reward_min": -0.9968466991499592, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.074888952876134, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.48889528761265, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1080.38, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5399372972502231, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.9739551431242885, -3.9163857779600786, -4.0610442828896876, -3.8711392708825176, -4.019447970957062, -4.024116599110745, -4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0644718011663854, "mean_inference_ms": 9.32760805944237, "mean_action_processing_ms": 0.4650671299961875, "mean_env_wait_ms": 11.483022097273533, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 468230, "agent_timesteps_total": 468230, "timers": {"sample_time_ms": 42865.725, "sample_throughput": 280.084, "load_time_ms": 8.789, "load_throughput": 1365978.945, "learn_time_ms": 37273.383, "learn_throughput": 322.107, "update_time_ms": 31.532}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005023524165153503, "policy_loss": -0.00039289347478188574, "vf_loss": 0.0054164151661098, "vf_explained_var": 0.24755771458148956, "kl": -1.3994874148437475e-09, "entropy": 2.7017691135406494, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 468230, "num_agent_steps_sampled": 468230, "num_steps_trained": 468230, "num_agent_steps_trained": 468230}, "done": false, "episodes_total": 234, "training_iteration": 39, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-12-51", "timestamp": 1690841571, "time_this_iter_s": 77.26552391052246, "time_total_s": 3466.1965897083282, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3466.1965897083282, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 99.98181818181817, "ram_util_percent": 55.3}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.911642667572581, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8362335991763941, "reward_component_totals/dist_change_reward_min": -0.9968466991499592, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.075409068396194, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.54090683961866, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1104.41, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.551946292752472, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-4.019332832117649, -3.828835314005304, -4.057684729428647, -3.902650974314687, -3.935719069384221, -3.883829192622625, -3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.053867558172312, "mean_inference_ms": 9.285915727104605, "mean_action_processing_ms": 0.4630597051749328, "mean_env_wait_ms": 11.428511053110606, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 480236, "agent_timesteps_total": 480236, "timers": {"sample_time_ms": 42564.49, "sample_throughput": 282.066, "load_time_ms": 8.701, "load_throughput": 1379816.41, "learn_time_ms": 37249.218, "learn_throughput": 322.315, "update_time_ms": 32.262}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0048925261944532394, "policy_loss": 0.0002748952538240701, "vf_loss": 0.004617629572749138, "vf_explained_var": 0.07614617049694061, "kl": -3.742815390950227e-09, "entropy": 2.7565436363220215, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 480236, "num_agent_steps_sampled": 480236, "num_steps_trained": 480236, "num_agent_steps_trained": 480236}, "done": false, "episodes_total": 240, "training_iteration": 40, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-14-09", "timestamp": 1690841649, "time_this_iter_s": 77.0409905910492, "time_total_s": 3543.2375802993774, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3543.2375802993774, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 99.98440366972477, "ram_util_percent": 55.374311926605515}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.9145679544296894, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8383261962450603, "reward_component_totals/dist_change_reward_min": -0.9946794955997454, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.076241758184635, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6241758184628, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1114.11, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.556793868964366, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.905817858512836, -3.8386745818878985, -4.012524949476363, -3.8195868376579565, -3.9488593904680425, -4.05455111025463, -3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.045742208515346, "mean_inference_ms": 9.244869588249477, "mean_action_processing_ms": 0.46118713234058967, "mean_env_wait_ms": 11.375779210880737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 492242, "agent_timesteps_total": 492242, "timers": {"sample_time_ms": 42536.906, "sample_throughput": 282.249, "load_time_ms": 8.884, "load_throughput": 1351468.939, "learn_time_ms": 37207.22, "learn_throughput": 322.679, "update_time_ms": 32.525}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003726960625499487, "policy_loss": -1.4772178474231623e-05, "vf_loss": 0.0037417318671941757, "vf_explained_var": 0.16443727910518646, "kl": 4.756755059287521e-11, "entropy": 2.7898526191711426, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 492242, "num_agent_steps_sampled": 492242, "num_steps_trained": 492242, "num_agent_steps_trained": 492242}, "done": false, "episodes_total": 246, "training_iteration": 41, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-15-38", "timestamp": 1690841738, "time_this_iter_s": 88.93333578109741, "time_total_s": 3632.170916080475, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3632.170916080475, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 99.98110236220472, "ram_util_percent": 55.31496062992123}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.916845979931145, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8400467147848937, "reward_component_totals/dist_change_reward_min": -0.9946794955997454, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.076799265146259, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.67992651462515, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1106.76, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5531207055460753, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.6583604989112697, -3.8369773690446145, -3.8272029524655222, -4.069594730073013, -3.9379236219487845, -3.8397077101182777, -3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0382001641616436, "mean_inference_ms": 9.206283357297643, "mean_action_processing_ms": 0.45943558869181395, "mean_env_wait_ms": 11.325736741138208, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 504248, "agent_timesteps_total": 504248, "timers": {"sample_time_ms": 42603.514, "sample_throughput": 281.808, "load_time_ms": 8.89, "load_throughput": 1350573.65, "learn_time_ms": 37259.338, "learn_throughput": 322.228, "update_time_ms": 32.406}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0038055540062487125, "policy_loss": -0.0010328743373975158, "vf_loss": 0.0048384289257228374, "vf_explained_var": 0.30521443486213684, "kl": -2.9041240523497436e-09, "entropy": 2.740781307220459, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 504248, "num_agent_steps_sampled": 504248, "num_steps_trained": 504248, "num_agent_steps_trained": 504248}, "done": false, "episodes_total": 252, "training_iteration": 42, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-16-59", "timestamp": 1690841819, "time_this_iter_s": 81.13021183013916, "time_total_s": 3713.301127910614, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3713.301127910614, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 99.98362068965517, "ram_util_percent": 55.356034482758616}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.919200108836084, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8428235563874172, "reward_component_totals/dist_change_reward_min": -0.9946794955997454, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.076376552448673, "reward_component_totals/delta_v_min": -2.203368442306908, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6376552448666, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 220.33684423069036, "constraint_violation.max_vel_constraint.steps_mean": 1097.92, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5487029144416274, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.978848161948261, -3.9738774496376363, -3.7625612240829645, -3.980859981073251, -3.94577422857832, -3.9325354578187857, -3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688], "episode_lengths": [2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0311023161070434, "mean_inference_ms": 9.169937753753754, "mean_action_processing_ms": 0.45774917926396474, "mean_env_wait_ms": 11.2772398848666, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 516254, "agent_timesteps_total": 516254, "timers": {"sample_time_ms": 42590.769, "sample_throughput": 281.892, "load_time_ms": 8.489, "load_throughput": 1414354.353, "learn_time_ms": 37268.644, "learn_throughput": 322.147, "update_time_ms": 30.689}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0026005301624536514, "policy_loss": -0.001369111123494804, "vf_loss": 0.003969642799347639, "vf_explained_var": 0.2055138647556305, "kl": -8.331832113128712e-09, "entropy": 2.769277572631836, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 516254, "num_agent_steps_sampled": 516254, "num_steps_trained": 516254, "num_agent_steps_trained": 516254}, "done": false, "episodes_total": 258, "training_iteration": 43, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-18-18", "timestamp": 1690841898, "time_this_iter_s": 78.77741241455078, "time_total_s": 3792.078540325165, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3792.078540325165, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 99.98407079646017, "ram_util_percent": 55.371681415929196}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.5506560673631644, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.9203794656946904, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8450081161682473, "reward_component_totals/dist_change_reward_min": -0.9946794955997454, "reward_component_totals/dist_change_reward_max": -0.4438503078935026, "reward_component_totals/delta_v_mean": -2.0753713495264483, "reward_component_totals/delta_v_min": -2.1375360237558687, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.53713495264412, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 213.75360237558675, "constraint_violation.max_vel_constraint.steps_mean": 1074.45, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5369565217391304, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.847396722414172, -3.5506560673631644, -3.9393314171880025, -3.9248706828640625, -3.9026918165017768, -3.7893116341094375, -3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0244219290237395, "mean_inference_ms": 9.135882589691612, "mean_action_processing_ms": 0.456119172228422, "mean_env_wait_ms": 11.23043623147504, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 528260, "agent_timesteps_total": 528260, "timers": {"sample_time_ms": 42468.219, "sample_throughput": 282.706, "load_time_ms": 8.048, "load_throughput": 1491806.214, "learn_time_ms": 37333.305, "learn_throughput": 321.59, "update_time_ms": 31.866}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005095316097140312, "policy_loss": 0.001069560763426125, "vf_loss": 0.004025758244097233, "vf_explained_var": 0.12677602469921112, "kl": -4.896954397537456e-09, "entropy": 2.782264232635498, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 528260, "num_agent_steps_sampled": 528260, "num_steps_trained": 528260, "num_agent_steps_trained": 528260}, "done": false, "episodes_total": 264, "training_iteration": 44, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-19-38", "timestamp": 1690841978, "time_this_iter_s": 79.35872721672058, "time_total_s": 3871.4372675418854, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3871.4372675418854, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 99.98230088495575, "ram_util_percent": 55.37964601769912}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7614772997576273, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.926308072368169, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8512220393313626, "reward_component_totals/dist_change_reward_min": -0.9946794955997454, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.0750860330368113, "reward_component_totals/delta_v_min": -2.1375360237558687, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5086033036804, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 213.75360237558675, "constraint_violation.max_vel_constraint.steps_mean": 1073.7, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5365817091454272, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.980264212307297, -3.8284429298132734, -3.9082711964504, -3.8799047551502137, -3.843687903199144, -4.025561017446844, -4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.017917280479302, "mean_inference_ms": 9.104079687826781, "mean_action_processing_ms": 0.4545775522991444, "mean_env_wait_ms": 11.185333174896595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 540266, "agent_timesteps_total": 540266, "timers": {"sample_time_ms": 42377.86, "sample_throughput": 283.308, "load_time_ms": 7.893, "load_throughput": 1521101.141, "learn_time_ms": 37583.196, "learn_throughput": 319.451, "update_time_ms": 31.702}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004187656566500664, "policy_loss": -0.00024201220367103815, "vf_loss": 0.004429667256772518, "vf_explained_var": 0.29952695965766907, "kl": -4.589016722178485e-09, "entropy": 2.748317003250122, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 540266, "num_agent_steps_sampled": 540266, "num_steps_trained": 540266, "num_agent_steps_trained": 540266}, "done": false, "episodes_total": 270, "training_iteration": 45, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-20-58", "timestamp": 1690842058, "time_this_iter_s": 79.77089262008667, "time_total_s": 3951.208160161972, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3951.208160161972, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 99.98421052631579, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7614772997576273, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.9227525720955954, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8486673852033466, "reward_component_totals/dist_change_reward_min": -0.9946794955997454, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.0740851868922543, "reward_component_totals/delta_v_min": -2.1375360237558687, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4085186892247, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 213.75360237558675, "constraint_violation.max_vel_constraint.steps_mean": 1057.34, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5284057971014493, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-4.006125781652964, -3.9250394349704196, -3.9821613251672963, -3.9152455348096717, -3.8475974170342155, -3.8900338614651497, -3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0117029680575684, "mean_inference_ms": 9.073816824704997, "mean_action_processing_ms": 0.4530802106423056, "mean_env_wait_ms": 11.141376004998131, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 552272, "agent_timesteps_total": 552272, "timers": {"sample_time_ms": 42288.254, "sample_throughput": 283.909, "load_time_ms": 7.625, "load_throughput": 1574624.731, "learn_time_ms": 37545.625, "learn_throughput": 319.771, "update_time_ms": 33.917}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005447543226182461, "policy_loss": 0.0006763184210285544, "vf_loss": 0.004771225154399872, "vf_explained_var": 0.16833090782165527, "kl": -4.701676825646928e-09, "entropy": 2.7266268730163574, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 552272, "num_agent_steps_sampled": 552272, "num_steps_trained": 552272, "num_agent_steps_trained": 552272}, "done": false, "episodes_total": 276, "training_iteration": 46, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-22-15", "timestamp": 1690842135, "time_this_iter_s": 76.7555136680603, "time_total_s": 4027.9636738300323, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4027.9636738300323, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 99.98636363636363, "ram_util_percent": 55.3}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7614772997576273, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.916633140533819, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8425713831262353, "reward_component_totals/dist_change_reward_min": -0.9946794955997454, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.0740617574075895, "reward_component_totals/delta_v_min": -2.1375360237558687, "reward_component_totals/delta_v_max": -2.0206935752928294, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.40617574075816, "delta_v_total_min": 202.06935752928226, "delta_v_total_max": 213.75360237558675, "constraint_violation.max_vel_constraint.steps_mean": 1027.99, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5137381309345327, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.8218762088110525, -4.060989864998303, -3.8479685567756463, -3.7957049588329133, -3.770344390945455, -4.022998721234999, -3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.003019145146331, "mean_inference_ms": 9.045105608506562, "mean_action_processing_ms": 0.45163912941458184, "mean_env_wait_ms": 11.098811720483345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 564278, "agent_timesteps_total": 564278, "timers": {"sample_time_ms": 42198.263, "sample_throughput": 284.514, "load_time_ms": 6.216, "load_throughput": 1931437.079, "learn_time_ms": 37598.674, "learn_throughput": 319.32, "update_time_ms": 31.656}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004170766565948725, "policy_loss": 0.00025518215261399746, "vf_loss": 0.003915584646165371, "vf_explained_var": 0.14611102640628815, "kl": -5.815758985505681e-09, "entropy": 2.771785020828247, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 564278, "num_agent_steps_sampled": 564278, "num_steps_trained": 564278, "num_agent_steps_trained": 564278}, "done": false, "episodes_total": 282, "training_iteration": 47, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-23-34", "timestamp": 1690842214, "time_this_iter_s": 79.50345158576965, "time_total_s": 4107.467125415802, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4107.467125415802, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 99.98482142857144, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7614772997576273, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.922645329090725, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8460472933404378, "reward_component_totals/dist_change_reward_min": -0.9946794955997454, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.0765980357502936, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.0234942388037847, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6598035750286, "delta_v_total_min": 202.34942388037794, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1007.66, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5035782108945527, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.9181035898883465, -3.8948966862068826, -3.7614772997576273, -3.996887528542412, -4.042036367959655, -3.8318585739020508, -4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9947498337161413, "mean_inference_ms": 9.01763491049349, "mean_action_processing_ms": 0.45028261667293307, "mean_env_wait_ms": 11.058098349494175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 576284, "agent_timesteps_total": 576284, "timers": {"sample_time_ms": 42158.259, "sample_throughput": 284.784, "load_time_ms": 6.157, "load_throughput": 1950068.498, "learn_time_ms": 37399.763, "learn_throughput": 321.018, "update_time_ms": 32.248}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006179537624120712, "policy_loss": 0.00109539192635566, "vf_loss": 0.005084147211164236, "vf_explained_var": 0.2915933430194855, "kl": -3.893028566182011e-09, "entropy": 2.728785753250122, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 576284, "num_agent_steps_sampled": 576284, "num_steps_trained": 576284, "num_agent_steps_trained": 576284}, "done": false, "episodes_total": 288, "training_iteration": 48, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-24-53", "timestamp": 1690842293, "time_this_iter_s": 78.58211350440979, "time_total_s": 4186.049238920212, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4186.049238920212, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 99.97767857142857, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.762880018154791, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.9246727686371434, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8469873035561085, "reward_component_totals/dist_change_reward_min": -0.9937353746548501, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.0776854650810397, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.0234942388037847, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7685465081032, "delta_v_total_min": 202.34942388037794, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1008.56, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5040279860069965, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-4.019709648505618, -3.834988738772977, -3.9016918823732443, -3.7693282845350984, -3.9678475977079803, -3.8705492795035026, -3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9867566382874224, "mean_inference_ms": 8.99133631444213, "mean_action_processing_ms": 0.4489522929198234, "mean_env_wait_ms": 11.018557655525244, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 588290, "agent_timesteps_total": 588290, "timers": {"sample_time_ms": 41898.887, "sample_throughput": 286.547, "load_time_ms": 6.186, "load_throughput": 1940846.45, "learn_time_ms": 37372.874, "learn_throughput": 321.249, "update_time_ms": 34.076}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0048655555583536625, "policy_loss": 0.0007730228826403618, "vf_loss": 0.004092532210052013, "vf_explained_var": 0.2627701461315155, "kl": -6.999940627139267e-09, "entropy": 2.7774500846862793, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 588290, "num_agent_steps_sampled": 588290, "num_steps_trained": 588290, "num_agent_steps_trained": 588290}, "done": false, "episodes_total": 294, "training_iteration": 49, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-26-08", "timestamp": 1690842368, "time_this_iter_s": 74.3842499256134, "time_total_s": 4260.433488845825, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4260.433488845825, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 99.98113207547169, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.762880018154791, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.929837344299475, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.850458415345571, "reward_component_totals/dist_change_reward_min": -0.9965790308781824, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.0793789289539095, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.0234942388037847, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93789289539026, "delta_v_total_min": 202.34942388037794, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1034.4, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5169415292353823, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8157108654743084, -3.992182854749113, -3.8838383456357075, -3.791415899925535, -3.8235376474672877, -3.762880018154791, -3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9790925399544959, "mean_inference_ms": 8.96607662629432, "mean_action_processing_ms": 0.4476984658276648, "mean_env_wait_ms": 10.981300923393865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 600296, "agent_timesteps_total": 600296, "timers": {"sample_time_ms": 42181.666, "sample_throughput": 284.626, "load_time_ms": 6.38, "load_throughput": 1881955.991, "learn_time_ms": 37242.715, "learn_throughput": 322.372, "update_time_ms": 33.944}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004895432852208614, "policy_loss": 0.00020859731012023985, "vf_loss": 0.004686838015913963, "vf_explained_var": 0.1803341954946518, "kl": -5.980993478260643e-09, "entropy": 2.7491261959075928, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 600296, "num_agent_steps_sampled": 600296, "num_steps_trained": 600296, "num_agent_steps_trained": 600296}, "done": false, "episodes_total": 300, "training_iteration": 50, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-27-26", "timestamp": 1690842446, "time_this_iter_s": 78.50700163841248, "time_total_s": 4338.940490484238, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4338.940490484238, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 99.98230088495575, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.771897519189153, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.931514651588811, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8521904527467642, "reward_component_totals/dist_change_reward_min": -0.9965790308781824, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.0793241988420523, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.0234942388037847, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93241988420448, "delta_v_total_min": 202.34942388037794, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1022.77, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5111294352823589, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.924390110084732, -4.051573642785887, -3.9395381458544243, -3.868269541888658, -3.9615295786306985, -3.8520349526296522, -3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9733687193775282, "mean_inference_ms": 8.94131714233754, "mean_action_processing_ms": 0.4465155886938185, "mean_env_wait_ms": 10.945428583598007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 612302, "agent_timesteps_total": 612302, "timers": {"sample_time_ms": 42312.346, "sample_throughput": 283.747, "load_time_ms": 6.184, "load_throughput": 1941542.376, "learn_time_ms": 37174.056, "learn_throughput": 322.967, "update_time_ms": 34.545}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0053843907080590725, "policy_loss": 0.0010780373122543097, "vf_loss": 0.004306355025619268, "vf_explained_var": 0.2344946563243866, "kl": -6.644435668334836e-09, "entropy": 2.7411553859710693, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 612302, "num_agent_steps_sampled": 612302, "num_steps_trained": 612302, "num_agent_steps_trained": 612302}, "done": false, "episodes_total": 306, "training_iteration": 51, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-28-56", "timestamp": 1690842536, "time_this_iter_s": 89.53047394752502, "time_total_s": 4428.470964431763, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4428.470964431763, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 99.98046875000001, "ram_util_percent": 55.29999999999998}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.771897519189153, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.9296925290351017, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8506067451347823, "reward_component_totals/dist_change_reward_min": -0.9965790308781824, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.0790857839003243, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.0234942388037847, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9085783900317, "delta_v_total_min": 202.34942388037794, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1036.6, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5180409795102449, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.997720171285259, -3.924767696673551, -4.0748359085037436, -3.868956161305806, -3.9971576935733317, -3.8599648322615785, -3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.967997547102174, "mean_inference_ms": 8.91757410830896, "mean_action_processing_ms": 0.44539146243626704, "mean_env_wait_ms": 10.91120623759456, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 624308, "agent_timesteps_total": 624308, "timers": {"sample_time_ms": 42118.118, "sample_throughput": 285.055, "load_time_ms": 6.305, "load_throughput": 1904209.258, "learn_time_ms": 37085.309, "learn_throughput": 323.74, "update_time_ms": 34.754}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0027654427103698254, "policy_loss": -0.0011986484751105309, "vf_loss": 0.003964090254157782, "vf_explained_var": 0.052291158586740494, "kl": -1.8300989612640706e-09, "entropy": 2.780343770980835, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 624308, "num_agent_steps_sampled": 624308, "num_steps_trained": 624308, "num_agent_steps_trained": 624308}, "done": false, "episodes_total": 312, "training_iteration": 52, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-30-15", "timestamp": 1690842615, "time_this_iter_s": 78.35162401199341, "time_total_s": 4506.822588443756, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4506.822588443756, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 99.97946428571429, "ram_util_percent": 55.31696428571428}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.771897519189153, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.925181058509261, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8454126935160277, "reward_component_totals/dist_change_reward_min": -0.9965790308781824, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.079768364993238, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.0234942388037847, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.97683649932307, "delta_v_total_min": 202.34942388037794, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1050.25, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5248625687156422, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8397959254718366, -4.0413391546114585, -3.966329732247827, -3.8379503944124895, -3.7952253263999776, -4.014433863069408, -3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9629274370476102, "mean_inference_ms": 8.89542640406492, "mean_action_processing_ms": 0.4443372662241626, "mean_env_wait_ms": 10.878553660806336, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 636314, "agent_timesteps_total": 636314, "timers": {"sample_time_ms": 42092.712, "sample_throughput": 285.228, "load_time_ms": 6.108, "load_throughput": 1965619.538, "learn_time_ms": 37207.349, "learn_throughput": 322.678, "update_time_ms": 31.992}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0024232431314885616, "policy_loss": -0.0012704373802989721, "vf_loss": 0.0036936812102794647, "vf_explained_var": 0.15239131450653076, "kl": -4.020709987173632e-09, "entropy": 2.779909133911133, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 636314, "num_agent_steps_sampled": 636314, "num_steps_trained": 636314, "num_agent_steps_trained": 636314}, "done": false, "episodes_total": 318, "training_iteration": 53, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-31-35", "timestamp": 1690842695, "time_this_iter_s": 79.67987298965454, "time_total_s": 4586.502461433411, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4586.502461433411, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 99.98333333333335, "ram_util_percent": 55.39999999999998}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.771897519189153, "episode_reward_min": -4.104216373078289, "episode_reward_mean": -3.926503448408533, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8449115322303675, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.0815919161781706, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.029520058383551, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.15919161781628, "delta_v_total_min": 202.95200583835398, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1052.6, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5260369815092454, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8089885126167538, -3.9554537957474882, -3.852280358793524, -3.9036830572167567, -4.072499486700207, -4.104216373078289, -3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.957916798176434, "mean_inference_ms": 8.874456042813312, "mean_action_processing_ms": 0.4433440763265548, "mean_env_wait_ms": 10.8472985252707, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 648320, "agent_timesteps_total": 648320, "timers": {"sample_time_ms": 42288.016, "sample_throughput": 283.91, "load_time_ms": 6.14, "load_throughput": 1955308.277, "learn_time_ms": 37296.024, "learn_throughput": 321.911, "update_time_ms": 29.945}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005639578215777874, "policy_loss": -3.394610757823102e-05, "vf_loss": 0.005673523992300034, "vf_explained_var": 0.28504934906959534, "kl": -3.830439521124163e-09, "entropy": 2.700465440750122, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 648320, "num_agent_steps_sampled": 648320, "num_steps_trained": 648320, "num_agent_steps_trained": 648320}, "done": false, "episodes_total": 324, "training_iteration": 54, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-32-57", "timestamp": 1690842777, "time_this_iter_s": 82.14828085899353, "time_total_s": 4668.650742292404, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4668.650742292404, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 99.9801724137931, "ram_util_percent": 55.456034482758604}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.771897519189153, "episode_reward_min": -4.091414861950634, "episode_reward_mean": -3.9272566858674534, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8454530930757979, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.08180359279166, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.029520058383551, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1803592791653, "delta_v_total_min": 202.95200583835398, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1038.47, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.518975512243878, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.771897519189153, -3.850104598814906, -3.9498189589129877, -3.920307261417852, -3.967184304507884, -4.056837894341441, -3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9533651570120512, "mean_inference_ms": 8.854424394028454, "mean_action_processing_ms": 0.44241460987788495, "mean_env_wait_ms": 10.817481937609395, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 660326, "agent_timesteps_total": 660326, "timers": {"sample_time_ms": 42409.397, "sample_throughput": 283.098, "load_time_ms": 6.511, "load_throughput": 1844024.807, "learn_time_ms": 36861.817, "learn_throughput": 325.703, "update_time_ms": 27.988}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004220813978463411, "policy_loss": 0.0008518951362930238, "vf_loss": 0.0033689201809465885, "vf_explained_var": 0.10824010521173477, "kl": -2.3283064365386963e-09, "entropy": 2.809427499771118, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 660326, "num_agent_steps_sampled": 660326, "num_steps_trained": 660326, "num_agent_steps_trained": 660326}, "done": false, "episodes_total": 330, "training_iteration": 55, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-34-14", "timestamp": 1690842854, "time_this_iter_s": 76.58744525909424, "time_total_s": 4745.238187551498, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4745.238187551498, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 99.98256880733945, "ram_util_percent": 55.39999999999997}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7752661713694398, "episode_reward_min": -4.091414861950634, "episode_reward_mean": -3.9292654881856572, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8477883081775655, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.0814771800080973, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.029520058383551, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.14771800080896, "delta_v_total_min": 202.95200583835398, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1031.56, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5155222388805597, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.9970327758581576, -3.9558520373814448, -4.070913070008117, -3.973676174583323, -4.091414861950634, -4.025821716534644, -4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.949109215132216, "mean_inference_ms": 8.83556057543982, "mean_action_processing_ms": 0.44150372012068323, "mean_env_wait_ms": 10.78841019509884, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 672332, "agent_timesteps_total": 672332, "timers": {"sample_time_ms": 42685.611, "sample_throughput": 281.266, "load_time_ms": 6.344, "load_throughput": 1892401.872, "learn_time_ms": 36700.353, "learn_throughput": 327.136, "update_time_ms": 27.821}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004789014812558889, "policy_loss": 0.0003024332399945706, "vf_loss": 0.004486581776291132, "vf_explained_var": 0.20986272394657135, "kl": -5.420197179972774e-09, "entropy": 2.7527241706848145, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 672332, "num_agent_steps_sampled": 672332, "num_steps_trained": 672332, "num_agent_steps_trained": 672332}, "done": false, "episodes_total": 336, "training_iteration": 56, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-35-32", "timestamp": 1690842932, "time_this_iter_s": 77.916090965271, "time_total_s": 4823.154278516769, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4823.154278516769, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.399999999999984}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7752661713694398, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.925559262019446, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8437998204355965, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7063782361623742, "reward_component_totals/delta_v_mean": -2.081759441583855, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.029520058383551, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.17594415838485, "delta_v_total_min": 202.95200583835398, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1022.8, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5111444277861069, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.057335281127883, -3.9085932441174727, -4.03493286500991, -3.8024828288433072, -3.9259373764730565, -3.8480932701376847, -4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.942881512332561, "mean_inference_ms": 8.817981973455986, "mean_action_processing_ms": 0.4406068028154319, "mean_env_wait_ms": 10.760169656009527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 684338, "agent_timesteps_total": 684338, "timers": {"sample_time_ms": 42590.627, "sample_throughput": 281.893, "load_time_ms": 6.609, "load_throughput": 1816689.412, "learn_time_ms": 36632.289, "learn_throughput": 327.744, "update_time_ms": 28.288}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005574430339038372, "policy_loss": 0.00049276661593467, "vf_loss": 0.005081661511212587, "vf_explained_var": 0.26709428429603577, "kl": -3.0968978492751376e-09, "entropy": 2.7283143997192383, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 684338, "num_agent_steps_sampled": 684338, "num_steps_trained": 684338, "num_agent_steps_trained": 684338}, "done": false, "episodes_total": 342, "training_iteration": 57, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-36-50", "timestamp": 1690843010, "time_this_iter_s": 77.91894125938416, "time_total_s": 4901.073219776154, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4901.073219776154, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 99.98288288288289, "ram_util_percent": 55.48018018018015}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7752661713694398, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.9238487514405627, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8430692666182121, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7117513273009446, "reward_component_totals/delta_v_mean": -2.080779484822356, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.029520058383551, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07794848223486, "delta_v_total_min": 202.95200583835398, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1034.68, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5170814592703649, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.037423866506816, -4.075429978978777, -4.039193899398498, -3.881738886908594, -3.7752661713694398, -3.9179734654655585, -4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9369522081673276, "mean_inference_ms": 8.801116754662237, "mean_action_processing_ms": 0.43975052864247355, "mean_env_wait_ms": 10.733148114573288, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 696344, "agent_timesteps_total": 696344, "timers": {"sample_time_ms": 42553.482, "sample_throughput": 282.139, "load_time_ms": 6.758, "load_throughput": 1776530.178, "learn_time_ms": 36378.551, "learn_throughput": 330.03, "update_time_ms": 29.01}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0026659651193767786, "policy_loss": -0.0013502947986125946, "vf_loss": 0.004016260616481304, "vf_explained_var": 0.176986426115036, "kl": -4.023213318049557e-09, "entropy": 2.759481430053711, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 696344, "num_agent_steps_sampled": 696344, "num_steps_trained": 696344, "num_agent_steps_trained": 696344}, "done": false, "episodes_total": 348, "training_iteration": 58, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-38-06", "timestamp": 1690843086, "time_this_iter_s": 75.7530882358551, "time_total_s": 4976.826308012009, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4976.826308012009, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 99.98425925925925, "ram_util_percent": 55.39999999999997}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7777989076797223, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.921120926055228, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.840479240481475, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7117513273009446, "reward_component_totals/delta_v_mean": -2.0806416855737604, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.029520058383551, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0641685573753, "delta_v_total_min": 202.95200583835398, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1056.01, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5277411294352823, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.024231603731153, -3.899687662830935, -3.8279678696513377, -3.96005300000688, -4.004111684848458, -3.9643913086420834, -3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9313292943167526, "mean_inference_ms": 8.784744002966645, "mean_action_processing_ms": 0.43892998810961315, "mean_env_wait_ms": 10.707165750021426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 708350, "agent_timesteps_total": 708350, "timers": {"sample_time_ms": 42754.091, "sample_throughput": 280.815, "load_time_ms": 6.647, "load_throughput": 1806263.274, "learn_time_ms": 36506.333, "learn_throughput": 328.874, "update_time_ms": 28.846}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 9.999999960041972e-12, "total_loss": 0.00477631064131856, "policy_loss": 0.00026356204762123525, "vf_loss": 0.0045127482153475285, "vf_explained_var": 0.2206427901983261, "kl": -4.223497995781145e-09, "entropy": 2.7519917488098145, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 708350, "num_agent_steps_sampled": 708350, "num_steps_trained": 708350, "num_agent_steps_trained": 708350}, "done": false, "episodes_total": 354, "training_iteration": 59, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-39-24", "timestamp": 1690843164, "time_this_iter_s": 77.6619279384613, "time_total_s": 5054.48823595047, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5054.48823595047, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 99.98558558558558, "ram_util_percent": 55.39999999999996}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7777989076797223, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.91844698310352, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8379379779697154, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7060309169031215, "reward_component_totals/delta_v_mean": -2.0805090051338113, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.0293841837843307, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05090051338033, "delta_v_total_min": 202.93841837843235, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1071.67, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.535567216391804, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.863041982908598, -4.02518537774305, -3.9947336511323694, -3.8409281837252225, -3.972535237548009, -3.791517317572226, -4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9259673914082618, "mean_inference_ms": 8.76909164503285, "mean_action_processing_ms": 0.43811918306761144, "mean_env_wait_ms": 10.681904169280903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 720356, "agent_timesteps_total": 720356, "timers": {"sample_time_ms": 42408.055, "sample_throughput": 283.107, "load_time_ms": 6.493, "load_throughput": 1849157.575, "learn_time_ms": 36670.385, "learn_throughput": 327.403, "update_time_ms": 28.323}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0036909696646034718, "policy_loss": -0.0013421999756246805, "vf_loss": 0.005033171270042658, "vf_explained_var": 0.24986189603805542, "kl": -3.908049883705189e-09, "entropy": 2.7149908542633057, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 720356, "num_agent_steps_sampled": 720356, "num_steps_trained": 720356, "num_agent_steps_trained": 720356}, "done": false, "episodes_total": 360, "training_iteration": 60, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-40-41", "timestamp": 1690843241, "time_this_iter_s": 76.66876745223999, "time_total_s": 5131.15700340271, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5131.15700340271, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 99.98545454545454, "ram_util_percent": 55.49545454545453}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7777989076797223, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.9230840430332012, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8421423210891913, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7060309169031215, "reward_component_totals/delta_v_mean": -2.0809417219440176, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.0293841837843307, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.094172194401, "delta_v_total_min": 202.93841837843235, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1074.72, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5370914542728636, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.0300926823343195, -3.976486390769244, -3.839113905615714, -3.937373473948978, -3.7842222623486252, -3.949831462176885, -3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9223519355889385, "mean_inference_ms": 8.753534542868858, "mean_action_processing_ms": 0.43734199472901564, "mean_env_wait_ms": 10.65750023551545, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 732362, "agent_timesteps_total": 732362, "timers": {"sample_time_ms": 42282.165, "sample_throughput": 283.95, "load_time_ms": 6.237, "load_throughput": 1924859.003, "learn_time_ms": 36873.33, "learn_throughput": 325.601, "update_time_ms": 26.791}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005464126355946064, "policy_loss": 5.531427086680196e-05, "vf_loss": 0.005408813711255789, "vf_explained_var": 0.309038907289505, "kl": -1.1541390065872292e-09, "entropy": 2.714385509490967, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 732362, "num_agent_steps_sampled": 732362, "num_steps_trained": 732362, "num_agent_steps_trained": 732362}, "done": false, "episodes_total": 366, "training_iteration": 61, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-42-11", "timestamp": 1690843331, "time_this_iter_s": 90.25388288497925, "time_total_s": 5221.410886287689, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5221.410886287689, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 99.98671875000001, "ram_util_percent": 55.453125}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7777989076797223, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.922098355428597, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.841895012957576, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7060309169031215, "reward_component_totals/delta_v_mean": -2.0802033424710267, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.0293841837843307, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.02033424710189, "delta_v_total_min": 202.93841837843235, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1087.36, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5434082958520741, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.887749710923181, -3.8660680486260333, -3.783680917903653, -3.8390295851314837, -3.812266994138888, -3.8099416801309802, -3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9191208216378275, "mean_inference_ms": 8.738551506957272, "mean_action_processing_ms": 0.4366133673497217, "mean_env_wait_ms": 10.634657249043277, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 744368, "agent_timesteps_total": 744368, "timers": {"sample_time_ms": 42324.674, "sample_throughput": 283.664, "load_time_ms": 6.124, "load_throughput": 1960446.533, "learn_time_ms": 37190.283, "learn_throughput": 322.826, "update_time_ms": 25.851}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004927350673824549, "policy_loss": -1.0174609087698627e-05, "vf_loss": 0.00493752583861351, "vf_explained_var": 0.24590416252613068, "kl": -5.838291183835054e-09, "entropy": 2.72021222114563, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 744368, "num_agent_steps_sampled": 744368, "num_steps_trained": 744368, "num_agent_steps_trained": 744368}, "done": false, "episodes_total": 372, "training_iteration": 62, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-43-33", "timestamp": 1690843413, "time_this_iter_s": 81.90343451499939, "time_total_s": 5303.314320802689, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5303.314320802689, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 99.98189655172413, "ram_util_percent": 55.52586206896553}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7565561697144414, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.922969577417169, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8422675911822881, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7060309169031215, "reward_component_totals/delta_v_mean": -2.0807019862348866, "reward_component_totals/delta_v_min": -2.166485176881155, "reward_component_totals/delta_v_max": -2.0293841837843307, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07019862348793, "delta_v_total_min": 202.93841837843235, "delta_v_total_max": 216.64851768811417, "constraint_violation.max_vel_constraint.steps_mean": 1069.64, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5345527236381808, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.7960708169946757, -3.7928241895798, -3.8184583394243337, -3.924698178653412, -4.047124149354069, -4.035749883289856, -3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9162145006388533, "mean_inference_ms": 8.724428709832939, "mean_action_processing_ms": 0.4359284147157411, "mean_env_wait_ms": 10.613393793959558, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 756374, "agent_timesteps_total": 756374, "timers": {"sample_time_ms": 42381.275, "sample_throughput": 283.285, "load_time_ms": 6.307, "load_throughput": 1903604.596, "learn_time_ms": 37020.835, "learn_throughput": 324.304, "update_time_ms": 28.612}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0027962438762187958, "policy_loss": -0.0018684053793549538, "vf_loss": 0.004664649721235037, "vf_explained_var": 0.2901953458786011, "kl": -3.727794073427049e-09, "entropy": 2.727412462234497, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 756374, "num_agent_steps_sampled": 756374, "num_steps_trained": 756374, "num_agent_steps_trained": 756374}, "done": false, "episodes_total": 378, "training_iteration": 63, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-44-52", "timestamp": 1690843492, "time_this_iter_s": 78.65846395492554, "time_total_s": 5381.972784757614, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5381.972784757614, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 99.98407079646019, "ram_util_percent": 55.42654867256637}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7565561697144414, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.9227123751367996, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8441122361382738, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7060309169031215, "reward_component_totals/delta_v_mean": -2.078600138998532, "reward_component_totals/delta_v_min": -2.1615138672788934, "reward_component_totals/delta_v_max": -2.0293841837843307, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.86001389985245, "delta_v_total_min": 202.93841837843235, "delta_v_total_max": 216.15138672788885, "constraint_violation.max_vel_constraint.steps_mean": 1097.09, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5482708645677162, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.9503284128576337, -4.017559396468206, -3.9000574087262265, -3.9702823065930026, -3.8763990996767523, -3.8988280885947804, -3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9135041508860078, "mean_inference_ms": 8.710862349063092, "mean_action_processing_ms": 0.4352705095194015, "mean_env_wait_ms": 10.592986236217795, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 768380, "agent_timesteps_total": 768380, "timers": {"sample_time_ms": 42099.764, "sample_throughput": 285.18, "load_time_ms": 6.236, "load_throughput": 1925366.815, "learn_time_ms": 37051.861, "learn_throughput": 324.032, "update_time_ms": 29.161}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005686279386281967, "policy_loss": -0.0003320568357594311, "vf_loss": 0.0060183387249708176, "vf_explained_var": 0.28639233112335205, "kl": -4.4463144277528954e-09, "entropy": 2.666543960571289, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 768380, "num_agent_steps_sampled": 768380, "num_steps_trained": 768380, "num_agent_steps_trained": 768380}, "done": false, "episodes_total": 384, "training_iteration": 64, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-46-12", "timestamp": 1690843572, "time_this_iter_s": 79.67005896568298, "time_total_s": 5461.642843723297, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5461.642843723297, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 99.98333333333335, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6019134637405372, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.9208037611748443, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8420619287774659, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.5226822866191425, "reward_component_totals/delta_v_mean": -2.0787418323973843, "reward_component_totals/delta_v_min": -2.1615138672788934, "reward_component_totals/delta_v_max": -2.0293841837843307, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.87418323973768, "delta_v_total_min": 202.93841837843235, "delta_v_total_max": 216.15138672788885, "constraint_violation.max_vel_constraint.steps_mean": 1103.31, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5513793103448276, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8361140439742614, -4.048483045586405, -3.914703256314169, -4.073476466752341, -3.9266457071139325, -3.9263001078584265, -4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.911023571460114, "mean_inference_ms": 8.697935407303138, "mean_action_processing_ms": 0.4346620821387432, "mean_env_wait_ms": 10.573705744307166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 780386, "agent_timesteps_total": 780386, "timers": {"sample_time_ms": 42096.474, "sample_throughput": 285.202, "load_time_ms": 6.477, "load_throughput": 1853650.067, "learn_time_ms": 37267.04, "learn_throughput": 322.161, "update_time_ms": 31.086}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003161726053804159, "policy_loss": -0.0006406958564184606, "vf_loss": 0.003802421037107706, "vf_explained_var": 0.07381583750247955, "kl": -6.30895946596155e-10, "entropy": 2.785921812057495, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 780386, "num_agent_steps_sampled": 780386, "num_steps_trained": 780386, "num_agent_steps_trained": 780386}, "done": false, "episodes_total": 390, "training_iteration": 65, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-47-31", "timestamp": 1690843651, "time_this_iter_s": 78.80849027633667, "time_total_s": 5540.451333999634, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5540.451333999634, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 99.98125000000002, "ram_util_percent": 55.368749999999984}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6019134637405372, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.917507176678782, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8392262766345425, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.5226822866191425, "reward_component_totals/delta_v_mean": -2.078280900044246, "reward_component_totals/delta_v_min": -2.1615138672788934, "reward_component_totals/delta_v_max": -2.0293841837843307, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.82809000442384, "delta_v_total_min": 202.93841837843235, "delta_v_total_max": 216.15138672788885, "constraint_violation.max_vel_constraint.steps_mean": 1101.98, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5507146426786607, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-4.0503632594394166, -3.96719040644164, -4.0322633132108425, -3.9778102035673983, -3.8021797570946343, -3.8979066707760284, -3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9088371117820344, "mean_inference_ms": 8.685773622626181, "mean_action_processing_ms": 0.43409750108508555, "mean_env_wait_ms": 10.55599995463949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 792392, "agent_timesteps_total": 792392, "timers": {"sample_time_ms": 42183.984, "sample_throughput": 284.61, "load_time_ms": 6.788, "load_throughput": 1768693.059, "learn_time_ms": 37534.688, "learn_throughput": 319.864, "update_time_ms": 29.8}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004849739372730255, "policy_loss": 8.165468170773238e-05, "vf_loss": 0.004768084269016981, "vf_explained_var": 0.24830420315265656, "kl": -4.341164761001437e-09, "entropy": 2.7274277210235596, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 792392, "num_agent_steps_sampled": 792392, "num_steps_trained": 792392, "num_agent_steps_trained": 792392}, "done": false, "episodes_total": 396, "training_iteration": 66, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-48-53", "timestamp": 1690843733, "time_this_iter_s": 81.42341709136963, "time_total_s": 5621.874751091003, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5621.874751091003, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 99.97948717948718, "ram_util_percent": 55.32478632478632}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.8951481214104486, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8157913536949383, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.079356767715517, "reward_component_totals/delta_v_min": -2.1615138672788934, "reward_component_totals/delta_v_max": -2.0293841837843307, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93567677155096, "delta_v_total_min": 202.93841837843235, "delta_v_total_max": 216.15138672788885, "constraint_violation.max_vel_constraint.steps_mean": 1107.56, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5535032483758121, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.965435333265808, -3.836930659486395, -3.793050829825412, -3.941793109892063, -3.867096491484028, -3.962630753645314, -4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9053301078102678, "mean_inference_ms": 8.674671949941109, "mean_action_processing_ms": 0.43354182921927176, "mean_env_wait_ms": 10.538779179505516, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 804398, "agent_timesteps_total": 804398, "timers": {"sample_time_ms": 42416.897, "sample_throughput": 283.048, "load_time_ms": 6.708, "load_throughput": 1789936.261, "learn_time_ms": 37392.848, "learn_throughput": 321.077, "update_time_ms": 30.028}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004241121932864189, "policy_loss": -0.0001522567035863176, "vf_loss": 0.004393378738313913, "vf_explained_var": 0.2638581395149231, "kl": -6.631918125776792e-09, "entropy": 2.757652997970581, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 804398, "num_agent_steps_sampled": 804398, "num_steps_trained": 804398, "num_agent_steps_trained": 804398}, "done": false, "episodes_total": 402, "training_iteration": 67, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-50-12", "timestamp": 1690843812, "time_this_iter_s": 78.86399030685425, "time_total_s": 5700.738741397858, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5700.738741397858, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 99.97946428571429, "ram_util_percent": 55.359821428571415}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.894189004152494, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8164633780076904, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.07772562614481, "reward_component_totals/delta_v_min": -2.1615138672788934, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.77256261448028, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 216.15138672788885, "constraint_violation.max_vel_constraint.steps_mean": 1113.57, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5565067466266866, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-4.01976695997665, -3.8739917023330044, -3.825759207804642, -3.865878601259441, -3.8419934429838465, -3.8711444666261903, -3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9019904541803236, "mean_inference_ms": 8.664694587415003, "mean_action_processing_ms": 0.4329735489609392, "mean_env_wait_ms": 10.522245675970288, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 816404, "agent_timesteps_total": 816404, "timers": {"sample_time_ms": 42596.856, "sample_throughput": 281.852, "load_time_ms": 6.506, "load_throughput": 1845301.945, "learn_time_ms": 37334.752, "learn_throughput": 321.577, "update_time_ms": 29.338}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005221037659794092, "policy_loss": 0.0005793871241621673, "vf_loss": 0.0046416521072387695, "vf_explained_var": 0.1987295001745224, "kl": -5.582928341851812e-09, "entropy": 2.7300291061401367, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 816404, "num_agent_steps_sampled": 816404, "num_steps_trained": 816404, "num_agent_steps_trained": 816404}, "done": false, "episodes_total": 408, "training_iteration": 68, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-51-29", "timestamp": 1690843889, "time_this_iter_s": 76.87171506881714, "time_total_s": 5777.610456466675, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5777.610456466675, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 99.97999999999999, "ram_util_percent": 55.30909090909088}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.89485909086512, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8177527840847462, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.077106306780381, "reward_component_totals/delta_v_min": -2.1615138672788934, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7106306780374, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 216.15138672788885, "constraint_violation.max_vel_constraint.steps_mean": 1106.65, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.553048475762119, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.8270714140601796, -3.891264650863246, -3.855083012871279, -3.985698423614455, -3.955049130941383, -3.8819400334658045, -3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8988652163631985, "mean_inference_ms": 8.654988529415272, "mean_action_processing_ms": 0.4324424830228501, "mean_env_wait_ms": 10.506504763632442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 828410, "agent_timesteps_total": 828410, "timers": {"sample_time_ms": 42689.237, "sample_throughput": 281.242, "load_time_ms": 6.393, "load_throughput": 1878137.625, "learn_time_ms": 37202.818, "learn_throughput": 322.717, "update_time_ms": 28.758}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0060038696974515915, "policy_loss": -7.330530206672847e-05, "vf_loss": 0.00607717502862215, "vf_explained_var": 0.30600881576538086, "kl": -6.429130117169279e-09, "entropy": 2.658184051513672, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 828410, "num_agent_steps_sampled": 828410, "num_steps_trained": 828410, "num_agent_steps_trained": 828410}, "done": false, "episodes_total": 414, "training_iteration": 69, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-52-46", "timestamp": 1690843966, "time_this_iter_s": 77.27960395812988, "time_total_s": 5854.890060424805, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5854.890060424805, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 99.98558558558557, "ram_util_percent": 55.38198198198198}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.081565070194076, "episode_reward_mean": -3.894214363374362, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.816547722073946, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.0776666413004232, "reward_component_totals/delta_v_min": -2.1615138672788934, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.76666413004156, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 216.15138672788885, "constraint_violation.max_vel_constraint.steps_mean": 1098.52, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5489855072463768, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.9090968243419058, -4.081565070194076, -3.9072627683946184, -3.8923995588024063, -3.8596031269400166, -3.9966409631403277, -3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8960156392840053, "mean_inference_ms": 8.645590549091828, "mean_action_processing_ms": 0.43193822619730804, "mean_env_wait_ms": 10.491543333384707, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 840416, "agent_timesteps_total": 840416, "timers": {"sample_time_ms": 42917.832, "sample_throughput": 279.744, "load_time_ms": 6.276, "load_throughput": 1912911.214, "learn_time_ms": 37123.963, "learn_throughput": 323.403, "update_time_ms": 27.707}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005758520215749741, "policy_loss": 0.0008765373495407403, "vf_loss": 0.0048819840885698795, "vf_explained_var": 0.200784832239151, "kl": -7.778546695647037e-09, "entropy": 2.749861478805542, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 840416, "num_agent_steps_sampled": 840416, "num_steps_trained": 840416, "num_agent_steps_trained": 840416}, "done": false, "episodes_total": 420, "training_iteration": 70, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-54-05", "timestamp": 1690844045, "time_this_iter_s": 78.15511584281921, "time_total_s": 5933.045176267624, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5933.045176267624, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 99.97818181818182, "ram_util_percent": 55.334545454545456}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.081338975130363, "episode_reward_mean": -3.8958195428230002, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8195016396942408, "reward_component_totals/dist_change_reward_min": -0.9993389742364345, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.0763179031287664, "reward_component_totals/delta_v_min": -2.134174477010965, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6317903128759, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 213.41744770109574, "constraint_violation.max_vel_constraint.steps_mean": 1113.49, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5564667666166917, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.8570929796783457, -4.028143646104839, -4.025764454172902, -4.005200160008616, -3.833501843585525, -3.9209215802889927, -3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.89451894991261, "mean_inference_ms": 8.636138842791754, "mean_action_processing_ms": 0.4314320083133517, "mean_env_wait_ms": 10.476800153715068, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 852422, "agent_timesteps_total": 852422, "timers": {"sample_time_ms": 43118.273, "sample_throughput": 278.443, "load_time_ms": 6.69, "load_throughput": 1794637.622, "learn_time_ms": 36832.846, "learn_throughput": 325.959, "update_time_ms": 27.829}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005210614763200283, "policy_loss": 0.0010648599127307534, "vf_loss": 0.004145756363868713, "vf_explained_var": 0.11360462009906769, "kl": -4.796811836627057e-09, "entropy": 2.7613933086395264, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 852422, "num_agent_steps_sampled": 852422, "num_steps_trained": 852422, "num_agent_steps_trained": 852422}, "done": false, "episodes_total": 426, "training_iteration": 71, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-55-34", "timestamp": 1690844134, "time_this_iter_s": 89.40048861503601, "time_total_s": 6022.44566488266, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6022.44566488266, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 99.97421875, "ram_util_percent": 55.29999999999998}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.081338975130363, "episode_reward_mean": -3.8952928910315037, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8198162203043734, "reward_component_totals/dist_change_reward_min": -0.9993389742364345, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.075476670727137, "reward_component_totals/delta_v_min": -2.134174477010965, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.54766707271293, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 213.41744770109574, "constraint_violation.max_vel_constraint.steps_mean": 1133.99, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5667116441779111, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.9515005937998264, -4.0398291632003565, -3.9728820374926666, -3.9983955506373166, -3.984522931003002, -3.843389940727636, -3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8931318948503897, "mean_inference_ms": 8.627053688566164, "mean_action_processing_ms": 0.43093385378066756, "mean_env_wait_ms": 10.46264548556941, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 864428, "agent_timesteps_total": 864428, "timers": {"sample_time_ms": 43142.466, "sample_throughput": 278.287, "load_time_ms": 6.594, "load_throughput": 1820808.055, "learn_time_ms": 36482.663, "learn_throughput": 329.088, "update_time_ms": 29.915}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0033558786381036043, "policy_loss": -0.000960987585131079, "vf_loss": 0.004316865000873804, "vf_explained_var": 0.19849969446659088, "kl": -6.178774381027097e-09, "entropy": 2.753711700439453, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 864428, "num_agent_steps_sampled": 864428, "num_steps_trained": 864428, "num_agent_steps_trained": 864428}, "done": false, "episodes_total": 432, "training_iteration": 72, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-56-53", "timestamp": 1690844213, "time_this_iter_s": 78.66970109939575, "time_total_s": 6101.115365982056, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6101.115365982056, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 99.97589285714287, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.081338975130363, "episode_reward_mean": -3.8906166321441362, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8153756384422255, "reward_component_totals/dist_change_reward_min": -0.9993389742364345, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.0752409937019185, "reward_component_totals/delta_v_min": -2.134174477010965, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.52409937019107, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 213.41744770109574, "constraint_violation.max_vel_constraint.steps_mean": 1124.04, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5617391304347825, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.928651212690464, -3.9768361208199776, -4.031845531262791, -3.978842283191348, -3.8898567248221614, -3.8909386734176037, -3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8918530473785653, "mean_inference_ms": 8.618235764188041, "mean_action_processing_ms": 0.4304726261148485, "mean_env_wait_ms": 10.449075927725826, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 876434, "agent_timesteps_total": 876434, "timers": {"sample_time_ms": 43152.193, "sample_throughput": 278.225, "load_time_ms": 6.585, "load_throughput": 1823359.518, "learn_time_ms": 36399.901, "learn_throughput": 329.836, "update_time_ms": 28.495}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0051681846380233765, "policy_loss": 0.0005601299344561994, "vf_loss": 0.0046080537140369415, "vf_explained_var": 0.24374999105930328, "kl": -4.1609089507232966e-09, "entropy": 2.7279372215270996, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 876434, "num_agent_steps_sampled": 876434, "num_steps_trained": 876434, "num_agent_steps_trained": 876434}, "done": false, "episodes_total": 438, "training_iteration": 73, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-58-11", "timestamp": 1690844291, "time_this_iter_s": 77.88394284248352, "time_total_s": 6178.999308824539, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6178.999308824539, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 99.96936936936936, "ram_util_percent": 55.300000000000004}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.081338975130363, "episode_reward_mean": -3.886788067050202, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8129349265688925, "reward_component_totals/dist_change_reward_min": -0.9993389742364345, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.073853140481316, "reward_component_totals/delta_v_min": -2.134174477010965, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.3853140481309, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 213.41744770109574, "constraint_violation.max_vel_constraint.steps_mean": 1137.03, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5682308845577211, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.9296578475817885, -3.8398492980509014, -4.0782223562687445, -3.7777989076797223, -3.818782160695168, -3.8956111199416084, -3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8907448994515392, "mean_inference_ms": 8.60955033222009, "mean_action_processing_ms": 0.4300392012231796, "mean_env_wait_ms": 10.436371291971561, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 888440, "agent_timesteps_total": 888440, "timers": {"sample_time_ms": 43395.402, "sample_throughput": 276.665, "load_time_ms": 6.653, "load_throughput": 1804709.666, "learn_time_ms": 36088.242, "learn_throughput": 332.685, "update_time_ms": 30.134}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0038225094322115183, "policy_loss": -0.0002949792251456529, "vf_loss": 0.004117489326745272, "vf_explained_var": 0.14842489361763, "kl": -2.7564144300384896e-09, "entropy": 2.7576653957366943, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 888440, "num_agent_steps_sampled": 888440, "num_steps_trained": 888440, "num_agent_steps_trained": 888440}, "done": false, "episodes_total": 444, "training_iteration": 74, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_15-59-30", "timestamp": 1690844370, "time_this_iter_s": 79.01258826255798, "time_total_s": 6258.011897087097, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6258.011897087097, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 99.98318584070796, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.081338975130363, "episode_reward_mean": -3.888567826217286, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8135456746318701, "reward_component_totals/dist_change_reward_min": -0.9898864253847212, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.0750221515854235, "reward_component_totals/delta_v_min": -2.134174477010965, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.50221515854156, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 213.41744770109574, "constraint_violation.max_vel_constraint.steps_mean": 1157.84, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5786306846576712, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9846266692594563, -3.795049181538549, -4.017693961877312, -3.9424806367822764, -3.9317619058747946, -4.013342691002254, -3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8897771071966054, "mean_inference_ms": 8.601589511021864, "mean_action_processing_ms": 0.42963793933434713, "mean_env_wait_ms": 10.424750953573179, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 900446, "agent_timesteps_total": 900446, "timers": {"sample_time_ms": 43617.136, "sample_throughput": 275.259, "load_time_ms": 6.32, "load_throughput": 1899798.306, "learn_time_ms": 36184.359, "learn_throughput": 331.801, "update_time_ms": 27.912}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005642675794661045, "policy_loss": 0.000969874148722738, "vf_loss": 0.0046728020533919334, "vf_explained_var": 0.19759206473827362, "kl": -3.4448921493179796e-09, "entropy": 2.744811773300171, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 900446, "num_agent_steps_sampled": 900446, "num_steps_trained": 900446, "num_agent_steps_trained": 900446}, "done": false, "episodes_total": 450, "training_iteration": 75, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-00-52", "timestamp": 1690844452, "time_this_iter_s": 81.90243172645569, "time_total_s": 6339.914328813553, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6339.914328813553, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 99.96752136752136, "ram_util_percent": 55.350427350427346}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.081338975130363, "episode_reward_mean": -3.8883451934285342, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8129748385113896, "reward_component_totals/dist_change_reward_min": -0.9898864253847212, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.0753703549171525, "reward_component_totals/delta_v_min": -2.134174477010965, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.53703549171448, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 213.41744770109574, "constraint_violation.max_vel_constraint.steps_mean": 1145.91, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5726686656671665, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.8383431369401055, -3.7833600656711273, -3.8243918506424333, -4.021849184409221, -3.896426193113415, -4.047652899448569, -3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.889029971521877, "mean_inference_ms": 8.594064048332346, "mean_action_processing_ms": 0.42929257020332556, "mean_env_wait_ms": 10.414558028269544, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 912452, "agent_timesteps_total": 912452, "timers": {"sample_time_ms": 43740.629, "sample_throughput": 274.482, "load_time_ms": 5.979, "load_throughput": 2008119.674, "learn_time_ms": 35992.07, "learn_throughput": 333.573, "update_time_ms": 27.33}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004873955622315407, "policy_loss": 0.00019030625117011368, "vf_loss": 0.004683648236095905, "vf_explained_var": 0.055214472115039825, "kl": -1.910212654721022e-09, "entropy": 2.7763078212738037, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 912452, "num_agent_steps_sampled": 912452, "num_steps_trained": 912452, "num_agent_steps_trained": 912452}, "done": false, "episodes_total": 456, "training_iteration": 76, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-02-13", "timestamp": 1690844533, "time_this_iter_s": 80.74829816818237, "time_total_s": 6420.662626981735, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6420.662626981735, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 99.97672413793104, "ram_util_percent": 55.410344827586194}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.081338975130363, "episode_reward_mean": -3.8886079035622667, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8142985031056235, "reward_component_totals/dist_change_reward_min": -0.9898864253847212, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.0743094004566505, "reward_component_totals/delta_v_min": -2.134174477010965, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.43094004566427, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 213.41744770109574, "constraint_violation.max_vel_constraint.steps_mean": 1145.46, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5724437781109446, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9543757110904156, -3.9128874356471393, -4.05896652916779, -4.081338975130363, -3.789527929506084, -3.915213804810449, -3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8871886062825594, "mean_inference_ms": 8.587235870140228, "mean_action_processing_ms": 0.4289978611568521, "mean_env_wait_ms": 10.405809410411978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 924458, "agent_timesteps_total": 924458, "timers": {"sample_time_ms": 43881.152, "sample_throughput": 273.603, "load_time_ms": 5.964, "load_throughput": 2012952.056, "learn_time_ms": 35920.711, "learn_throughput": 334.236, "update_time_ms": 26.899}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004141019191592932, "policy_loss": -0.00010322330490453169, "vf_loss": 0.004244242794811726, "vf_explained_var": 0.1715143322944641, "kl": -7.085061426437278e-09, "entropy": 2.746408224105835, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 924458, "num_agent_steps_sampled": 924458, "num_steps_trained": 924458, "num_agent_steps_trained": 924458}, "done": false, "episodes_total": 462, "training_iteration": 77, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-03-33", "timestamp": 1690844613, "time_this_iter_s": 79.52993392944336, "time_total_s": 6500.192560911179, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6500.192560911179, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 99.97500000000001, "ram_util_percent": 55.42321428571427}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.070888852457354, "episode_reward_mean": -3.8835074524718776, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8091445749762947, "reward_component_totals/dist_change_reward_min": -0.9840589023129506, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.0743628774955907, "reward_component_totals/delta_v_min": -2.130807585418227, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.43628774955832, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 213.08075854182187, "constraint_violation.max_vel_constraint.steps_mean": 1156.13, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5777761119440279, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.7869405522136343, -3.8831331467589045, -4.019918887240055, -4.023817096204061, -3.7565561697144414, -3.9195098433932145, -3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8853938859310642, "mean_inference_ms": 8.580922367562827, "mean_action_processing_ms": 0.42872279870652563, "mean_env_wait_ms": 10.397902683832848, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 936464, "agent_timesteps_total": 936464, "timers": {"sample_time_ms": 43949.402, "sample_throughput": 273.178, "load_time_ms": 5.999, "load_throughput": 2001304.102, "learn_time_ms": 36022.3, "learn_throughput": 333.294, "update_time_ms": 27.513}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006303613539785147, "policy_loss": 0.0006420704303309321, "vf_loss": 0.0056615425273776054, "vf_explained_var": 0.2859891355037689, "kl": -5.315047957310526e-09, "entropy": 2.708043336868286, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 936464, "num_agent_steps_sampled": 936464, "num_steps_trained": 936464, "num_agent_steps_trained": 936464}, "done": false, "episodes_total": 468, "training_iteration": 78, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-04-52", "timestamp": 1690844692, "time_this_iter_s": 78.51912426948547, "time_total_s": 6578.711685180664, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6578.711685180664, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 99.97589285714287, "ram_util_percent": 55.33928571428571}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.885888200243756, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8091711809416104, "reward_component_totals/dist_change_reward_min": -0.9840589023129506, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.076717019302153, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.67170193021454, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1156.79, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5781059470264868, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.8033257407251133, -3.9606030390087446, -3.7852903912983527, -3.860573951571583, -3.789380556218529, -3.8145608137552793, -3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.883707868295672, "mean_inference_ms": 8.574856226040977, "mean_action_processing_ms": 0.42846392269142003, "mean_env_wait_ms": 10.390593243088297, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 948470, "agent_timesteps_total": 948470, "timers": {"sample_time_ms": 44238.306, "sample_throughput": 271.394, "load_time_ms": 6.266, "load_throughput": 1915938.905, "learn_time_ms": 35966.565, "learn_throughput": 333.81, "update_time_ms": 28.002}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006674807518720627, "policy_loss": 0.0013362655881792307, "vf_loss": 0.0053385416977107525, "vf_explained_var": 0.3633583188056946, "kl": -5.753169940447833e-09, "entropy": 2.7151708602905273, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 948470, "num_agent_steps_sampled": 948470, "num_steps_trained": 948470, "num_agent_steps_trained": 948470}, "done": false, "episodes_total": 474, "training_iteration": 79, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-06-12", "timestamp": 1690844772, "time_this_iter_s": 79.6112596988678, "time_total_s": 6658.322944879532, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6658.322944879532, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 99.97807017543862, "ram_util_percent": 55.337719298245595}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.89483420960934, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8168151336543903, "reward_component_totals/dist_change_reward_min": -0.9840589023129506, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.0780190759549573, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.80190759549495, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1155.22, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5773213393303349, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9810595390070733, -4.037871051617211, -3.8874396631822936, -3.8788937054787653, -3.8807898683719912, -3.6019134637405372, -3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8821500351677531, "mean_inference_ms": 8.569001684061496, "mean_action_processing_ms": 0.4282276795913831, "mean_env_wait_ms": 10.384054961347253, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 960476, "agent_timesteps_total": 960476, "timers": {"sample_time_ms": 44369.231, "sample_throughput": 270.593, "load_time_ms": 6.472, "load_throughput": 1855056.743, "learn_time_ms": 35880.412, "learn_throughput": 334.612, "update_time_ms": 29.38}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005008374340832233, "policy_loss": 0.0011281929910182953, "vf_loss": 0.003880184143781662, "vf_explained_var": 0.19950519502162933, "kl": -2.8515494410186193e-09, "entropy": 2.7882089614868164, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 960476, "num_agent_steps_sampled": 960476, "num_steps_trained": 960476, "num_agent_steps_trained": 960476}, "done": false, "episodes_total": 480, "training_iteration": 80, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-07-30", "timestamp": 1690844850, "time_this_iter_s": 78.60142421722412, "time_total_s": 6736.924369096756, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6736.924369096756, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 99.98125000000002, "ram_util_percent": 55.39642857142856}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.898397476826643, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8198695075542126, "reward_component_totals/dist_change_reward_min": -0.9840589023129506, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.0785279692724385, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85279692724308, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1141.07, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5702498750624687, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9344735199276535, -4.002265609563382, -3.9848719192657134, -4.0182789358518605, -3.903729742594228, -3.7275009491925113, -3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8817936243967779, "mean_inference_ms": 8.563328812845363, "mean_action_processing_ms": 0.4280458272177669, "mean_env_wait_ms": 10.378587304144679, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 972482, "agent_timesteps_total": 972482, "timers": {"sample_time_ms": 44558.039, "sample_throughput": 269.446, "load_time_ms": 6.386, "load_throughput": 1879960.645, "learn_time_ms": 35765.089, "learn_throughput": 335.69, "update_time_ms": 29.859}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006142825819551945, "policy_loss": 0.0005950601771473885, "vf_loss": 0.00554776843637228, "vf_explained_var": 0.2807548940181732, "kl": -3.357267575054834e-09, "entropy": 2.690856456756592, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 972482, "num_agent_steps_sampled": 972482, "num_steps_trained": 972482, "num_agent_steps_trained": 972482}, "done": false, "episodes_total": 486, "training_iteration": 81, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-09-01", "timestamp": 1690844941, "time_this_iter_s": 90.11402535438538, "time_total_s": 6827.038394451141, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6827.038394451141, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 99.97519379844961, "ram_util_percent": 55.37984496124031}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.897932382342893, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8206844950633073, "reward_component_totals/dist_change_reward_min": -0.9926844716318112, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.0772478872795936, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.72478872795858, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1141.31, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5703698150924538, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9936559856372087, -3.828582107430668, -3.972925079716098, -3.96967031342255, -3.957211520337781, -3.902486551296814, -2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.881525245785833, "mean_inference_ms": 8.558015200518703, "mean_action_processing_ms": 0.42786644215062014, "mean_env_wait_ms": 10.373303113049552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 984488, "agent_timesteps_total": 984488, "timers": {"sample_time_ms": 44529.957, "sample_throughput": 269.616, "load_time_ms": 6.469, "load_throughput": 1856020.796, "learn_time_ms": 35875.465, "learn_throughput": 334.658, "update_time_ms": 29.282}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004817571025341749, "policy_loss": -0.0004929801798425615, "vf_loss": 0.005310552194714546, "vf_explained_var": 0.2727733850479126, "kl": -6.9974372962633424e-09, "entropy": 2.6896936893463135, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 984488, "num_agent_steps_sampled": 984488, "num_steps_trained": 984488, "num_agent_steps_trained": 984488}, "done": false, "episodes_total": 492, "training_iteration": 82, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-10-20", "timestamp": 1690845020, "time_this_iter_s": 79.45746660232544, "time_total_s": 6906.495861053467, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6906.495861053467, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 99.97610619469027, "ram_util_percent": 55.430088495575205}, "trial_id": "079e1_00000"}
{"episode_reward_max": -2.762108945170318, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.8967752135260976, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.819450431862386, "reward_component_totals/dist_change_reward_min": -0.9926844716318112, "reward_component_totals/dist_change_reward_max": 0.34049299764704744, "reward_component_totals/delta_v_mean": -2.0773247816637195, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7324781663712, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1136.04, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.567736131934033, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-2.762108945170318, -4.022960762780554, -3.839362542508529, -3.007677761602631, -3.951927321282972, -3.8209459197017472, -3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8812449632208381, "mean_inference_ms": 8.553222102226494, "mean_action_processing_ms": 0.4277010635912101, "mean_env_wait_ms": 10.368533916676329, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 996494, "agent_timesteps_total": 996494, "timers": {"sample_time_ms": 44834.084, "sample_throughput": 267.787, "load_time_ms": 6.605, "load_throughput": 1817745.212, "learn_time_ms": 36006.409, "learn_throughput": 333.441, "update_time_ms": 29.166}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0057998220436275005, "policy_loss": 0.0007355455891229212, "vf_loss": 0.005064275581389666, "vf_explained_var": 0.1965138018131256, "kl": -4.624066463065901e-09, "entropy": 2.723310947418213, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 996494, "num_agent_steps_sampled": 996494, "num_steps_trained": 996494, "num_agent_steps_trained": 996494}, "done": false, "episodes_total": 498, "training_iteration": 83, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-11-43", "timestamp": 1690845103, "time_this_iter_s": 82.24500870704651, "time_total_s": 6988.740869760513, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6988.740869760513, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 99.97881355932202, "ram_util_percent": 55.44915254237285}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7468950711013873, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.916768029069609, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8388646845799796, "reward_component_totals/dist_change_reward_min": -0.9926844716318112, "reward_component_totals/dist_change_reward_max": -0.642622683984317, "reward_component_totals/delta_v_mean": -2.0779033444896373, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.022563833644, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.790334448963, "delta_v_total_min": 202.2563833643991, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1121.84, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5606396801599199, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.78975268958787, -3.7600820960676753, -4.008140686824042, -3.9401767383392485, -3.887022025355148, -3.8208479590225215, -4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.881024354432471, "mean_inference_ms": 8.548403251765825, "mean_action_processing_ms": 0.427577785138336, "mean_env_wait_ms": 10.36452392807884, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1008500, "agent_timesteps_total": 1008500, "timers": {"sample_time_ms": 45000.086, "sample_throughput": 266.799, "load_time_ms": 6.494, "load_throughput": 1848777.396, "learn_time_ms": 35962.651, "learn_throughput": 333.846, "update_time_ms": 27.435}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 9.999999960041972e-12, "total_loss": 0.00541306845843792, "policy_loss": 0.0004341124731581658, "vf_loss": 0.004978956654667854, "vf_explained_var": 0.25933629274368286, "kl": -9.81393633026073e-10, "entropy": 2.7453126907348633, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1008500, "num_agent_steps_sampled": 1008500, "num_steps_trained": 1008500, "num_agent_steps_trained": 1008500}, "done": false, "episodes_total": 504, "training_iteration": 84, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-13-03", "timestamp": 1690845183, "time_this_iter_s": 80.22367596626282, "time_total_s": 7068.964545726776, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7068.964545726776, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 99.97876106194691, "ram_util_percent": 55.3858407079646}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.9160628829839057, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8354964859790864, "reward_component_totals/dist_change_reward_min": -0.9926844716318112, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.080566397004826, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05663970048187, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1105.24, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.552343828085957, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.061765818091402, -3.868868287797386, -3.845689975265069, -3.881348986714925, -3.9629209234965446, -3.760541882110524, -3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8808885447374712, "mean_inference_ms": 8.543247334584565, "mean_action_processing_ms": 0.42745958195167005, "mean_env_wait_ms": 10.36068563684097, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1020506, "agent_timesteps_total": 1020506, "timers": {"sample_time_ms": 44867.304, "sample_throughput": 267.589, "load_time_ms": 7.534, "load_throughput": 1593524.673, "learn_time_ms": 35855.416, "learn_throughput": 334.845, "update_time_ms": 28.806}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003331588115543127, "policy_loss": -0.00033800912206061184, "vf_loss": 0.0036695983726531267, "vf_explained_var": 0.14466796815395355, "kl": -3.001762838295008e-09, "entropy": 2.7901129722595215, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1020506, "num_agent_steps_sampled": 1020506, "num_steps_trained": 1020506, "num_agent_steps_trained": 1020506}, "done": false, "episodes_total": 510, "training_iteration": 85, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-14-23", "timestamp": 1690845263, "time_this_iter_s": 79.5329864025116, "time_total_s": 7148.497532129288, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7148.497532129288, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 99.97982456140352, "ram_util_percent": 55.383333333333326}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.9160258451362937, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8355571153422718, "reward_component_totals/dist_change_reward_min": -0.9926844716318112, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.080468729794029, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0468729794021, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1119.42, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5594302848575712, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.918825744221832, -3.8410187506957403, -3.8391052049699304, -4.009221411245948, -3.91363225223348, -3.9668554306820996, -4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.88086062225235, "mean_inference_ms": 8.53838051802696, "mean_action_processing_ms": 0.4273638977760688, "mean_env_wait_ms": 10.357348732396085, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1032512, "agent_timesteps_total": 1032512, "timers": {"sample_time_ms": 44691.485, "sample_throughput": 268.642, "load_time_ms": 8.662, "load_throughput": 1386048.736, "learn_time_ms": 35847.989, "learn_throughput": 334.914, "update_time_ms": 28.381}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0042707351967692375, "policy_loss": 0.0003705511917360127, "vf_loss": 0.003900181967765093, "vf_explained_var": 0.18079164624214172, "kl": -1.449558473254342e-09, "entropy": 2.769075393676758, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1032512, "num_agent_steps_sampled": 1032512, "num_steps_trained": 1032512, "num_agent_steps_trained": 1032512}, "done": false, "episodes_total": 516, "training_iteration": 86, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-15-42", "timestamp": 1690845342, "time_this_iter_s": 78.86381363868713, "time_total_s": 7227.361345767975, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7227.361345767975, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 99.97699115044249, "ram_util_percent": 55.45221238938052}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.916577326645872, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8372199748723941, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.079357351773484, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93573517734762, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1122.8, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5611194402798599, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.0168914929136195, -3.964052600001475, -3.9822931051032118, -3.963361375743236, -3.9854752588384716, -3.8279183087940445, -3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.87958576167793, "mean_inference_ms": 8.533877864545376, "mean_action_processing_ms": 0.42728638466423374, "mean_env_wait_ms": 10.354547416023273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1044518, "agent_timesteps_total": 1044518, "timers": {"sample_time_ms": 44551.102, "sample_throughput": 269.488, "load_time_ms": 8.49, "load_throughput": 1414100.162, "learn_time_ms": 36006.394, "learn_throughput": 333.441, "update_time_ms": 29.258}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006273310631513596, "policy_loss": 0.0011544213630259037, "vf_loss": 0.005118889734148979, "vf_explained_var": 0.3125074505805969, "kl": -4.2986045833970365e-09, "entropy": 2.7197656631469727, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1044518, "num_agent_steps_sampled": 1044518, "num_steps_trained": 1044518, "num_agent_steps_trained": 1044518}, "done": false, "episodes_total": 522, "training_iteration": 87, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-17-02", "timestamp": 1690845422, "time_this_iter_s": 79.73290848731995, "time_total_s": 7307.094254255295, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7307.094254255295, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 99.98230088495575, "ram_util_percent": 55.39823008849556}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.915716320834552, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8362166984096153, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.079499622424944, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.94996224249357, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1119.03, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5592353823088455, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.901523035026034, -3.917686967661788, -4.060555976380545, -3.924799937988677, -3.8169134421454185, -3.882815363857781, -3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8784015391556068, "mean_inference_ms": 8.529534803751645, "mean_action_processing_ms": 0.42723027149458553, "mean_env_wait_ms": 10.352142770783287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1056524, "agent_timesteps_total": 1056524, "timers": {"sample_time_ms": 44586.351, "sample_throughput": 269.275, "load_time_ms": 8.469, "load_throughput": 1417567.401, "learn_time_ms": 35899.828, "learn_throughput": 334.431, "update_time_ms": 30.138}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004907790571451187, "policy_loss": 0.0006886267219670117, "vf_loss": 0.004219165537506342, "vf_explained_var": 0.07065849751234055, "kl": -6.359030635394447e-09, "entropy": 2.7735767364501953, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1056524, "num_agent_steps_sampled": 1056524, "num_steps_trained": 1056524, "num_agent_steps_trained": 1056524}, "done": false, "episodes_total": 528, "training_iteration": 88, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-18-20", "timestamp": 1690845500, "time_this_iter_s": 77.926349401474, "time_total_s": 7385.020603656769, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7385.020603656769, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.399999999999984}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.917091923030298, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8363601775408628, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.080731745489442, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0731745489434, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1139.53, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5694802598700649, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.908937554002777, -3.982810884729032, -3.770633875670846, -3.960783207718281, -3.9077928786516143, -3.835531567466483, -3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.877223583201683, "mean_inference_ms": 8.52504422866875, "mean_action_processing_ms": 0.4271755628221555, "mean_env_wait_ms": 10.349773751302198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1068530, "agent_timesteps_total": 1068530, "timers": {"sample_time_ms": 44254.221, "sample_throughput": 271.296, "load_time_ms": 8.308, "load_throughput": 1445033.426, "learn_time_ms": 35902.922, "learn_throughput": 334.402, "update_time_ms": 29.631}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005641873925924301, "policy_loss": 0.0011101579293608665, "vf_loss": 0.004531714599579573, "vf_explained_var": 0.19448834657669067, "kl": -4.541449438733025e-09, "entropy": 2.7465639114379883, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1068530, "num_agent_steps_sampled": 1068530, "num_steps_trained": 1068530, "num_agent_steps_trained": 1068530}, "done": false, "episodes_total": 534, "training_iteration": 89, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-19-37", "timestamp": 1690845577, "time_this_iter_s": 76.29071807861328, "time_total_s": 7461.311321735382, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7461.311321735382, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 99.97614678899085, "ram_util_percent": 55.351376146788965}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.9208483095878757, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8397777020960484, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.0810706074918346, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10706074918264, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1151.07, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5752473763118441, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.941650983780791, -3.8321297498596953, -3.9609114990292245, -3.836097358023057, -3.98141301322691, -3.8245162187427386, -4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8761498716558958, "mean_inference_ms": 8.521022062879052, "mean_action_processing_ms": 0.4271225072924528, "mean_env_wait_ms": 10.34760565121415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1080536, "agent_timesteps_total": 1080536, "timers": {"sample_time_ms": 44161.03, "sample_throughput": 271.869, "load_time_ms": 8.55, "load_throughput": 1404249.653, "learn_time_ms": 36028.033, "learn_throughput": 333.241, "update_time_ms": 29.117}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003921447787433863, "policy_loss": -0.0006179751362651587, "vf_loss": 0.0045394268818199635, "vf_explained_var": 0.19289399683475494, "kl": -4.5564707562562035e-09, "entropy": 2.7394654750823975, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1080536, "num_agent_steps_sampled": 1080536, "num_steps_trained": 1080536, "num_agent_steps_trained": 1080536}, "done": false, "episodes_total": 540, "training_iteration": 90, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-20-56", "timestamp": 1690845656, "time_this_iter_s": 78.98453092575073, "time_total_s": 7540.295852661133, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7540.295852661133, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 99.98053097345134, "ram_util_percent": 55.38141592920351}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.926941847628078, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8442595436307039, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.082682303997381, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.26823039973732, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1134.64, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5670364817591205, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.070888852457354, -3.864412258201532, -3.8299681229914104, -3.9466991413064165, -4.0184023711857595, -4.041061597320213, -4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.876008928229809, "mean_inference_ms": 8.516842413233705, "mean_action_processing_ms": 0.42709206940688454, "mean_env_wait_ms": 10.34558081528613, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1092542, "agent_timesteps_total": 1092542, "timers": {"sample_time_ms": 43750.342, "sample_throughput": 274.421, "load_time_ms": 8.581, "load_throughput": 1399154.059, "learn_time_ms": 36255.114, "learn_throughput": 331.153, "update_time_ms": 28.639}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004252292215824127, "policy_loss": 0.00011699334572767839, "vf_loss": 0.004135301802307367, "vf_explained_var": 0.16212892532348633, "kl": -2.395902365392999e-09, "entropy": 2.7794692516326904, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1092542, "num_agent_steps_sampled": 1092542, "num_steps_trained": 1092542, "num_agent_steps_trained": 1092542}, "done": false, "episodes_total": 546, "training_iteration": 91, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-22-24", "timestamp": 1690845744, "time_this_iter_s": 88.28020596504211, "time_total_s": 7628.576058626175, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7628.576058626175, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 99.98174603174604, "ram_util_percent": 55.39999999999997}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.923502682390301, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8430324537694384, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.0804702286208703, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.04702286208624, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1121.5, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5611073695169722, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.055299318295585, -3.849686982618234, -3.873321619498581, -3.824919878541146, -3.922883598125325, -3.8718602525662087, -3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8759140983834117, "mean_inference_ms": 8.512626332182206, "mean_action_processing_ms": 0.42704242266939557, "mean_env_wait_ms": 10.343277475260884, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1104396, "agent_timesteps_total": 1104396, "timers": {"sample_time_ms": 43869.769, "sample_throughput": 273.327, "load_time_ms": 8.487, "load_throughput": 1412869.29, "learn_time_ms": 36225.798, "learn_throughput": 331.002, "update_time_ms": 27.084}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006027191877365112, "policy_loss": 0.0002796039334498346, "vf_loss": 0.005747588351368904, "vf_explained_var": 0.31560200452804565, "kl": -3.978366969192848e-09, "entropy": 2.701240062713623, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1104396, "num_agent_steps_sampled": 1104396, "num_steps_trained": 1104396, "num_agent_steps_trained": 1104396}, "done": false, "episodes_total": 552, "training_iteration": 92, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-23-45", "timestamp": 1690845825, "time_this_iter_s": 80.38772439956665, "time_total_s": 7708.963783025742, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7708.963783025742, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 99.97610619469026, "ram_util_percent": 55.45929203539823}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.925148217992135, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8442774117242804, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.080870806267861, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0870806267853, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1122.05, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5613822320856877, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.8712782429062935, -4.026629024892268, -3.8035136359079877, -3.9421295892000057, -3.782039921483329, -3.854225583121065, -3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.875773485239861, "mean_inference_ms": 8.508526557161316, "mean_action_processing_ms": 0.426978504216319, "mean_env_wait_ms": 10.340531239869025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1116402, "agent_timesteps_total": 1116402, "timers": {"sample_time_ms": 43466.086, "sample_throughput": 275.866, "load_time_ms": 8.163, "load_throughput": 1468886.571, "learn_time_ms": 36111.727, "learn_throughput": 332.047, "update_time_ms": 26.549}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 9.999999960041972e-12, "total_loss": 0.002836091909557581, "policy_loss": -0.0011099590919911861, "vf_loss": 0.003946049604564905, "vf_explained_var": 0.21147525310516357, "kl": -1.4520620261748718e-09, "entropy": 2.7708346843719482, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1116402, "num_agent_steps_sampled": 1116402, "num_steps_trained": 1116402, "num_agent_steps_trained": 1116402}, "done": false, "episodes_total": 558, "training_iteration": 93, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-25-02", "timestamp": 1690845902, "time_this_iter_s": 77.06422400474548, "time_total_s": 7786.028007030487, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7786.028007030487, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 99.9809090909091, "ram_util_percent": 55.45636363636363}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.9292380447632507, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8482206019134795, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.0810174428497787, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10174428497712, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1108.46, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5545906278877868, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.7468950711013873, -3.8617767350552574, -4.004248509864157, -3.9530794556881403, -3.9437423853542732, -3.854809732909156, -3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8755339747526343, "mean_inference_ms": 8.504288233344537, "mean_action_processing_ms": 0.4268988704985021, "mean_env_wait_ms": 10.337335839272704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1128408, "agent_timesteps_total": 1128408, "timers": {"sample_time_ms": 43198.558, "sample_throughput": 277.574, "load_time_ms": 8.224, "load_throughput": 1457955.809, "learn_time_ms": 36198.985, "learn_throughput": 331.247, "update_time_ms": 26.878}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004494063090533018, "policy_loss": 0.0002627069770824164, "vf_loss": 0.004231357015669346, "vf_explained_var": 0.18413269519805908, "kl": -4.3361576551603775e-09, "entropy": 2.758107900619507, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1128408, "num_agent_steps_sampled": 1128408, "num_steps_trained": 1128408, "num_agent_steps_trained": 1128408}, "done": false, "episodes_total": 564, "training_iteration": 94, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-26-21", "timestamp": 1690845981, "time_this_iter_s": 78.39234614372253, "time_total_s": 7864.42035317421, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7864.42035317421, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.675000000000004}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.173083450519797, "episode_reward_mean": -3.931958382757807, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8524765820362251, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.079481800721589, "reward_component_totals/delta_v_min": -2.2020867917438283, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.94818007215815, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 220.2086791743819, "constraint_violation.max_vel_constraint.steps_mean": 1125.11, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5629114674679967, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.75637131312716, -4.002524863594012, -4.173083450519797, -3.8974187272077074, -3.9465614671292526, -4.000886588166417, -3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8752895055763252, "mean_inference_ms": 8.500168296641409, "mean_action_processing_ms": 0.4268073247347757, "mean_env_wait_ms": 10.33428013177511, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1140414, "agent_timesteps_total": 1140414, "timers": {"sample_time_ms": 43178.638, "sample_throughput": 277.702, "load_time_ms": 8.039, "load_throughput": 1491605.533, "learn_time_ms": 36251.038, "learn_throughput": 330.771, "update_time_ms": 28.462}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0059389108791947365, "policy_loss": 0.0006553158164024353, "vf_loss": 0.0052835987880826, "vf_explained_var": 0.1703796088695526, "kl": -3.7478224967912865e-09, "entropy": 2.7031362056732178, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1140414, "num_agent_steps_sampled": 1140414, "num_steps_trained": 1140414, "num_agent_steps_trained": 1140414}, "done": false, "episodes_total": 570, "training_iteration": 95, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-27-41", "timestamp": 1690846061, "time_this_iter_s": 79.86389780044556, "time_total_s": 7944.284250974655, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7944.284250974655, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 99.98421052631579, "ram_util_percent": 55.68508771929825}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.9336188181519174, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8537914715582828, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.0798273465936417, "reward_component_totals/delta_v_min": -2.138156438271201, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98273465936333, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 213.81564382711932, "constraint_violation.max_vel_constraint.steps_mean": 1135.08, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5678939762136239, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.916415849948483, -3.9725611053215144, -4.0995770906619295, -3.97233332790844, -4.02341223580045, -3.7635135886892535, -3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8750032384924298, "mean_inference_ms": 8.49597591042109, "mean_action_processing_ms": 0.4267179089296643, "mean_env_wait_ms": 10.33086021500295, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1152420, "agent_timesteps_total": 1152420, "timers": {"sample_time_ms": 42956.797, "sample_throughput": 279.136, "load_time_ms": 7.229, "load_throughput": 1658785.865, "learn_time_ms": 36296.305, "learn_throughput": 330.359, "update_time_ms": 30.912}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004845671355724335, "policy_loss": -0.0007768670911900699, "vf_loss": 0.005622539669275284, "vf_explained_var": 0.3408578038215637, "kl": -3.4849489960464552e-09, "entropy": 2.7017571926116943, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1152420, "num_agent_steps_sampled": 1152420, "num_steps_trained": 1152420, "num_agent_steps_trained": 1152420}, "done": false, "episodes_total": 576, "training_iteration": 96, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-28-58", "timestamp": 1690846138, "time_this_iter_s": 77.14666366577148, "time_total_s": 8021.430914640427, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8021.430914640427, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 99.9846846846847, "ram_util_percent": 55.42702702702699}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.929654243595883, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8496628276298328, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.079991415966057, "reward_component_totals/delta_v_min": -2.138156438271201, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.99914159660497, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 213.81564382711932, "constraint_violation.max_vel_constraint.steps_mean": 1153.79, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.577244301051205, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.940974373832109, -3.829491650068426, -3.9919805650740603, -4.074921599663902, -3.7699451673197695, -3.9544615248926913, -3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.873678854856156, "mean_inference_ms": 8.491884797033173, "mean_action_processing_ms": 0.4266068508453531, "mean_env_wait_ms": 10.327135070841225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1164426, "agent_timesteps_total": 1164426, "timers": {"sample_time_ms": 42744.703, "sample_throughput": 280.521, "load_time_ms": 7.279, "load_throughput": 1647375.64, "learn_time_ms": 36373.738, "learn_throughput": 329.655, "update_time_ms": 31.889}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004990892950445414, "policy_loss": -0.0002270570839755237, "vf_loss": 0.005217947531491518, "vf_explained_var": 0.25103724002838135, "kl": -4.478860393675177e-09, "entropy": 2.723386764526367, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1164426, "num_agent_steps_sampled": 1164426, "num_steps_trained": 1164426, "num_agent_steps_trained": 1164426}, "done": false, "episodes_total": 582, "training_iteration": 97, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-30-17", "timestamp": 1690846217, "time_this_iter_s": 78.39083957672119, "time_total_s": 8099.821754217148, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8099.821754217148, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 99.9857142857143, "ram_util_percent": 55.41160714285713}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.9269754046689376, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8468228691216251, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.08015253554732, "reward_component_totals/delta_v_min": -2.138156438271201, "reward_component_totals/delta_v_max": -2.0243574590484372, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.01525355473117, "delta_v_total_min": 202.43574590484263, "delta_v_total_max": 213.81564382711932, "constraint_violation.max_vel_constraint.steps_mean": 1156.09, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5783937263385615, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9534865666310735, -4.029651903336, -3.8780536741972957, -3.9390123916434763, -3.9504003798751057, -3.92717063060607, -4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8723287874907595, "mean_inference_ms": 8.488093074323078, "mean_action_processing_ms": 0.4264792818540613, "mean_env_wait_ms": 10.32313895841128, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1176432, "agent_timesteps_total": 1176432, "timers": {"sample_time_ms": 42485.747, "sample_throughput": 282.231, "load_time_ms": 7.208, "load_throughput": 1663586.911, "learn_time_ms": 36638.108, "learn_throughput": 327.277, "update_time_ms": 30.206}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004416865762323141, "policy_loss": 0.0005155382095836103, "vf_loss": 0.003901326796039939, "vf_explained_var": 0.14771747589111328, "kl": -7.585772898721643e-09, "entropy": 2.7670090198516846, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1176432, "num_agent_steps_sampled": 1176432, "num_steps_trained": 1176432, "num_agent_steps_trained": 1176432}, "done": false, "episodes_total": 588, "training_iteration": 98, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-31-35", "timestamp": 1690846295, "time_this_iter_s": 77.90795397758484, "time_total_s": 8177.729708194733, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8177.729708194733, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 99.97567567567567, "ram_util_percent": 55.5}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.9282427092561414, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8465927835071413, "reward_component_totals/dist_change_reward_min": -0.9947803643109892, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.081649925749007, "reward_component_totals/delta_v_min": -2.138156438271201, "reward_component_totals/delta_v_max": -2.02787356257439, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16499257489994, "delta_v_total_min": 202.78735625743815, "delta_v_total_max": 213.81564382711932, "constraint_violation.max_vel_constraint.steps_mean": 1154.74, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5777190636698957, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.071614478902539, -3.790595346950621, -3.892902159617457, -3.876131680209755, -3.872263527087056, -3.903567895715579, -3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8709990326995802, "mean_inference_ms": 8.484265475064273, "mean_action_processing_ms": 0.4263508886624527, "mean_env_wait_ms": 10.319235344881843, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1188438, "agent_timesteps_total": 1188438, "timers": {"sample_time_ms": 42655.647, "sample_throughput": 281.107, "load_time_ms": 7.222, "load_throughput": 1660253.41, "learn_time_ms": 37045.207, "learn_throughput": 323.68, "update_time_ms": 29.726}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004520927555859089, "policy_loss": -0.0011817732593044639, "vf_loss": 0.005702701862901449, "vf_explained_var": 0.3487633466720581, "kl": -6.964890886251851e-09, "entropy": 2.6890623569488525, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1188438, "num_agent_steps_sampled": 1188438, "num_steps_trained": 1188438, "num_agent_steps_trained": 1188438}, "done": false, "episodes_total": 594, "training_iteration": 99, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-32-57", "timestamp": 1690846377, "time_this_iter_s": 82.13255882263184, "time_total_s": 8259.862267017365, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8259.862267017365, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 99.98103448275862, "ram_util_percent": 55.49913793103448}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6305557861958313, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.932703300070285, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8515253282850211, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.5185760547254852, "reward_component_totals/delta_v_mean": -2.0811779717852708, "reward_component_totals/delta_v_min": -2.138156438271201, "reward_component_totals/delta_v_max": -2.02787356257439, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.11779717852627, "delta_v_total_min": 202.78735625743815, "delta_v_total_max": 213.81564382711932, "constraint_violation.max_vel_constraint.steps_mean": 1139.7, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5702028217908353, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.8362520690713504, -3.832333188831197, -4.099425253838035, -3.8604228728547194, -3.6305557861958313, -3.90643542250767, -3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8696693372182336, "mean_inference_ms": 8.480232907049386, "mean_action_processing_ms": 0.4262136171457305, "mean_env_wait_ms": 10.31494676668881, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1200444, "agent_timesteps_total": 1200444, "timers": {"sample_time_ms": 42507.807, "sample_throughput": 282.085, "load_time_ms": 7.803, "load_throughput": 1536651.3, "learn_time_ms": 37313.214, "learn_throughput": 321.355, "update_time_ms": 30.242}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0051316567696630955, "policy_loss": 0.000838687177747488, "vf_loss": 0.00429296912625432, "vf_explained_var": 0.1762947142124176, "kl": -4.9420183501069914e-09, "entropy": 2.7475194931030273, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1200444, "num_agent_steps_sampled": 1200444, "num_steps_trained": 1200444, "num_agent_steps_trained": 1200444}, "done": false, "episodes_total": 600, "training_iteration": 100, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-34-17", "timestamp": 1690846457, "time_this_iter_s": 80.16994881629944, "time_total_s": 8340.032215833664, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8340.032215833664, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 99.98260869565217, "ram_util_percent": 55.49913043478261}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7823979052535073, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.936240824061818, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8563747493427896, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7084811739931969, "reward_component_totals/delta_v_mean": -2.079866074719035, "reward_component_totals/delta_v_min": -2.138156438271201, "reward_component_totals/delta_v_max": -2.02787356257439, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98660747190274, "delta_v_total_min": 202.78735625743815, "delta_v_total_max": 213.81564382711932, "constraint_violation.max_vel_constraint.steps_mean": 1146.06, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5733812325854379, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.784643598066392, -4.048945180441973, -3.7833051307938446, -3.9816224686204107, -3.844925626203057, -3.9067561475656527, -3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8690825521233443, "mean_inference_ms": 8.475879034289752, "mean_action_processing_ms": 0.426048779091443, "mean_env_wait_ms": 10.310045433281164, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1212450, "agent_timesteps_total": 1212450, "timers": {"sample_time_ms": 42492.729, "sample_throughput": 282.185, "load_time_ms": 7.816, "load_throughput": 1534073.341, "learn_time_ms": 37380.393, "learn_throughput": 320.778, "update_time_ms": 29.164}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004496574867516756, "policy_loss": 0.0003456978010945022, "vf_loss": 0.004150876775383949, "vf_explained_var": 0.13380166888237, "kl": -5.986000584101703e-09, "entropy": 2.76326847076416, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1212450, "num_agent_steps_sampled": 1212450, "num_steps_trained": 1212450, "num_agent_steps_trained": 1212450}, "done": false, "episodes_total": 606, "training_iteration": 101, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-35-47", "timestamp": 1690846547, "time_this_iter_s": 88.74861121177673, "time_total_s": 8428.78082704544, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8428.78082704544, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 99.98650793650795, "ram_util_percent": 55.49920634920635}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7823979052535073, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.94060339714748, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8598264640337504, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7084811739931969, "reward_component_totals/delta_v_mean": -2.0807769331137376, "reward_component_totals/delta_v_min": -2.138156438271201, "reward_component_totals/delta_v_max": -2.02787356257439, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07769331137297, "delta_v_total_min": 202.78735625743815, "delta_v_total_max": 213.81564382711932, "constraint_violation.max_vel_constraint.steps_mean": 1158.09, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5793932265884364, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.8588865775742027, -4.012771349878962, -3.7880925439606434, -3.9659998435321597, -3.7823979052535073, -3.948033415689621, -4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8684738029877406, "mean_inference_ms": 8.471410557843203, "mean_action_processing_ms": 0.425873137930749, "mean_env_wait_ms": 10.304827860843723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1224456, "agent_timesteps_total": 1224456, "timers": {"sample_time_ms": 42200.304, "sample_throughput": 284.5, "load_time_ms": 8.453, "load_throughput": 1420266.128, "learn_time_ms": 37476.347, "learn_throughput": 320.362, "update_time_ms": 29.417}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005312229506671429, "policy_loss": 0.0004752452077809721, "vf_loss": 0.004836985841393471, "vf_explained_var": 0.20772600173950195, "kl": -2.440966317962534e-09, "entropy": 2.7467777729034424, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1224456, "num_agent_steps_sampled": 1224456, "num_steps_trained": 1224456, "num_agent_steps_trained": 1224456}, "done": false, "episodes_total": 612, "training_iteration": 102, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-37-05", "timestamp": 1690846625, "time_this_iter_s": 78.4002730846405, "time_total_s": 8507.181100130081, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8507.181100130081, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 99.98660714285714, "ram_util_percent": 55.49910714285714}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7848161630243053, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.94621956084563, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8646048331135904, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7084811739931969, "reward_component_totals/delta_v_mean": -2.081614727732046, "reward_component_totals/delta_v_min": -2.138156438271201, "reward_component_totals/delta_v_max": -2.02787356257439, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16147277320383, "delta_v_total_min": 202.78735625743815, "delta_v_total_max": 213.81564382711932, "constraint_violation.max_vel_constraint.steps_mean": 1145.86, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5732812825604505, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.062005916385353, -3.7947054567671668, -3.9240851216460824, -4.032579129264986, -4.000448274403636, -3.940659639993253, -3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8678514495256437, "mean_inference_ms": 8.466887113317911, "mean_action_processing_ms": 0.4256774338380625, "mean_env_wait_ms": 10.299117187991206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1236462, "agent_timesteps_total": 1236462, "timers": {"sample_time_ms": 42105.386, "sample_throughput": 285.142, "load_time_ms": 8.432, "load_throughput": 1423783.835, "learn_time_ms": 37693.543, "learn_throughput": 318.516, "update_time_ms": 29.85}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005435124039649963, "policy_loss": 0.0006139613105915487, "vf_loss": 0.0048211622051894665, "vf_explained_var": 0.26565682888031006, "kl": -4.6841521772478245e-09, "entropy": 2.726284980773926, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1236462, "num_agent_steps_sampled": 1236462, "num_steps_trained": 1236462, "num_agent_steps_trained": 1236462}, "done": false, "episodes_total": 618, "training_iteration": 103, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-38-24", "timestamp": 1690846704, "time_this_iter_s": 78.26929497718811, "time_total_s": 8585.45039510727, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8585.45039510727, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 99.98839285714287, "ram_util_percent": 55.5}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7848161630243053, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.942118929774826, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.861570727782219, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7084811739931969, "reward_component_totals/delta_v_mean": -2.0805482019926145, "reward_component_totals/delta_v_min": -2.138156438271201, "reward_component_totals/delta_v_max": -2.02787356257439, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0548201992607, "delta_v_total_min": 202.78735625743815, "delta_v_total_max": 213.81564382711932, "constraint_violation.max_vel_constraint.steps_mean": 1159.59, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5801428517758428, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.9183096057027242, -3.99448468768158, -3.7848161630243053, -4.015173189456665, -4.021028423409113, -4.001464853317458, -3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8672211467921573, "mean_inference_ms": 8.462557116220095, "mean_action_processing_ms": 0.4254714328548804, "mean_env_wait_ms": 10.293092374260484, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1248468, "agent_timesteps_total": 1248468, "timers": {"sample_time_ms": 42100.649, "sample_throughput": 285.174, "load_time_ms": 8.955, "load_throughput": 1340674.688, "learn_time_ms": 37603.173, "learn_throughput": 319.282, "update_time_ms": 31.015}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006749408785253763, "policy_loss": 0.0010212191846221685, "vf_loss": 0.005728188902139664, "vf_explained_var": 0.31567808985710144, "kl": -2.7188611362305437e-09, "entropy": 2.6854898929595947, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1248468, "num_agent_steps_sampled": 1248468, "num_steps_trained": 1248468, "num_agent_steps_trained": 1248468}, "done": false, "episodes_total": 624, "training_iteration": 104, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-39-41", "timestamp": 1690846781, "time_this_iter_s": 77.42886996269226, "time_total_s": 8662.879265069962, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8662.879265069962, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 99.98378378378378, "ram_util_percent": 55.5}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7882303293138513, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.9454551169127945, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8646400315598409, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7084811739931969, "reward_component_totals/delta_v_mean": -2.0808150853529606, "reward_component_totals/delta_v_min": -2.138156438271201, "reward_component_totals/delta_v_max": -2.02787356257439, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.08150853529528, "delta_v_total_min": 202.78735625743815, "delta_v_total_max": 213.81564382711932, "constraint_violation.max_vel_constraint.steps_mean": 1129.12, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5649154654689962, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.855533224127514, -3.826673012137239, -3.892111211092452, -4.045044218551059, -3.8827335277149517, -3.991112300681969, -4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8665520719443143, "mean_inference_ms": 8.458584626180276, "mean_action_processing_ms": 0.4252774837835822, "mean_env_wait_ms": 10.287145200729544, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1260474, "agent_timesteps_total": 1260474, "timers": {"sample_time_ms": 41979.578, "sample_throughput": 285.996, "load_time_ms": 8.964, "load_throughput": 1339284.087, "learn_time_ms": 37733.255, "learn_throughput": 318.181, "update_time_ms": 30.257}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004166203085333109, "policy_loss": 0.0005532738869078457, "vf_loss": 0.0036129304207861423, "vf_explained_var": 0.16066710650920868, "kl": -4.2810794909087235e-09, "entropy": 2.792694330215454, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1260474, "num_agent_steps_sampled": 1260474, "num_steps_trained": 1260474, "num_agent_steps_trained": 1260474}, "done": false, "episodes_total": 630, "training_iteration": 105, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-41-01", "timestamp": 1690846861, "time_this_iter_s": 79.93871927261353, "time_total_s": 8742.817984342575, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8742.817984342575, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 99.98421052631579, "ram_util_percent": 55.49912280701754}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7882303293138513, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.94506893728534, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8640336067076523, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7084811739931969, "reward_component_totals/delta_v_mean": -2.081035330577694, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.02787356257439, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10353305776866, "delta_v_total_min": 202.78735625743815, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1114.16, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5574392035999307, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.033488768042849, -3.869741958224477, -4.099610132147252, -3.865441937185331, -4.091334476610549, -3.9125176325385866, -3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8659214870267533, "mean_inference_ms": 8.454687595203167, "mean_action_processing_ms": 0.4250743176194795, "mean_env_wait_ms": 10.281022909505081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1272480, "agent_timesteps_total": 1272480, "timers": {"sample_time_ms": 42015.596, "sample_throughput": 285.751, "load_time_ms": 9.096, "load_throughput": 1319975.828, "learn_time_ms": 37831.267, "learn_throughput": 317.357, "update_time_ms": 29.519}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006408561486750841, "policy_loss": 1.178473553409276e-06, "vf_loss": 0.006407382898032665, "vf_explained_var": 0.3397808074951172, "kl": -5.505317979270785e-09, "entropy": 2.6648154258728027, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1272480, "num_agent_steps_sampled": 1272480, "num_steps_trained": 1272480, "num_agent_steps_trained": 1272480}, "done": false, "episodes_total": 636, "training_iteration": 106, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-42-20", "timestamp": 1690846940, "time_this_iter_s": 78.49665689468384, "time_total_s": 8821.314641237259, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8821.314641237259, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 99.9857142857143, "ram_util_percent": 55.5}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7882303293138513, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.94051122085147, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.859501790200106, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7084811739931969, "reward_component_totals/delta_v_mean": -2.0810094306513696, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.02787356257439, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10094306513622, "delta_v_total_min": 202.78735625743815, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1100.12, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5504227118458078, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.996396974650236, -4.027708054864981, -4.018382506392489, -3.9397329816258053, -3.826864640673886, -3.8687043355806043, -4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8643964244808082, "mean_inference_ms": 8.450950380106523, "mean_action_processing_ms": 0.4248569426714866, "mean_env_wait_ms": 10.27480683474007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1284486, "agent_timesteps_total": 1284486, "timers": {"sample_time_ms": 42071.558, "sample_throughput": 285.371, "load_time_ms": 9.063, "load_throughput": 1324708.691, "learn_time_ms": 37809.263, "learn_throughput": 317.541, "update_time_ms": 29.15}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006771569140255451, "policy_loss": 0.00149358285125345, "vf_loss": 0.0052779847756028175, "vf_explained_var": 0.21011419594287872, "kl": -5.7131130937193575e-09, "entropy": 2.7232236862182617, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1284486, "num_agent_steps_sampled": 1284486, "num_steps_trained": 1284486, "num_agent_steps_trained": 1284486}, "done": false, "episodes_total": 642, "training_iteration": 107, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-43-39", "timestamp": 1690847019, "time_this_iter_s": 78.74940204620361, "time_total_s": 8900.064043283463, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8900.064043283463, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 99.98839285714287, "ram_util_percent": 55.5}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7882303293138513, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.939020108938477, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8575835416831229, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7084811739931969, "reward_component_totals/delta_v_mean": -2.081436567255361, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.0364886217812708, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.14365672553532, "delta_v_total_min": 203.64886217812654, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1137.25, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5689784339847382, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.059289687293482, -4.016595126107649, -3.843101146271933, -3.812960883757524, -3.882487975535457, -4.08931438598516, -3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044], "episode_lengths": [2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.86286774203527, "mean_inference_ms": 8.4471610418513, "mean_action_processing_ms": 0.42463330897620677, "mean_env_wait_ms": 10.268689766703185, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1296492, "agent_timesteps_total": 1296492, "timers": {"sample_time_ms": 41985.134, "sample_throughput": 285.958, "load_time_ms": 9.147, "load_throughput": 1312571.714, "learn_time_ms": 37870.832, "learn_throughput": 317.025, "update_time_ms": 29.411}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005089533049613237, "policy_loss": -0.00021181661577429622, "vf_loss": 0.005301348399370909, "vf_explained_var": 0.2585796117782593, "kl": -2.7188611362305437e-09, "entropy": 2.6991147994995117, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1296492, "num_agent_steps_sampled": 1296492, "num_steps_trained": 1296492, "num_agent_steps_trained": 1296492}, "done": false, "episodes_total": 648, "training_iteration": 108, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-44-57", "timestamp": 1690847097, "time_this_iter_s": 77.66094160079956, "time_total_s": 8977.724984884262, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8977.724984884262, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 99.98378378378378, "ram_util_percent": 55.4954954954955}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7882303293138513, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.9375882217783107, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8560737131877149, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7113632384031869, "reward_component_totals/delta_v_mean": -2.0815145085906015, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.0364886217812708, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.15145085905948, "delta_v_total_min": 203.64886217812654, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1145.23, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5723288355822089, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.8032520988744007, -3.7882303293138513, -4.000320154024935, -3.9989202660945082, -3.978174955594393, -3.8135415206802485, -3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8613297013518626, "mean_inference_ms": 8.443333756324334, "mean_action_processing_ms": 0.4244234456759305, "mean_env_wait_ms": 10.262539705243848, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1308498, "agent_timesteps_total": 1308498, "timers": {"sample_time_ms": 41941.418, "sample_throughput": 286.256, "load_time_ms": 9.316, "load_throughput": 1288748.428, "learn_time_ms": 37703.863, "learn_throughput": 318.429, "update_time_ms": 30.936}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004087984096258879, "policy_loss": -0.00028423749608919024, "vf_loss": 0.004372222814708948, "vf_explained_var": 0.19048979878425598, "kl": -4.080795257266345e-09, "entropy": 2.750624895095825, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1308498, "num_agent_steps_sampled": 1308498, "num_steps_trained": 1308498, "num_agent_steps_trained": 1308498}, "done": false, "episodes_total": 654, "training_iteration": 109, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-46-17", "timestamp": 1690847177, "time_this_iter_s": 80.02889108657837, "time_total_s": 9057.75387597084, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9057.75387597084, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 99.97894736842106, "ram_util_percent": 55.46491228070174}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7939430513385615, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.9404308957074146, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8589665358949791, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.722116179303509, "reward_component_totals/delta_v_mean": -2.0814643598124416, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.0364886217812708, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1464359812434, "delta_v_total_min": 203.64886217812654, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1159.56, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5794902548725637, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.837835812582864, -4.000842334827738, -3.9988715828408994, -4.05953246809649, -3.892747119444042, -3.9718933596336967, -4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.859787128603131, "mean_inference_ms": 8.439700293726814, "mean_action_processing_ms": 0.42421723757818675, "mean_env_wait_ms": 10.256556019591393, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1320504, "agent_timesteps_total": 1320504, "timers": {"sample_time_ms": 42148.307, "sample_throughput": 284.851, "load_time_ms": 8.471, "load_throughput": 1417367.904, "learn_time_ms": 37849.241, "learn_throughput": 317.206, "update_time_ms": 29.366}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005415053106844425, "policy_loss": 0.0006619750056415796, "vf_loss": 0.004753079731017351, "vf_explained_var": 0.2564135789871216, "kl": -5.239941369694634e-09, "entropy": 2.725771903991699, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1320504, "num_agent_steps_sampled": 1320504, "num_steps_trained": 1320504, "num_agent_steps_trained": 1320504}, "done": false, "episodes_total": 660, "training_iteration": 110, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-47-41", "timestamp": 1690847261, "time_this_iter_s": 83.6547577381134, "time_total_s": 9141.408633708954, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9141.408633708954, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 99.98583333333333, "ram_util_percent": 55.429999999999986}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7939430513385615, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.938444015125082, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8567777013765264, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.722116179303509, "reward_component_totals/delta_v_mean": -2.0816663137485616, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.0228241982559405, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16663137485543, "delta_v_total_min": 202.28241982559308, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1142.47, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5709495252373813, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.0255615238556155, -4.05831977540045, -3.836584792775893, -3.851479118318287, -3.92146065466747, -3.9249713174694962, -3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8589682987685345, "mean_inference_ms": 8.435671620182193, "mean_action_processing_ms": 0.4240196837925513, "mean_env_wait_ms": 10.250399144911787, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1332510, "agent_timesteps_total": 1332510, "timers": {"sample_time_ms": 41981.633, "sample_throughput": 285.982, "load_time_ms": 8.432, "load_throughput": 1423872.404, "learn_time_ms": 37896.402, "learn_throughput": 316.811, "update_time_ms": 31.619}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004178256262093782, "policy_loss": 0.00010921261127805337, "vf_loss": 0.004069042857736349, "vf_explained_var": 0.2113415151834488, "kl": -6.817181041895992e-09, "entropy": 2.7603683471679688, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1332510, "num_agent_steps_sampled": 1332510, "num_steps_trained": 1332510, "num_agent_steps_trained": 1332510}, "done": false, "episodes_total": 666, "training_iteration": 111, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-49-09", "timestamp": 1690847349, "time_this_iter_s": 87.6400740146637, "time_total_s": 9229.048707723618, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9229.048707723618, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 99.98479999999999, "ram_util_percent": 55.501599999999996}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7723419545322496, "episode_reward_min": -4.113868382570607, "episode_reward_mean": -3.9360694949665618, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8560965635710935, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.722116179303509, "reward_component_totals/delta_v_mean": -2.0799729313954742, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.99729313954663, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1119.26, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5593503248375812, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.9363070303621015, -4.0371514278752665, -4.009131136210429, -4.113868382570607, -3.8211346934681645, -4.002147963562642, -3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8581480367169574, "mean_inference_ms": 8.43161040027199, "mean_action_processing_ms": 0.4238121089540555, "mean_env_wait_ms": 10.243914716066234, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1344516, "agent_timesteps_total": 1344516, "timers": {"sample_time_ms": 42138.99, "sample_throughput": 284.914, "load_time_ms": 7.931, "load_throughput": 1513880.536, "learn_time_ms": 37823.296, "learn_throughput": 317.423, "update_time_ms": 31.588}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004598076920956373, "policy_loss": -0.0002819503133650869, "vf_loss": 0.004880026914179325, "vf_explained_var": 0.24400553107261658, "kl": -3.607623089152412e-09, "entropy": 2.7235631942749023, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1344516, "num_agent_steps_sampled": 1344516, "num_steps_trained": 1344516, "num_agent_steps_trained": 1344516}, "done": false, "episodes_total": 672, "training_iteration": 112, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-50-28", "timestamp": 1690847428, "time_this_iter_s": 79.2002100944519, "time_total_s": 9308.24891781807, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9308.24891781807, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 99.98407079646019, "ram_util_percent": 55.5283185840708}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7723419545322496, "episode_reward_min": -4.0929467578021725, "episode_reward_mean": -3.9306580160765363, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8511102860315185, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7182702416169818, "reward_component_totals/delta_v_mean": -2.079547730045024, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.95477300450165, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1120.1, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5597701149425288, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.9464674567347355, -3.8473637798599016, -3.889515065338406, -3.8447267837627517, -3.84251270701487, -3.8313774195376906, -3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8572575214721843, "mean_inference_ms": 8.427977259167516, "mean_action_processing_ms": 0.42358582357674535, "mean_env_wait_ms": 10.237154175890431, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1356522, "agent_timesteps_total": 1356522, "timers": {"sample_time_ms": 42165.125, "sample_throughput": 284.738, "load_time_ms": 8.153, "load_throughput": 1472602.303, "learn_time_ms": 37872.244, "learn_throughput": 317.013, "update_time_ms": 31.402}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.851859946171657e-35, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005316354334354401, "policy_loss": -8.144748426275328e-05, "vf_loss": 0.005397802218794823, "vf_explained_var": 0.27920469641685486, "kl": -4.81934403495643e-09, "entropy": 2.7026054859161377, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1356522, "num_agent_steps_sampled": 1356522, "num_steps_trained": 1356522, "num_agent_steps_trained": 1356522}, "done": false, "episodes_total": 678, "training_iteration": 113, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-51-48", "timestamp": 1690847508, "time_this_iter_s": 79.04194116592407, "time_total_s": 9387.290858983994, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9387.290858983994, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 99.98053097345134, "ram_util_percent": 55.45221238938051}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7723419545322496, "episode_reward_min": -4.0929467578021725, "episode_reward_mean": -3.9310743038408287, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8518951912912089, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7182702416169818, "reward_component_totals/delta_v_mean": -2.079179112549626, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.91791125496187, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1120.58, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5600099950024987, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.878875200720966, -3.9660086451271814, -3.8575552396408272, -3.917561776114895, -3.9106909652976096, -4.0686464027079925, -3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8563731427437984, "mean_inference_ms": 8.424187611953071, "mean_action_processing_ms": 0.42336505718323714, "mean_env_wait_ms": 10.230317508762424, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1368528, "agent_timesteps_total": 1368528, "timers": {"sample_time_ms": 42063.029, "sample_throughput": 285.429, "load_time_ms": 7.547, "load_throughput": 1590896.747, "learn_time_ms": 38112.856, "learn_throughput": 315.012, "update_time_ms": 30.252}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005555931478738785, "policy_loss": 0.0004991618334315717, "vf_loss": 0.005056769587099552, "vf_explained_var": 0.18381571769714355, "kl": -4.884436410890203e-09, "entropy": 2.737806797027588, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1368528, "num_agent_steps_sampled": 1368528, "num_steps_trained": 1368528, "num_agent_steps_trained": 1368528}, "done": false, "episodes_total": 684, "training_iteration": 114, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-53-07", "timestamp": 1690847587, "time_this_iter_s": 78.83832001686096, "time_total_s": 9466.129179000854, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9466.129179000854, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 99.99107142857143, "ram_util_percent": 55.37053571428571}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7723419545322496, "episode_reward_min": -4.0929467578021725, "episode_reward_mean": -3.930577435319616, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8505422267104156, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7182702416169818, "reward_component_totals/delta_v_mean": -2.0800352086092064, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00352086091993, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1134.71, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.567071464267866, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.873864733639677, -3.9769300557978164, -3.975640632506492, -3.9987332150598798, -3.8176409046184214, -3.94976743334977, -4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8554460962147437, "mean_inference_ms": 8.420299451152859, "mean_action_processing_ms": 0.42314923551755484, "mean_env_wait_ms": 10.223185741563752, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1380534, "agent_timesteps_total": 1380534, "timers": {"sample_time_ms": 41863.408, "sample_throughput": 286.79, "load_time_ms": 6.459, "load_throughput": 1858754.298, "learn_time_ms": 37951.755, "learn_throughput": 316.349, "update_time_ms": 29.445}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.629649865429142e-36, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003617743728682399, "policy_loss": -0.0006019670399837196, "vf_loss": 0.004219711292535067, "vf_explained_var": 0.08728359639644623, "kl": -6.917323158717181e-09, "entropy": 2.791517734527588, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1380534, "num_agent_steps_sampled": 1380534, "num_steps_trained": 1380534, "num_agent_steps_trained": 1380534}, "done": false, "episodes_total": 690, "training_iteration": 115, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-54-23", "timestamp": 1690847663, "time_this_iter_s": 76.30399084091187, "time_total_s": 9542.433169841766, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9542.433169841766, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 99.97889908256882, "ram_util_percent": 55.39724770642199}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7723419545322496, "episode_reward_min": -4.0929467578021725, "episode_reward_mean": -3.930331965576354, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8507555096375404, "reward_component_totals/dist_change_reward_min": -0.9989304010706912, "reward_component_totals/dist_change_reward_max": -0.7182702416169818, "reward_component_totals/delta_v_mean": -2.079576455938819, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.95764559388124, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1134.6, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5670164917541229, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.044781003310057, -4.0549608107705675, -3.9950737607811098, -3.990910257067425, -4.021804419607928, -3.827444384152737, -3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8544340104270736, "mean_inference_ms": 8.416363923347037, "mean_action_processing_ms": 0.42292339006334145, "mean_env_wait_ms": 10.215493678519747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1392540, "agent_timesteps_total": 1392540, "timers": {"sample_time_ms": 41711.883, "sample_throughput": 287.832, "load_time_ms": 6.238, "load_throughput": 1924785.429, "learn_time_ms": 38055.079, "learn_throughput": 315.49, "update_time_ms": 29.024}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004164902959018946, "policy_loss": -0.00021147313236724585, "vf_loss": 0.004376374650746584, "vf_explained_var": 0.15442140400409698, "kl": -6.644435668334836e-09, "entropy": 2.766350507736206, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1392540, "num_agent_steps_sampled": 1392540, "num_steps_trained": 1392540, "num_agent_steps_trained": 1392540}, "done": false, "episodes_total": 696, "training_iteration": 116, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-55-41", "timestamp": 1690847741, "time_this_iter_s": 78.02665209770203, "time_total_s": 9620.459821939468, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9620.459821939468, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 99.98108108108107, "ram_util_percent": 55.33423423423424}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7723419545322496, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.928411068164724, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8498132307881323, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.078597837376597, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85978373765906, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1144.8, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5721139430284857, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.93781617861179, -3.951279560148796, -3.852530361320052, -3.928302088610754, -3.814931010024666, -4.05259789484781, -3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8525902679748425, "mean_inference_ms": 8.412633089070242, "mean_action_processing_ms": 0.4226844183265034, "mean_env_wait_ms": 10.207638129630597, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1404546, "agent_timesteps_total": 1404546, "timers": {"sample_time_ms": 41480.179, "sample_throughput": 289.439, "load_time_ms": 6.396, "load_throughput": 1877066.5, "learn_time_ms": 37989.692, "learn_throughput": 316.033, "update_time_ms": 28.159}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4074124663572855e-36, "cur_lr": 9.999999960041972e-12, "total_loss": 0.00489027937874198, "policy_loss": -0.00035285676131024957, "vf_loss": 0.005243134684860706, "vf_explained_var": 0.2042187750339508, "kl": -5.800737667982503e-09, "entropy": 2.7109556198120117, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1404546, "num_agent_steps_sampled": 1404546, "num_steps_trained": 1404546, "num_agent_steps_trained": 1404546}, "done": false, "episodes_total": 702, "training_iteration": 117, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-56-57", "timestamp": 1690847817, "time_this_iter_s": 75.75258922576904, "time_total_s": 9696.212411165237, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9696.212411165237, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 99.97962962962963, "ram_util_percent": 55.31666666666666}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7723419545322496, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.929707235556603, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8511412293749687, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.0785660061816404, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85660061816333, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1144.52, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5719740129935031, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.9245109405817673, -4.0929467578021725, -3.9153181461259954, -3.9861507108752576, -3.946069327650922, -4.08528319886335, -4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.850764822737288, "mean_inference_ms": 8.40886705082319, "mean_action_processing_ms": 0.4224409449521084, "mean_env_wait_ms": 10.199588626655366, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1416552, "agent_timesteps_total": 1416552, "timers": {"sample_time_ms": 41391.273, "sample_throughput": 290.061, "load_time_ms": 6.247, "load_throughput": 1921817.745, "learn_time_ms": 37947.719, "learn_throughput": 316.383, "update_time_ms": 28.114}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2037062331786428e-36, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004831499420106411, "policy_loss": -0.0004057411861140281, "vf_loss": 0.005237239878624678, "vf_explained_var": 0.2266026735305786, "kl": -5.535360614317142e-09, "entropy": 2.699310302734375, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1416552, "num_agent_steps_sampled": 1416552, "num_steps_trained": 1416552, "num_agent_steps_trained": 1416552}, "done": false, "episodes_total": 708, "training_iteration": 118, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-58-14", "timestamp": 1690847894, "time_this_iter_s": 76.30358862876892, "time_total_s": 9772.515999794006, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9772.515999794006, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 99.98073394495412, "ram_util_percent": 55.381651376146756}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7723419545322496, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.925223316500561, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8482744768132572, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.076948839687311, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.69488396873032, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1139.81, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5696201899050474, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-4.012490991667081, -3.9598942756788142, -4.041508123515927, -3.8725520883278493, -3.90537944068845, -3.8098638886492555, -3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8489704798668003, "mean_inference_ms": 8.405233908358738, "mean_action_processing_ms": 0.42221183569939513, "mean_env_wait_ms": 10.191710193483884, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1428558, "agent_timesteps_total": 1428558, "timers": {"sample_time_ms": 41286.148, "sample_throughput": 290.8, "load_time_ms": 6.078, "load_throughput": 1975187.542, "learn_time_ms": 38230.416, "learn_throughput": 314.043, "update_time_ms": 26.422}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0051897368393838406, "policy_loss": 0.0006028315983712673, "vf_loss": 0.004586906637996435, "vf_explained_var": 0.23570574820041656, "kl": -4.701676825646928e-09, "entropy": 2.7280406951904297, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1428558, "num_agent_steps_sampled": 1428558, "num_steps_trained": 1428558, "num_agent_steps_trained": 1428558}, "done": false, "episodes_total": 714, "training_iteration": 119, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_16-59-36", "timestamp": 1690847976, "time_this_iter_s": 81.76938796043396, "time_total_s": 9854.28538775444, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9854.28538775444, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 99.98376068376069, "ram_util_percent": 55.39572649572647}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7723419545322496, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.9261456530952916, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8489942993451652, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.0771513537501325, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.71513537501255, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1144.78, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5721039480259871, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.9231313933324796, -3.9351478840637486, -3.8747440465680487, -3.896153778078221, -4.086226952321928, -4.037763500424417, -4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.847200628940728, "mean_inference_ms": 8.401829896472007, "mean_action_processing_ms": 0.42198587984511027, "mean_env_wait_ms": 10.183925588292004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1440564, "agent_timesteps_total": 1440564, "timers": {"sample_time_ms": 41042.02, "sample_throughput": 292.529, "load_time_ms": 6.57, "load_throughput": 1827521.759, "learn_time_ms": 37984.414, "learn_throughput": 316.077, "update_time_ms": 27.878}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.009265582946607e-37, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0039029044564813375, "policy_loss": -0.00044853263534605503, "vf_loss": 0.00435143755748868, "vf_explained_var": 0.2818606495857239, "kl": -2.000340781904697e-09, "entropy": 2.7435455322265625, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1440564, "num_agent_steps_sampled": 1440564, "num_steps_trained": 1440564, "num_agent_steps_trained": 1440564}, "done": false, "episodes_total": 720, "training_iteration": 120, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-00-55", "timestamp": 1690848055, "time_this_iter_s": 78.77806258201599, "time_total_s": 9933.063450336456, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9933.063450336456, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 99.98407079646019, "ram_util_percent": 55.39203539823007}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7723419545322496, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.92575480765161, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8484825469618787, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.0772722606897385, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7272260689731, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1143.98, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.571704147926037, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-4.03280442390875, -3.83689126021388, -4.043371970895882, -4.031837528623797, -3.9235091089640446, -3.8085683566480983, -3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8461455795165955, "mean_inference_ms": 8.398109290140612, "mean_action_processing_ms": 0.42174553190699043, "mean_env_wait_ms": 10.176020644825158, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1452570, "agent_timesteps_total": 1452570, "timers": {"sample_time_ms": 41677.505, "sample_throughput": 288.069, "load_time_ms": 6.399, "load_throughput": 1876304.156, "learn_time_ms": 37760.055, "learn_throughput": 317.955, "update_time_ms": 27.738}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5046327914733034e-37, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0025529663544148207, "policy_loss": -0.0020245949272066355, "vf_loss": 0.004577559884637594, "vf_explained_var": 0.25724631547927856, "kl": -2.7138540303894843e-09, "entropy": 2.746281862258911, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1452570, "num_agent_steps_sampled": 1452570, "num_steps_trained": 1452570, "num_agent_steps_trained": 1452570}, "done": false, "episodes_total": 726, "training_iteration": 121, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-02-26", "timestamp": 1690848146, "time_this_iter_s": 91.75056982040405, "time_total_s": 10024.81402015686, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10024.81402015686, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 99.98396946564885, "ram_util_percent": 55.35801526717557}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7653501172924235, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.9223994501997077, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8453281781324827, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.077071272067232, "reward_component_totals/delta_v_min": -2.1515777702132812, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.70712720672253, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 215.157777021328, "constraint_violation.max_vel_constraint.steps_mean": 1142.7, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.571064467766117, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.9284842040715766, -3.9680507533873355, -3.890723388734128, -3.9352537197545283, -3.838824207123353, -3.7939430513385615, -3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8450951257327204, "mean_inference_ms": 8.394265103316508, "mean_action_processing_ms": 0.4215058977471381, "mean_env_wait_ms": 10.168392016528273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1464576, "agent_timesteps_total": 1464576, "timers": {"sample_time_ms": 41563.825, "sample_throughput": 288.857, "load_time_ms": 6.283, "load_throughput": 1910893.229, "learn_time_ms": 37740.044, "learn_throughput": 318.124, "update_time_ms": 31.589}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.523163957366517e-38, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003426777198910713, "policy_loss": -0.0010047846008092165, "vf_loss": 0.004431560635566711, "vf_explained_var": 0.2028023898601532, "kl": -5.55038193184032e-09, "entropy": 2.7440176010131836, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1464576, "num_agent_steps_sampled": 1464576, "num_steps_trained": 1464576, "num_agent_steps_trained": 1464576}, "done": false, "episodes_total": 732, "training_iteration": 122, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-03-45", "timestamp": 1690848225, "time_this_iter_s": 77.96766138076782, "time_total_s": 10102.781681537628, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10102.781681537628, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 99.98272727272726, "ram_util_percent": 55.382727272727244}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7653501172924235, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.924151041011917, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8481643454307437, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.075986695581181, "reward_component_totals/delta_v_min": -2.1370520072678727, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5986695581174, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 213.70520072678622, "constraint_violation.max_vel_constraint.steps_mean": 1127.62, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5635282358820589, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.8837337599112556, -4.016766447509653, -3.9900706381543314, -3.8930251573247934, -3.927766052377986, -3.96790526839119, -3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8440033864720062, "mean_inference_ms": 8.390425292788041, "mean_action_processing_ms": 0.42128200526982873, "mean_env_wait_ms": 10.16090238790964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1476582, "agent_timesteps_total": 1476582, "timers": {"sample_time_ms": 41569.835, "sample_throughput": 288.815, "load_time_ms": 6.237, "load_throughput": 1924932.582, "learn_time_ms": 37476.482, "learn_throughput": 320.361, "update_time_ms": 32.144}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.7615819786832586e-38, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0062463730573654175, "policy_loss": 0.000668691354803741, "vf_loss": 0.005577681586146355, "vf_explained_var": 0.3587934970855713, "kl": -2.8565565468596787e-09, "entropy": 2.6873257160186768, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1476582, "num_agent_steps_sampled": 1476582, "num_steps_trained": 1476582, "num_agent_steps_trained": 1476582}, "done": false, "episodes_total": 738, "training_iteration": 123, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-05-01", "timestamp": 1690848301, "time_this_iter_s": 76.42573642730713, "time_total_s": 10179.207417964935, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10179.207417964935, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 99.98440366972478, "ram_util_percent": 55.36146788990825}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7568238591262317, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.9218122758255833, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8478850627518171, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.0739272130737736, "reward_component_totals/delta_v_min": -2.1370520072678727, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.39272130737666, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 213.70520072678622, "constraint_violation.max_vel_constraint.steps_mean": 1105.33, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1803, "constraint_violation.max_vel_constraint.ratio_mean": 0.5523888055972014, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9010494752623688}, "hist_stats": {"episode_reward": [-3.8479244386479907, -3.9608952717242234, -4.010796095594353, -3.813391175753044, -3.9687232680977984, -3.9053588228344407, -3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8429409890897666, "mean_inference_ms": 8.386698981240075, "mean_action_processing_ms": 0.42106747967953523, "mean_env_wait_ms": 10.153477206161988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1488588, "agent_timesteps_total": 1488588, "timers": {"sample_time_ms": 41631.121, "sample_throughput": 288.39, "load_time_ms": 6.503, "load_throughput": 1846086.673, "learn_time_ms": 37375.885, "learn_throughput": 321.223, "update_time_ms": 31.536}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006115959491580725, "policy_loss": 0.0010617910884320736, "vf_loss": 0.005054169334471226, "vf_explained_var": 0.2278471142053604, "kl": -4.215987114974951e-09, "entropy": 2.7207961082458496, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1488588, "num_agent_steps_sampled": 1488588, "num_steps_trained": 1488588, "num_agent_steps_trained": 1488588}, "done": false, "episodes_total": 744, "training_iteration": 124, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-06-20", "timestamp": 1690848380, "time_this_iter_s": 78.47172617912292, "time_total_s": 10257.679144144058, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10257.679144144058, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.369642857142836}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7568238591262317, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.9203465583136805, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8470441576457197, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.073302400667969, "reward_component_totals/delta_v_min": -2.1370520072678727, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.33024006679614, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 213.70520072678622, "constraint_violation.max_vel_constraint.steps_mean": 1082.99, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5412243878060969, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.981349655486315, -3.931514933926044, -3.853213630383026, -3.920400178206901, -4.052259741281352, -3.9475216933204518, -3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8418981755752406, "mean_inference_ms": 8.382943121509124, "mean_action_processing_ms": 0.42085837463289566, "mean_env_wait_ms": 10.146177935433906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1500594, "agent_timesteps_total": 1500594, "timers": {"sample_time_ms": 41717.941, "sample_throughput": 287.79, "load_time_ms": 6.514, "load_throughput": 1842985.482, "learn_time_ms": 37414.425, "learn_throughput": 320.892, "update_time_ms": 31.213}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005095246713608503, "policy_loss": -1.2533959306892939e-05, "vf_loss": 0.005107781384140253, "vf_explained_var": 0.24472197890281677, "kl": -5.054678009486224e-09, "entropy": 2.7173781394958496, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1500594, "num_agent_steps_sampled": 1500594, "num_steps_trained": 1500594, "num_agent_steps_trained": 1500594}, "done": false, "episodes_total": 750, "training_iteration": 125, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-07-38", "timestamp": 1690848458, "time_this_iter_s": 77.56453800201416, "time_total_s": 10335.243682146072, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10335.243682146072, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 99.98738738738739, "ram_util_percent": 55.387387387387356}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7311157305512017, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.9169165626791043, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.843110851576623, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.073805711102489, "reward_component_totals/delta_v_min": -2.1370520072678727, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.38057111024816, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 213.70520072678622, "constraint_violation.max_vel_constraint.steps_mean": 1062.76, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5311144427786106, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.8909281847924135, -3.988366209242594, -3.8505749926414654, -3.9370558962144657, -3.907354699014294, -4.004223730624494, -3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8409149300522623, "mean_inference_ms": 8.3790917669052, "mean_action_processing_ms": 0.42064422542253405, "mean_env_wait_ms": 10.13878385465399, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1512600, "agent_timesteps_total": 1512600, "timers": {"sample_time_ms": 41950.975, "sample_throughput": 286.191, "load_time_ms": 6.377, "load_throughput": 1882849.648, "learn_time_ms": 37284.998, "learn_throughput": 322.006, "update_time_ms": 31.082}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0032324492931365967, "policy_loss": -0.0007133815670385957, "vf_loss": 0.0039458321407437325, "vf_explained_var": 0.18423697352409363, "kl": -4.138376752393924e-09, "entropy": 2.771521806716919, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1512600, "num_agent_steps_sampled": 1512600, "num_steps_trained": 1512600, "num_agent_steps_trained": 1512600}, "done": false, "episodes_total": 756, "training_iteration": 126, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-08-57", "timestamp": 1690848537, "time_this_iter_s": 79.08140468597412, "time_total_s": 10414.325086832047, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10414.325086832047, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 99.98421052631579, "ram_util_percent": 55.3657894736842}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7311157305512017, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.9160370720434257, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8420536218934375, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.0739834501499965, "reward_component_totals/delta_v_min": -2.1370520072678727, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.3983450149989, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 213.70520072678622, "constraint_violation.max_vel_constraint.steps_mean": 1055.86, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5276661669165418, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.978144274805894, -3.927842024271397, -3.9280776833145943, -3.8173922071617836, -3.8259606046222547, -3.8109604335470753, -3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8391956370748994, "mean_inference_ms": 8.375386211114732, "mean_action_processing_ms": 0.42041970641397997, "mean_env_wait_ms": 10.131185187815676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1524606, "agent_timesteps_total": 1524606, "timers": {"sample_time_ms": 41941.339, "sample_throughput": 286.257, "load_time_ms": 6.161, "load_throughput": 1948657.362, "learn_time_ms": 37347.663, "learn_throughput": 321.466, "update_time_ms": 31.331}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004909799434244633, "policy_loss": 0.0006556913140229881, "vf_loss": 0.004254108294844627, "vf_explained_var": 0.2879997491836548, "kl": -4.0332275297316755e-09, "entropy": 2.7490484714508057, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1524606, "num_agent_steps_sampled": 1524606, "num_steps_trained": 1524606, "num_agent_steps_trained": 1524606}, "done": false, "episodes_total": 762, "training_iteration": 127, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-10-14", "timestamp": 1690848614, "time_this_iter_s": 76.30684208869934, "time_total_s": 10490.631928920746, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10490.631928920746, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 99.98440366972478, "ram_util_percent": 55.36697247706421}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7311157305512017, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.9169605935616714, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8413468566590018, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.7092236055733803, "reward_component_totals/delta_v_mean": -2.0756137369026773, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.005054697295035, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.561373690267, "delta_v_total_min": 200.50546972950235, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1056.27, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5278710644677662, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.995841780477825, -3.935161346558452, -3.7723419545322496, -4.040659046897393, -3.840954161434186, -3.9580528637099945, -3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.837538319176021, "mean_inference_ms": 8.372029423403331, "mean_action_processing_ms": 0.4201970704050996, "mean_env_wait_ms": 10.123735272276651, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1536612, "agent_timesteps_total": 1536612, "timers": {"sample_time_ms": 42293.63, "sample_throughput": 283.873, "load_time_ms": 6.397, "load_throughput": 1876905.587, "learn_time_ms": 37361.153, "learn_throughput": 321.35, "update_time_ms": 32.005}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.00648396834731102, "policy_loss": 0.0012531974352896214, "vf_loss": 0.005230769980698824, "vf_explained_var": 0.31126487255096436, "kl": -5.723127305401476e-09, "entropy": 2.7200093269348145, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1536612, "num_agent_steps_sampled": 1536612, "num_steps_trained": 1536612, "num_agent_steps_trained": 1536612}, "done": false, "episodes_total": 768, "training_iteration": 128, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-11-34", "timestamp": 1690848694, "time_this_iter_s": 80.04571795463562, "time_total_s": 10570.677646875381, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10570.677646875381, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 99.98508771929824, "ram_util_percent": 55.29999999999999}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.912719378632475, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8374390033470327, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.07528037528545, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.52803752854427, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1050.69, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5250824587706148, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.841242290654603, -3.8735872621299663, -3.9286240922882385, -3.9361320748296342, -3.9626799277442255, -3.9444294789608954, -3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8358945079381492, "mean_inference_ms": 8.36866914639941, "mean_action_processing_ms": 0.4199870593435983, "mean_env_wait_ms": 10.116394615469417, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1548618, "agent_timesteps_total": 1548618, "timers": {"sample_time_ms": 42214.372, "sample_throughput": 284.406, "load_time_ms": 6.45, "load_throughput": 1861406.413, "learn_time_ms": 37172.69, "learn_throughput": 322.979, "update_time_ms": 32.239}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0036196152213960886, "policy_loss": -0.000545572314877063, "vf_loss": 0.004165187012404203, "vf_explained_var": 0.12858664989471436, "kl": -2.4109236829161773e-09, "entropy": 2.7617595195770264, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1548618, "num_agent_steps_sampled": 1548618, "num_steps_trained": 1548618, "num_agent_steps_trained": 1548618}, "done": false, "episodes_total": 774, "training_iteration": 129, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-12-53", "timestamp": 1690848773, "time_this_iter_s": 79.13336777687073, "time_total_s": 10649.811014652252, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10649.811014652252, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 99.98230088495573, "ram_util_percent": 55.329203539823006}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.9133388555144073, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8385938186387059, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.074745036875708, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.47450368757006, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1052.64, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5260569715142429, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.8708200225349616, -3.8213444413283613, -3.7906334592129403, -3.85368465889624, -3.884066419411134, -3.9456133423892696, -3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.834289369974309, "mean_inference_ms": 8.365241612175804, "mean_action_processing_ms": 0.41978211786559355, "mean_env_wait_ms": 10.109457124921537, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1560624, "agent_timesteps_total": 1560624, "timers": {"sample_time_ms": 42161.732, "sample_throughput": 284.761, "load_time_ms": 6.076, "load_throughput": 1976125.428, "learn_time_ms": 37084.586, "learn_throughput": 323.746, "update_time_ms": 32.77}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004388869274407625, "policy_loss": 0.0001346234930679202, "vf_loss": 0.0042542447336018085, "vf_explained_var": 0.17203214764595032, "kl": -5.998518570748956e-09, "entropy": 2.7546615600585938, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1560624, "num_agent_steps_sampled": 1560624, "num_steps_trained": 1560624, "num_agent_steps_trained": 1560624}, "done": false, "episodes_total": 780, "training_iteration": 130, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-14-11", "timestamp": 1690848851, "time_this_iter_s": 77.47322368621826, "time_total_s": 10727.28423833847, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10727.28423833847, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 99.98899082568806, "ram_util_percent": 55.308256880733914}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.9149732054114628, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8403765307173452, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.074596674694124, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4596674694116, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1043.91, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5216941529235383, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.980807056107623, -3.874406703052286, -3.9631961802697093, -3.9015616762581473, -3.9195452372535526, -3.837778745409966, -3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8333668164056587, "mean_inference_ms": 8.361468120296715, "mean_action_processing_ms": 0.41958284841659477, "mean_env_wait_ms": 10.102851327314946, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1572630, "agent_timesteps_total": 1572630, "timers": {"sample_time_ms": 41821.569, "sample_throughput": 287.077, "load_time_ms": 6.072, "load_throughput": 1977366.976, "learn_time_ms": 37118.185, "learn_throughput": 323.453, "update_time_ms": 31.655}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0038949514273554087, "policy_loss": 0.00039225767250172794, "vf_loss": 0.0035026944242417812, "vf_explained_var": 0.07948355376720428, "kl": -2.8540531049614515e-10, "entropy": 2.795382499694824, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1572630, "num_agent_steps_sampled": 1572630, "num_steps_trained": 1572630, "num_agent_steps_trained": 1572630}, "done": false, "episodes_total": 786, "training_iteration": 131, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-15-40", "timestamp": 1690848940, "time_this_iter_s": 88.64945435523987, "time_total_s": 10815.93369269371, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10815.93369269371, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 99.98346456692911, "ram_util_percent": 55.32598425196849}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.096694608140423, "episode_reward_mean": -3.9137911062528086, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8395659528453582, "reward_component_totals/dist_change_reward_min": -0.9993330069963396, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.0742251534074576, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.422515340745, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1040.6, "constraint_violation.max_vel_constraint.steps_min": 404, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5200399800099951, "constraint_violation.max_vel_constraint.ratio_min": 0.20189905047476261, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.928646358049887, -4.02349823478627, -3.9205895442375356, -3.937971880908596, -4.000351254442943, -4.096694608140423, -3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8325280485977797, "mean_inference_ms": 8.357718627129609, "mean_action_processing_ms": 0.4193862033001692, "mean_env_wait_ms": 10.09666360461768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1584636, "agent_timesteps_total": 1584636, "timers": {"sample_time_ms": 41737.828, "sample_throughput": 287.653, "load_time_ms": 5.91, "load_throughput": 2031589.825, "learn_time_ms": 37059.289, "learn_throughput": 323.967, "update_time_ms": 29.231}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005688212346285582, "policy_loss": 0.001059129019267857, "vf_loss": 0.004629084374755621, "vf_explained_var": 0.1560019552707672, "kl": -4.26856194835068e-09, "entropy": 2.751676082611084, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1584636, "num_agent_steps_sampled": 1584636, "num_steps_trained": 1584636, "num_agent_steps_trained": 1584636}, "done": false, "episodes_total": 792, "training_iteration": 132, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-16-57", "timestamp": 1690849017, "time_this_iter_s": 76.49455237388611, "time_total_s": 10892.428245067596, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10892.428245067596, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 99.9834862385321, "ram_util_percent": 55.36422018348624}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.093588180324912, "episode_reward_mean": -3.911323335572513, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8371374903767667, "reward_component_totals/dist_change_reward_min": -0.9952008023217992, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.0741858451957533, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4185845195746, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1047.16, "constraint_violation.max_vel_constraint.steps_min": 404, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5233183408295852, "constraint_violation.max_vel_constraint.ratio_min": 0.20189905047476261, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.7772772370082075, -3.8034307544647348, -4.038491371172808, -4.026639669297749, -3.9895280039224774, -4.012257831330927, -3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8317640478908133, "mean_inference_ms": 8.35399905397661, "mean_action_processing_ms": 0.41920588236625256, "mean_env_wait_ms": 10.090848304265823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1596642, "agent_timesteps_total": 1596642, "timers": {"sample_time_ms": 41730.325, "sample_throughput": 287.704, "load_time_ms": 6.291, "load_throughput": 1908351.416, "learn_time_ms": 37211.112, "learn_throughput": 322.646, "update_time_ms": 27.484}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004484857898205519, "policy_loss": -0.00044691612129099667, "vf_loss": 0.004931772127747536, "vf_explained_var": 0.3068527579307556, "kl": -4.506399697845609e-09, "entropy": 2.715543746948242, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1596642, "num_agent_steps_sampled": 1596642, "num_steps_trained": 1596642, "num_agent_steps_trained": 1596642}, "done": false, "episodes_total": 798, "training_iteration": 133, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-18-15", "timestamp": 1690849095, "time_this_iter_s": 77.88030648231506, "time_total_s": 10970.308551549911, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10970.308551549911, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 99.98660714285714, "ram_util_percent": 55.391964285714266}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.093588180324912, "episode_reward_mean": -3.910079335131062, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.834819900436021, "reward_component_totals/dist_change_reward_min": -0.9952008023217992, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.075259434695048, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.52594346950409, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1038.53, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5190054972513743, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.8808639225786563, -3.9480380699185353, -3.8760254712043682, -3.9603605337968126, -3.970703447638645, -3.9685080874102328, -3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8310600677690716, "mean_inference_ms": 8.350444784600176, "mean_action_processing_ms": 0.4190238541608305, "mean_env_wait_ms": 10.085102331179714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1608648, "agent_timesteps_total": 1608648, "timers": {"sample_time_ms": 41829.074, "sample_throughput": 287.025, "load_time_ms": 6.361, "load_throughput": 1887358.985, "learn_time_ms": 37055.975, "learn_throughput": 323.996, "update_time_ms": 28.873}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0056601944379508495, "policy_loss": -1.2024275747535285e-05, "vf_loss": 0.005672219209372997, "vf_explained_var": 0.22133679687976837, "kl": -4.8318615775144735e-09, "entropy": 2.6844170093536377, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1608648, "num_agent_steps_sampled": 1608648, "num_steps_trained": 1608648, "num_agent_steps_trained": 1608648}, "done": false, "episodes_total": 804, "training_iteration": 134, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-19-33", "timestamp": 1690849173, "time_this_iter_s": 77.90048837661743, "time_total_s": 11048.209039926529, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11048.209039926529, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 99.98018018018017, "ram_util_percent": 55.383783783783755}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.9114907180348526, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8366189160500492, "reward_component_totals/dist_change_reward_min": -0.9952008023217992, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.07487180198481, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4871801984803, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1027.91, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5136981509245376, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.8301142875993364, -4.0532124505934295, -3.850653661976577, -3.8286952410770474, -4.082774883842038, -3.8615696008191422, -3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8304270249375185, "mean_inference_ms": 8.34722874183646, "mean_action_processing_ms": 0.4188625694441042, "mean_env_wait_ms": 10.079982316984015, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1620654, "agent_timesteps_total": 1620654, "timers": {"sample_time_ms": 42041.723, "sample_throughput": 285.573, "load_time_ms": 6.822, "load_throughput": 1759909.337, "learn_time_ms": 36992.463, "learn_throughput": 324.553, "update_time_ms": 29.362}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004878186620771885, "policy_loss": 0.0009362492710351944, "vf_loss": 0.003941936418414116, "vf_explained_var": 0.071665920317173, "kl": -4.881932635925068e-09, "entropy": 2.7872023582458496, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1620654, "num_agent_steps_sampled": 1620654, "num_steps_trained": 1620654, "num_agent_steps_trained": 1620654}, "done": false, "episodes_total": 810, "training_iteration": 135, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-20-52", "timestamp": 1690849252, "time_this_iter_s": 79.09477281570435, "time_total_s": 11127.303812742233, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11127.303812742233, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 99.97256637168141, "ram_util_percent": 55.4221238938053}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.9133421650362443, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8374541270998583, "reward_component_totals/dist_change_reward_min": -0.993997900673696, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.0758880379363926, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.58880379363853, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1022.54, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5110144927536231, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.997774274213258, -3.8763490844126567, -3.9344622214847362, -3.940992403228557, -3.824534120883828, -3.956351020202608, -4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8298007474322975, "mean_inference_ms": 8.343929697532461, "mean_action_processing_ms": 0.4187139701553057, "mean_env_wait_ms": 10.075106680299971, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1632660, "agent_timesteps_total": 1632660, "timers": {"sample_time_ms": 42065.966, "sample_throughput": 285.409, "load_time_ms": 6.777, "load_throughput": 1771642.561, "learn_time_ms": 37026.53, "learn_throughput": 324.254, "update_time_ms": 29.61}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0046129836700856686, "policy_loss": 0.00030037376563996077, "vf_loss": 0.004312611185014248, "vf_explained_var": 0.13139912486076355, "kl": -6.491718718137918e-09, "entropy": 2.758124351501465, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1632660, "num_agent_steps_sampled": 1632660, "num_steps_trained": 1632660, "num_agent_steps_trained": 1632660}, "done": false, "episodes_total": 816, "training_iteration": 136, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-22-12", "timestamp": 1690849332, "time_this_iter_s": 79.63286137580872, "time_total_s": 11206.936674118042, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11206.936674118042, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 99.98684210526316, "ram_util_percent": 55.34912280701753}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.9112987187231507, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8346929378171721, "reward_component_totals/dist_change_reward_min": -0.993997900673696, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.0766057809059855, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.66057809059777, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1013.88, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5066866566716641, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-4.034798300043182, -4.093588180324912, -3.8413624094547334, -3.963448979511491, -3.84297441803197, -4.066525396482951, -3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8284759612109411, "mean_inference_ms": 8.340786785058718, "mean_action_processing_ms": 0.4185520318540826, "mean_env_wait_ms": 10.070071878037306, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1644666, "agent_timesteps_total": 1644666, "timers": {"sample_time_ms": 42378.913, "sample_throughput": 283.301, "load_time_ms": 7.093, "load_throughput": 1692574.982, "learn_time_ms": 37379.686, "learn_throughput": 321.191, "update_time_ms": 28.742}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0034103759098798037, "policy_loss": -0.0007081902585923672, "vf_loss": 0.00411856546998024, "vf_explained_var": 0.22153326869010925, "kl": 2.0779508669299673e-10, "entropy": 2.7595415115356445, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1644666, "num_agent_steps_sampled": 1644666, "num_steps_trained": 1644666, "num_agent_steps_trained": 1644666}, "done": false, "episodes_total": 822, "training_iteration": 137, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-23-35", "timestamp": 1690849415, "time_this_iter_s": 82.87855696678162, "time_total_s": 11289.815231084824, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11289.815231084824, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 99.9854700854701, "ram_util_percent": 55.3}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.907521577122319, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.831749766604118, "reward_component_totals/dist_change_reward_min": -0.993997900673696, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.0757718105182086, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5771810518201, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1005.18, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5023388305847076, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.8897445151677106, -3.977876826670541, -3.7653501172924235, -3.79897563041862, -3.9140349908979886, -4.027827427304913, -3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8272258641227603, "mean_inference_ms": 8.337787944677414, "mean_action_processing_ms": 0.418395055804086, "mean_env_wait_ms": 10.065273140820402, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1656672, "agent_timesteps_total": 1656672, "timers": {"sample_time_ms": 42227.345, "sample_throughput": 284.318, "load_time_ms": 6.964, "load_throughput": 1723893.103, "learn_time_ms": 37280.957, "learn_throughput": 322.041, "update_time_ms": 27.542}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004987874533981085, "policy_loss": 0.0001264258607989177, "vf_loss": 0.004861447028815746, "vf_explained_var": 0.3055904507637024, "kl": -8.199143586296032e-09, "entropy": 2.7116143703460693, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1656672, "num_agent_steps_sampled": 1656672, "num_steps_trained": 1656672, "num_agent_steps_trained": 1656672}, "done": false, "episodes_total": 828, "training_iteration": 138, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-24-53", "timestamp": 1690849493, "time_this_iter_s": 77.57523941993713, "time_total_s": 11367.39047050476, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11367.39047050476, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 99.97747747747748, "ram_util_percent": 55.300000000000004}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.9101460330159745, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8334900628175659, "reward_component_totals/dist_change_reward_min": -0.993997900673696, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.076655970198416, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.66559701984093, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1033.96, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5167216391804098, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.963344619784947, -3.837942884415912, -3.9137591219422303, -3.873529361284467, -3.7568238591262317, -4.009335783515831, -3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.826007199776847, "mean_inference_ms": 8.33485954530165, "mean_action_processing_ms": 0.41823595797410446, "mean_env_wait_ms": 10.060465373997511, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1668678, "agent_timesteps_total": 1668678, "timers": {"sample_time_ms": 42258.136, "sample_throughput": 284.111, "load_time_ms": 6.83, "load_throughput": 1757759.233, "learn_time_ms": 36967.89, "learn_throughput": 324.768, "update_time_ms": 26.445}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004853180609643459, "policy_loss": 0.0006515473360195756, "vf_loss": 0.004201632924377918, "vf_explained_var": 0.19622693955898285, "kl": -8.088987257792724e-09, "entropy": 2.7563765048980713, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1668678, "num_agent_steps_sampled": 1668678, "num_steps_trained": 1668678, "num_agent_steps_trained": 1668678}, "done": false, "episodes_total": 834, "training_iteration": 139, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-26-09", "timestamp": 1690849569, "time_this_iter_s": 76.2586760520935, "time_total_s": 11443.649146556854, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11443.649146556854, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 99.98532110091743, "ram_util_percent": 55.3}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.2188890320020254, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.909494186162352, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8340553234223556, "reward_component_totals/dist_change_reward_min": -0.993997900673696, "reward_component_totals/dist_change_reward_max": -0.1548416073081274, "reward_component_totals/delta_v_mean": -2.075438862740003, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5438862739996, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1043.07, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5212743628185907, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.9365581263358207, -3.95933263269545, -3.9348867053562095, -3.8484536980062414, -3.9433493804067314, -3.9141398840007233, -3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8248214900190365, "mean_inference_ms": 8.331885538451811, "mean_action_processing_ms": 0.4180623728297334, "mean_env_wait_ms": 10.0554974474583, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1680684, "agent_timesteps_total": 1680684, "timers": {"sample_time_ms": 42149.925, "sample_throughput": 284.84, "load_time_ms": 6.69, "load_throughput": 1794650.414, "learn_time_ms": 36942.631, "learn_throughput": 324.99, "update_time_ms": 25.034}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005832740105688572, "policy_loss": 0.0005735978484153748, "vf_loss": 0.005259142257273197, "vf_explained_var": 0.21640010178089142, "kl": -3.7403116159850924e-09, "entropy": 2.6895811557769775, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1680684, "num_agent_steps_sampled": 1680684, "num_steps_trained": 1680684, "num_agent_steps_trained": 1680684}, "done": false, "episodes_total": 840, "training_iteration": 140, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-27-26", "timestamp": 1690849646, "time_this_iter_s": 76.02538228034973, "time_total_s": 11519.674528837204, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11519.674528837204, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 99.98348623853212, "ram_util_percent": 55.3}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.9055686038918203, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8288201894200783, "reward_component_totals/dist_change_reward_min": -0.993997900673696, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.0767484144717487, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.020241879771158, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.67484144717412, "delta_v_total_min": 202.02418797711522, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1055.82, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5276461769115443, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.8708304918401684, -3.8066112580720586, -3.9360075737639644, -3.8895787333779612, -3.9096278999402587, -3.7311157305512017, -3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8242523993076531, "mean_inference_ms": 8.328703707620225, "mean_action_processing_ms": 0.4179077612350636, "mean_env_wait_ms": 10.050660076842984, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1692690, "agent_timesteps_total": 1692690, "timers": {"sample_time_ms": 42527.76, "sample_throughput": 282.31, "load_time_ms": 6.865, "load_throughput": 1748791.945, "learn_time_ms": 36817.12, "learn_throughput": 326.098, "update_time_ms": 27.612}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004683607257902622, "policy_loss": 0.00042116219992749393, "vf_loss": 0.0042624445632100105, "vf_explained_var": 0.09036587178707123, "kl": -2.165575274659659e-09, "entropy": 2.776519536972046, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1692690, "num_agent_steps_sampled": 1692690, "num_steps_trained": 1692690, "num_agent_steps_trained": 1692690}, "done": false, "episodes_total": 846, "training_iteration": 141, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-28-57", "timestamp": 1690849737, "time_this_iter_s": 91.21047472953796, "time_total_s": 11610.885003566742, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11610.885003566742, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 99.98615384615385, "ram_util_percent": 55.300000000000004}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.911234702143493, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8345295451789366, "reward_component_totals/dist_change_reward_min": -0.993997900673696, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.0767051569645636, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.026596331248687, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.67051569645562, "delta_v_total_min": 202.65963312486764, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1071.57, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5355172413793102, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.984626443386139, -4.058169269427432, -3.807171643692026, -3.8525492821494325, -3.946036364764822, -3.9187771652316536, -3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8236893174406972, "mean_inference_ms": 8.325563359539967, "mean_action_processing_ms": 0.41775344642154233, "mean_env_wait_ms": 10.045962409475857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1704696, "agent_timesteps_total": 1704696, "timers": {"sample_time_ms": 42623.783, "sample_throughput": 281.674, "load_time_ms": 6.839, "load_throughput": 1755559.291, "learn_time_ms": 36995.561, "learn_throughput": 324.525, "update_time_ms": 25.601}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003150138771161437, "policy_loss": -0.0011741654016077518, "vf_loss": 0.00432430487126112, "vf_explained_var": 0.14100344479084015, "kl": -3.690240557574498e-09, "entropy": 2.7487900257110596, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1704696, "num_agent_steps_sampled": 1704696, "num_steps_trained": 1704696, "num_agent_steps_trained": 1704696}, "done": false, "episodes_total": 852, "training_iteration": 142, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-30-16", "timestamp": 1690849816, "time_this_iter_s": 79.20089983940125, "time_total_s": 11690.085903406143, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11690.085903406143, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 99.98230088495576, "ram_util_percent": 55.339823008849535}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.909857827508059, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8337693944748352, "reward_component_totals/dist_change_reward_min": -0.993997900673696, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.076088433033231, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.026596331248687, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.60884330332235, "delta_v_total_min": 202.65963312486764, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1076.07, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5377661169415292, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.95141329613124, -3.9406916362150333, -3.958662119140137, -3.7749740674790004, -3.810954751925362, -3.9692185709380507, -3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8231321192595613, "mean_inference_ms": 8.322766660084485, "mean_action_processing_ms": 0.4176081993994086, "mean_env_wait_ms": 10.04157697547614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1716702, "agent_timesteps_total": 1716702, "timers": {"sample_time_ms": 42814.685, "sample_throughput": 280.418, "load_time_ms": 6.431, "load_throughput": 1867031.019, "learn_time_ms": 36907.096, "learn_throughput": 325.303, "update_time_ms": 27.48}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.002666937652975321, "policy_loss": -0.001232414273545146, "vf_loss": 0.0038993528578430414, "vf_explained_var": 0.12791429460048676, "kl": -3.4098424084305634e-09, "entropy": 2.784433126449585, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1716702, "num_agent_steps_sampled": 1716702, "num_steps_trained": 1716702, "num_agent_steps_trained": 1716702}, "done": false, "episodes_total": 858, "training_iteration": 143, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-31-36", "timestamp": 1690849896, "time_this_iter_s": 78.95925807952881, "time_total_s": 11769.045161485672, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11769.045161485672, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 99.98495575221239, "ram_util_percent": 55.399999999999984}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.9121098050571224, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8356762899842645, "reward_component_totals/dist_change_reward_min": -0.993997900673696, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.076433515072866, "reward_component_totals/delta_v_min": -2.1490784337619964, "reward_component_totals/delta_v_max": -2.026596331248687, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.64335150728587, "delta_v_total_min": 202.65963312486764, "delta_v_total_max": 214.90784337619908, "constraint_violation.max_vel_constraint.steps_mean": 1086.36, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5429085457271365, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.9106093744948605, -3.8579767203513926, -3.8716054704693064, -3.96036449136854, -3.9327417757456304, -4.022392913128569, -3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.82260926470346, "mean_inference_ms": 8.320078311963902, "mean_action_processing_ms": 0.41746851710464417, "mean_env_wait_ms": 10.037493950047145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1728708, "agent_timesteps_total": 1728708, "timers": {"sample_time_ms": 42768.19, "sample_throughput": 280.723, "load_time_ms": 6.276, "load_throughput": 1912969.348, "learn_time_ms": 36899.513, "learn_throughput": 325.37, "update_time_ms": 26.604}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0021383343264460564, "policy_loss": -0.001536669908091426, "vf_loss": 0.0036750026047229767, "vf_explained_var": 0.24896162748336792, "kl": -2.5761583977157443e-09, "entropy": 2.7756175994873047, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1728708, "num_agent_steps_sampled": 1728708, "num_steps_trained": 1728708, "num_agent_steps_trained": 1728708}, "done": false, "episodes_total": 864, "training_iteration": 144, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-32-53", "timestamp": 1690849973, "time_this_iter_s": 77.32743334770203, "time_total_s": 11846.372594833374, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11846.372594833374, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 99.98108108108107, "ram_util_percent": 55.39999999999996}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.910326856308647, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8343740359395465, "reward_component_totals/dist_change_reward_min": -0.993997900673696, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.0759528203691078, "reward_component_totals/delta_v_min": -2.134087478717167, "reward_component_totals/delta_v_max": -2.026596331248687, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.59528203691008, "delta_v_total_min": 202.65963312486764, "delta_v_total_max": 213.40874787171634, "constraint_violation.max_vel_constraint.steps_mean": 1082.1, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5407796101949026, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-3.9994059886574798, -3.9380645343409277, -3.2188890320020254, -4.007395416815832, -4.065350690052879, -3.9693146282334952, -4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8220929678022628, "mean_inference_ms": 8.317298934169507, "mean_action_processing_ms": 0.41733356140561634, "mean_env_wait_ms": 10.033426068373231, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1740714, "agent_timesteps_total": 1740714, "timers": {"sample_time_ms": 42514.564, "sample_throughput": 282.397, "load_time_ms": 5.949, "load_throughput": 2018026.081, "learn_time_ms": 36905.893, "learn_throughput": 325.314, "update_time_ms": 25.823}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005243958905339241, "policy_loss": 0.0008707051165401936, "vf_loss": 0.004373255651444197, "vf_explained_var": 0.13824552297592163, "kl": -4.901961503378516e-09, "entropy": 2.7531256675720215, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1740714, "num_agent_steps_sampled": 1740714, "num_steps_trained": 1740714, "num_agent_steps_trained": 1740714}, "done": false, "episodes_total": 870, "training_iteration": 145, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-34-10", "timestamp": 1690850050, "time_this_iter_s": 76.62685370445251, "time_total_s": 11922.999448537827, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11922.999448537827, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 99.97757009345793, "ram_util_percent": 55.47476635514017}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.913312583962278, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8373538827068612, "reward_component_totals/dist_change_reward_min": -0.993997900673696, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.0759587012554244, "reward_component_totals/delta_v_min": -2.134087478717167, "reward_component_totals/delta_v_max": -2.0267773387332775, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5958701255417, "delta_v_total_min": 202.67773387332667, "delta_v_total_max": 213.40874787171634, "constraint_violation.max_vel_constraint.steps_mean": 1095.94, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5476961519240379, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-4.010860462070365, -3.8166462528867275, -3.7663957846328886, -3.9200749969243827, -3.8509481964125487, -3.807340336171819, -4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8216275485924625, "mean_inference_ms": 8.314434066761535, "mean_action_processing_ms": 0.4171981185819276, "mean_env_wait_ms": 10.029432883315739, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1752720, "agent_timesteps_total": 1752720, "timers": {"sample_time_ms": 42280.007, "sample_throughput": 283.964, "load_time_ms": 6.084, "load_throughput": 1973507.776, "learn_time_ms": 36715.569, "learn_throughput": 327.0, "update_time_ms": 26.666}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004673204850405455, "policy_loss": 0.0003455836558714509, "vf_loss": 0.004327620845288038, "vf_explained_var": 0.09721243381500244, "kl": -4.1984624665758474e-09, "entropy": 2.752624750137329, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1752720, "num_agent_steps_sampled": 1752720, "num_steps_trained": 1752720, "num_agent_steps_trained": 1752720}, "done": false, "episodes_total": 876, "training_iteration": 146, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-35-26", "timestamp": 1690850126, "time_this_iter_s": 75.40892004966736, "time_total_s": 11998.408368587494, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11998.408368587494, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 99.97962962962963, "ram_util_percent": 55.40740740740738}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.920195081991421, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.843608468268782, "reward_component_totals/dist_change_reward_min": -0.9967922076693941, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.0765866137226463, "reward_component_totals/delta_v_min": -2.134087478717167, "reward_component_totals/delta_v_max": -2.0267773387332775, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.65866137226385, "delta_v_total_min": 202.67773387332667, "delta_v_total_max": 213.40874787171634, "constraint_violation.max_vel_constraint.steps_mean": 1111.18, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.555312343828086, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-4.009765953921314, -4.029394441782392, -3.7701993568226877, -3.8619490483677, -3.866111603784065, -3.961443811711753, -3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8205548426417286, "mean_inference_ms": 8.311808276707126, "mean_action_processing_ms": 0.4170575596235968, "mean_env_wait_ms": 10.025218566411782, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1764726, "agent_timesteps_total": 1764726, "timers": {"sample_time_ms": 42128.859, "sample_throughput": 284.983, "load_time_ms": 5.711, "load_throughput": 2102080.667, "learn_time_ms": 36294.404, "learn_throughput": 330.795, "update_time_ms": 26.209}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004346475470811129, "policy_loss": 0.00048167441855184734, "vf_loss": 0.00386480032466352, "vf_explained_var": 0.16498292982578278, "kl": -5.305033745628407e-09, "entropy": 2.7827250957489014, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1764726, "num_agent_steps_sampled": 1764726, "num_steps_trained": 1764726, "num_agent_steps_trained": 1764726}, "done": false, "episodes_total": 882, "training_iteration": 147, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-36-43", "timestamp": 1690850203, "time_this_iter_s": 77.15306115150452, "time_total_s": 12075.561429738998, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12075.561429738998, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 99.98454545454547, "ram_util_percent": 55.39999999999997}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.9185690043425, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8422716497059152, "reward_component_totals/dist_change_reward_min": -0.9967922076693941, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.0762973546365933, "reward_component_totals/delta_v_min": -2.134087478717167, "reward_component_totals/delta_v_max": -2.0267773387332775, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.62973546365853, "delta_v_total_min": 202.67773387332667, "delta_v_total_max": 213.40874787171634, "constraint_violation.max_vel_constraint.steps_mean": 1106.51, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5529785107446277, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-3.8284713440574265, -3.933839810044816, -3.947042472295703, -3.822176640592153, -3.8732423425072406, -3.9710275190872797, -4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8194849488990237, "mean_inference_ms": 8.309381200991155, "mean_action_processing_ms": 0.4169225904263428, "mean_env_wait_ms": 10.020964064162278, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1776732, "agent_timesteps_total": 1776732, "timers": {"sample_time_ms": 42013.714, "sample_throughput": 285.764, "load_time_ms": 5.523, "load_throughput": 2173775.504, "learn_time_ms": 36406.209, "learn_throughput": 329.779, "update_time_ms": 26.53}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0029979594983160496, "policy_loss": -0.0020706183277070522, "vf_loss": 0.00506857642903924, "vf_explained_var": 0.2603203058242798, "kl": -1.7650064743079952e-09, "entropy": 2.7111093997955322, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1776732, "num_agent_steps_sampled": 1776732, "num_steps_trained": 1776732, "num_agent_steps_trained": 1776732}, "done": false, "episodes_total": 888, "training_iteration": 148, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-38-01", "timestamp": 1690850281, "time_this_iter_s": 77.52296447753906, "time_total_s": 12153.084394216537, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12153.084394216537, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 99.98288288288289, "ram_util_percent": 55.45315315315313}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.9218853396288034, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8458820464761577, "reward_component_totals/dist_change_reward_min": -0.9967922076693941, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.0760032931526538, "reward_component_totals/delta_v_min": -2.134087478717167, "reward_component_totals/delta_v_max": -2.0267773387332775, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.60032931526462, "delta_v_total_min": 202.67773387332667, "delta_v_total_max": 213.40874787171634, "constraint_violation.max_vel_constraint.steps_mean": 1114.9, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5571714142928534, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-4.0593025791199, -4.042435401732987, -3.9664062275396494, -3.7485607425490253, -4.060310116746969, -3.868254978337302, -3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8184287818782687, "mean_inference_ms": 8.306978964978372, "mean_action_processing_ms": 0.41678901263219975, "mean_env_wait_ms": 10.016651465733656, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1788738, "agent_timesteps_total": 1788738, "timers": {"sample_time_ms": 41987.357, "sample_throughput": 285.943, "load_time_ms": 5.949, "load_throughput": 2018244.458, "learn_time_ms": 36531.528, "learn_throughput": 328.648, "update_time_ms": 29.781}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004820376168936491, "policy_loss": 0.00020322678028605878, "vf_loss": 0.004617149010300636, "vf_explained_var": 0.33572760224342346, "kl": -3.6501837108460222e-09, "entropy": 2.7514495849609375, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1788738, "num_agent_steps_sampled": 1788738, "num_steps_trained": 1788738, "num_agent_steps_trained": 1788738}, "done": false, "episodes_total": 894, "training_iteration": 149, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-39-18", "timestamp": 1690850358, "time_this_iter_s": 77.33870434761047, "time_total_s": 12230.423098564148, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12230.423098564148, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 99.97927927927927, "ram_util_percent": 55.461261261261235}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.9181366780550078, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8419306669360224, "reward_component_totals/dist_change_reward_min": -0.9967922076693941, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.0762060111189915, "reward_component_totals/delta_v_min": -2.134087478717167, "reward_component_totals/delta_v_max": -2.0267773387332775, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6206011118984, "delta_v_total_min": 202.67773387332667, "delta_v_total_max": 213.40874787171634, "constraint_violation.max_vel_constraint.steps_mean": 1112.63, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5560369815092454, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.873024290690891, -3.964656976020758, -3.9643090068109563, -3.792669454444926, -3.9154162585498824, -4.018242525736141, -3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8173596350838033, "mean_inference_ms": 8.304824783866785, "mean_action_processing_ms": 0.41665517757363923, "mean_env_wait_ms": 10.012272609292408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1800744, "agent_timesteps_total": 1800744, "timers": {"sample_time_ms": 42042.731, "sample_throughput": 285.567, "load_time_ms": 5.967, "load_throughput": 2011978.897, "learn_time_ms": 36408.033, "learn_throughput": 329.762, "update_time_ms": 29.871}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004065859597176313, "policy_loss": -0.000185681288712658, "vf_loss": 0.0042515406385064125, "vf_explained_var": 0.1033986508846283, "kl": -3.3097000695647694e-09, "entropy": 2.768537998199463, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1800744, "num_agent_steps_sampled": 1800744, "num_steps_trained": 1800744, "num_agent_steps_trained": 1800744}, "done": false, "episodes_total": 900, "training_iteration": 150, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-40-34", "timestamp": 1690850434, "time_this_iter_s": 75.32004737854004, "time_total_s": 12305.743145942688, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12305.743145942688, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 99.98224299065421, "ram_util_percent": 55.39999999999998}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.115526794828577, "episode_reward_mean": -3.9211148872553996, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8440220786238442, "reward_component_totals/dist_change_reward_min": -0.9967922076693941, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.077092808631562, "reward_component_totals/delta_v_min": -2.130252113938337, "reward_component_totals/delta_v_max": -2.0267773387332775, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.70928086315556, "delta_v_total_min": 202.67773387332667, "delta_v_total_max": 213.0252113938325, "constraint_violation.max_vel_constraint.steps_mean": 1109.21, "constraint_violation.max_vel_constraint.steps_min": 496, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5543278360819591, "constraint_violation.max_vel_constraint.ratio_min": 0.2478760619690155, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.992210924757206, -4.115526794828577, -3.8776533002815237, -3.826588018772932, -3.8815596585920944, -4.089792333944781, -3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8168846425372434, "mean_inference_ms": 8.302573612358167, "mean_action_processing_ms": 0.416532165062232, "mean_env_wait_ms": 10.008123033639823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1812750, "agent_timesteps_total": 1812750, "timers": {"sample_time_ms": 41939.812, "sample_throughput": 286.267, "load_time_ms": 5.816, "load_throughput": 2064311.463, "learn_time_ms": 36515.934, "learn_throughput": 328.788, "update_time_ms": 26.883}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004591007716953754, "policy_loss": 0.0005428656004369259, "vf_loss": 0.00404814537614584, "vf_explained_var": 0.1340673714876175, "kl": -3.467424125602747e-09, "entropy": 2.781442880630493, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1812750, "num_agent_steps_sampled": 1812750, "num_steps_trained": 1812750, "num_agent_steps_trained": 1812750}, "done": false, "episodes_total": 906, "training_iteration": 151, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-42-05", "timestamp": 1690850525, "time_this_iter_s": 91.16976928710938, "time_total_s": 12396.912915229797, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12396.912915229797, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 99.98702290076336, "ram_util_percent": 55.46106870229007}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.110136186521877, "episode_reward_mean": -3.917446385534266, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8409462594942875, "reward_component_totals/dist_change_reward_min": -0.9967922076693941, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.076500126039985, "reward_component_totals/delta_v_min": -2.130252113938337, "reward_component_totals/delta_v_max": -2.0267773387332775, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6500126039978, "delta_v_total_min": 202.67773387332667, "delta_v_total_max": 213.0252113938325, "constraint_violation.max_vel_constraint.steps_mean": 1134.45, "constraint_violation.max_vel_constraint.steps_min": 496, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5669415292353823, "constraint_violation.max_vel_constraint.ratio_min": 0.2478760619690155, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9065554475474005, -3.8266285878883046, -3.905106384632975, -4.082522413441206, -3.8816988430496306, -3.8593250338806984, -3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8164467501261177, "mean_inference_ms": 8.300231613222769, "mean_action_processing_ms": 0.41640731917491997, "mean_env_wait_ms": 10.00406938986268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1824756, "agent_timesteps_total": 1824756, "timers": {"sample_time_ms": 41964.203, "sample_throughput": 286.101, "load_time_ms": 6.002, "load_throughput": 2000222.987, "learn_time_ms": 36333.646, "learn_throughput": 330.438, "update_time_ms": 29.346}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006567026954144239, "policy_loss": 0.0008988489280454814, "vf_loss": 0.005668176803737879, "vf_explained_var": 0.20189563930034637, "kl": -3.893028566182011e-09, "entropy": 2.692857027053833, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1824756, "num_agent_steps_sampled": 1824756, "num_steps_trained": 1824756, "num_agent_steps_trained": 1824756}, "done": false, "episodes_total": 912, "training_iteration": 152, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-43-23", "timestamp": 1690850603, "time_this_iter_s": 77.65551590919495, "time_total_s": 12474.568431138992, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12474.568431138992, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 99.99090909090908, "ram_util_percent": 55.420909090909056}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.110136186521877, "episode_reward_mean": -3.9181527279693733, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8425593514744318, "reward_component_totals/dist_change_reward_min": -0.9967922076693941, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.0755933764949472, "reward_component_totals/delta_v_min": -2.130252113938337, "reward_component_totals/delta_v_max": -2.0267773387332775, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.559337649494, "delta_v_total_min": 202.67773387332667, "delta_v_total_max": 213.0252113938325, "constraint_violation.max_vel_constraint.steps_mean": 1139.23, "constraint_violation.max_vel_constraint.steps_min": 506, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5693303348325837, "constraint_violation.max_vel_constraint.ratio_min": 0.25287356321839083, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.982792826284521, -3.86111006544008, -3.9432109573863015, -3.797980767075042, -3.8786492705338445, -3.9420184999579604, -3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8160071689430262, "mean_inference_ms": 8.298002083174945, "mean_action_processing_ms": 0.4162744243342923, "mean_env_wait_ms": 9.999901782238421, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1836762, "agent_timesteps_total": 1836762, "timers": {"sample_time_ms": 41831.942, "sample_throughput": 287.006, "load_time_ms": 6.435, "load_throughput": 1865868.811, "learn_time_ms": 36362.794, "learn_throughput": 330.173, "update_time_ms": 29.112}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004764983896166086, "policy_loss": 0.0009346117149107158, "vf_loss": 0.0038303714245557785, "vf_explained_var": 0.1703314185142517, "kl": -7.205231966622705e-09, "entropy": 2.7760090827941895, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1836762, "num_agent_steps_sampled": 1836762, "num_steps_trained": 1836762, "num_agent_steps_trained": 1836762}, "done": false, "episodes_total": 918, "training_iteration": 153, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-44-41", "timestamp": 1690850681, "time_this_iter_s": 77.87070488929749, "time_total_s": 12552.43913602829, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12552.43913602829, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 99.98288288288289, "ram_util_percent": 55.45225225225225}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.110136186521877, "episode_reward_mean": -3.918991639439413, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8439900273284835, "reward_component_totals/dist_change_reward_min": -0.9967922076693941, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.0750016121109356, "reward_component_totals/delta_v_min": -2.130252113938337, "reward_component_totals/delta_v_max": -2.0267773387332775, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.50016121109292, "delta_v_total_min": 202.67773387332667, "delta_v_total_max": 213.0252113938325, "constraint_violation.max_vel_constraint.steps_mean": 1129.5, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5644677661169415, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9209438934978103, -3.9084488604715677, -3.7903140433150027, -4.0246089559899705, -3.8004603237251917, -3.9278464307570617, -4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8156001946336096, "mean_inference_ms": 8.29569997990929, "mean_action_processing_ms": 0.4161561779038685, "mean_env_wait_ms": 9.996039912526848, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1848768, "agent_timesteps_total": 1848768, "timers": {"sample_time_ms": 42038.042, "sample_throughput": 285.598, "load_time_ms": 6.42, "load_throughput": 1870026.211, "learn_time_ms": 36439.29, "learn_throughput": 329.48, "update_time_ms": 28.451}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005537457298487425, "policy_loss": 0.0003444247122388333, "vf_loss": 0.00519303185865283, "vf_explained_var": 0.30453887581825256, "kl": -7.004947732980327e-09, "entropy": 2.700486660003662, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1848768, "num_agent_steps_sampled": 1848768, "num_steps_trained": 1848768, "num_agent_steps_trained": 1848768}, "done": false, "episodes_total": 924, "training_iteration": 154, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-46-01", "timestamp": 1690850761, "time_this_iter_s": 80.15655851364136, "time_total_s": 12632.595694541931, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12632.595694541931, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 99.98782608695653, "ram_util_percent": 55.45391304347825}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.110136186521877, "episode_reward_mean": -3.9212939251932433, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8461345891016688, "reward_component_totals/dist_change_reward_min": -0.9967922076693941, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.075159336091581, "reward_component_totals/delta_v_min": -2.130252113938337, "reward_component_totals/delta_v_max": -2.0267773387332775, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5159336091574, "delta_v_total_min": 202.67773387332667, "delta_v_total_max": 213.0252113938325, "constraint_violation.max_vel_constraint.steps_mean": 1147.74, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5735832083958021, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.040967396016672, -4.057358483644571, -3.786489368534708, -4.023133094439525, -3.8026108608146707, -3.882614690603101, -3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8152210881531605, "mean_inference_ms": 8.293596891111322, "mean_action_processing_ms": 0.4160358530491003, "mean_env_wait_ms": 9.992265849282903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1860774, "agent_timesteps_total": 1860774, "timers": {"sample_time_ms": 42228.781, "sample_throughput": 284.308, "load_time_ms": 6.245, "load_throughput": 1922492.749, "learn_time_ms": 36480.734, "learn_throughput": 329.105, "update_time_ms": 29.171}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.00524723157286644, "policy_loss": 0.0006105462671257555, "vf_loss": 0.0046366858296096325, "vf_explained_var": 0.17174971103668213, "kl": -4.784294294069014e-09, "entropy": 2.735241413116455, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1860774, "num_agent_steps_sampled": 1860774, "num_steps_trained": 1860774, "num_agent_steps_trained": 1860774}, "done": false, "episodes_total": 930, "training_iteration": 155, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-47-21", "timestamp": 1690850841, "time_this_iter_s": 78.95995163917542, "time_total_s": 12711.555646181107, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12711.555646181107, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 99.9858407079646, "ram_util_percent": 55.50796460176991}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.1522280987346294, "episode_reward_min": -4.110136186521877, "episode_reward_mean": -3.9220869204275175, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8472460634402829, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.03646476941746185, "reward_component_totals/delta_v_mean": -2.074840856987241, "reward_component_totals/delta_v_min": -2.130252113938337, "reward_component_totals/delta_v_max": -2.0267773387332775, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.48408569872342, "delta_v_total_min": 202.67773387332667, "delta_v_total_max": 213.0252113938325, "constraint_violation.max_vel_constraint.steps_mean": 1160.33, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5798750624687655, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.846363118643107, -3.9783427028046257, -3.8962473435503373, -3.8833722282914596, -3.1522280987346294, -4.071559633552704, -4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.814883696452046, "mean_inference_ms": 8.291521251590254, "mean_action_processing_ms": 0.4159331453302778, "mean_env_wait_ms": 9.988746940516878, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1872780, "agent_timesteps_total": 1872780, "timers": {"sample_time_ms": 42523.319, "sample_throughput": 282.339, "load_time_ms": 6.065, "load_throughput": 1979488.973, "learn_time_ms": 36553.193, "learn_throughput": 328.453, "update_time_ms": 28.011}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004348337184637785, "policy_loss": 0.00011432475002948195, "vf_loss": 0.0042340136133134365, "vf_explained_var": 0.2347715049982071, "kl": -4.86691131840189e-09, "entropy": 2.7489254474639893, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1872780, "num_agent_steps_sampled": 1872780, "num_steps_trained": 1872780, "num_agent_steps_trained": 1872780}, "done": false, "episodes_total": 936, "training_iteration": 156, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-48-40", "timestamp": 1690850920, "time_this_iter_s": 79.05265164375305, "time_total_s": 12790.60829782486, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12790.60829782486, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 99.98230088495576, "ram_util_percent": 55.51061946902654}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7453994639484693, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.932286964083839, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8549108902624564, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.6647862409322103, "reward_component_totals/delta_v_mean": -2.077376073821389, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0298551426331257, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.73760738213815, "delta_v_total_min": 202.98551426331184, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1174.34, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5868842717210679, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.038689714613943, -3.912777521550824, -3.9669181394355997, -4.001989091860331, -4.097336698859262, -3.9237285144972933, -4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8139580264143618, "mean_inference_ms": 8.289647000019691, "mean_action_processing_ms": 0.4158248990012891, "mean_env_wait_ms": 9.985250056391221, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1884784, "agent_timesteps_total": 1884784, "timers": {"sample_time_ms": 42580.008, "sample_throughput": 281.959, "load_time_ms": 6.317, "load_throughput": 1900512.34, "learn_time_ms": 36706.848, "learn_throughput": 327.072, "update_time_ms": 28.743}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.007824691012501717, "policy_loss": -0.00045737510663457215, "vf_loss": 0.008282064460217953, "vf_explained_var": 0.3255949020385742, "kl": -5.638006506103466e-09, "entropy": 2.5633068084716797, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1884784, "num_agent_steps_sampled": 1884784, "num_steps_trained": 1884784, "num_agent_steps_trained": 1884784}, "done": false, "episodes_total": 942, "training_iteration": 157, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-49-59", "timestamp": 1690850999, "time_this_iter_s": 79.28948378562927, "time_total_s": 12869.897781610489, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12869.897781610489, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 99.98584070796461, "ram_util_percent": 55.4362831858407}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7453994639484693, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.925305474698846, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8474235453519305, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.6647862409322103, "reward_component_totals/delta_v_mean": -2.077881929346922, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0298551426331257, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.78819293469147, "delta_v_total_min": 202.98551426331184, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1191.27, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5953450413362603, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.012834325549923, -3.9989498116836675, -3.879224357121944, -3.798307805000828, -4.051690237954214, -3.8867815698521833, -3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8130872243341587, "mean_inference_ms": 8.288081883676908, "mean_action_processing_ms": 0.41572063059654385, "mean_env_wait_ms": 9.981919026798261, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1896790, "agent_timesteps_total": 1896790, "timers": {"sample_time_ms": 42682.993, "sample_throughput": 281.278, "load_time_ms": 6.445, "load_throughput": 1862718.061, "learn_time_ms": 36628.327, "learn_throughput": 327.774, "update_time_ms": 28.842}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004556445404887199, "policy_loss": 0.0006409090128727257, "vf_loss": 0.003915537614375353, "vf_explained_var": 0.12521222233772278, "kl": -4.145887633200118e-09, "entropy": 2.768331527709961, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1896790, "num_agent_steps_sampled": 1896790, "num_steps_trained": 1896790, "num_agent_steps_trained": 1896790}, "done": false, "episodes_total": 948, "training_iteration": 158, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-51-17", "timestamp": 1690851077, "time_this_iter_s": 77.68391346931458, "time_total_s": 12947.581695079803, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12947.581695079803, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 99.98288288288289, "ram_util_percent": 55.422522522522485}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7453994639484693, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.926179338281675, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.846232318102149, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.6647862409322103, "reward_component_totals/delta_v_mean": -2.079947020179533, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0298551426331257, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.99470201795262, "delta_v_total_min": 202.98551426331184, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1177.08, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5882535870633968, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.921846488468579, -3.7453994639484693, -3.924716228161942, -3.899208716722737, -4.0013897250784245, -3.948001631309139, -3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.812276952372614, "mean_inference_ms": 8.28662103514754, "mean_action_processing_ms": 0.4156193227018725, "mean_env_wait_ms": 9.978636371530555, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1908796, "agent_timesteps_total": 1908796, "timers": {"sample_time_ms": 42857.211, "sample_throughput": 280.135, "load_time_ms": 6.573, "load_throughput": 1826437.399, "learn_time_ms": 36631.509, "learn_throughput": 327.745, "update_time_ms": 27.094}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005317161325365305, "policy_loss": 0.0006522001349367201, "vf_loss": 0.004664959851652384, "vf_explained_var": 0.31297168135643005, "kl": -1.9753050306547948e-09, "entropy": 2.7363698482513428, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1908796, "num_agent_steps_sampled": 1908796, "num_steps_trained": 1908796, "num_agent_steps_trained": 1908796}, "done": false, "episodes_total": 954, "training_iteration": 159, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-52-36", "timestamp": 1690851156, "time_this_iter_s": 79.05519008636475, "time_total_s": 13026.636885166168, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13026.636885166168, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 99.98672566371681, "ram_util_percent": 55.4008849557522}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7422013687373017, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.925380619355662, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.845048653934525, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.080331965421143, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0190777194003307, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.03319654211364, "delta_v_total_min": 201.90777194003238, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1170.0, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5847153561788391, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9537749907895336, -3.943412434296766, -3.7800117552940553, -4.004521659967237, -3.9722679892740786, -3.780584485931124, -3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8115069957673682, "mean_inference_ms": 8.285093459378293, "mean_action_processing_ms": 0.4155315368687286, "mean_env_wait_ms": 9.975648188392434, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1920802, "agent_timesteps_total": 1920802, "timers": {"sample_time_ms": 43330.705, "sample_throughput": 277.074, "load_time_ms": 6.927, "load_throughput": 1733167.723, "learn_time_ms": 36866.772, "learn_throughput": 325.654, "update_time_ms": 27.547}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004945451393723488, "policy_loss": -0.0003532954433467239, "vf_loss": 0.0052987439557909966, "vf_explained_var": 0.25989824533462524, "kl": -3.4749347843643363e-09, "entropy": 2.6999645233154297, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1920802, "num_agent_steps_sampled": 1920802, "num_steps_trained": 1920802, "num_agent_steps_trained": 1920802}, "done": false, "episodes_total": 960, "training_iteration": 160, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-53-59", "timestamp": 1690851239, "time_this_iter_s": 82.45474934577942, "time_total_s": 13109.091634511948, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13109.091634511948, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 99.98103448275863, "ram_util_percent": 55.50086206896554}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7422013687373017, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.927211947276716, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8473606841753205, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.079851263101402, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0190777194003307, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98512631013946, "delta_v_total_min": 201.90777194003238, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1173.2, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5863145565786393, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.8837494212379102, -3.8381668604509525, -3.9742845241748084, -3.9283425896418684, -4.0163224522112175, -3.8936035014524206, -3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8112626127652476, "mean_inference_ms": 8.283318559570034, "mean_action_processing_ms": 0.4154474970552192, "mean_env_wait_ms": 9.972880400499486, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1932808, "agent_timesteps_total": 1932808, "timers": {"sample_time_ms": 43125.47, "sample_throughput": 278.392, "load_time_ms": 7.139, "load_throughput": 1681666.003, "learn_time_ms": 36854.101, "learn_throughput": 325.766, "update_time_ms": 28.866}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005457901395857334, "policy_loss": 0.00010563409159658477, "vf_loss": 0.005352267529815435, "vf_explained_var": 0.2752346098423004, "kl": -5.269984004740991e-09, "entropy": 2.7032651901245117, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1932808, "num_agent_steps_sampled": 1932808, "num_steps_trained": 1932808, "num_agent_steps_trained": 1932808}, "done": false, "episodes_total": 966, "training_iteration": 161, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-55-28", "timestamp": 1690851328, "time_this_iter_s": 89.02407264709473, "time_total_s": 13198.115707159042, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13198.115707159042, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 99.98661417322836, "ram_util_percent": 55.45039370078738}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7422013687373017, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.92525262213639, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.846210578133583, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.079042044002815, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0159738371769627, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90420440028072, "delta_v_total_min": 201.59738371769558, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1166.62, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5830262007565502, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.8550853263318574, -3.8026003935893895, -4.055761740815988, -3.873619641064837, -3.8871855375378166, -4.066633107822467, -4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8110642630349605, "mean_inference_ms": 8.28172251619286, "mean_action_processing_ms": 0.415372181540025, "mean_env_wait_ms": 9.97026942898219, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1944814, "agent_timesteps_total": 1944814, "timers": {"sample_time_ms": 43243.151, "sample_throughput": 277.635, "load_time_ms": 7.496, "load_throughput": 1601576.737, "learn_time_ms": 37029.871, "learn_throughput": 324.219, "update_time_ms": 27.492}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0051307231187820435, "policy_loss": 0.0004015351878479123, "vf_loss": 0.004729187581688166, "vf_explained_var": 0.22300666570663452, "kl": -6.812173936054933e-09, "entropy": 2.715796947479248, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1944814, "num_agent_steps_sampled": 1944814, "num_steps_trained": 1944814, "num_agent_steps_trained": 1944814}, "done": false, "episodes_total": 972, "training_iteration": 162, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-56-49", "timestamp": 1690851409, "time_this_iter_s": 80.56924533843994, "time_total_s": 13278.684952497482, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13278.684952497482, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 99.98173913043478, "ram_util_percent": 55.458260869565194}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7422013687373017, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.9247594742692953, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8439014939280834, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.0808579803412193, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0159738371769627, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0857980341211, "delta_v_total_min": 201.59738371769558, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1143.17, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5713070603267651, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.001340015559634, -4.068280870776558, -3.931739371795763, -3.905336928520761, -4.011212787210171, -3.756080746253382, -3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8109062079229512, "mean_inference_ms": 8.280137295170181, "mean_action_processing_ms": 0.4153077245638103, "mean_env_wait_ms": 9.967854492484115, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1956820, "agent_timesteps_total": 1956820, "timers": {"sample_time_ms": 43426.861, "sample_throughput": 276.46, "load_time_ms": 7.243, "load_throughput": 1657498.839, "learn_time_ms": 36966.868, "learn_throughput": 324.772, "update_time_ms": 26.132}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005082122515887022, "policy_loss": 0.000684681290294975, "vf_loss": 0.004397444427013397, "vf_explained_var": 0.25890037417411804, "kl": -2.5110660217819714e-09, "entropy": 2.7605245113372803, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1956820, "num_agent_steps_sampled": 1956820, "num_steps_trained": 1956820, "num_agent_steps_trained": 1956820}, "done": false, "episodes_total": 978, "training_iteration": 163, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-58-08", "timestamp": 1690851488, "time_this_iter_s": 79.0772967338562, "time_total_s": 13357.762249231339, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13357.762249231339, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 99.98849557522125, "ram_util_percent": 55.39911504424777}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7422013687373017, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.9281422162152033, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.846957141784007, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.081185074431204, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0159738371769627, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.11850744311968, "delta_v_total_min": 201.59738371769558, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1156.28, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5778587844646961, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9302262817188796, -3.796423370554889, -3.8681915379354037, -3.9741217278252137, -3.8796855848696588, -3.975303747173669, -4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8107730869765573, "mean_inference_ms": 8.27871728113753, "mean_action_processing_ms": 0.4152452021381883, "mean_env_wait_ms": 9.96574720096877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1968826, "agent_timesteps_total": 1968826, "timers": {"sample_time_ms": 43394.603, "sample_throughput": 276.666, "load_time_ms": 7.144, "load_throughput": 1680431.386, "learn_time_ms": 37113.923, "learn_throughput": 323.485, "update_time_ms": 27.783}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0036190319806337357, "policy_loss": -0.0004888604744337499, "vf_loss": 0.004107892978936434, "vf_explained_var": 0.18071521818637848, "kl": -7.085061426437278e-09, "entropy": 2.7604031562805176, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1968826, "num_agent_steps_sampled": 1968826, "num_steps_trained": 1968826, "num_agent_steps_trained": 1968826}, "done": false, "episodes_total": 984, "training_iteration": 164, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_17-59-30", "timestamp": 1690851570, "time_this_iter_s": 81.35817980766296, "time_total_s": 13439.120429039001, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13439.120429039001, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 99.98103448275863, "ram_util_percent": 55.4905172413793}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7422013687373017, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.9294807448728073, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8484256961274365, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.0810550487453767, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0159738371769627, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10550487453693, "delta_v_total_min": 201.59738371769558, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1143.21, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5713270503317625, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.047136435972962, -3.968335588221561, -3.8619765539304716, -3.974995747046611, -3.8799079357395643, -3.8144370140209904, -3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8106795106757934, "mean_inference_ms": 8.277361131692977, "mean_action_processing_ms": 0.41518691135281643, "mean_env_wait_ms": 9.96388351975932, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1980832, "agent_timesteps_total": 1980832, "timers": {"sample_time_ms": 43332.121, "sample_throughput": 277.065, "load_time_ms": 7.156, "load_throughput": 1677637.759, "learn_time_ms": 36944.569, "learn_throughput": 324.968, "update_time_ms": 26.952}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.002426208695396781, "policy_loss": -0.0010984863620251417, "vf_loss": 0.003524694126099348, "vf_explained_var": 0.10307037085294724, "kl": -2.98173441493077e-09, "entropy": 2.798372268676758, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1980832, "num_agent_steps_sampled": 1980832, "num_steps_trained": 1980832, "num_agent_steps_trained": 1980832}, "done": false, "episodes_total": 990, "training_iteration": 165, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-00-47", "timestamp": 1690851647, "time_this_iter_s": 76.60313153266907, "time_total_s": 13515.72356057167, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13515.72356057167, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 99.97909090909091, "ram_util_percent": 55.4190909090909}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7422013687373017, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.9285726054840033, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8470410814283086, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.081531524055703, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0159738371769627, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.15315240556953, "delta_v_total_min": 201.59738371769558, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1152.44, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.575939743984936, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.8958437135463315, -3.851437034849858, -3.9311976750217594, -3.9975805154676465, -4.078527910550651, -3.9753802398314617, -3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8106316371498514, "mean_inference_ms": 8.276193436488757, "mean_action_processing_ms": 0.41513547504454806, "mean_env_wait_ms": 9.962326789873423, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1992838, "agent_timesteps_total": 1992838, "timers": {"sample_time_ms": 43379.041, "sample_throughput": 276.765, "load_time_ms": 7.497, "load_throughput": 1601449.401, "learn_time_ms": 36786.269, "learn_throughput": 326.366, "update_time_ms": 26.887}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006003041286021471, "policy_loss": 0.00034759871778078377, "vf_loss": 0.0056554414331912994, "vf_explained_var": 0.2914073169231415, "kl": -5.625488963545422e-09, "entropy": 2.683152437210083, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1992838, "num_agent_steps_sampled": 1992838, "num_steps_trained": 1992838, "num_agent_steps_trained": 1992838}, "done": false, "episodes_total": 996, "training_iteration": 166, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-02-05", "timestamp": 1690851725, "time_this_iter_s": 77.93622779846191, "time_total_s": 13593.659788370132, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13593.659788370132, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 99.98198198198196, "ram_util_percent": 55.44684684684682}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7422013687373017, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.9254267239662877, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8445561746575359, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.0808705493087603, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0159738371769627, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.08705493087535, "delta_v_total_min": 201.59738371769558, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1137.98, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5687133571783393, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.8404613991346235, -4.06618203455542, -3.8564134827767704, -4.009174365443951, -3.8275854238074065, -3.894938239460692, -3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.810030018724385, "mean_inference_ms": 8.275066349449986, "mean_action_processing_ms": 0.41507322165791216, "mean_env_wait_ms": 9.960859326401275, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2004844, "agent_timesteps_total": 2004844, "timers": {"sample_time_ms": 43413.769, "sample_throughput": 276.548, "load_time_ms": 7.384, "load_throughput": 1626039.389, "learn_time_ms": 36700.214, "learn_throughput": 327.137, "update_time_ms": 27.688}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004177264869213104, "policy_loss": -0.0013790092198178172, "vf_loss": 0.005556273739784956, "vf_explained_var": 0.22856107354164124, "kl": -5.375133227403239e-09, "entropy": 2.700636386871338, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2004844, "num_agent_steps_sampled": 2004844, "num_steps_trained": 2004844, "num_agent_steps_trained": 2004844}, "done": false, "episodes_total": 1002, "training_iteration": 167, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-03-24", "timestamp": 1690851804, "time_this_iter_s": 78.76140832901001, "time_total_s": 13672.421196699142, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13672.421196699142, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 99.97837837837838, "ram_util_percent": 55.44504504504504}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7422013687373017, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.926504701551029, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8457659287226537, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.0807387728283833, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0159738371769627, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07387728283763, "delta_v_total_min": 201.59738371769558, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1145.22, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.572331548082887, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.784015621867877, -3.8180422249635795, -3.981763162442218, -4.110136186521877, -3.885476505187664, -4.070970899048615, -3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8094669856753465, "mean_inference_ms": 8.273975815488136, "mean_action_processing_ms": 0.41502523877837616, "mean_env_wait_ms": 9.959586182507019, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2016850, "agent_timesteps_total": 2016850, "timers": {"sample_time_ms": 43552.635, "sample_throughput": 275.666, "load_time_ms": 7.412, "load_throughput": 1619888.113, "learn_time_ms": 36591.745, "learn_throughput": 328.107, "update_time_ms": 28.582}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004410962108522654, "policy_loss": 0.0003078788286074996, "vf_loss": 0.004103085957467556, "vf_explained_var": 0.18161828815937042, "kl": -7.595787110403762e-09, "entropy": 2.7623250484466553, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2016850, "num_agent_steps_sampled": 2016850, "num_steps_trained": 2016850, "num_agent_steps_trained": 2016850}, "done": false, "episodes_total": 1008, "training_iteration": 168, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-04-42", "timestamp": 1690851882, "time_this_iter_s": 78.02438569068909, "time_total_s": 13750.445582389832, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13750.445582389832, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 99.98125000000002, "ram_util_percent": 55.45357142857142}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7422013687373017, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.924041974207299, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8433029092476186, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.080739064959688, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.0159738371769627, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07390649596812, "delta_v_total_min": 201.59738371769558, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1153.1, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5762695790673947, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.8425865176382104, -3.801960513972931, -3.957037795518001, -3.9744387225855258, -4.086473629203648, -3.9645821087820066, -3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8089087059690039, "mean_inference_ms": 8.272860051296062, "mean_action_processing_ms": 0.4149875639734516, "mean_env_wait_ms": 9.958498998533884, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2028856, "agent_timesteps_total": 2028856, "timers": {"sample_time_ms": 43550.162, "sample_throughput": 275.682, "load_time_ms": 7.391, "load_throughput": 1624313.794, "learn_time_ms": 36796.081, "learn_throughput": 326.285, "update_time_ms": 28.551}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005221574101597071, "policy_loss": 0.0002412502799415961, "vf_loss": 0.004980325233191252, "vf_explained_var": 0.10117008537054062, "kl": -7.222757059111018e-09, "entropy": 2.726531982421875, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2028856, "num_agent_steps_sampled": 2028856, "num_steps_trained": 2028856, "num_agent_steps_trained": 2028856}, "done": false, "episodes_total": 1014, "training_iteration": 169, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-06-03", "timestamp": 1690851963, "time_this_iter_s": 81.05354380607605, "time_total_s": 13831.499126195908, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13831.499126195908, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 99.98620689655174, "ram_util_percent": 55.39827586206894}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7338079214149293, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.9197551846203225, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8396866876375749, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.0800684969827556, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00684969827492, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1167.76, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5835959158989791, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.9311411946489683, -3.8674524953110394, -3.7987792346822604, -3.8412248710537997, -4.050689977451428, -3.842046153817588, -4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8083892565857025, "mean_inference_ms": 8.271749160482841, "mean_action_processing_ms": 0.4149507001844125, "mean_env_wait_ms": 9.95763084429197, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2040862, "agent_timesteps_total": 2040862, "timers": {"sample_time_ms": 43254.16, "sample_throughput": 277.569, "load_time_ms": 7.154, "load_throughput": 1678174.481, "learn_time_ms": 36737.536, "learn_throughput": 326.805, "update_time_ms": 27.344}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0054428549483418465, "policy_loss": 0.0009421442518942058, "vf_loss": 0.004500711336731911, "vf_explained_var": 0.18914784491062164, "kl": -6.178774381027097e-09, "entropy": 2.7347939014434814, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2040862, "num_agent_steps_sampled": 2040862, "num_steps_trained": 2040862, "num_agent_steps_trained": 2040862}, "done": false, "episodes_total": 1020, "training_iteration": 170, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-07-22", "timestamp": 1690852042, "time_this_iter_s": 78.87057518959045, "time_total_s": 13910.369701385498, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13910.369701385498, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 99.9857142857143, "ram_util_percent": 55.39732142857141}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7338079214149293, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.9208644603575435, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.839566620297752, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.0812978400597997, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.12978400597927, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1166.58, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5830062107515527, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-4.015523249722534, -4.0282823650928465, -3.8096894000392463, -3.856619937016049, -3.8353082744761, -3.8309524112385267, -4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8083368746384025, "mean_inference_ms": 8.270520578230748, "mean_action_processing_ms": 0.4149156467368151, "mean_env_wait_ms": 9.95671364678444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2052868, "agent_timesteps_total": 2052868, "timers": {"sample_time_ms": 43463.703, "sample_throughput": 276.23, "load_time_ms": 6.936, "load_throughput": 1730950.565, "learn_time_ms": 36642.86, "learn_throughput": 327.649, "update_time_ms": 30.61}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004564264323562384, "policy_loss": -8.159362914739177e-05, "vf_loss": 0.004645857959985733, "vf_explained_var": 0.2699199318885803, "kl": -5.452743589984266e-09, "entropy": 2.7277097702026367, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2052868, "num_agent_steps_sampled": 2052868, "num_steps_trained": 2052868, "num_agent_steps_trained": 2052868}, "done": false, "episodes_total": 1026, "training_iteration": 171, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-08-53", "timestamp": 1690852133, "time_this_iter_s": 90.20644402503967, "time_total_s": 14000.576145410538, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14000.576145410538, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 99.98372093023255, "ram_util_percent": 55.490697674418605}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7338079214149293, "episode_reward_min": -4.114478872140166, "episode_reward_mean": -3.922826676170734, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8412151243649052, "reward_component_totals/dist_change_reward_min": -0.9987213127724803, "reward_component_totals/dist_change_reward_max": -0.7075956421448787, "reward_component_totals/delta_v_mean": -2.081611551805837, "reward_component_totals/delta_v_min": -2.172080140709869, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16115518058302, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 217.20801407098702, "constraint_violation.max_vel_constraint.steps_mean": 1133.15, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.566299564074891, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-4.0309542997819925, -4.023907096368177, -4.053407543143867, -3.897943792472003, -3.9675030562003046, -4.114478872140166, -4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8082858415922598, "mean_inference_ms": 8.269290218346082, "mean_action_processing_ms": 0.41488156906366336, "mean_env_wait_ms": 9.955830878714629, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2064874, "agent_timesteps_total": 2064874, "timers": {"sample_time_ms": 43440.574, "sample_throughput": 276.378, "load_time_ms": 6.68, "load_throughput": 1797347.133, "learn_time_ms": 36549.28, "learn_throughput": 328.488, "update_time_ms": 29.067}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003758820705115795, "policy_loss": -0.0007163858972489834, "vf_loss": 0.004475205671042204, "vf_explained_var": 0.2431013286113739, "kl": -3.955617167150649e-09, "entropy": 2.736299753189087, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2064874, "num_agent_steps_sampled": 2064874, "num_steps_trained": 2064874, "num_agent_steps_trained": 2064874}, "done": false, "episodes_total": 1032, "training_iteration": 172, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-10-12", "timestamp": 1690852212, "time_this_iter_s": 79.40016150474548, "time_total_s": 14079.976306915283, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14079.976306915283, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 99.9780701754386, "ram_util_percent": 55.392105263157866}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.089441979491994, "episode_reward_mean": -3.912769701428612, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8322296217852879, "reward_component_totals/dist_change_reward_min": -0.9963727932628182, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.080540079643332, "reward_component_totals/delta_v_min": -2.157091062664984, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05400796433253, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 215.70910626649783, "constraint_violation.max_vel_constraint.steps_mean": 1103.55, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1943, "constraint_violation.max_vel_constraint.ratio_mean": 0.5515069603767401, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9710144927536232}, "hist_stats": {"episode_reward": [-4.089441979491994, -3.9684845946823906, -3.8535774483568934, -3.8546315403371905, -3.8000710741533776, -3.7799214608861265, -3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688], "episode_lengths": [2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.808234660519837, "mean_inference_ms": 8.268197294061386, "mean_action_processing_ms": 0.4148424988122878, "mean_env_wait_ms": 9.954923676143743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2076880, "agent_timesteps_total": 2076880, "timers": {"sample_time_ms": 43288.835, "sample_throughput": 277.346, "load_time_ms": 6.339, "load_throughput": 1893889.369, "learn_time_ms": 36594.491, "learn_throughput": 328.082, "update_time_ms": 29.713}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004797100555151701, "policy_loss": 0.0010381060419604182, "vf_loss": 0.0037589927669614553, "vf_explained_var": 0.1547163724899292, "kl": -6.516754247343215e-09, "entropy": 2.7796874046325684, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2076880, "num_agent_steps_sampled": 2076880, "num_steps_trained": 2076880, "num_agent_steps_trained": 2076880}, "done": false, "episodes_total": 1038, "training_iteration": 173, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-11-30", "timestamp": 1690852290, "time_this_iter_s": 77.99418020248413, "time_total_s": 14157.970487117767, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14157.970487117767, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 99.97747747747748, "ram_util_percent": 55.43783783783783}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.088042901650681, "episode_reward_mean": -3.91488408284125, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8351671705657013, "reward_component_totals/dist_change_reward_min": -0.9963727932628182, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.079716912275556, "reward_component_totals/delta_v_min": -2.157091062664984, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.97169122755489, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 215.70910626649783, "constraint_violation.max_vel_constraint.steps_mean": 1091.11, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5452823588205897, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9272315692012065, -3.8275851820053024, -4.087759128186251, -3.8207223278857088, -4.047947723421132, -4.015518086496475, -3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8081983929194372, "mean_inference_ms": 8.26698041428941, "mean_action_processing_ms": 0.4148086453945894, "mean_env_wait_ms": 9.9540679314712, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2088886, "agent_timesteps_total": 2088886, "timers": {"sample_time_ms": 43017.781, "sample_throughput": 279.094, "load_time_ms": 6.286, "load_throughput": 1909835.129, "learn_time_ms": 36471.413, "learn_throughput": 329.189, "update_time_ms": 27.705}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005809057038277388, "policy_loss": 0.0010157979559153318, "vf_loss": 0.004793259315192699, "vf_explained_var": 0.19662295281887054, "kl": -2.1705823805007185e-09, "entropy": 2.731989622116089, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2088886, "num_agent_steps_sampled": 2088886, "num_steps_trained": 2088886, "num_agent_steps_trained": 2088886}, "done": false, "episodes_total": 1044, "training_iteration": 174, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-12-48", "timestamp": 1690852368, "time_this_iter_s": 77.39593553543091, "time_total_s": 14235.366422653198, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14235.366422653198, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 99.97657657657658, "ram_util_percent": 55.422522522522485}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.088042901650681, "episode_reward_mean": -3.9129424553639502, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8349294394196908, "reward_component_totals/dist_change_reward_min": -0.9963727932628182, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.078013015944266, "reward_component_totals/delta_v_min": -2.157091062664984, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.80130159442587, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 215.70910626649783, "constraint_violation.max_vel_constraint.steps_mean": 1076.41, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5379360319840081, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.85649804196955, -3.97815571411728, -3.9684367123828195, -3.848618187058433, -3.911903588759549, -3.997330397008951, -3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8082008519931667, "mean_inference_ms": 8.265634208697257, "mean_action_processing_ms": 0.4147690549313824, "mean_env_wait_ms": 9.953161905928853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2100892, "agent_timesteps_total": 2100892, "timers": {"sample_time_ms": 43027.952, "sample_throughput": 279.028, "load_time_ms": 6.329, "load_throughput": 1896871.389, "learn_time_ms": 36567.862, "learn_throughput": 328.321, "update_time_ms": 28.122}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0035399231128394604, "policy_loss": -0.0002609994844533503, "vf_loss": 0.003800923703238368, "vf_explained_var": 0.058129437267780304, "kl": -2.5085624688614416e-09, "entropy": 2.792574882507324, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2100892, "num_agent_steps_sampled": 2100892, "num_steps_trained": 2100892, "num_agent_steps_trained": 2100892}, "done": false, "episodes_total": 1050, "training_iteration": 175, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-14-06", "timestamp": 1690852446, "time_this_iter_s": 77.64941120147705, "time_total_s": 14313.015833854675, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14313.015833854675, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 99.98363636363635, "ram_util_percent": 55.3972727272727}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.088042901650681, "episode_reward_mean": -3.9121012916777027, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8363957710796128, "reward_component_totals/dist_change_reward_min": -0.9963727932628182, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.075705520598097, "reward_component_totals/delta_v_min": -2.136627751191455, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.570552059809, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 213.66277511914527, "constraint_violation.max_vel_constraint.steps_mean": 1085.24, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5423488255872063, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9654664298085223, -3.7422013687373017, -3.8364084574409905, -3.907380119332591, -4.021938368784154, -4.040363456357457, -3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8081930723055577, "mean_inference_ms": 8.264226668964518, "mean_action_processing_ms": 0.4147253664345393, "mean_env_wait_ms": 9.95221111227038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2112898, "agent_timesteps_total": 2112898, "timers": {"sample_time_ms": 42909.454, "sample_throughput": 279.798, "load_time_ms": 5.983, "load_throughput": 2006767.243, "learn_time_ms": 36673.924, "learn_throughput": 327.372, "update_time_ms": 27.968}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004431418143212795, "policy_loss": -0.0006071852403692901, "vf_loss": 0.005038602277636528, "vf_explained_var": 0.2745419144630432, "kl": -2.909131158190803e-09, "entropy": 2.713038682937622, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2112898, "num_agent_steps_sampled": 2112898, "num_steps_trained": 2112898, "num_agent_steps_trained": 2112898}, "done": false, "episodes_total": 1056, "training_iteration": 176, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-15-24", "timestamp": 1690852524, "time_this_iter_s": 77.77716207504272, "time_total_s": 14390.792995929718, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14390.792995929718, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 99.98378378378379, "ram_util_percent": 55.463063063063025}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.088042901650681, "episode_reward_mean": -3.909149674893555, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8312223367886149, "reward_component_totals/dist_change_reward_min": -0.9963727932628182, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.0779273381049475, "reward_component_totals/delta_v_min": -2.136627751191455, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.79273381049396, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 213.66277511914527, "constraint_violation.max_vel_constraint.steps_mean": 1111.81, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5556271864067966, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.8266804886453487, -3.965783913932782, -3.9091372115310343, -3.85380266840742, -3.916522224474419, -3.9898784770005333, -3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8076748377892995, "mean_inference_ms": 8.262885068833048, "mean_action_processing_ms": 0.4146724780608965, "mean_env_wait_ms": 9.95093500111762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2124904, "agent_timesteps_total": 2124904, "timers": {"sample_time_ms": 42926.149, "sample_throughput": 279.69, "load_time_ms": 6.083, "load_throughput": 1973600.592, "learn_time_ms": 36721.718, "learn_throughput": 326.945, "update_time_ms": 27.953}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005633124615997076, "policy_loss": 0.0010838373564183712, "vf_loss": 0.004549285396933556, "vf_explained_var": 0.135933980345726, "kl": -3.6001124303908227e-09, "entropy": 2.7509968280792236, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2124904, "num_agent_steps_sampled": 2124904, "num_steps_trained": 2124904, "num_agent_steps_trained": 2124904}, "done": false, "episodes_total": 1062, "training_iteration": 177, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-16-43", "timestamp": 1690852603, "time_this_iter_s": 79.45916509628296, "time_total_s": 14470.252161026001, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14470.252161026001, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 99.97964601769911, "ram_util_percent": 55.43185840707964}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.088042901650681, "episode_reward_mean": -3.908151595143199, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8292962798562873, "reward_component_totals/dist_change_reward_min": -0.9963727932628182, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.078855315286918, "reward_component_totals/delta_v_min": -2.142141229013603, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.885531528691, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 214.21412290135925, "constraint_violation.max_vel_constraint.steps_mean": 1115.54, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5574912543728135, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9566488078086453, -3.8156898336027822, -3.797623958490744, -3.8621735337595346, -4.007944529527481, -4.074972877588202, -3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8071324050400122, "mean_inference_ms": 8.26165394027846, "mean_action_processing_ms": 0.4146234332711815, "mean_env_wait_ms": 9.949671815772358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2136910, "agent_timesteps_total": 2136910, "timers": {"sample_time_ms": 42931.346, "sample_throughput": 279.656, "load_time_ms": 6.225, "load_throughput": 1928714.766, "learn_time_ms": 36532.106, "learn_throughput": 328.642, "update_time_ms": 27.348}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004399231169372797, "policy_loss": 0.00013504458183888346, "vf_loss": 0.004264188464730978, "vf_explained_var": 0.2505374550819397, "kl": -2.6938256070252464e-09, "entropy": 2.7470991611480713, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2136910, "num_agent_steps_sampled": 2136910, "num_steps_trained": 2136910, "num_agent_steps_trained": 2136910}, "done": false, "episodes_total": 1068, "training_iteration": 178, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-18-00", "timestamp": 1690852680, "time_this_iter_s": 76.18883395195007, "time_total_s": 14546.440994977951, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14546.440994977951, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 99.98532110091743, "ram_util_percent": 55.42660550458713}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.088042901650681, "episode_reward_mean": -3.9027779718735234, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.824872599450096, "reward_component_totals/dist_change_reward_min": -0.9963727932628182, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.0779053724234338, "reward_component_totals/delta_v_min": -2.142141229013603, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.79053724234265, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 214.21412290135925, "constraint_violation.max_vel_constraint.steps_mean": 1127.95, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5636931534232884, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9167533058962247, -3.8922428283333463, -3.790245544770912, -3.809411874336684, -4.081467917115727, -4.088042901650681, -4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8065805167472104, "mean_inference_ms": 8.26044219668006, "mean_action_processing_ms": 0.4145692900124411, "mean_env_wait_ms": 9.948315477627995, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2148916, "agent_timesteps_total": 2148916, "timers": {"sample_time_ms": 42797.318, "sample_throughput": 280.532, "load_time_ms": 5.661, "load_throughput": 2120769.094, "learn_time_ms": 36457.971, "learn_throughput": 329.311, "update_time_ms": 27.776}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005097184330224991, "policy_loss": 0.0008147688931785524, "vf_loss": 0.004282414447516203, "vf_explained_var": 0.14444564282894135, "kl": -3.192033082299872e-09, "entropy": 2.774570941925049, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2148916, "num_agent_steps_sampled": 2148916, "num_steps_trained": 2148916, "num_agent_steps_trained": 2148916}, "done": false, "episodes_total": 1074, "training_iteration": 179, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-19-19", "timestamp": 1690852759, "time_this_iter_s": 79.02099204063416, "time_total_s": 14625.461987018585, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14625.461987018585, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 99.98230088495575, "ram_util_percent": 55.46017699115044}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.082959511592523, "episode_reward_mean": -3.90432971879503, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8258839702577512, "reward_component_totals/dist_change_reward_min": -0.9884808746125918, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.078445748537286, "reward_component_totals/delta_v_min": -2.142548602769771, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.84457485372778, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 214.2548602769762, "constraint_violation.max_vel_constraint.steps_mean": 1129.45, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5644427786106945, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.002480047859597, -3.8168046891816703, -4.023438713387707, -4.0000306455117665, -3.902897016229921, -3.8278678611108985, -4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.805997014631451, "mean_inference_ms": 8.259237041691959, "mean_action_processing_ms": 0.4145117447179304, "mean_env_wait_ms": 9.94665139902823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2160922, "agent_timesteps_total": 2160922, "timers": {"sample_time_ms": 42691.757, "sample_throughput": 281.225, "load_time_ms": 5.653, "load_throughput": 2123828.102, "learn_time_ms": 36457.033, "learn_throughput": 329.319, "update_time_ms": 27.64}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0058949608355760574, "policy_loss": 0.0006006943876855075, "vf_loss": 0.0052942680194973946, "vf_explained_var": 0.26005226373672485, "kl": -6.339002212030209e-09, "entropy": 2.713024377822876, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2160922, "num_agent_steps_sampled": 2160922, "num_steps_trained": 2160922, "num_agent_steps_trained": 2160922}, "done": false, "episodes_total": 1080, "training_iteration": 180, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-20-37", "timestamp": 1690852837, "time_this_iter_s": 77.84766435623169, "time_total_s": 14703.309651374817, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14703.309651374817, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 99.97567567567567, "ram_util_percent": 55.46306306306306}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.082959511592523, "episode_reward_mean": -3.9035818731137426, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8244173206690294, "reward_component_totals/dist_change_reward_min": -0.9884808746125918, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.0791645524447198, "reward_component_totals/delta_v_min": -2.142548602769771, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.91645524447125, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 214.2548602769762, "constraint_violation.max_vel_constraint.steps_mean": 1124.96, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5621989005497252, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.015424686479752, -4.002573586149745, -3.957365019385899, -3.8516769464817777, -3.8173683289644185, -3.886555119908813, -4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8058555322376568, "mean_inference_ms": 8.257861709079073, "mean_action_processing_ms": 0.4144694662217823, "mean_env_wait_ms": 9.945141914707103, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2172928, "agent_timesteps_total": 2172928, "timers": {"sample_time_ms": 42577.827, "sample_throughput": 281.978, "load_time_ms": 5.627, "load_throughput": 2133736.174, "learn_time_ms": 36579.786, "learn_throughput": 328.214, "update_time_ms": 24.469}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.003584355115890503, "policy_loss": -2.37139956880128e-05, "vf_loss": 0.003608068684116006, "vf_explained_var": 0.11020556092262268, "kl": 2.5035553057745075e-12, "entropy": 2.800384283065796, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2172928, "num_agent_steps_sampled": 2172928, "num_steps_trained": 2172928, "num_agent_steps_trained": 2172928}, "done": false, "episodes_total": 1086, "training_iteration": 181, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-22-08", "timestamp": 1690852928, "time_this_iter_s": 90.31453609466553, "time_total_s": 14793.624187469482, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14793.624187469482, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 99.98527131782944, "ram_util_percent": 55.48139534883721}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.903433034170589, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8233827606776605, "reward_component_totals/dist_change_reward_min": -0.9929432591465526, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.0800502734929354, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00502734929285, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1133.56, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5664967516241879, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.028611996335662, -4.048574080196024, -3.774296126194894, -3.9005696844520887, -4.082959511592523, -4.017345921846946, -3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8056943865109119, "mean_inference_ms": 8.256485690595417, "mean_action_processing_ms": 0.4144199734615093, "mean_env_wait_ms": 9.943530763283164, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2184934, "agent_timesteps_total": 2184934, "timers": {"sample_time_ms": 42375.295, "sample_throughput": 283.325, "load_time_ms": 5.588, "load_throughput": 2148685.738, "learn_time_ms": 36574.489, "learn_throughput": 328.262, "update_time_ms": 25.272}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005090680904686451, "policy_loss": 0.0006143012433312833, "vf_loss": 0.0044763823971152306, "vf_explained_var": 0.14784546196460724, "kl": -6.934848251205494e-10, "entropy": 2.762723922729492, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2184934, "num_agent_steps_sampled": 2184934, "num_steps_trained": 2184934, "num_agent_steps_trained": 2184934}, "done": false, "episodes_total": 1092, "training_iteration": 182, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-23-25", "timestamp": 1690853005, "time_this_iter_s": 77.3040030002594, "time_total_s": 14870.928190469742, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14870.928190469742, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 99.98440366972478, "ram_util_percent": 55.41743119266054}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.902340428062078, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8230235318435232, "reward_component_totals/dist_change_reward_min": -0.9929432591465526, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.079316896218562, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93168962185544, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1131.37, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5654022988505747, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.827061640470287, -3.9212268261431094, -3.7961096633409452, -3.770675374102344, -3.8189591670585408, -4.048215684258434, -3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8055535534963092, "mean_inference_ms": 8.254996994392153, "mean_action_processing_ms": 0.4143770671928404, "mean_env_wait_ms": 9.9419831900938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2196940, "agent_timesteps_total": 2196940, "timers": {"sample_time_ms": 42437.262, "sample_throughput": 282.912, "load_time_ms": 5.756, "load_throughput": 2085703.734, "learn_time_ms": 36806.087, "learn_throughput": 326.196, "update_time_ms": 25.626}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006018687970936298, "policy_loss": 0.000867408060003072, "vf_loss": 0.005151278804987669, "vf_explained_var": 0.26069384813308716, "kl": -7.43555927940065e-09, "entropy": 2.717190980911255, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2196940, "num_agent_steps_sampled": 2196940, "num_steps_trained": 2196940, "num_agent_steps_trained": 2196940}, "done": false, "episodes_total": 1098, "training_iteration": 183, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-24-46", "timestamp": 1690853086, "time_this_iter_s": 80.9499089717865, "time_total_s": 14951.878099441528, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14951.878099441528, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 99.98103448275862, "ram_util_percent": 55.47413793103447}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.907042747724111, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8275879314224502, "reward_component_totals/dist_change_reward_min": -0.9929432591465526, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.0794548163016677, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.94548163016592, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1134.52, "constraint_violation.max_vel_constraint.steps_min": 350, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.566976511744128, "constraint_violation.max_vel_constraint.ratio_min": 0.17491254372813594, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.89287462757592, -4.021078814441927, -3.8489039576918325, -3.972520452626288, -3.9109782112275466, -3.784397743634548, -3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8054187217617752, "mean_inference_ms": 8.253589176314, "mean_action_processing_ms": 0.4143324535301642, "mean_env_wait_ms": 9.940393597611775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2208946, "agent_timesteps_total": 2208946, "timers": {"sample_time_ms": 42601.257, "sample_throughput": 281.823, "load_time_ms": 5.772, "load_throughput": 2079871.707, "learn_time_ms": 37006.3, "learn_throughput": 324.431, "update_time_ms": 27.283}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0030842076521366835, "policy_loss": -0.0011240682797506452, "vf_loss": 0.0042082746513187885, "vf_explained_var": 0.1985192596912384, "kl": -5.390154544926418e-09, "entropy": 2.752189874649048, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2208946, "num_agent_steps_sampled": 2208946, "num_steps_trained": 2208946, "num_agent_steps_trained": 2208946}, "done": false, "episodes_total": 1104, "training_iteration": 184, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-26-07", "timestamp": 1690853167, "time_this_iter_s": 80.97434687614441, "time_total_s": 15032.852446317673, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15032.852446317673, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 99.98869565217392, "ram_util_percent": 55.50956521739129}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9081689940628035, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8281026909422532, "reward_component_totals/dist_change_reward_min": -0.9929432591465526, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.080066303120557, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0066303120549, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1124.19, "constraint_violation.max_vel_constraint.steps_min": 312, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5618140929535231, "constraint_violation.max_vel_constraint.ratio_min": 0.15592203898050974, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.894649715597711, -3.940645945112358, -3.9868235639728398, -3.886636686113812, -3.9455592510469284, -3.838430980142626, -4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8053040847759823, "mean_inference_ms": 8.252186025856076, "mean_action_processing_ms": 0.4142802239796646, "mean_env_wait_ms": 9.938677492743695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2220952, "agent_timesteps_total": 2220952, "timers": {"sample_time_ms": 42628.104, "sample_throughput": 281.645, "load_time_ms": 5.891, "load_throughput": 2037945.326, "learn_time_ms": 37117.653, "learn_throughput": 323.458, "update_time_ms": 27.287}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005364273674786091, "policy_loss": 0.0006975419237278402, "vf_loss": 0.00466673169285059, "vf_explained_var": 0.23941579461097717, "kl": -3.577580454106055e-09, "entropy": 2.73073673248291, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2220952, "num_agent_steps_sampled": 2220952, "num_steps_trained": 2220952, "num_agent_steps_trained": 2220952}, "done": false, "episodes_total": 1110, "training_iteration": 185, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-27-27", "timestamp": 1690853247, "time_this_iter_s": 79.02094554901123, "time_total_s": 15111.873391866684, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15111.873391866684, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 99.97982456140352, "ram_util_percent": 55.455263157894734}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9057354056696045, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8258746516992627, "reward_component_totals/dist_change_reward_min": -0.9929432591465526, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.0798607539703484, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.014434771090751, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98607539703409, "delta_v_total_min": 201.4434771090743, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1104.73, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5520889555222389, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.023670657786535, -3.8136138465363154, -3.8433176720753943, -3.7338079214149293, -3.866749572501238, -4.001048207322156, -3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8052189872101545, "mean_inference_ms": 8.25090045896797, "mean_action_processing_ms": 0.41422990550386013, "mean_env_wait_ms": 9.936951414912473, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2232958, "agent_timesteps_total": 2232958, "timers": {"sample_time_ms": 42676.091, "sample_throughput": 281.328, "load_time_ms": 5.984, "load_throughput": 2006271.542, "learn_time_ms": 37148.212, "learn_throughput": 323.192, "update_time_ms": 27.611}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0046858773566782475, "policy_loss": -0.00032900291262194514, "vf_loss": 0.005014879163354635, "vf_explained_var": 0.2505350112915039, "kl": -5.490296661747607e-09, "entropy": 2.7238965034484863, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2232958, "num_agent_steps_sampled": 2232958, "num_steps_trained": 2232958, "num_agent_steps_trained": 2232958}, "done": false, "episodes_total": 1116, "training_iteration": 186, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-28-45", "timestamp": 1690853325, "time_this_iter_s": 78.57576179504395, "time_total_s": 15190.449153661728, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15190.449153661728, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 99.97857142857144, "ram_util_percent": 55.399999999999984}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9069980415518417, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8274992897784081, "reward_component_totals/dist_change_reward_min": -0.9929432591465526, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.0794987517734405, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.0256886606415145, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9498751773433, "delta_v_total_min": 202.56886606415048, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1076.31, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5378860569715141, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9192786918362135, -3.871840870491118, -3.8955806784172626, -3.887763480119186, -3.892486740292827, -4.028132495542771, -3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8046241821932865, "mean_inference_ms": 8.249633230730964, "mean_action_processing_ms": 0.4141805380162418, "mean_env_wait_ms": 9.935189211939598, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2244964, "agent_timesteps_total": 2244964, "timers": {"sample_time_ms": 42692.643, "sample_throughput": 281.219, "load_time_ms": 6.138, "load_throughput": 1956120.988, "learn_time_ms": 37181.251, "learn_throughput": 322.905, "update_time_ms": 30.299}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004186870530247688, "policy_loss": -0.0004647759487852454, "vf_loss": 0.00465164752677083, "vf_explained_var": 0.21140393614768982, "kl": -4.396242925253091e-09, "entropy": 2.732651710510254, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2244964, "num_agent_steps_sampled": 2244964, "num_steps_trained": 2244964, "num_agent_steps_trained": 2244964}, "done": false, "episodes_total": 1122, "training_iteration": 187, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-30-06", "timestamp": 1690853406, "time_this_iter_s": 80.0412871837616, "time_total_s": 15270.49044084549, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15270.49044084549, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 99.97719298245613, "ram_util_percent": 55.465789473684204}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9052286830557574, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8260893703786748, "reward_component_totals/dist_change_reward_min": -0.9929432591465526, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.079139312677089, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.0256886606415145, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.91393126770814, "delta_v_total_min": 202.56886606415048, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1102.17, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5508095952023987, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.8279638347467673, -3.9972660843733063, -3.9445100288384, -3.882238035110276, -3.800509732537013, -3.937650317797663, -3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8040439284206775, "mean_inference_ms": 8.248640478464177, "mean_action_processing_ms": 0.4141345085616042, "mean_env_wait_ms": 9.933572372369007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2256970, "agent_timesteps_total": 2256970, "timers": {"sample_time_ms": 42717.978, "sample_throughput": 281.053, "load_time_ms": 6.627, "load_throughput": 1811754.621, "learn_time_ms": 37529.213, "learn_throughput": 319.911, "update_time_ms": 29.0}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0034460227470844984, "policy_loss": -0.0005361647927202284, "vf_loss": 0.003982187248766422, "vf_explained_var": 0.18133050203323364, "kl": -7.115104061483635e-09, "entropy": 2.756964683532715, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2256970, "num_agent_steps_sampled": 2256970, "num_steps_trained": 2256970, "num_agent_steps_trained": 2256970}, "done": false, "episodes_total": 1128, "training_iteration": 188, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-31-26", "timestamp": 1690853486, "time_this_iter_s": 79.88259792327881, "time_total_s": 15350.373038768768, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15350.373038768768, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 99.97894736842106, "ram_util_percent": 55.55263157894737}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.6036183905088595, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9060137404980715, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8266108643226306, "reward_component_totals/dist_change_reward_min": -0.9932254113544222, "reward_component_totals/dist_change_reward_max": -0.5238952427092899, "reward_component_totals/delta_v_mean": -2.079402876175447, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.940287617544, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1130.39, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5649125437281359, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.813771898390402, -3.870219324231668, -3.6036183905088595, -4.056727522428688, -3.930473691870539, -3.8342638332542167, -4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8035008849231537, "mean_inference_ms": 8.247696036045902, "mean_action_processing_ms": 0.41408677618349793, "mean_env_wait_ms": 9.931990283333299, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2268976, "agent_timesteps_total": 2268976, "timers": {"sample_time_ms": 42827.891, "sample_throughput": 280.331, "load_time_ms": 6.826, "load_throughput": 1758968.787, "learn_time_ms": 37288.35, "learn_throughput": 321.977, "update_time_ms": 27.051}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004306190647184849, "policy_loss": -0.00018755026394501328, "vf_loss": 0.004493738524615765, "vf_explained_var": 0.13754740357398987, "kl": -1.8951913371978435e-09, "entropy": 2.747093677520752, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2268976, "num_agent_steps_sampled": 2268976, "num_steps_trained": 2268976, "num_agent_steps_trained": 2268976}, "done": false, "episodes_total": 1134, "training_iteration": 189, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-32-44", "timestamp": 1690853564, "time_this_iter_s": 77.63066554069519, "time_total_s": 15428.003704309464, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15428.003704309464, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 99.98108108108107, "ram_util_percent": 55.527927927927955}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.70833314492464, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9078018646860424, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8287776392936044, "reward_component_totals/dist_change_reward_min": -0.9932254113544222, "reward_component_totals/dist_change_reward_max": -0.6187184407726866, "reward_component_totals/delta_v_mean": -2.0790242253924442, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9024225392437, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1125.38, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5624087956021989, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-4.062960118218924, -3.8493247851523185, -4.036923848838665, -3.8436199618370575, -4.061972746918746, -4.026552289906844, -3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443, -3.7534093305752227, -3.789389809547046, -3.941702248087279, -3.8228377338399158, -3.951448142722038, -4.029099814710021], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8029806716268189, "mean_inference_ms": 8.246824575455113, "mean_action_processing_ms": 0.41404110269317607, "mean_env_wait_ms": 9.930487106998482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2280982, "agent_timesteps_total": 2280982, "timers": {"sample_time_ms": 42974.755, "sample_throughput": 279.373, "load_time_ms": 6.714, "load_throughput": 1788201.026, "learn_time_ms": 37235.921, "learn_throughput": 322.431, "update_time_ms": 27.154}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005486136302351952, "policy_loss": 0.000792363309301436, "vf_loss": 0.00469377264380455, "vf_explained_var": 0.24524039030075073, "kl": -6.5568115381609005e-09, "entropy": 2.7302961349487305, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2280982, "num_agent_steps_sampled": 2280982, "num_steps_trained": 2280982, "num_agent_steps_trained": 2280982}, "done": false, "episodes_total": 1140, "training_iteration": 190, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-34-02", "timestamp": 1690853642, "time_this_iter_s": 78.74426555633545, "time_total_s": 15506.747969865799, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15506.747969865799, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 99.97767857142857, "ram_util_percent": 55.53303571428571}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.70833314492464, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.904347501855384, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8252906480061947, "reward_component_totals/dist_change_reward_min": -0.9932254113544222, "reward_component_totals/dist_change_reward_max": -0.6187184407726866, "reward_component_totals/delta_v_mean": -2.079056853849196, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90568538491888, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1132.59, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5660119940029985, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.8398983787686225, -3.8277674141528184, -3.8949927518178464, -3.8814176879011337, -3.9673447305568343, -4.0027079000560555, -3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443, -3.7534093305752227, -3.789389809547046, -3.941702248087279, -3.8228377338399158, -3.951448142722038, -4.029099814710021, -4.027683450790872, -3.925194494805681, -3.8350922018993394, -3.8574820823322966, -3.9966790018053278, -3.8937862361732027], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8029345960731546, "mean_inference_ms": 8.24594399965726, "mean_action_processing_ms": 0.4139985378466948, "mean_env_wait_ms": 9.929037441766747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2292988, "agent_timesteps_total": 2292988, "timers": {"sample_time_ms": 42862.921, "sample_throughput": 280.102, "load_time_ms": 6.676, "load_throughput": 1798483.329, "learn_time_ms": 37102.276, "learn_throughput": 323.592, "update_time_ms": 26.969}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.0051270886324346066, "policy_loss": 1.615273845345655e-06, "vf_loss": 0.005125474650412798, "vf_explained_var": 0.2063290774822235, "kl": -4.636584449713155e-09, "entropy": 2.709845781326294, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2292988, "num_agent_steps_sampled": 2292988, "num_steps_trained": 2292988, "num_agent_steps_trained": 2292988}, "done": false, "episodes_total": 1146, "training_iteration": 191, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-35-31", "timestamp": 1690853731, "time_this_iter_s": 87.87397933006287, "time_total_s": 15594.621949195862, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15594.621949195862, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 99.98492063492063, "ram_util_percent": 55.56507936507936}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.70833314492464, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9028633082832584, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8246215724409334, "reward_component_totals/dist_change_reward_min": -0.9932254113544222, "reward_component_totals/dist_change_reward_max": -0.6187184407726866, "reward_component_totals/delta_v_mean": -2.0782417358423304, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.82417358423237, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1142.08, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5707546226886557, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.9461201371410675, -3.774465432209251, -3.9651685838272392, -3.8210194888815066, -3.8337569706011125, -3.92808381937912, -3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443, -3.7534093305752227, -3.789389809547046, -3.941702248087279, -3.8228377338399158, -3.951448142722038, -4.029099814710021, -4.027683450790872, -3.925194494805681, -3.8350922018993394, -3.8574820823322966, -3.9966790018053278, -3.8937862361732027, -3.7897974361512814, -3.8794275209630094, -3.8910817518677208, -3.8795306477199034, -3.819983258516422, -4.005888890822332], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8028616948487897, "mean_inference_ms": 8.245068325383947, "mean_action_processing_ms": 0.4139679806914187, "mean_env_wait_ms": 9.927798047288976, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2304994, "agent_timesteps_total": 2304994, "timers": {"sample_time_ms": 43014.167, "sample_throughput": 279.117, "load_time_ms": 6.588, "load_throughput": 1822343.351, "learn_time_ms": 36945.296, "learn_throughput": 324.967, "update_time_ms": 28.485}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005611826665699482, "policy_loss": 0.0010029205586761236, "vf_loss": 0.004608905408531427, "vf_explained_var": 0.26102542877197266, "kl": -7.1351324848478725e-09, "entropy": 2.730369806289673, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2304994, "num_agent_steps_sampled": 2304994, "num_steps_trained": 2304994, "num_agent_steps_trained": 2304994}, "done": false, "episodes_total": 1152, "training_iteration": 192, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-36-48", "timestamp": 1690853808, "time_this_iter_s": 77.30320024490356, "time_total_s": 15671.925149440765, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15671.925149440765, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 99.98181818181818, "ram_util_percent": 55.60727272727273}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.70833314492464, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9042193126197535, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8259525139740006, "reward_component_totals/dist_change_reward_min": -0.9932254113544222, "reward_component_totals/dist_change_reward_max": -0.6187184407726866, "reward_component_totals/delta_v_mean": -2.078266798645758, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.82667986457508, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1152.72, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.576071964017991, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.9825931226897637, -3.82632062233363, -3.845064373354448, -3.8027776136881397, -3.852995491403286, -3.884062289568955, -3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443, -3.7534093305752227, -3.789389809547046, -3.941702248087279, -3.8228377338399158, -3.951448142722038, -4.029099814710021, -4.027683450790872, -3.925194494805681, -3.8350922018993394, -3.8574820823322966, -3.9966790018053278, -3.8937862361732027, -3.7897974361512814, -3.8794275209630094, -3.8910817518677208, -3.8795306477199034, -3.819983258516422, -4.005888890822332, -3.8198625219777496, -3.849565949390315, -3.8592332162361105, -4.02654580302735, -4.04878097840116, -3.8002263966560497], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8027679381822532, "mean_inference_ms": 8.244194231563785, "mean_action_processing_ms": 0.41393433959623444, "mean_env_wait_ms": 9.926432830052415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2317000, "agent_timesteps_total": 2317000, "timers": {"sample_time_ms": 42925.351, "sample_throughput": 279.695, "load_time_ms": 6.724, "load_throughput": 1785651.961, "learn_time_ms": 36617.44, "learn_throughput": 327.877, "update_time_ms": 28.033}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004705999046564102, "policy_loss": 8.08068725746125e-05, "vf_loss": 0.004625192377716303, "vf_explained_var": 0.14264969527721405, "kl": -4.926997032583813e-09, "entropy": 2.7427589893341064, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2317000, "num_agent_steps_sampled": 2317000, "num_steps_trained": 2317000, "num_agent_steps_trained": 2317000}, "done": false, "episodes_total": 1158, "training_iteration": 193, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-38-05", "timestamp": 1690853885, "time_this_iter_s": 76.76280355453491, "time_total_s": 15748.6879529953, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15748.6879529953, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 99.9772727272727, "ram_util_percent": 55.51000000000002}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.70833314492464, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9047619688927138, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8284775853583239, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6187184407726866, "reward_component_totals/delta_v_mean": -2.0762843835343956, "reward_component_totals/delta_v_min": -2.146580865283806, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.62843835343884, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 214.6580865283801, "constraint_violation.max_vel_constraint.steps_mean": 1139.03, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5692303848075962, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.830929908261257, -4.004984771422574, -3.807292184299326, -3.981732364000494, -3.8256999269110614, -3.8494521771732693, -3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443, -3.7534093305752227, -3.789389809547046, -3.941702248087279, -3.8228377338399158, -3.951448142722038, -4.029099814710021, -4.027683450790872, -3.925194494805681, -3.8350922018993394, -3.8574820823322966, -3.9966790018053278, -3.8937862361732027, -3.7897974361512814, -3.8794275209630094, -3.8910817518677208, -3.8795306477199034, -3.819983258516422, -4.005888890822332, -3.8198625219777496, -3.849565949390315, -3.8592332162361105, -4.02654580302735, -4.04878097840116, -3.8002263966560497, -3.8532216535254897, -3.7988277909635846, -3.8711079485286044, -4.043823065353798, -3.8103200898580503, -3.87077859210473], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.802686479527983, "mean_inference_ms": 8.243353305900389, "mean_action_processing_ms": 0.41390261967722547, "mean_env_wait_ms": 9.925018546170726, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2329006, "agent_timesteps_total": 2329006, "timers": {"sample_time_ms": 42774.29, "sample_throughput": 280.683, "load_time_ms": 6.878, "load_throughput": 1745657.725, "learn_time_ms": 36419.655, "learn_throughput": 329.657, "update_time_ms": 27.484}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005813253112137318, "policy_loss": 0.00041853555012494326, "vf_loss": 0.00539471535012126, "vf_explained_var": 0.29285645484924316, "kl": -7.357948916819623e-09, "entropy": 2.691493272781372, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2329006, "num_agent_steps_sampled": 2329006, "num_steps_trained": 2329006, "num_agent_steps_trained": 2329006}, "done": false, "episodes_total": 1164, "training_iteration": 194, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-39-23", "timestamp": 1690853963, "time_this_iter_s": 77.52635335922241, "time_total_s": 15826.214306354523, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15826.214306354523, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 99.98198198198196, "ram_util_percent": 55.61801801801802}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.70833314492464, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9079511464321435, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8299994934786219, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6187184407726866, "reward_component_totals/delta_v_mean": -2.0779516529535287, "reward_component_totals/delta_v_min": -2.189003138840194, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.79516529535212, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 218.90031388401866, "constraint_violation.max_vel_constraint.steps_mean": 1143.7, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5715642178910545, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.70833314492464, -3.860804339271021, -3.9277849208549918, -3.805616704674866, -4.041804608675102, -3.9214930905609036, -3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443, -3.7534093305752227, -3.789389809547046, -3.941702248087279, -3.8228377338399158, -3.951448142722038, -4.029099814710021, -4.027683450790872, -3.925194494805681, -3.8350922018993394, -3.8574820823322966, -3.9966790018053278, -3.8937862361732027, -3.7897974361512814, -3.8794275209630094, -3.8910817518677208, -3.8795306477199034, -3.819983258516422, -4.005888890822332, -3.8198625219777496, -3.849565949390315, -3.8592332162361105, -4.02654580302735, -4.04878097840116, -3.8002263966560497, -3.8532216535254897, -3.7988277909635846, -3.8711079485286044, -4.043823065353798, -3.8103200898580503, -3.87077859210473, -3.9668725763517436, -4.094312349477532, -3.839324274327422, -4.035845811242607, -3.807286675331189, -3.875367399280627], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8026053373273816, "mean_inference_ms": 8.242652031432323, "mean_action_processing_ms": 0.4138626673808437, "mean_env_wait_ms": 9.923473403652308, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2341012, "agent_timesteps_total": 2341012, "timers": {"sample_time_ms": 42699.706, "sample_throughput": 281.173, "load_time_ms": 6.799, "load_throughput": 1765840.048, "learn_time_ms": 36472.394, "learn_throughput": 329.18, "update_time_ms": 26.85}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.005134302657097578, "policy_loss": -0.00039046150050126016, "vf_loss": 0.005524762906134129, "vf_explained_var": 0.2882278263568878, "kl": -3.497466760649104e-09, "entropy": 2.6937174797058105, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2341012, "num_agent_steps_sampled": 2341012, "num_steps_trained": 2341012, "num_agent_steps_trained": 2341012}, "done": false, "episodes_total": 1170, "training_iteration": 195, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-40-42", "timestamp": 1690854042, "time_this_iter_s": 78.77829432487488, "time_total_s": 15904.992600679398, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15904.992600679398, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 99.97946428571429, "ram_util_percent": 55.580357142857146}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7534093305752227, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.911089732669112, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8340549309535025, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6281646052286542, "reward_component_totals/delta_v_mean": -2.077034801715616, "reward_component_totals/delta_v_min": -2.189003138840194, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.70348017156087, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 218.90031388401866, "constraint_violation.max_vel_constraint.steps_mean": 1116.32, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5578810594702648, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.89598697353699, -3.9284121255112963, -3.982757260389986, -3.962885005580014, -3.885513812085655, -3.8670941750914634, -3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443, -3.7534093305752227, -3.789389809547046, -3.941702248087279, -3.8228377338399158, -3.951448142722038, -4.029099814710021, -4.027683450790872, -3.925194494805681, -3.8350922018993394, -3.8574820823322966, -3.9966790018053278, -3.8937862361732027, -3.7897974361512814, -3.8794275209630094, -3.8910817518677208, -3.8795306477199034, -3.819983258516422, -4.005888890822332, -3.8198625219777496, -3.849565949390315, -3.8592332162361105, -4.02654580302735, -4.04878097840116, -3.8002263966560497, -3.8532216535254897, -3.7988277909635846, -3.8711079485286044, -4.043823065353798, -3.8103200898580503, -3.87077859210473, -3.9668725763517436, -4.094312349477532, -3.839324274327422, -4.035845811242607, -3.807286675331189, -3.875367399280627, -3.7866106290299886, -3.8761054576835647, -3.9945939564428072, -4.037077974964814, -3.87792817675408, -4.007379237783008], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8025444197319203, "mean_inference_ms": 8.24190345053594, "mean_action_processing_ms": 0.4138204079156261, "mean_env_wait_ms": 9.92203757481729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2353018, "agent_timesteps_total": 2353018, "timers": {"sample_time_ms": 42587.792, "sample_throughput": 281.912, "load_time_ms": 7.062, "load_throughput": 1699997.428, "learn_time_ms": 36518.101, "learn_throughput": 328.768, "update_time_ms": 28.16}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.00557700265198946, "policy_loss": 0.0007601473480463028, "vf_loss": 0.004816855303943157, "vf_explained_var": 0.2726221978664398, "kl": -1.1240963715408725e-09, "entropy": 2.7220582962036133, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2353018, "num_agent_steps_sampled": 2353018, "num_steps_trained": 2353018, "num_agent_steps_trained": 2353018}, "done": false, "episodes_total": 1176, "training_iteration": 196, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-42-00", "timestamp": 1690854120, "time_this_iter_s": 77.98879027366638, "time_total_s": 15982.981390953064, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15982.981390953064, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 99.98558558558558, "ram_util_percent": 55.63063063063062}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7534093305752227, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9090575457607173, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8341579276799655, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6281646052286542, "reward_component_totals/delta_v_mean": -2.0748996180807584, "reward_component_totals/delta_v_min": -2.189003138840194, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4899618080751, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 218.90031388401866, "constraint_violation.max_vel_constraint.steps_mean": 1121.74, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5605897051474262, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.995669343711034, -3.913049496097314, -3.843467511126763, -3.99394006704056, -3.994826326125378, -3.834815817089224, -3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443, -3.7534093305752227, -3.789389809547046, -3.941702248087279, -3.8228377338399158, -3.951448142722038, -4.029099814710021, -4.027683450790872, -3.925194494805681, -3.8350922018993394, -3.8574820823322966, -3.9966790018053278, -3.8937862361732027, -3.7897974361512814, -3.8794275209630094, -3.8910817518677208, -3.8795306477199034, -3.819983258516422, -4.005888890822332, -3.8198625219777496, -3.849565949390315, -3.8592332162361105, -4.02654580302735, -4.04878097840116, -3.8002263966560497, -3.8532216535254897, -3.7988277909635846, -3.8711079485286044, -4.043823065353798, -3.8103200898580503, -3.87077859210473, -3.9668725763517436, -4.094312349477532, -3.839324274327422, -4.035845811242607, -3.807286675331189, -3.875367399280627, -3.7866106290299886, -3.8761054576835647, -3.9945939564428072, -4.037077974964814, -3.87792817675408, -4.007379237783008, -3.9438330750693833, -3.808519391603001, -3.9765212371151177, -3.883457570895847, -3.796401986613648, -3.9106974000589387], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8020273837729521, "mean_inference_ms": 8.24110891025758, "mean_action_processing_ms": 0.41377040683231103, "mean_env_wait_ms": 9.920500963720373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2365024, "agent_timesteps_total": 2365024, "timers": {"sample_time_ms": 42236.092, "sample_throughput": 284.259, "load_time_ms": 6.848, "load_throughput": 1753328.221, "learn_time_ms": 36287.097, "learn_throughput": 330.861, "update_time_ms": 24.306}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.00539172999560833, "policy_loss": -4.516859553405084e-05, "vf_loss": 0.005436897277832031, "vf_explained_var": 0.26140296459198, "kl": -4.093312799824389e-09, "entropy": 2.686650276184082, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2365024, "num_agent_steps_sampled": 2365024, "num_steps_trained": 2365024, "num_agent_steps_trained": 2365024}, "done": false, "episodes_total": 1182, "training_iteration": 197, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-43-14", "timestamp": 1690854194, "time_this_iter_s": 74.0953676700592, "time_total_s": 16057.076758623123, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16057.076758623123, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 99.98679245283019, "ram_util_percent": 52.72452830188679}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7534093305752227, "episode_reward_min": -4.139524124430359, "episode_reward_mean": -3.9089126864763877, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8332182173145619, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6281646052286542, "reward_component_totals/delta_v_mean": -2.0756944691618315, "reward_component_totals/delta_v_min": -2.189003138840194, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.56944691618253, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 218.90031388401866, "constraint_violation.max_vel_constraint.steps_mean": 1117.69, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5585657171414293, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.8366787624589818, -3.7741239579156503, -3.9361108050354963, -4.139524124430359, -4.038750617967656, -3.8202816653631837, -4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443, -3.7534093305752227, -3.789389809547046, -3.941702248087279, -3.8228377338399158, -3.951448142722038, -4.029099814710021, -4.027683450790872, -3.925194494805681, -3.8350922018993394, -3.8574820823322966, -3.9966790018053278, -3.8937862361732027, -3.7897974361512814, -3.8794275209630094, -3.8910817518677208, -3.8795306477199034, -3.819983258516422, -4.005888890822332, -3.8198625219777496, -3.849565949390315, -3.8592332162361105, -4.02654580302735, -4.04878097840116, -3.8002263966560497, -3.8532216535254897, -3.7988277909635846, -3.8711079485286044, -4.043823065353798, -3.8103200898580503, -3.87077859210473, -3.9668725763517436, -4.094312349477532, -3.839324274327422, -4.035845811242607, -3.807286675331189, -3.875367399280627, -3.7866106290299886, -3.8761054576835647, -3.9945939564428072, -4.037077974964814, -3.87792817675408, -4.007379237783008, -3.9438330750693833, -3.808519391603001, -3.9765212371151177, -3.883457570895847, -3.796401986613648, -3.9106974000589387, -3.877114935636929, -4.041947596562023, -4.031364173189879, -3.8036111996400876, -3.8729995983006598, -3.934245129427646], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.801521185113304, "mean_inference_ms": 8.240229248918913, "mean_action_processing_ms": 0.4137083308778457, "mean_env_wait_ms": 9.918644694899966, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2377030, "agent_timesteps_total": 2377030, "timers": {"sample_time_ms": 41862.63, "sample_throughput": 286.795, "load_time_ms": 6.241, "load_throughput": 1923704.543, "learn_time_ms": 35990.319, "learn_throughput": 333.59, "update_time_ms": 27.672}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.006928355433046818, "policy_loss": 0.00036867737071588635, "vf_loss": 0.006559680216014385, "vf_explained_var": 0.35388216376304626, "kl": -3.4098424084305634e-09, "entropy": 2.6563448905944824, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2377030, "num_agent_steps_sampled": 2377030, "num_steps_trained": 2377030, "num_agent_steps_trained": 2377030}, "done": false, "episodes_total": 1188, "training_iteration": 198, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-44-28", "timestamp": 1690854268, "time_this_iter_s": 73.26760268211365, "time_total_s": 16130.344361305237, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16130.344361305237, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 99.97500000000001, "ram_util_percent": 51.815384615384616}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7534093305752227, "episode_reward_min": -4.094312349477532, "episode_reward_mean": -3.910006448062759, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8342620720868349, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6281646052286542, "reward_component_totals/delta_v_mean": -2.0757443759759298, "reward_component_totals/delta_v_min": -2.189003138840194, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5744375975923, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 218.90031388401866, "constraint_violation.max_vel_constraint.steps_mean": 1094.14, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5467966016991505, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-4.030905087443858, -3.94926075067744, -3.912607485826873, -3.991291102488015, -3.8717588035570385, -3.8334110298738784, -4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443, -3.7534093305752227, -3.789389809547046, -3.941702248087279, -3.8228377338399158, -3.951448142722038, -4.029099814710021, -4.027683450790872, -3.925194494805681, -3.8350922018993394, -3.8574820823322966, -3.9966790018053278, -3.8937862361732027, -3.7897974361512814, -3.8794275209630094, -3.8910817518677208, -3.8795306477199034, -3.819983258516422, -4.005888890822332, -3.8198625219777496, -3.849565949390315, -3.8592332162361105, -4.02654580302735, -4.04878097840116, -3.8002263966560497, -3.8532216535254897, -3.7988277909635846, -3.8711079485286044, -4.043823065353798, -3.8103200898580503, -3.87077859210473, -3.9668725763517436, -4.094312349477532, -3.839324274327422, -4.035845811242607, -3.807286675331189, -3.875367399280627, -3.7866106290299886, -3.8761054576835647, -3.9945939564428072, -4.037077974964814, -3.87792817675408, -4.007379237783008, -3.9438330750693833, -3.808519391603001, -3.9765212371151177, -3.883457570895847, -3.796401986613648, -3.9106974000589387, -3.877114935636929, -4.041947596562023, -4.031364173189879, -3.8036111996400876, -3.8729995983006598, -3.934245129427646, -4.058348563175548, -3.9491274446065683, -3.8710733707563185, -3.846895059020257, -4.084933942094411, -3.844467712155373], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8009603212885354, "mean_inference_ms": 8.23918205962945, "mean_action_processing_ms": 0.41362647159625077, "mean_env_wait_ms": 9.916313951731587, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2389036, "agent_timesteps_total": 2389036, "timers": {"sample_time_ms": 41176.149, "sample_throughput": 291.577, "load_time_ms": 6.229, "load_throughput": 1927570.435, "learn_time_ms": 35717.14, "learn_throughput": 336.141, "update_time_ms": 28.069}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004257140215486288, "policy_loss": 0.00011555914534255862, "vf_loss": 0.0041415817104279995, "vf_explained_var": 0.22094722092151642, "kl": 7.335417273601763e-10, "entropy": 2.7739996910095215, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2389036, "num_agent_steps_sampled": 2389036, "num_steps_trained": 2389036, "num_agent_steps_trained": 2389036}, "done": false, "episodes_total": 1194, "training_iteration": 199, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-45-36", "timestamp": 1690854336, "time_this_iter_s": 68.09982252120972, "time_total_s": 16198.444183826447, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16198.444183826447, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 99.97959183673467, "ram_util_percent": 51.54081632653061}, "trial_id": "079e1_00000"}
{"episode_reward_max": -3.7534093305752227, "episode_reward_min": -4.094312349477532, "episode_reward_mean": -3.906515515867188, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8314698310586983, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6281646052286542, "reward_component_totals/delta_v_mean": -2.0750456848084955, "reward_component_totals/delta_v_min": -2.189003138840194, "reward_component_totals/delta_v_max": -2.02324238131444, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.50456848084895, "delta_v_total_min": 202.32423813144393, "delta_v_total_max": 218.90031388401866, "constraint_violation.max_vel_constraint.steps_mean": 1099.31, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1962, "constraint_violation.max_vel_constraint.ratio_mean": 0.5493803098450774, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9805097451274363}, "hist_stats": {"episode_reward": [-4.0344111339498845, -4.018401727275683, -4.020994572395088, -3.8735030545253726, -3.8264870454026134, -3.875187783183343, -3.887405848011917, -3.915121805143311, -3.9908024073964095, -4.048373551929737, -3.9760782507962165, -3.792796011012921, -3.8366602690204337, -3.8397652641904623, -3.956699754238996, -3.8473877534073067, -3.9172245905290106, -3.8749073696611376, -3.881048925747865, -3.8243450578767195, -3.872225170194067, -4.038720351851547, -3.7946366537801346, -3.861161838315464, -3.7956183304133386, -3.885757001851614, -4.012296730629321, -3.968676552101066, -3.8987821265120735, -3.7904133388228916, -3.948359820467995, -3.8970837164185284, -3.8555151230588796, -4.078489652354443, -3.7534093305752227, -3.789389809547046, -3.941702248087279, -3.8228377338399158, -3.951448142722038, -4.029099814710021, -4.027683450790872, -3.925194494805681, -3.8350922018993394, -3.8574820823322966, -3.9966790018053278, -3.8937862361732027, -3.7897974361512814, -3.8794275209630094, -3.8910817518677208, -3.8795306477199034, -3.819983258516422, -4.005888890822332, -3.8198625219777496, -3.849565949390315, -3.8592332162361105, -4.02654580302735, -4.04878097840116, -3.8002263966560497, -3.8532216535254897, -3.7988277909635846, -3.8711079485286044, -4.043823065353798, -3.8103200898580503, -3.87077859210473, -3.9668725763517436, -4.094312349477532, -3.839324274327422, -4.035845811242607, -3.807286675331189, -3.875367399280627, -3.7866106290299886, -3.8761054576835647, -3.9945939564428072, -4.037077974964814, -3.87792817675408, -4.007379237783008, -3.9438330750693833, -3.808519391603001, -3.9765212371151177, -3.883457570895847, -3.796401986613648, -3.9106974000589387, -3.877114935636929, -4.041947596562023, -4.031364173189879, -3.8036111996400876, -3.8729995983006598, -3.934245129427646, -4.058348563175548, -3.9491274446065683, -3.8710733707563185, -3.846895059020257, -4.084933942094411, -3.844467712155373, -4.0260400173793505, -3.8200260849917473, -3.906722411096842, -3.8123925884810204, -3.87660607758258, -3.7983538607784793], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8003392924681512, "mean_inference_ms": 8.23796988338168, "mean_action_processing_ms": 0.41352458403000286, "mean_env_wait_ms": 9.913478615048525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2401042, "agent_timesteps_total": 2401042, "timers": {"sample_time_ms": 40652.403, "sample_throughput": 295.333, "load_time_ms": 6.209, "load_throughput": 1933572.952, "learn_time_ms": 35530.288, "learn_throughput": 337.909, "update_time_ms": 30.518}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-12, "total_loss": 0.004882887005805969, "policy_loss": 0.0006736452342011034, "vf_loss": 0.004209241829812527, "vf_explained_var": 0.08499404042959213, "kl": -6.754592440927354e-09, "entropy": 2.752495288848877, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2401042, "num_agent_steps_sampled": 2401042, "num_steps_trained": 2401042, "num_agent_steps_trained": 2401042}, "done": true, "episodes_total": 1200, "training_iteration": 200, "experiment_id": "bd0b1ac1b5b945c497527697127be625", "date": "2023-07-31_18-46-48", "timestamp": 1690854408, "time_this_iter_s": 71.7377278804779, "time_total_s": 16270.181911706924, "pid": 3553817, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-11, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16270.181911706924, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 99.98235294117646, "ram_util_percent": 51.59313725490196}, "trial_id": "079e1_00000"}
