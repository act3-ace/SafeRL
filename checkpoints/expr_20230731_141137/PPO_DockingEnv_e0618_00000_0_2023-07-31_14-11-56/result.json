{"episode_reward_max": -3.801279160038309, "episode_reward_min": -3.906790602502561, "episode_reward_mean": -3.868041636231275, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7860437416030971, "reward_component_totals/dist_change_reward_min": -0.8221965123810681, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0819978946281843, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.0715022702018433, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.19978946281765, "delta_v_total_min": 207.15022702018368, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1262.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 984, "constraint_violation.max_vel_constraint.steps_max": 1657, "constraint_violation.max_vel_constraint.ratio_mean": 0.630767949358654, "constraint_violation.max_vel_constraint.ratio_min": 0.4917541229385307, "constraint_violation.max_vel_constraint.ratio_max": 0.8280859570214892}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1319981886869743, "mean_inference_ms": 8.880139250696558, "mean_action_processing_ms": 0.4457488006010002, "mean_env_wait_ms": 10.860644000552314, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 12006, "agent_timesteps_total": 12006, "timers": {"sample_time_ms": 60613.391, "sample_throughput": 198.075, "load_time_ms": 546.716, "load_throughput": 21960.205, "learn_time_ms": 44920.313, "learn_throughput": 267.273, "update_time_ms": 39.607}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00498148612678051, "policy_loss": -9.261782543035224e-05, "vf_loss": 0.005074103828519583, "vf_explained_var": 0.39536675810813904, "kl": 9.463438921386569e-10, "entropy": 2.727297306060791, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 12006, "num_agent_steps_sampled": 12006, "num_steps_trained": 12006, "num_agent_steps_trained": 12006}, "done": false, "episodes_total": 6, "training_iteration": 1, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-15-24", "timestamp": 1690838124, "time_this_iter_s": 106.65653491020203, "time_total_s": 106.65653491020203, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 106.65653491020203, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 99.98758169934639, "ram_util_percent": 59.80718954248366}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.801279160038309, "episode_reward_min": -4.037579231612092, "episode_reward_mean": -3.9101104843742878, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8380579880378908, "reward_component_totals/dist_change_reward_min": -0.9770711120984973, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.072052496336404, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.0375823511679996, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.20524963363957, "delta_v_total_min": 203.7582351167993, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1314.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 702, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6567549558554057, "constraint_violation.max_vel_constraint.ratio_min": 0.35082458770614694, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7890941429678953, "mean_inference_ms": 8.944216249122528, "mean_action_processing_ms": 0.44775579126431664, "mean_env_wait_ms": 10.937109533464055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 24012, "agent_timesteps_total": 24012, "timers": {"sample_time_ms": 53932.85, "sample_throughput": 222.61, "load_time_ms": 276.081, "load_throughput": 43487.168, "learn_time_ms": 43618.232, "learn_throughput": 275.252, "update_time_ms": 36.652}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 1.000000013351432e-10, "total_loss": 0.006024628411978483, "policy_loss": 0.0006616113823838532, "vf_loss": 0.00536301638931036, "vf_explained_var": 0.17779327929019928, "kl": 6.509243838381806e-11, "entropy": 2.7045207023620605, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 24012, "num_agent_steps_sampled": 24012, "num_steps_trained": 24012, "num_agent_steps_trained": 24012}, "done": false, "episodes_total": 12, "training_iteration": 2, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-16-54", "timestamp": 1690838214, "time_this_iter_s": 89.66868090629578, "time_total_s": 196.3252158164978, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 196.3252158164978, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 99.98046875, "ram_util_percent": 62.60546875}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7889708308305643, "episode_reward_min": -4.042123249883898, "episode_reward_mean": -3.9069245573262297, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8381490685726718, "reward_component_totals/dist_change_reward_min": -0.9770711120984973, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.068775488753565, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.8775488753557, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1306.611111111111, "constraint_violation.max_vel_constraint.steps_min": 702, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6529790660225443, "constraint_violation.max_vel_constraint.ratio_min": 0.35082458770614694, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.607530233841532, "mean_inference_ms": 9.028996777027608, "mean_action_processing_ms": 0.45226457179780855, "mean_env_wait_ms": 11.080275533102164, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 36018, "agent_timesteps_total": 36018, "timers": {"sample_time_ms": 52726.207, "sample_throughput": 227.705, "load_time_ms": 189.934, "load_throughput": 63211.294, "learn_time_ms": 42998.028, "learn_throughput": 279.222, "update_time_ms": 35.874}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004273643717169762, "policy_loss": -0.00015890589565970004, "vf_loss": 0.004432550631463528, "vf_explained_var": 0.24483714997768402, "kl": -2.8865991819060355e-09, "entropy": 2.747758150100708, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 36018, "num_agent_steps_sampled": 36018, "num_steps_trained": 36018, "num_agent_steps_trained": 36018}, "done": false, "episodes_total": 18, "training_iteration": 3, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-18-26", "timestamp": 1690838306, "time_this_iter_s": 92.18586850166321, "time_total_s": 288.511084318161, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 288.511084318161, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 99.97175572519083, "ram_util_percent": 62.89160305343511}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7889708308305643, "episode_reward_min": -4.042123249883898, "episode_reward_mean": -3.908923809125259, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8354651419926725, "reward_component_totals/dist_change_reward_min": -0.9770711120984973, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0734586671325936, "reward_component_totals/delta_v_min": -2.118751326799401, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.34586671325846, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 211.87513267993864, "constraint_violation.max_vel_constraint.steps_mean": 1246.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6227719473596535, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4931828916270526, "mean_inference_ms": 9.093930249522264, "mean_action_processing_ms": 0.4570894046329219, "mean_env_wait_ms": 11.198887647129498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 48024, "agent_timesteps_total": 48024, "timers": {"sample_time_ms": 52080.777, "sample_throughput": 230.527, "load_time_ms": 143.954, "load_throughput": 83401.723, "learn_time_ms": 42866.939, "learn_throughput": 280.076, "update_time_ms": 37.179}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0030270011629909277, "policy_loss": -0.0004228578764013946, "vf_loss": 0.003449859097599983, "vf_explained_var": 0.10931851714849472, "kl": -2.7313789008331923e-09, "entropy": 2.79830265045166, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 48024, "num_agent_steps_sampled": 48024, "num_steps_trained": 48024, "num_agent_steps_trained": 48024}, "done": false, "episodes_total": 24, "training_iteration": 4, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-19-59", "timestamp": 1690838399, "time_this_iter_s": 92.72775959968567, "time_total_s": 381.2388439178467, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 381.2388439178467, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 99.97819548872181, "ram_util_percent": 62.96691729323309}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7889708308305643, "episode_reward_min": -4.084495308995135, "episode_reward_mean": -3.91733977195485, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8432548157807571, "reward_component_totals/dist_change_reward_min": -0.9910339589415851, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0740849561740995, "reward_component_totals/delta_v_min": -2.118751326799401, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.40849561740907, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 211.87513267993864, "constraint_violation.max_vel_constraint.steps_mean": 1189.3, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.594352823588206, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4161871900693734, "mean_inference_ms": 9.164145361571956, "mean_action_processing_ms": 0.46162143279276635, "mean_env_wait_ms": 11.296356874880258, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 60030, "agent_timesteps_total": 60030, "timers": {"sample_time_ms": 51962.008, "sample_throughput": 231.053, "load_time_ms": 116.721, "load_throughput": 102860.953, "learn_time_ms": 43129.767, "learn_throughput": 278.369, "update_time_ms": 39.528}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 1.000000013351432e-10, "total_loss": 0.005257153417915106, "policy_loss": 0.0005534308729693294, "vf_loss": 0.004703722428530455, "vf_explained_var": 0.3385322391986847, "kl": 2.38588815371088e-09, "entropy": 2.7233195304870605, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 60030, "num_agent_steps_sampled": 60030, "num_steps_trained": 60030, "num_agent_steps_trained": 60030}, "done": false, "episodes_total": 30, "training_iteration": 5, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-21-35", "timestamp": 1690838495, "time_this_iter_s": 95.7978982925415, "time_total_s": 477.0367422103882, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 477.0367422103882, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 99.97153284671532, "ram_util_percent": 62.94525547445255}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7889708308305643, "episode_reward_min": -4.084495308995135, "episode_reward_mean": -3.908791029285175, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8348520877973429, "reward_component_totals/dist_change_reward_min": -0.9910339589415851, "reward_component_totals/dist_change_reward_max": -0.7221796395967314, "reward_component_totals/delta_v_mean": -2.07393894148784, "reward_component_totals/delta_v_min": -2.118751326799401, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.3938941487831, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 211.87513267993864, "constraint_violation.max_vel_constraint.steps_mean": 1189.3055555555557, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5943555999777889, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.359432901201467, "mean_inference_ms": 9.233923794254919, "mean_action_processing_ms": 0.46440103231369956, "mean_env_wait_ms": 11.366120902065472, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 72036, "agent_timesteps_total": 72036, "timers": {"sample_time_ms": 51873.739, "sample_throughput": 231.447, "load_time_ms": 99.863, "load_throughput": 120224.932, "learn_time_ms": 43259.855, "learn_throughput": 277.532, "update_time_ms": 39.636}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 1.000000013351432e-10, "total_loss": 0.005096741020679474, "policy_loss": 0.0003928529331460595, "vf_loss": 0.0047038886696100235, "vf_explained_var": 0.2339177429676056, "kl": -1.7825313447517033e-09, "entropy": 2.7357006072998047, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 72036, "num_agent_steps_sampled": 72036, "num_steps_trained": 72036, "num_agent_steps_trained": 72036}, "done": false, "episodes_total": 36, "training_iteration": 6, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-23-11", "timestamp": 1690838591, "time_this_iter_s": 95.4833436012268, "time_total_s": 572.520085811615, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 572.520085811615, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 99.9731343283582, "ram_util_percent": 62.94701492537312}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7889708308305643, "episode_reward_min": -4.084495308995135, "episode_reward_mean": -3.913588166525106, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8394128691862969, "reward_component_totals/dist_change_reward_min": -0.9910339589415851, "reward_component_totals/dist_change_reward_max": -0.7221796395967314, "reward_component_totals/delta_v_mean": -2.0741752973388152, "reward_component_totals/delta_v_min": -2.118751326799401, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4175297338807, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 211.87513267993864, "constraint_violation.max_vel_constraint.steps_mean": 1184.142857142857, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.591775540801028, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.315981754460065, "mean_inference_ms": 9.282921147303522, "mean_action_processing_ms": 0.4659875712362326, "mean_env_wait_ms": 11.41706670176796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 84042, "agent_timesteps_total": 84042, "timers": {"sample_time_ms": 51835.354, "sample_throughput": 231.618, "load_time_ms": 87.262, "load_throughput": 137586.386, "learn_time_ms": 43110.83, "learn_throughput": 278.492, "update_time_ms": 38.711}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0027406990993767977, "policy_loss": -0.0014870376326143742, "vf_loss": 0.00422773789614439, "vf_explained_var": 0.19264814257621765, "kl": -4.070781045584226e-09, "entropy": 2.748086929321289, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 84042, "num_agent_steps_sampled": 84042, "num_steps_trained": 84042, "num_agent_steps_trained": 84042}, "done": false, "episodes_total": 42, "training_iteration": 7, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-24-45", "timestamp": 1690838685, "time_this_iter_s": 93.93976974487305, "time_total_s": 666.459855556488, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 666.459855556488, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 99.9822222222222, "ram_util_percent": 62.94444444444444}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7889708308305643, "episode_reward_min": -4.084495308995135, "episode_reward_mean": -3.9173415204851025, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8412098827460864, "reward_component_totals/dist_change_reward_min": -0.9910339589415851, "reward_component_totals/dist_change_reward_max": -0.7221796395967314, "reward_component_totals/delta_v_mean": -2.0761316377390213, "reward_component_totals/delta_v_min": -2.130381897985938, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6131637739014, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.03818979859255, "constraint_violation.max_vel_constraint.steps_mean": 1170.8333333333333, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5851241046143594, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.281363805741853, "mean_inference_ms": 9.32135221470093, "mean_action_processing_ms": 0.46685769240721625, "mean_env_wait_ms": 11.446258932748941, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 96048, "agent_timesteps_total": 96048, "timers": {"sample_time_ms": 51285.627, "sample_throughput": 234.101, "load_time_ms": 77.168, "load_throughput": 155582.71, "learn_time_ms": 42957.845, "learn_throughput": 279.483, "update_time_ms": 38.945}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003365818876773119, "policy_loss": -0.0002710037224460393, "vf_loss": 0.003636822337284684, "vf_explained_var": 0.14414075016975403, "kl": -2.661279197013755e-09, "entropy": 2.7835185527801514, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 96048, "num_agent_steps_sampled": 96048, "num_steps_trained": 96048, "num_agent_steps_trained": 96048}, "done": false, "episodes_total": 48, "training_iteration": 8, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-26-15", "timestamp": 1690838775, "time_this_iter_s": 89.4483654499054, "time_total_s": 755.9082210063934, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 755.9082210063934, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 99.96929133858268, "ram_util_percent": 62.9511811023622}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7889708308305643, "episode_reward_min": -4.084495308995135, "episode_reward_mean": -3.917852213133717, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.840391313772412, "reward_component_totals/dist_change_reward_min": -0.9910339589415851, "reward_component_totals/dist_change_reward_max": -0.7221796395967314, "reward_component_totals/delta_v_mean": -2.0774608993613093, "reward_component_totals/delta_v_min": -2.130381897985938, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.74608993613018, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.03818979859255, "constraint_violation.max_vel_constraint.steps_mean": 1146.4259259259259, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5729264997131063, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2526099896262926, "mean_inference_ms": 9.350552264535848, "mean_action_processing_ms": 0.4676546486986919, "mean_env_wait_ms": 11.46908741583004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 108054, "agent_timesteps_total": 108054, "timers": {"sample_time_ms": 51176.406, "sample_throughput": 234.6, "load_time_ms": 69.378, "load_throughput": 173051.303, "learn_time_ms": 42931.741, "learn_throughput": 279.653, "update_time_ms": 37.751}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0036946500185877085, "policy_loss": -0.0004499371279962361, "vf_loss": 0.004144586622714996, "vf_explained_var": 0.13593152165412903, "kl": 3.5850911128676444e-09, "entropy": 2.7558627128601074, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 108054, "num_agent_steps_sampled": 108054, "num_steps_trained": 108054, "num_agent_steps_trained": 108054}, "done": false, "episodes_total": 54, "training_iteration": 9, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-27-48", "timestamp": 1690838868, "time_this_iter_s": 93.15922975540161, "time_total_s": 849.067450761795, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 849.067450761795, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 99.97293233082706, "ram_util_percent": 63.0}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7889708308305643, "episode_reward_min": -4.084495308995135, "episode_reward_mean": -3.9222465086163276, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8424296399808132, "reward_component_totals/dist_change_reward_min": -0.9910339589415851, "reward_component_totals/dist_change_reward_max": -0.7221796395967314, "reward_component_totals/delta_v_mean": -2.0798168686355196, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9816868635511, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1127.7, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5635682158920539, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2287010310536077, "mean_inference_ms": 9.372244560560775, "mean_action_processing_ms": 0.468183403008856, "mean_env_wait_ms": 11.485705957019515, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 120060, "agent_timesteps_total": 120060, "timers": {"sample_time_ms": 50861.36, "sample_throughput": 236.053, "load_time_ms": 62.921, "load_throughput": 190809.327, "learn_time_ms": 42951.794, "learn_throughput": 279.523, "update_time_ms": 37.094}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0031727782916277647, "policy_loss": -0.0002479965041857213, "vf_loss": 0.0034207759890705347, "vf_explained_var": 0.06935496628284454, "kl": -1.279316763636018e-09, "entropy": 2.8051846027374268, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 120060, "num_agent_steps_sampled": 120060, "num_steps_trained": 120060, "num_agent_steps_trained": 120060}, "done": false, "episodes_total": 60, "training_iteration": 10, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-29-19", "timestamp": 1690838959, "time_this_iter_s": 91.2732994556427, "time_total_s": 940.3407502174377, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 940.3407502174377, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 99.97862595419848, "ram_util_percent": 63.0}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.084495308995135, "episode_reward_mean": -3.916117670596061, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8347876306869716, "reward_component_totals/dist_change_reward_min": -0.9910339589415851, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.081330039909095, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.13300399090863, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1153.9545454545455, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5766889282631411, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.223494621197492, "mean_inference_ms": 9.392185381925286, "mean_action_processing_ms": 0.46859241320499245, "mean_env_wait_ms": 11.501486741733942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 132066, "agent_timesteps_total": 132066, "timers": {"sample_time_ms": 51181.624, "sample_throughput": 234.576, "load_time_ms": 9.015, "load_throughput": 1331750.448, "learn_time_ms": 42647.001, "learn_throughput": 281.52, "update_time_ms": 36.17}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004318015184253454, "policy_loss": 3.7866575439693406e-05, "vf_loss": 0.004280149471014738, "vf_explained_var": 0.10209418088197708, "kl": 1.533177318435719e-08, "entropy": 2.7631921768188477, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 132066, "num_agent_steps_sampled": 132066, "num_steps_trained": 132066, "num_agent_steps_trained": 132066}, "done": false, "episodes_total": 66, "training_iteration": 11, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-31-05", "timestamp": 1690839065, "time_this_iter_s": 105.8016369342804, "time_total_s": 1046.1423871517181, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1046.1423871517181, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 99.98079470198675, "ram_util_percent": 63.05298013245036}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.085581175893996, "episode_reward_mean": -3.916017628867135, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8367384744439266, "reward_component_totals/dist_change_reward_min": -0.9910339589415851, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.0792791544232143, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9279154423206, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1146.4722222222222, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5729496362929647, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.216871435928884, "mean_inference_ms": 9.409086917158824, "mean_action_processing_ms": 0.46957915026650215, "mean_env_wait_ms": 11.515529467462738, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 144072, "agent_timesteps_total": 144072, "timers": {"sample_time_ms": 51355.685, "sample_throughput": 233.781, "load_time_ms": 10.099, "load_throughput": 1188818.68, "learn_time_ms": 42734.713, "learn_throughput": 280.943, "update_time_ms": 35.653}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 1.000000013351432e-10, "total_loss": 0.005610117223113775, "policy_loss": 0.0005603818572126329, "vf_loss": 0.005049735773354769, "vf_explained_var": 0.253675639629364, "kl": 3.3372391516905964e-09, "entropy": 2.708498954772949, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 144072, "num_agent_steps_sampled": 144072, "num_steps_trained": 144072, "num_agent_steps_trained": 144072}, "done": false, "episodes_total": 72, "training_iteration": 12, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-32-38", "timestamp": 1690839158, "time_this_iter_s": 92.33723568916321, "time_total_s": 1138.4796228408813, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1138.4796228408813, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 99.97307692307692, "ram_util_percent": 63.100000000000016}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.085581175893996, "episode_reward_mean": -3.9201061537766724, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8410704258364922, "reward_component_totals/dist_change_reward_min": -0.9910339589415851, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.079035727940185, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9035727940177, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1160.525641025641, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5799728340957727, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2100407346116193, "mean_inference_ms": 9.42295571722179, "mean_action_processing_ms": 0.47037251441212535, "mean_env_wait_ms": 11.526433151474736, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 156078, "agent_timesteps_total": 156078, "timers": {"sample_time_ms": 51245.652, "sample_throughput": 234.283, "load_time_ms": 8.815, "load_throughput": 1361959.383, "learn_time_ms": 42700.224, "learn_throughput": 281.169, "update_time_ms": 35.653}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 1.000000013351432e-10, "total_loss": 0.005716418847441673, "policy_loss": 0.0003702799149323255, "vf_loss": 0.005346141289919615, "vf_explained_var": 0.26663506031036377, "kl": 1.7124318629768709e-09, "entropy": 2.6945645809173584, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 156078, "num_agent_steps_sampled": 156078, "num_steps_trained": 156078, "num_agent_steps_trained": 156078}, "done": false, "episodes_total": 78, "training_iteration": 13, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-34-09", "timestamp": 1690839249, "time_this_iter_s": 90.75956201553345, "time_total_s": 1229.2391848564148, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1229.2391848564148, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 99.98, "ram_util_percent": 63.100000000000016}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.085581175893996, "episode_reward_mean": -3.916068218758015, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8370792891607398, "reward_component_totals/dist_change_reward_min": -0.9910339589415851, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.0789889295972808, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89889295972725, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1151.9404761904761, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5756823968967897, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2032001806095427, "mean_inference_ms": 9.435487218991252, "mean_action_processing_ms": 0.4711082213039505, "mean_env_wait_ms": 11.536498436583159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 168084, "agent_timesteps_total": 168084, "timers": {"sample_time_ms": 51199.447, "sample_throughput": 234.495, "load_time_ms": 9.169, "load_throughput": 1309384.005, "learn_time_ms": 43125.473, "learn_throughput": 278.397, "update_time_ms": 36.045}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004249515011906624, "policy_loss": 0.0007693529478274286, "vf_loss": 0.003480164334177971, "vf_explained_var": 0.015457789413630962, "kl": -1.955276607290557e-09, "entropy": 2.8113889694213867, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 168084, "num_agent_steps_sampled": 168084, "num_steps_trained": 168084, "num_agent_steps_trained": 168084}, "done": false, "episodes_total": 84, "training_iteration": 14, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-35-46", "timestamp": 1690839346, "time_this_iter_s": 96.58351922035217, "time_total_s": 1325.822704076767, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1325.822704076767, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 99.98115942028986, "ram_util_percent": 63.123913043478254}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.9167268481319257, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8380793422260353, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.078647505905897, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.86475059058895, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1155.0333333333333, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5772280526403464, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1966776475771823, "mean_inference_ms": 9.445189628648542, "mean_action_processing_ms": 0.4717086496061963, "mean_env_wait_ms": 11.545511811253714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 180090, "agent_timesteps_total": 180090, "timers": {"sample_time_ms": 50897.059, "sample_throughput": 235.888, "load_time_ms": 9.116, "load_throughput": 1317013.825, "learn_time_ms": 43302.999, "learn_throughput": 277.256, "update_time_ms": 34.57}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003402506234124303, "policy_loss": -0.0004288442141842097, "vf_loss": 0.003831349778920412, "vf_explained_var": 0.23837006092071533, "kl": -4.756754989898582e-10, "entropy": 2.7673180103302, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 180090, "num_agent_steps_sampled": 180090, "num_steps_trained": 180090, "num_agent_steps_trained": 180090}, "done": false, "episodes_total": 90, "training_iteration": 15, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-37-21", "timestamp": 1690839441, "time_this_iter_s": 94.63520216941833, "time_total_s": 1420.4579062461853, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1420.4579062461853, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 99.97555555555556, "ram_util_percent": 63.19999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.9143692850463068, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8359870499446772, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.078382235101635, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8382235101627, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1153.3125, "constraint_violation.max_vel_constraint.steps_min": 400, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5763680659670164, "constraint_violation.max_vel_constraint.ratio_min": 0.19990004997501248, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1901923980962317, "mean_inference_ms": 9.453435604270728, "mean_action_processing_ms": 0.4722667029646203, "mean_env_wait_ms": 11.555287131017993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 192096, "agent_timesteps_total": 192096, "timers": {"sample_time_ms": 50685.507, "sample_throughput": 236.872, "load_time_ms": 8.761, "load_throughput": 1370436.162, "learn_time_ms": 43405.064, "learn_throughput": 276.604, "update_time_ms": 34.082}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00587208429351449, "policy_loss": 0.0005330286221578717, "vf_loss": 0.005339054390788078, "vf_explained_var": 0.17547549307346344, "kl": 1.9572794940359017e-08, "entropy": 2.695122241973877, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 192096, "num_agent_steps_sampled": 192096, "num_steps_trained": 192096, "num_agent_steps_trained": 192096}, "done": false, "episodes_total": 96, "training_iteration": 16, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-38-55", "timestamp": 1690839535, "time_this_iter_s": 94.4333267211914, "time_total_s": 1514.8912329673767, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1514.8912329673767, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 99.9748148148148, "ram_util_percent": 63.19999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.9149689944177384, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8369533012409539, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.07801569317679, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.80156931767823, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1145.65, "constraint_violation.max_vel_constraint.steps_min": 400, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5725387306346825, "constraint_violation.max_vel_constraint.ratio_min": 0.19990004997501248, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037579231612092, -3.984167265459213, -4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1067930190820845, "mean_inference_ms": 9.479416976158145, "mean_action_processing_ms": 0.47273386981769083, "mean_env_wait_ms": 11.567258673633594, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 204102, "agent_timesteps_total": 204102, "timers": {"sample_time_ms": 50431.56, "sample_throughput": 238.065, "load_time_ms": 8.543, "load_throughput": 1405280.288, "learn_time_ms": 43873.527, "learn_throughput": 273.65, "update_time_ms": 33.812}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002949087182059884, "policy_loss": -0.0006956958095543087, "vf_loss": 0.0036447816528379917, "vf_explained_var": 0.13250242173671722, "kl": -4.706683931487987e-09, "entropy": 2.772174835205078, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 204102, "num_agent_steps_sampled": 204102, "num_steps_trained": 204102, "num_agent_steps_trained": 204102}, "done": false, "episodes_total": 102, "training_iteration": 17, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-40-32", "timestamp": 1690839632, "time_this_iter_s": 96.17110991477966, "time_total_s": 1611.0623428821564, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1611.0623428821564, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 99.96934306569342, "ram_util_percent": 63.199999999999996}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.9128496970041264, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8352296091570153, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.077620087847117, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7620087847109, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1135.89, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5676611694152923, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-4.009907691223632, -3.9194858673495276, -3.871341265226104, -3.890594674233225, -3.906071820307436, -4.042123249883898, -3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0871776874538583, "mean_inference_ms": 9.514265556952102, "mean_action_processing_ms": 0.47496516732925265, "mean_env_wait_ms": 11.619344968149996, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 216108, "agent_timesteps_total": 216108, "timers": {"sample_time_ms": 50889.383, "sample_throughput": 235.923, "load_time_ms": 8.809, "load_throughput": 1362899.344, "learn_time_ms": 44485.289, "learn_throughput": 269.887, "update_time_ms": 33.092}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003061141585931182, "policy_loss": -0.0009393544751219451, "vf_loss": 0.004000495653599501, "vf_explained_var": 0.10312271863222122, "kl": -2.8790885231444463e-09, "entropy": 2.748140811920166, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 216108, "num_agent_steps_sampled": 216108, "num_steps_trained": 216108, "num_agent_steps_trained": 216108}, "done": false, "episodes_total": 108, "training_iteration": 18, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-42-12", "timestamp": 1690839732, "time_this_iter_s": 100.19729042053223, "time_total_s": 1711.2596333026886, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1711.2596333026886, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 99.97535211267606, "ram_util_percent": 63.19999999999998}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.916703960249278, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8383941801209798, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.078309780128304, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0274717259407082, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.83097801282963, "delta_v_total_min": 202.7471725940706, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1125.17, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.562303848075962, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.891132222262371, -3.7889708308305643, -3.795045655680193, -3.979972440416221, -3.845776901003868, -3.908598183110911, -3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0790308689092627, "mean_inference_ms": 9.54444765779893, "mean_action_processing_ms": 0.4767948715950002, "mean_env_wait_ms": 11.657858107673949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 228114, "agent_timesteps_total": 228114, "timers": {"sample_time_ms": 50979.503, "sample_throughput": 235.506, "load_time_ms": 8.614, "load_throughput": 1393759.62, "learn_time_ms": 44785.995, "learn_throughput": 268.075, "update_time_ms": 34.169}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 1.000000013351432e-10, "total_loss": 0.005109874531626701, "policy_loss": 0.0008731859270483255, "vf_loss": 0.004236687906086445, "vf_explained_var": 0.17922766506671906, "kl": 1.2267420412825913e-10, "entropy": 2.758958101272583, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 228114, "num_agent_steps_sampled": 228114, "num_steps_trained": 228114, "num_agent_steps_trained": 228114}, "done": false, "episodes_total": 114, "training_iteration": 19, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-43-49", "timestamp": 1690839829, "time_this_iter_s": 97.05345487594604, "time_total_s": 1808.3130881786346, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1808.3130881786346, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 99.97246376811594, "ram_util_percent": 63.19999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.9229221665236143, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8440045604594363, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.0789176060641843, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0280847923457683, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89176060641768, "delta_v_total_min": 202.80847923457586, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1114.49, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5569665167416291, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8854216688677057, -4.018676470655378, -3.890239371768593, -3.9408167917276398, -4.01498246468263, -3.8568785102138143, -4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0756176981070795, "mean_inference_ms": 9.568754961933843, "mean_action_processing_ms": 0.4779336151077336, "mean_env_wait_ms": 11.677879216726499, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 240120, "agent_timesteps_total": 240120, "timers": {"sample_time_ms": 51091.368, "sample_throughput": 234.991, "load_time_ms": 8.786, "load_throughput": 1366416.317, "learn_time_ms": 44728.893, "learn_throughput": 268.417, "update_time_ms": 33.959}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0035981747787445784, "policy_loss": -0.000489355472382158, "vf_loss": 0.004087529610842466, "vf_explained_var": 0.181290864944458, "kl": -1.37695543855898e-09, "entropy": 2.749647378921509, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 240120, "num_agent_steps_sampled": 240120, "num_steps_trained": 240120, "num_agent_steps_trained": 240120}, "done": false, "episodes_total": 120, "training_iteration": 20, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-45-21", "timestamp": 1690839921, "time_this_iter_s": 91.89028072357178, "time_total_s": 1900.2033689022064, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1900.2033689022064, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 99.96893939393941, "ram_util_percent": 63.246969696969714}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.9229661570507455, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8443739076165548, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.0785922494341964, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0280847923457683, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85922494341892, "delta_v_total_min": 202.80847923457586, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1116.74, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5580909545227386, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-4.084495308995135, -4.031581194613545, -3.8380383051808824, -3.8800459559532627, -3.9518926685584495, -3.8425994704278086, -3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0798671249425085, "mean_inference_ms": 9.584135570504573, "mean_action_processing_ms": 0.4786339460551604, "mean_env_wait_ms": 11.688734956099397, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 252126, "agent_timesteps_total": 252126, "timers": {"sample_time_ms": 51038.127, "sample_throughput": 235.236, "load_time_ms": 8.645, "load_throughput": 1388801.017, "learn_time_ms": 44706.499, "learn_throughput": 268.552, "update_time_ms": 34.392}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0031810470391064882, "policy_loss": -0.0011387603590264916, "vf_loss": 0.004319807514548302, "vf_explained_var": 0.2699083387851715, "kl": 3.1875266870429186e-08, "entropy": 2.732011318206787, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 252126, "num_agent_steps_sampled": 252126, "num_steps_trained": 252126, "num_agent_steps_trained": 252126}, "done": false, "episodes_total": 126, "training_iteration": 21, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-47-07", "timestamp": 1690840027, "time_this_iter_s": 105.14286589622498, "time_total_s": 2005.3462347984314, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2005.3462347984314, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 99.97666666666667, "ram_util_percent": 63.10000000000002}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.9233427248080113, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.845462991863445, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.077879732944572, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0280847923457683, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7879732944565, "delta_v_total_min": 202.80847923457586, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1119.85, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5596451774112944, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8935205590742816, -3.8051208369026535, -3.864090578404806, -3.839059782252815, -3.9912881931729016, -3.854519282615397, -3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0845320812812336, "mean_inference_ms": 9.589745769334435, "mean_action_processing_ms": 0.47882812145322795, "mean_env_wait_ms": 11.690614350767012, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 264132, "agent_timesteps_total": 264132, "timers": {"sample_time_ms": 51007.832, "sample_throughput": 235.376, "load_time_ms": 7.476, "load_throughput": 1605868.162, "learn_time_ms": 44917.647, "learn_throughput": 267.289, "update_time_ms": 35.237}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0043991026468575, "policy_loss": 0.0006499654846265912, "vf_loss": 0.003749134950339794, "vf_explained_var": 0.08166438341140747, "kl": -2.4284485533598854e-09, "entropy": 2.780454158782959, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 264132, "num_agent_steps_sampled": 264132, "num_steps_trained": 264132, "num_agent_steps_trained": 264132}, "done": false, "episodes_total": 132, "training_iteration": 22, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-48-41", "timestamp": 1690840121, "time_this_iter_s": 94.1721019744873, "time_total_s": 2099.5183367729187, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2099.5183367729187, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 99.97910447761194, "ram_util_percent": 63.10000000000002}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.9294778919587863, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.85160031429632, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.0778775776624716, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0280847923457683, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.78775776624644, "delta_v_total_min": 202.80847923457586, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1101.98, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5507146426786607, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.851319633899072, -3.9891751853515074, -3.9391118225096458, -4.028811822239611, -3.9403794499104525, -3.8794559318693747, -3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.089618254618266, "mean_inference_ms": 9.5896552676628, "mean_action_processing_ms": 0.47913415139993776, "mean_env_wait_ms": 11.688787684409409, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 276138, "agent_timesteps_total": 276138, "timers": {"sample_time_ms": 51120.722, "sample_throughput": 234.856, "load_time_ms": 8.051, "load_throughput": 1491271.654, "learn_time_ms": 45163.884, "learn_throughput": 265.832, "update_time_ms": 35.915}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0026625096797943115, "policy_loss": -0.0011738648172467947, "vf_loss": 0.0038363737985491753, "vf_explained_var": 0.13366588950157166, "kl": -1.4395442615722231e-09, "entropy": 2.7714126110076904, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 276138, "num_agent_steps_sampled": 276138, "num_steps_trained": 276138, "num_agent_steps_trained": 276138}, "done": false, "episodes_total": 138, "training_iteration": 23, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-50-16", "timestamp": 1690840216, "time_this_iter_s": 94.39978957176208, "time_total_s": 2193.918126344681, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2193.918126344681, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 99.97407407407407, "ram_util_percent": 63.16518518518518}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.931714356321663, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8528571676076184, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.0788571887140503, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0280847923457683, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.88571887140426, "delta_v_total_min": 202.80847923457586, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1085.3, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5423788105947025, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9119115214595626, -3.8602256199779124, -4.051931186635975, -4.017786279377183, -3.8698139373212452, -3.8938348823499007, -3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0949096537345744, "mean_inference_ms": 9.589119650148392, "mean_action_processing_ms": 0.4795435706883308, "mean_env_wait_ms": 11.68804790190526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 288144, "agent_timesteps_total": 288144, "timers": {"sample_time_ms": 50886.218, "sample_throughput": 235.938, "load_time_ms": 7.709, "load_throughput": 1557385.487, "learn_time_ms": 44419.071, "learn_throughput": 270.289, "update_time_ms": 35.094}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003838540054857731, "policy_loss": 0.00020842551020905375, "vf_loss": 0.003630115883424878, "vf_explained_var": 0.13464733958244324, "kl": -2.6362436678084578e-09, "entropy": 2.7904460430145264, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 288144, "num_agent_steps_sampled": 288144, "num_steps_trained": 288144, "num_agent_steps_trained": 288144}, "done": false, "episodes_total": 144, "training_iteration": 24, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-51-43", "timestamp": 1690840303, "time_this_iter_s": 86.79990696907043, "time_total_s": 2280.718033313751, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2280.718033313751, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 99.975, "ram_util_percent": 58.668548387096756}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.929619821719646, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8521003765134232, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.0775194452062284, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0280847923457683, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7519445206221, "delta_v_total_min": 202.80847923457586, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1078.64, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5390504747626187, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8962206169029034, -3.9576593131696614, -3.9818608325260794, -3.932236943666002, -3.7941286919214834, -3.9991745260313323, -3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0996948911213935, "mean_inference_ms": 9.586060529973867, "mean_action_processing_ms": 0.47982413342736324, "mean_env_wait_ms": 11.684921574448962, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 300150, "agent_timesteps_total": 300150, "timers": {"sample_time_ms": 50229.255, "sample_throughput": 239.024, "load_time_ms": 7.854, "load_throughput": 1528738.948, "learn_time_ms": 43543.36, "learn_throughput": 275.725, "update_time_ms": 33.882}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004382913466542959, "policy_loss": 0.0002819474320858717, "vf_loss": 0.0041009667329490185, "vf_explained_var": 0.21216963231563568, "kl": 1.170412122775133e-08, "entropy": 2.738227367401123, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 300150, "num_agent_steps_sampled": 300150, "num_steps_trained": 300150, "num_agent_steps_trained": 300150}, "done": false, "episodes_total": 150, "training_iteration": 25, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-53-02", "timestamp": 1690840382, "time_this_iter_s": 79.25880813598633, "time_total_s": 2359.9768414497375, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2359.9768414497375, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 99.98392857142858, "ram_util_percent": 55.41785714285712}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.927984842870073, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8503153400291397, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.0776695028409393, "reward_component_totals/delta_v_min": -2.1359112759431227, "reward_component_totals/delta_v_max": -2.0280847923457683, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7669502840932, "delta_v_total_min": 202.80847923457586, "delta_v_total_max": 213.5911275943116, "constraint_violation.max_vel_constraint.steps_mean": 1073.27, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5363668165917042, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9006485547684573, -4.010166988535547, -4.031100914938106, -4.0355513315640446, -3.9439100887861422, -3.986644399927232, -3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.104072889030422, "mean_inference_ms": 9.57921951394112, "mean_action_processing_ms": 0.47992522641901303, "mean_env_wait_ms": 11.677140974157307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 312156, "agent_timesteps_total": 312156, "timers": {"sample_time_ms": 49322.38, "sample_throughput": 243.419, "load_time_ms": 7.089, "load_throughput": 1693491.41, "learn_time_ms": 42792.681, "learn_throughput": 280.562, "update_time_ms": 32.056}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0031774563249200583, "policy_loss": -0.0004931535804644227, "vf_loss": 0.003670609090477228, "vf_explained_var": 0.05038246139883995, "kl": -9.713794213439542e-10, "entropy": 2.7852940559387207, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 312156, "num_agent_steps_sampled": 312156, "num_steps_trained": 312156, "num_agent_steps_trained": 312156}, "done": false, "episodes_total": 156, "training_iteration": 26, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-54-21", "timestamp": 1690840461, "time_this_iter_s": 77.7990312576294, "time_total_s": 2437.775872707367, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2437.775872707367, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 99.97857142857143, "ram_util_percent": 55.29999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.3892337669251047, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.9236416401477303, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8465085636105819, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.31198889318284184, "reward_component_totals/delta_v_mean": -2.0771330765371556, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0280847923457683, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.71330765371485, "delta_v_total_min": 202.80847923457586, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1100.64, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5500622347814574, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9352044863915294, -3.84762476739032, -4.02635823294003, -3.3892337669251047, -3.9123535846375876, -3.967317111739413, -3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0978539877393683, "mean_inference_ms": 9.5710196638548, "mean_action_processing_ms": 0.4798586416850725, "mean_env_wait_ms": 11.665369571493748, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 324158, "agent_timesteps_total": 324158, "timers": {"sample_time_ms": 48434.041, "sample_throughput": 247.875, "load_time_ms": 6.793, "load_throughput": 1767473.248, "learn_time_ms": 41673.388, "learn_throughput": 288.088, "update_time_ms": 30.887}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 1.000000013351432e-10, "total_loss": 0.005524017382413149, "policy_loss": 1.308305945713073e-05, "vf_loss": 0.005510934162884951, "vf_explained_var": 0.22670216858386993, "kl": 1.3644877583374182e-07, "entropy": 2.6763641834259033, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 324158, "num_agent_steps_sampled": 324158, "num_steps_trained": 324158, "num_agent_steps_trained": 324158}, "done": false, "episodes_total": 162, "training_iteration": 27, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-55-37", "timestamp": 1690840537, "time_this_iter_s": 75.99265909194946, "time_total_s": 2513.7685317993164, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2513.7685317993164, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 99.98073394495414, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.9242382741380712, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8469558745656424, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.077282399572435, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0280847923457683, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7282399572428, "delta_v_total_min": 202.80847923457586, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1076.49, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5379932692642161, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.7875637394852335, -4.085581175893996, -3.9612291224563476, -3.77545828488114, -3.8548658370832927, -4.036350946278889, -3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0921909138666637, "mean_inference_ms": 9.555814325288479, "mean_action_processing_ms": 0.47919491333360525, "mean_env_wait_ms": 11.648136360769413, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 336164, "agent_timesteps_total": 336164, "timers": {"sample_time_ms": 47333.467, "sample_throughput": 253.639, "load_time_ms": 6.526, "load_throughput": 1839685.517, "learn_time_ms": 40401.909, "learn_throughput": 297.154, "update_time_ms": 31.722}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00506425928324461, "policy_loss": 0.0011148130288347602, "vf_loss": 0.003949450328946114, "vf_explained_var": 0.1948927342891693, "kl": -2.338320648220815e-09, "entropy": 2.7639596462249756, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 336164, "num_agent_steps_sampled": 336164, "num_steps_trained": 336164, "num_agent_steps_trained": 336164}, "done": false, "episodes_total": 168, "training_iteration": 28, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-56-54", "timestamp": 1690840614, "time_this_iter_s": 76.43438458442688, "time_total_s": 2590.2029163837433, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2590.2029163837433, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 99.98440366972477, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.922119629300535, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8436195122315511, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.0785001170689896, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.031586563686528, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8500117068982, "delta_v_total_min": 203.1586563686527, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1081.59, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5405419949013975, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.991921272097655, -3.920397244799627, -4.060794601348611, -3.95068081453858, -3.853638741155334, -3.8477137530505283, -3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0867109062178106, "mean_inference_ms": 9.537972862965084, "mean_action_processing_ms": 0.47844322962105595, "mean_env_wait_ms": 11.62692735236313, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 348170, "agent_timesteps_total": 348170, "timers": {"sample_time_ms": 46446.2, "sample_throughput": 258.484, "load_time_ms": 7.735, "load_throughput": 1552067.911, "learn_time_ms": 39814.698, "learn_throughput": 301.537, "update_time_ms": 30.602}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004589554853737354, "policy_loss": 0.0005999013083055615, "vf_loss": 0.003989651799201965, "vf_explained_var": 0.10006973147392273, "kl": -1.992830123143108e-09, "entropy": 2.7482597827911377, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 348170, "num_agent_steps_sampled": 348170, "num_steps_trained": 348170, "num_agent_steps_trained": 348170}, "done": false, "episodes_total": 174, "training_iteration": 29, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-58-16", "timestamp": 1690840696, "time_this_iter_s": 82.37285447120667, "time_total_s": 2672.57577085495, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2672.57577085495, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 99.98305084745763, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.0893650079124795, "episode_reward_mean": -3.9228500909891797, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8446113591732677, "reward_component_totals/dist_change_reward_min": -0.9997473658972692, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.0782387318159175, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.031586563686528, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.82387318159104, "delta_v_total_min": 203.1586563686527, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1065.58, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5325409954011477, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.905020737642714, -3.8255791413261395, -3.8067238962759697, -3.9427741116421404, -4.0893650079124795, -3.8840367582671265, -3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0810287498309172, "mean_inference_ms": 9.518560785269903, "mean_action_processing_ms": 0.477663948554704, "mean_env_wait_ms": 11.603003446409893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 360176, "agent_timesteps_total": 360176, "timers": {"sample_time_ms": 45706.748, "sample_throughput": 262.666, "load_time_ms": 9.952, "load_throughput": 1206339.31, "learn_time_ms": 39204.301, "learn_throughput": 306.232, "update_time_ms": 30.242}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 1.000000013351432e-10, "total_loss": 0.005160034634172916, "policy_loss": 0.0008428535074926913, "vf_loss": 0.004317181650549173, "vf_explained_var": 0.15424096584320068, "kl": -7.761021270091817e-10, "entropy": 2.7310588359832764, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 360176, "num_agent_steps_sampled": 360176, "num_steps_trained": 360176, "num_agent_steps_trained": 360176}, "done": false, "episodes_total": 180, "training_iteration": 30, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_14-59-35", "timestamp": 1690840775, "time_this_iter_s": 78.35409879684448, "time_total_s": 2750.9298696517944, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2750.9298696517944, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 99.97946428571429, "ram_util_percent": 55.29999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.0871536404953375, "episode_reward_mean": -3.9209601677628525, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8435019562832706, "reward_component_totals/dist_change_reward_min": -0.9968870606700865, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.0774582114795876, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.031586563686528, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.74582114795803, "delta_v_total_min": 203.1586563686527, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1095.11, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.547298616590553, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8446644637885443, -3.8409811069169635, -3.9718728095716322, -3.924765809743433, -3.850432344563923, -3.921851142174273, -3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.077896406202981, "mean_inference_ms": 9.494974999564255, "mean_action_processing_ms": 0.47668590643806685, "mean_env_wait_ms": 11.57494228143741, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 372182, "agent_timesteps_total": 372182, "timers": {"sample_time_ms": 44351.666, "sample_throughput": 270.691, "load_time_ms": 12.07, "load_throughput": 994661.496, "learn_time_ms": 38634.841, "learn_throughput": 310.745, "update_time_ms": 29.225}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00482527632266283, "policy_loss": 0.0008309265831485391, "vf_loss": 0.003994351252913475, "vf_explained_var": -0.009515524841845036, "kl": 4.25604412823688e-11, "entropy": 2.7520153522491455, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 372182, "num_agent_steps_sampled": 372182, "num_steps_trained": 372182, "num_agent_steps_trained": 372182}, "done": false, "episodes_total": 186, "training_iteration": 31, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-01-01", "timestamp": 1690840861, "time_this_iter_s": 85.82192969322205, "time_total_s": 2836.7517993450165, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2836.7517993450165, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 99.97950819672131, "ram_util_percent": 55.29999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.0871536404953375, "episode_reward_mean": -3.9210648512658213, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8448444947264357, "reward_component_totals/dist_change_reward_min": -0.9968870606700865, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.0762203565393915, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.62203565393847, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1078.26, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5388778269853556, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.799736849977002, -3.792265355899932, -4.044845415334875, -3.8649039246220087, -4.061128292662726, -3.8022027263823635, -3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0744346901538173, "mean_inference_ms": 9.469226493253096, "mean_action_processing_ms": 0.4756571989165243, "mean_env_wait_ms": 11.543298699398926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 384188, "agent_timesteps_total": 384188, "timers": {"sample_time_ms": 43536.783, "sample_throughput": 275.758, "load_time_ms": 12.504, "load_throughput": 960105.555, "learn_time_ms": 38003.582, "learn_throughput": 315.907, "update_time_ms": 28.044}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003387880977243185, "policy_loss": -0.000496371416375041, "vf_loss": 0.0038842507638037205, "vf_explained_var": 0.2650632858276367, "kl": -3.790382674395687e-09, "entropy": 2.74111008644104, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 384188, "num_agent_steps_sampled": 384188, "num_steps_trained": 384188, "num_agent_steps_trained": 384188}, "done": false, "episodes_total": 192, "training_iteration": 32, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-02-20", "timestamp": 1690840940, "time_this_iter_s": 79.66855239868164, "time_total_s": 2916.420351743698, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2916.420351743698, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 99.97787610619469, "ram_util_percent": 55.29999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.0871536404953375, "episode_reward_mean": -3.921413938592596, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8457577877096589, "reward_component_totals/dist_change_reward_min": -0.9968870606700865, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.075656150882943, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5656150882936, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1084.73, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5421112102937015, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.78199048457222, -3.8638110820328944, -4.037722132403858, -3.866992820916747, -3.9760011312219072, -3.941681304585968, -3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.070502611312146, "mean_inference_ms": 9.44167713180456, "mean_action_processing_ms": 0.47441897583611575, "mean_env_wait_ms": 11.506148306828145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 396194, "agent_timesteps_total": 396194, "timers": {"sample_time_ms": 42590.566, "sample_throughput": 281.884, "load_time_ms": 13.825, "load_throughput": 868427.076, "learn_time_ms": 37333.176, "learn_throughput": 321.58, "update_time_ms": 25.843}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004998071119189262, "policy_loss": 0.00038307521026581526, "vf_loss": 0.004614993929862976, "vf_explained_var": 0.09557035565376282, "kl": 9.788901245144643e-09, "entropy": 2.721256971359253, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 396194, "num_agent_steps_sampled": 396194, "num_steps_trained": 396194, "num_agent_steps_trained": 396194}, "done": false, "episodes_total": 198, "training_iteration": 33, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-03-39", "timestamp": 1690841019, "time_this_iter_s": 78.19950556755066, "time_total_s": 2994.619857311249, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2994.619857311249, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 99.97477477477479, "ram_util_percent": 55.300000000000004}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.0871536404953375, "episode_reward_mean": -3.9199492692943187, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8449666825330056, "reward_component_totals/dist_change_reward_min": -0.9968870606700865, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.074982586761319, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.49825867613123, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1083.03, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5412616350813076, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9096784415795556, -3.834522090852464, -3.8149397641752127, -3.8448443790403006, -3.998859034236956, -3.989261187283594, -4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.066054150013629, "mean_inference_ms": 9.411074766500985, "mean_action_processing_ms": 0.472982508240743, "mean_env_wait_ms": 11.465332347531275, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 408200, "agent_timesteps_total": 408200, "timers": {"sample_time_ms": 42020.017, "sample_throughput": 285.711, "load_time_ms": 13.73, "load_throughput": 874438.204, "learn_time_ms": 37284.129, "learn_throughput": 322.003, "update_time_ms": 23.096}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0047357939183712006, "policy_loss": 0.00016228374443016946, "vf_loss": 0.004573511891067028, "vf_explained_var": 0.2376452386379242, "kl": 5.132288483089553e-10, "entropy": 2.6994268894195557, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 408200, "num_agent_steps_sampled": 408200, "num_steps_trained": 408200, "num_agent_steps_trained": 408200}, "done": false, "episodes_total": 204, "training_iteration": 34, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-05-00", "timestamp": 1690841100, "time_this_iter_s": 80.4853572845459, "time_total_s": 3075.1052145957947, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3075.1052145957947, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 99.98173913043479, "ram_util_percent": 55.29999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.0871536404953375, "episode_reward_mean": -3.919729781825927, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8452561991116293, "reward_component_totals/dist_change_reward_min": -0.9968870606700865, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.074473582714303, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.44735827142958, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1102.88, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5511816750613175, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-4.052524930567027, -3.9334742709370736, -4.003066824629787, -4.047764645084495, -4.019396606213593, -3.878326537501998, -4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.061157872884235, "mean_inference_ms": 9.376477131965132, "mean_action_processing_ms": 0.4713964520666833, "mean_env_wait_ms": 11.421930653070731, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 420206, "agent_timesteps_total": 420206, "timers": {"sample_time_ms": 41939.631, "sample_throughput": 286.259, "load_time_ms": 13.515, "load_throughput": 888315.409, "learn_time_ms": 37425.189, "learn_throughput": 320.789, "update_time_ms": 25.467}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003532728413119912, "policy_loss": -0.00021098164143040776, "vf_loss": 0.003743712091818452, "vf_explained_var": 0.05042395368218422, "kl": -1.6999140983742222e-09, "entropy": 2.770634412765503, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 420206, "num_agent_steps_sampled": 420206, "num_steps_trained": 420206, "num_agent_steps_trained": 420206}, "done": false, "episodes_total": 210, "training_iteration": 35, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-06-20", "timestamp": 1690841180, "time_this_iter_s": 79.89551758766174, "time_total_s": 3155.0007321834564, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3155.0007321834564, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 99.98157894736843, "ram_util_percent": 55.29999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.0871536404953375, "episode_reward_mean": -3.917183865958937, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8434562597498203, "reward_component_totals/dist_change_reward_min": -0.9968870606700865, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.0737276062091228, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.37276062091155, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1079.82, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5396574371802582, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-4.005117774907193, -4.082157127130063, -3.8259498755241963, -4.02036893946077, -4.028610717316996, -4.06140159284279, -3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0556150108915845, "mean_inference_ms": 9.33977042094888, "mean_action_processing_ms": 0.469706141831962, "mean_env_wait_ms": 11.37527719299246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 432212, "agent_timesteps_total": 432212, "timers": {"sample_time_ms": 41929.211, "sample_throughput": 286.33, "load_time_ms": 13.931, "load_throughput": 861774.752, "learn_time_ms": 37822.171, "learn_throughput": 317.422, "update_time_ms": 26.821}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004732338711619377, "policy_loss": 0.0008135484531521797, "vf_loss": 0.003918791189789772, "vf_explained_var": 0.14304785430431366, "kl": -8.862585665347922e-10, "entropy": 2.757359027862549, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 432212, "num_agent_steps_sampled": 432212, "num_steps_trained": 432212, "num_agent_steps_trained": 432212}, "done": false, "episodes_total": 216, "training_iteration": 36, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-07-41", "timestamp": 1690841261, "time_this_iter_s": 81.68600726127625, "time_total_s": 3236.6867394447327, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3236.6867394447327, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 99.97863247863248, "ram_util_percent": 55.35897435897437}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.0871536404953375, "episode_reward_mean": -3.9123750953913565, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8383404536272938, "reward_component_totals/dist_change_reward_min": -0.9968466991500798, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.0740346417640674, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.40346417640615, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1075.23, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5373635841067949, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.8678918801069297, -3.867978405041024, -3.8853884505473535, -3.900143284773751, -4.059692694793662, -3.9838833215698886, -3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0445506642007736, "mean_inference_ms": 9.303172673893926, "mean_action_processing_ms": 0.467911477425408, "mean_env_wait_ms": 11.325997549054314, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 444218, "agent_timesteps_total": 444218, "timers": {"sample_time_ms": 41917.309, "sample_throughput": 286.421, "load_time_ms": 14.061, "load_throughput": 853829.485, "learn_time_ms": 37944.942, "learn_throughput": 316.406, "update_time_ms": 29.523}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0031321458518505096, "policy_loss": -0.0007961036753840744, "vf_loss": 0.003928247839212418, "vf_explained_var": 0.17486093938350677, "kl": 2.901620499429214e-09, "entropy": 2.742899179458618, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 444218, "num_agent_steps_sampled": 444218, "num_steps_trained": 444218, "num_agent_steps_trained": 444218}, "done": false, "episodes_total": 222, "training_iteration": 37, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-08-59", "timestamp": 1690841339, "time_this_iter_s": 77.21016073226929, "time_total_s": 3313.896900177002, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3313.896900177002, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 99.98108108108106, "ram_util_percent": 55.30990990990991}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.0871536404953375, "episode_reward_mean": -3.9100272412117976, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8356678866114899, "reward_component_totals/dist_change_reward_min": -0.9968466991500798, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.0743593546003134, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.43593546003066, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1072.47, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5359842737619672, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.900887231031893, -3.7986305920498467, -4.024092880227365, -3.899122959782991, -3.951456136088485, -4.0871536404953375, -3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0334339318924317, "mean_inference_ms": 9.265317050744809, "mean_action_processing_ms": 0.4660328361831786, "mean_env_wait_ms": 11.273946549935351, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 456224, "agent_timesteps_total": 456224, "timers": {"sample_time_ms": 42099.813, "sample_throughput": 285.179, "load_time_ms": 14.006, "load_throughput": 857194.16, "learn_time_ms": 38248.412, "learn_throughput": 313.895, "update_time_ms": 27.537}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002542841713875532, "policy_loss": -0.0012528954539448023, "vf_loss": 0.0037957371678203344, "vf_explained_var": 0.08896531164646149, "kl": -4.038234635572735e-09, "entropy": 2.7664718627929688, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 456224, "num_agent_steps_sampled": 456224, "num_steps_trained": 456224, "num_agent_steps_trained": 456224}, "done": false, "episodes_total": 228, "training_iteration": 38, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-10-20", "timestamp": 1690841420, "time_this_iter_s": 81.31187510490417, "time_total_s": 3395.208775281906, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3395.208775281906, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 99.98189655172415, "ram_util_percent": 55.36206896551724}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.9101077912204936, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8351903994216028, "reward_component_totals/dist_change_reward_min": -0.9968466991500798, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.074917391798897, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.491739179889, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1080.62, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5400572372802082, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.9739502521658263, -3.916378316998345, -4.06104080500897, -3.8711367967433867, -4.019430541084347, -4.024044275471526, -4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.022252301321158, "mean_inference_ms": 9.2258533547462, "mean_action_processing_ms": 0.46411442320393803, "mean_env_wait_ms": 11.220243376964843, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 468230, "agent_timesteps_total": 468230, "timers": {"sample_time_ms": 41987.356, "sample_throughput": 285.943, "load_time_ms": 13.295, "load_throughput": 903019.889, "learn_time_ms": 37934.453, "learn_throughput": 316.493, "update_time_ms": 27.421}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004048387985676527, "policy_loss": -0.0005436124629341066, "vf_loss": 0.0045920019038021564, "vf_explained_var": 0.17765484750270844, "kl": 2.0847105375310093e-08, "entropy": 2.701812267303467, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 468230, "num_agent_steps_sampled": 468230, "num_steps_trained": 468230, "num_agent_steps_trained": 468230}, "done": false, "episodes_total": 234, "training_iteration": 39, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-11-39", "timestamp": 1690841499, "time_this_iter_s": 78.06755685806274, "time_total_s": 3473.276332139969, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3473.276332139969, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 99.97837837837838, "ram_util_percent": 55.300000000000004}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.911668035181943, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8362250638376537, "reward_component_totals/dist_change_reward_min": -0.9968466991500798, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.075442971344296, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.54429713442886, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1104.67, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5520762277849557, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-4.01931923458435, -3.8288050969836096, -4.057670664421396, -3.9026304695221588, -3.9356865524676286, -3.883800752514721, -3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.01122930086649, "mean_inference_ms": 9.185736530032369, "mean_action_processing_ms": 0.4621834467783728, "mean_env_wait_ms": 11.165520042670435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 480236, "agent_timesteps_total": 480236, "timers": {"sample_time_ms": 41824.675, "sample_throughput": 287.055, "load_time_ms": 11.449, "load_throughput": 1048652.426, "learn_time_ms": 38106.555, "learn_throughput": 315.064, "update_time_ms": 28.5}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0043487087823450565, "policy_loss": 0.00023657828569412231, "vf_loss": 0.004112132824957371, "vf_explained_var": 0.010136504657566547, "kl": -2.698832712866306e-09, "entropy": 2.75658917427063, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 480236, "num_agent_steps_sampled": 480236, "num_steps_trained": 480236, "num_agent_steps_trained": 480236}, "done": false, "episodes_total": 240, "training_iteration": 40, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-12-57", "timestamp": 1690841577, "time_this_iter_s": 78.4535026550293, "time_total_s": 3551.729834794998, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3551.729834794998, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 99.98198198198199, "ram_util_percent": 55.300000000000004}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.914596178417542, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8383173777517094, "reward_component_totals/dist_change_reward_min": -0.9946794955997434, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.0762788006658384, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.62788006658317, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1114.35, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5569138089943511, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.9058038910583983, -3.838696326655715, -4.012500539834212, -3.8195619043893285, -3.948856755999339, -4.054551024472099, -3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.002617870160325, "mean_inference_ms": 9.144331651348928, "mean_action_processing_ms": 0.460335765975484, "mean_env_wait_ms": 11.112195874141596, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 492242, "agent_timesteps_total": 492242, "timers": {"sample_time_ms": 42507.865, "sample_throughput": 282.442, "load_time_ms": 9.491, "load_throughput": 1264922.402, "learn_time_ms": 38042.174, "learn_throughput": 315.597, "update_time_ms": 30.547}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00345599208958447, "policy_loss": -6.911948003107682e-05, "vf_loss": 0.0035251120571047068, "vf_explained_var": 0.11686372011899948, "kl": -2.3984059183135287e-09, "entropy": 2.78987979888916, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 492242, "num_agent_steps_sampled": 492242, "num_steps_trained": 492242, "num_agent_steps_trained": 492242}, "done": false, "episodes_total": 246, "training_iteration": 41, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-14-29", "timestamp": 1690841669, "time_this_iter_s": 92.06300330162048, "time_total_s": 3643.7928380966187, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3643.7928380966187, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 99.98167938931297, "ram_util_percent": 55.360305343511456}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.9168831912187136, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8400378991005253, "reward_component_totals/dist_change_reward_min": -0.9946794955997434, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.0768452921181946, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6845292118188, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1107.02, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.553250640578559, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.6605523271831344, -3.8369780022942983, -3.8272530732662604, -4.069591856045095, -3.9379308819932017, -3.839704999274974, -3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9946209517994364, "mean_inference_ms": 9.10477962150144, "mean_action_processing_ms": 0.458557626271672, "mean_env_wait_ms": 11.061267232210726, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 504248, "agent_timesteps_total": 504248, "timers": {"sample_time_ms": 42512.074, "sample_throughput": 282.414, "load_time_ms": 9.131, "load_throughput": 1314909.178, "learn_time_ms": 37753.818, "learn_throughput": 318.008, "update_time_ms": 30.843}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0030831003095954657, "policy_loss": -0.001050432794727385, "vf_loss": 0.00413353368639946, "vf_explained_var": 0.22287069261074066, "kl": 2.2123918697047884e-08, "entropy": 2.7408699989318848, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 504248, "num_agent_steps_sampled": 504248, "num_steps_trained": 504248, "num_agent_steps_trained": 504248}, "done": false, "episodes_total": 252, "training_iteration": 42, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-15-47", "timestamp": 1690841747, "time_this_iter_s": 76.8678195476532, "time_total_s": 3720.660657644272, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3720.660657644272, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 99.98363636363636, "ram_util_percent": 55.339999999999996}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.9192178959926878, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8427928432480443, "reward_component_totals/dist_change_reward_min": -0.9946794955997434, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.07642505274465, "reward_component_totals/delta_v_min": -2.2033233496546685, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6425052744643, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 220.33233496546612, "constraint_violation.max_vel_constraint.steps_mean": 1098.16, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5488228544716125, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.9788472190027875, -3.9738323569853935, -3.762558149476708, -3.9808283995522196, -3.9458346849734633, -3.932397528757703, -3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675], "episode_lengths": [2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9870230146801973, "mean_inference_ms": 9.067339563708014, "mean_action_processing_ms": 0.4568507147950524, "mean_env_wait_ms": 11.012066714059786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 516254, "agent_timesteps_total": 516254, "timers": {"sample_time_ms": 42170.557, "sample_throughput": 284.701, "load_time_ms": 7.292, "load_throughput": 1646513.814, "learn_time_ms": 37799.843, "learn_throughput": 317.62, "update_time_ms": 33.983}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0021993021946400404, "policy_loss": -0.0014272979460656643, "vf_loss": 0.0036266001407057047, "vf_explained_var": 0.1455952674150467, "kl": -3.737808285109168e-09, "entropy": 2.769324779510498, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 516254, "num_agent_steps_sampled": 516254, "num_steps_trained": 516254, "num_agent_steps_trained": 516254}, "done": false, "episodes_total": 258, "training_iteration": 43, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-17-02", "timestamp": 1690841822, "time_this_iter_s": 75.26362919807434, "time_total_s": 3795.924286842346, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3795.924286842346, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 99.98148148148148, "ram_util_percent": 55.337037037037035}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.547858115883362, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.920401026011303, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8449788957047442, "reward_component_totals/dist_change_reward_min": -0.9946794955997434, "reward_component_totals/dist_change_reward_max": -0.4410419569429581, "reward_component_totals/delta_v_mean": -2.075422130306565, "reward_component_totals/delta_v_min": -2.1375568314890088, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5422130306558, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 213.75568314890023, "constraint_violation.max_vel_constraint.steps_mean": 1074.71, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5370864567716142, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.847383788563083, -3.547858115883362, -3.9393567939648575, -3.924924436915586, -3.902840004079497, -3.789366806652172, -3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.979943899442883, "mean_inference_ms": 9.032112511330151, "mean_action_processing_ms": 0.4552554975500971, "mean_env_wait_ms": 10.966283714541218, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 528260, "agent_timesteps_total": 528260, "timers": {"sample_time_ms": 42174.411, "sample_throughput": 284.675, "load_time_ms": 7.384, "load_throughput": 1626018.387, "learn_time_ms": 37796.294, "learn_throughput": 317.65, "update_time_ms": 36.723}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004800219554454088, "policy_loss": 0.0010473094880580902, "vf_loss": 0.003752912627533078, "vf_explained_var": 0.08949607610702515, "kl": -2.6587756440932253e-09, "entropy": 2.7823033332824707, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 528260, "num_agent_steps_sampled": 528260, "num_steps_trained": 528260, "num_agent_steps_trained": 528260}, "done": false, "episodes_total": 264, "training_iteration": 44, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-18-23", "timestamp": 1690841903, "time_this_iter_s": 80.59803032875061, "time_total_s": 3876.522317171097, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3876.522317171097, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 99.98521739130436, "ram_util_percent": 55.37130434782608}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7615370313106222, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.9263588508603506, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8512210737519024, "reward_component_totals/dist_change_reward_min": -0.9946794955997434, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.075137777108454, "reward_component_totals/delta_v_min": -2.1375568314890088, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5137777108447, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 213.75568314890023, "constraint_violation.max_vel_constraint.steps_mean": 1073.97, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5367166416791604, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.9803179749021553, -3.8285002914855983, -3.9082793095072086, -3.879880235698567, -3.8437517480686854, -4.025603180679801, -4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.973422571218442, "mean_inference_ms": 8.999651383200757, "mean_action_processing_ms": 0.45368140111977473, "mean_env_wait_ms": 10.922398168617088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 540266, "agent_timesteps_total": 540266, "timers": {"sample_time_ms": 42277.113, "sample_throughput": 283.983, "load_time_ms": 7.377, "load_throughput": 1627431.973, "learn_time_ms": 37901.024, "learn_throughput": 316.772, "update_time_ms": 35.161}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003531218273565173, "policy_loss": -0.00031241195392794907, "vf_loss": 0.003843628568574786, "vf_explained_var": 0.24209801852703094, "kl": -3.004266280193235e-11, "entropy": 2.748326301574707, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 540266, "num_agent_steps_sampled": 540266, "num_steps_trained": 540266, "num_agent_steps_trained": 540266}, "done": false, "episodes_total": 270, "training_iteration": 45, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-19-45", "timestamp": 1690841985, "time_this_iter_s": 81.95686483383179, "time_total_s": 3958.4791820049286, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3958.4791820049286, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 99.98119658119657, "ram_util_percent": 55.37521367521368}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7615370313106222, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.9228049519328803, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8486668171871264, "reward_component_totals/dist_change_reward_min": -0.9946794955997434, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.0741381347457604, "reward_component_totals/delta_v_min": -2.1375568314890088, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.41381347457525, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 213.75568314890023, "constraint_violation.max_vel_constraint.steps_mean": 1057.67, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5285707146426787, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-4.006177286423876, -3.9250494587403315, -3.98226300358839, -3.9153479183537234, -3.847691398210835, -3.890120300369359, -3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9673449993879777, "mean_inference_ms": 8.968665774295811, "mean_action_processing_ms": 0.4522017297985196, "mean_env_wait_ms": 10.880581610248944, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 552272, "agent_timesteps_total": 552272, "timers": {"sample_time_ms": 42411.896, "sample_throughput": 283.081, "load_time_ms": 7.284, "load_throughput": 1648168.238, "learn_time_ms": 37629.353, "learn_throughput": 319.059, "update_time_ms": 34.592}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004754303954541683, "policy_loss": 0.0006073100375942886, "vf_loss": 0.004146992228925228, "vf_explained_var": 0.10844483971595764, "kl": -3.422360173033212e-09, "entropy": 2.726637363433838, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 552272, "num_agent_steps_sampled": 552272, "num_steps_trained": 552272, "num_agent_steps_trained": 552272}, "done": false, "episodes_total": 276, "training_iteration": 46, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-21-06", "timestamp": 1690842066, "time_this_iter_s": 80.31232213973999, "time_total_s": 4038.7915041446686, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4038.7915041446686, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 99.98521739130436, "ram_util_percent": 55.29999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7615370313106222, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.916683110161405, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8425708151065144, "reward_component_totals/dist_change_reward_min": -0.9946794955997434, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.074112295054896, "reward_component_totals/delta_v_min": -2.1375568314890088, "reward_component_totals/delta_v_max": -2.0207643017669557, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.41122950548888, "delta_v_total_min": 202.0764301766953, "delta_v_total_max": 213.75568314890023, "constraint_violation.max_vel_constraint.steps_mean": 1028.28, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5138830584707647, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.821903426138612, -4.06105939004147, -3.8479935213367065, -3.7957392943368804, -3.7704151174195832, -4.023007822103113, -3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.959078322979289, "mean_inference_ms": 8.940329930532181, "mean_action_processing_ms": 0.45078200870004537, "mean_env_wait_ms": 10.840313214142668, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 564278, "agent_timesteps_total": 564278, "timers": {"sample_time_ms": 42296.946, "sample_throughput": 283.85, "load_time_ms": 7.305, "load_throughput": 1643477.69, "learn_time_ms": 37827.096, "learn_throughput": 317.392, "update_time_ms": 33.259}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0038858780171722174, "policy_loss": 0.00033329674624837935, "vf_loss": 0.0035525800194591284, "vf_explained_var": 0.08328219503164291, "kl": -3.0518338967056025e-09, "entropy": 2.771840810775757, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 564278, "num_agent_steps_sampled": 564278, "num_steps_trained": 564278, "num_agent_steps_trained": 564278}, "done": false, "episodes_total": 282, "training_iteration": 47, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-22-24", "timestamp": 1690842144, "time_this_iter_s": 77.99732971191406, "time_total_s": 4116.788833856583, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4116.788833856583, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 99.98545454545454, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7615370313106222, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.92267600658294, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8460215371813041, "reward_component_totals/dist_change_reward_min": -0.9946794955997434, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.076654469401641, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.023529670735204, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.66544694016335, "delta_v_total_min": 202.35296707352012, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1007.93, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5037131434282858, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.9182181919872106, -3.894930514574675, -3.7615370313106222, -3.9969273496604907, -4.042076092617585, -3.8319746520602584, -4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9511887053754344, "mean_inference_ms": 8.913311583664722, "mean_action_processing_ms": 0.44941471756998225, "mean_env_wait_ms": 10.801495128735631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 576284, "agent_timesteps_total": 576284, "timers": {"sample_time_ms": 41987.531, "sample_throughput": 285.942, "load_time_ms": 8.652, "load_throughput": 1387607.021, "learn_time_ms": 37735.542, "learn_throughput": 318.162, "update_time_ms": 31.955}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 1.000000013351432e-10, "total_loss": 0.005278965923935175, "policy_loss": 0.0011072468478232622, "vf_loss": 0.004171715583652258, "vf_explained_var": 0.1904558390378952, "kl": 4.488874605357296e-09, "entropy": 2.728832244873047, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 576284, "num_agent_steps_sampled": 576284, "num_steps_trained": 576284, "num_agent_steps_trained": 576284}, "done": false, "episodes_total": 288, "training_iteration": 48, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-23-41", "timestamp": 1690842221, "time_this_iter_s": 77.34510946273804, "time_total_s": 4194.133943319321, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4194.133943319321, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 99.98198198198196, "ram_util_percent": 55.300000000000004}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.76288907667002, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.9247036818738037, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8469614556193629, "reward_component_totals/dist_change_reward_min": -0.99373537465485, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.077742226254447, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.023529670735204, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.77422262544394, "delta_v_total_min": 202.35296707352012, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1008.84, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.504167916041979, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-4.019811311181144, -3.835021294631269, -3.9017152420295855, -3.7693927050364975, -3.967905221392388, -3.870579874617333, -3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9437902755554552, "mean_inference_ms": 8.887985654428842, "mean_action_processing_ms": 0.44813837166396575, "mean_env_wait_ms": 10.764543152013355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 588290, "agent_timesteps_total": 588290, "timers": {"sample_time_ms": 41862.65, "sample_throughput": 286.795, "load_time_ms": 8.232, "load_throughput": 1458417.24, "learn_time_ms": 37800.833, "learn_throughput": 317.612, "update_time_ms": 32.883}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004445345140993595, "policy_loss": 0.0008006701827980578, "vf_loss": 0.0036446775775402784, "vf_explained_var": 0.1796259582042694, "kl": -2.8290174647338517e-09, "entropy": 2.777505874633789, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 588290, "num_agent_steps_sampled": 588290, "num_steps_trained": 588290, "num_agent_steps_trained": 588290}, "done": false, "episodes_total": 294, "training_iteration": 49, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-24-59", "timestamp": 1690842299, "time_this_iter_s": 77.48710346221924, "time_total_s": 4271.62104678154, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4271.62104678154, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 99.97818181818182, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.76288907667002, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.929870983521746, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8504326820240503, "reward_component_totals/dist_change_reward_min": -0.996579030878183, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.079438301497701, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.023529670735204, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.94383014976935, "delta_v_total_min": 202.35296707352012, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1034.71, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.517096451774113, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8157162173256918, -3.992184313310976, -3.8838913401750537, -3.7914550590844085, -3.823520425499903, -3.76288907667002, -3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9367138212333959, "mean_inference_ms": 8.864116195835269, "mean_action_processing_ms": 0.4468777566246827, "mean_env_wait_ms": 10.72875016891732, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 600296, "agent_timesteps_total": 600296, "timers": {"sample_time_ms": 41767.531, "sample_throughput": 287.448, "load_time_ms": 7.699, "load_throughput": 1559406.231, "learn_time_ms": 37766.422, "learn_throughput": 317.901, "update_time_ms": 31.766}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004122307989746332, "policy_loss": 5.2728180889971554e-05, "vf_loss": 0.004069581162184477, "vf_explained_var": 0.09678203612565994, "kl": 2.653768593763317e-10, "entropy": 2.7491934299468994, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 600296, "num_agent_steps_sampled": 600296, "num_steps_trained": 600296, "num_agent_steps_trained": 600296}, "done": false, "episodes_total": 300, "training_iteration": 50, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-26-16", "timestamp": 1690842376, "time_this_iter_s": 77.19341707229614, "time_total_s": 4348.814463853836, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4348.814463853836, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 99.98198198198199, "ram_util_percent": 55.300000000000004}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7720810288270625, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.9315644411027346, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.852175915278488, "reward_component_totals/dist_change_reward_min": -0.996579030878183, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.0793885258242524, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.023529670735204, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9388525824245, "delta_v_total_min": 202.35296707352012, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1023.08, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5112843578210895, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.92437707168077, -4.051560380787213, -3.939511471335449, -3.8682977243554904, -3.961527747768539, -3.852029186923351, -3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.931616308244628, "mean_inference_ms": 8.840640913917502, "mean_action_processing_ms": 0.4456747641910026, "mean_env_wait_ms": 10.69443963033149, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 612302, "agent_timesteps_total": 612302, "timers": {"sample_time_ms": 41441.55, "sample_throughput": 289.709, "load_time_ms": 7.869, "load_throughput": 1525649.679, "learn_time_ms": 37990.477, "learn_throughput": 316.027, "update_time_ms": 30.262}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004706257954239845, "policy_loss": 0.0010253519285470247, "vf_loss": 0.003680906258523464, "vf_explained_var": 0.18368792533874512, "kl": 1.3794589914795097e-09, "entropy": 2.7411952018737793, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 612302, "num_agent_steps_sampled": 612302, "num_steps_trained": 612302, "num_agent_steps_trained": 612302}, "done": false, "episodes_total": 306, "training_iteration": 51, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-27-48", "timestamp": 1690842468, "time_this_iter_s": 91.04079627990723, "time_total_s": 4439.855260133743, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4439.855260133743, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 99.98384615384614, "ram_util_percent": 55.300000000000004}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7720810288270625, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.929744704686871, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8505921969620127, "reward_component_totals/dist_change_reward_min": -0.996579030878183, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.079152507724865, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.023529670735204, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.91525077248573, "delta_v_total_min": 202.35296707352012, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1036.89, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5181859070464767, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.9977030930690503, -3.924771517778307, -4.074822409094779, -3.869108273601044, -3.997210539299741, -3.85999891871747, -3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9270208318454407, "mean_inference_ms": 8.818083368512866, "mean_action_processing_ms": 0.44451912471041605, "mean_env_wait_ms": 10.661769290123063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 624308, "agent_timesteps_total": 624308, "timers": {"sample_time_ms": 41258.816, "sample_throughput": 290.992, "load_time_ms": 8.021, "load_throughput": 1496852.541, "learn_time_ms": 38096.047, "learn_throughput": 315.151, "update_time_ms": 30.662}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002449184423312545, "policy_loss": -0.0011345493840053678, "vf_loss": 0.0035837343893945217, "vf_explained_var": -0.0019058912293985486, "kl": -3.422360173033212e-09, "entropy": 2.7803797721862793, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 624308, "num_agent_steps_sampled": 624308, "num_steps_trained": 624308, "num_agent_steps_trained": 624308}, "done": false, "episodes_total": 312, "training_iteration": 52, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-29-04", "timestamp": 1690842544, "time_this_iter_s": 76.0708281993866, "time_total_s": 4515.92608833313, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4515.92608833313, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 99.98073394495412, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7720810288270625, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.92523328853991, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8453981464102526, "reward_component_totals/dist_change_reward_min": -0.996579030878183, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.0798351421296633, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.023529670735204, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98351421296556, "delta_v_total_min": 202.35296707352012, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1050.52, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5249975012493753, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8397927092548745, -4.041329873888521, -3.966387455770011, -3.8380094734933126, -3.7952161870828265, -4.014469295000812, -3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9227913118182796, "mean_inference_ms": 8.797073790334693, "mean_action_processing_ms": 0.44343273505906183, "mean_env_wait_ms": 10.630881250114825, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 636314, "agent_timesteps_total": 636314, "timers": {"sample_time_ms": 41711.286, "sample_throughput": 287.836, "load_time_ms": 7.97, "load_throughput": 1506381.101, "learn_time_ms": 37899.6, "learn_throughput": 316.784, "update_time_ms": 28.103}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0019873986020684242, "policy_loss": -0.0013149918522685766, "vf_loss": 0.003302391152828932, "vf_explained_var": 0.09361724555492401, "kl": -3.504977419410693e-10, "entropy": 2.780003070831299, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 636314, "num_agent_steps_sampled": 636314, "num_steps_trained": 636314, "num_agent_steps_trained": 636314}, "done": false, "episodes_total": 318, "training_iteration": 53, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-30-22", "timestamp": 1690842622, "time_this_iter_s": 77.79469084739685, "time_total_s": 4593.720779180527, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4593.720779180527, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 99.97837837837838, "ram_util_percent": 55.3261261261261}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7720810288270625, "episode_reward_min": -4.1042084915064345, "episode_reward_mean": -3.9265592936795755, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8448972084389955, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.0816620852405863, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.029610843906806, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16620852405788, "delta_v_total_min": 202.96108439067987, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1052.85, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5261619190404798, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8090388885750284, -3.955493901030739, -3.852288557412371, -3.9036857897749653, -4.0725690607185285, -4.1042084915064345, -3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9188125374111757, "mean_inference_ms": 8.776639354590474, "mean_action_processing_ms": 0.4423823694728712, "mean_env_wait_ms": 10.60156234804881, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 648320, "agent_timesteps_total": 648320, "timers": {"sample_time_ms": 41739.993, "sample_throughput": 287.638, "load_time_ms": 7.996, "load_throughput": 1501418.144, "learn_time_ms": 37529.862, "learn_throughput": 319.905, "update_time_ms": 27.73}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004081550985574722, "policy_loss": -0.00030610186513513327, "vf_loss": 0.00438765250146389, "vf_explained_var": 0.17832744121551514, "kl": 5.431713745451816e-08, "entropy": 2.700864791870117, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 648320, "num_agent_steps_sampled": 648320, "num_steps_trained": 648320, "num_agent_steps_trained": 648320}, "done": false, "episodes_total": 324, "training_iteration": 54, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-31-39", "timestamp": 1690842699, "time_this_iter_s": 77.15907573699951, "time_total_s": 4670.879854917526, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4670.879854917526, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 99.98454545454547, "ram_util_percent": 55.39999999999997}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7720810288270625, "episode_reward_min": -4.091399291573092, "episode_reward_mean": -3.92731263726295, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8454378026588875, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.0818748346040685, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.029610843906806, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.18748346040604, "delta_v_total_min": 202.96108439067987, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1038.7, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5190904547726136, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.7720810288270625, -3.8500875554131104, -3.949839766646127, -3.920612537434243, -3.9671800950453147, -4.056995714427118, -3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.915254745007091, "mean_inference_ms": 8.75701489732408, "mean_action_processing_ms": 0.4413597338939665, "mean_env_wait_ms": 10.573756384437768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 660326, "agent_timesteps_total": 660326, "timers": {"sample_time_ms": 41716.367, "sample_throughput": 287.801, "load_time_ms": 8.164, "load_throughput": 1470559.608, "learn_time_ms": 37281.518, "learn_throughput": 322.036, "update_time_ms": 26.728}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00408126600086689, "policy_loss": 0.0008689351961947978, "vf_loss": 0.003212330862879753, "vf_explained_var": 0.06922847777605057, "kl": -3.8404537328062816e-09, "entropy": 2.809512138366699, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 660326, "num_agent_steps_sampled": 660326, "num_steps_trained": 660326, "num_agent_steps_trained": 660326}, "done": false, "episodes_total": 330, "training_iteration": 55, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-32-59", "timestamp": 1690842779, "time_this_iter_s": 79.17486715316772, "time_total_s": 4750.054722070694, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4750.054722070694, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 99.97857142857144, "ram_util_percent": 55.45714285714285}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.775330438835902, "episode_reward_min": -4.091399291573092, "episode_reward_mean": -3.9293215408358235, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8477730082381045, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.0815485325977243, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.029610843906806, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1548532597716, "delta_v_total_min": 202.96108439067987, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1031.76, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5156221889055472, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.9972342484981946, -3.9558607435233446, -4.071051121418625, -3.9736834607047413, -4.091399291573092, -4.025868744599375, -4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9119761282910983, "mean_inference_ms": 8.738245777219571, "mean_action_processing_ms": 0.44039978221510084, "mean_env_wait_ms": 10.547493881469512, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 672332, "agent_timesteps_total": 672332, "timers": {"sample_time_ms": 41661.216, "sample_throughput": 288.182, "load_time_ms": 8.267, "load_throughput": 1452196.856, "learn_time_ms": 36942.055, "learn_throughput": 324.995, "update_time_ms": 27.034}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004182832315564156, "policy_loss": 0.00035510092857293785, "vf_loss": 0.003827735548838973, "vf_explained_var": 0.10787644982337952, "kl": 2.793717435167764e-08, "entropy": 2.753035068511963, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 672332, "num_agent_steps_sampled": 672332, "num_steps_trained": 672332, "num_agent_steps_trained": 672332}, "done": false, "episodes_total": 336, "training_iteration": 56, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-34-15", "timestamp": 1690842855, "time_this_iter_s": 76.37276864051819, "time_total_s": 4826.427490711212, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4826.427490711212, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 99.98256880733945, "ram_util_percent": 55.39999999999997}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.775330438835902, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.925622245477074, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8437847295631319, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.7063829951280184, "reward_component_totals/delta_v_mean": -2.081837515913947, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.029610843906806, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.18375159139396, "delta_v_total_min": 202.96108439067987, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1023.01, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5112493753123438, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.057343040731858, -3.9086949494600045, -4.034936130449377, -3.8024849372400658, -3.9259539495255336, -3.848130660433888, -4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9068048671009137, "mean_inference_ms": 8.720897514926536, "mean_action_processing_ms": 0.4394661084440633, "mean_env_wait_ms": 10.522255887806265, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 684338, "agent_timesteps_total": 684338, "timers": {"sample_time_ms": 41951.766, "sample_throughput": 286.186, "load_time_ms": 8.066, "load_throughput": 1488547.387, "learn_time_ms": 36406.772, "learn_throughput": 329.774, "update_time_ms": 26.14}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004723299760371447, "policy_loss": 0.0006498661823570728, "vf_loss": 0.004073434509336948, "vf_explained_var": 0.14362774789333344, "kl": 1.3173708346414514e-08, "entropy": 2.7286298274993896, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 684338, "num_agent_steps_sampled": 684338, "num_steps_trained": 684338, "num_agent_steps_trained": 684338}, "done": false, "episodes_total": 342, "training_iteration": 57, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-35-31", "timestamp": 1690842931, "time_this_iter_s": 75.5036678314209, "time_total_s": 4901.931158542633, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4901.931158542633, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 99.98333333333332, "ram_util_percent": 55.39999999999997}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.775330438835902, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.9239184117060124, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8430541324144832, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.7117513273009465, "reward_component_totals/delta_v_mean": -2.0808642792915335, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.029610843906806, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.08642792915268, "delta_v_total_min": 202.96108439067987, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1034.91, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5171964017991004, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.03744190442831, -4.075846632433075, -4.039524847731446, -3.881773727974024, -3.775330438835902, -3.917966405293428, -4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.90181852183919, "mean_inference_ms": 8.70439505258508, "mean_action_processing_ms": 0.4385804712359011, "mean_env_wait_ms": 10.498321393709052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 696344, "agent_timesteps_total": 696344, "timers": {"sample_time_ms": 42107.625, "sample_throughput": 285.127, "load_time_ms": 6.689, "load_throughput": 1794887.093, "learn_time_ms": 36247.488, "learn_throughput": 331.223, "update_time_ms": 28.361}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002073207637295127, "policy_loss": -0.0013892014976590872, "vf_loss": 0.003462409833446145, "vf_explained_var": 0.09998447448015213, "kl": -4.200965797451772e-09, "entropy": 2.759704828262329, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 696344, "num_agent_steps_sampled": 696344, "num_steps_trained": 696344, "num_agent_steps_trained": 696344}, "done": false, "episodes_total": 348, "training_iteration": 58, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-36-48", "timestamp": 1690843008, "time_this_iter_s": 77.24680018424988, "time_total_s": 4979.177958726883, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4979.177958726883, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 99.98272727272727, "ram_util_percent": 55.478181818181795}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7780264641070427, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.9211898761280395, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8404641032395804, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.7117513273009465, "reward_component_totals/delta_v_mean": -2.0807257728884654, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.029610843906806, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07257728884576, "delta_v_total_min": 202.96108439067987, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1056.22, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5278460769615192, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.02426012283088, -3.8997113628368787, -3.8281153611461534, -3.9600979265111675, -4.004131522615337, -3.9643951542360814, -3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8971308990275484, "mean_inference_ms": 8.688735901948833, "mean_action_processing_ms": 0.43773667563782503, "mean_env_wait_ms": 10.475872048458665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 708350, "agent_timesteps_total": 708350, "timers": {"sample_time_ms": 42227.358, "sample_throughput": 284.318, "load_time_ms": 6.807, "load_throughput": 1763743.387, "learn_time_ms": 36222.9, "learn_throughput": 331.448, "update_time_ms": 26.951}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0040555065497756, "policy_loss": 0.00029025619733147323, "vf_loss": 0.0037652498576790094, "vf_explained_var": 0.10654468834400177, "kl": 8.917663940621878e-09, "entropy": 2.752253293991089, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 708350, "num_agent_steps_sampled": 708350, "num_steps_trained": 708350, "num_agent_steps_trained": 708350}, "done": false, "episodes_total": 354, "training_iteration": 59, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-38-07", "timestamp": 1690843087, "time_this_iter_s": 78.39314222335815, "time_total_s": 5057.571100950241, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5057.571100950241, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.399999999999984}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7780264641070427, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.9185231799837648, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8379220192970556, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.7059341922328625, "reward_component_totals/delta_v_mean": -2.080601160686715, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.0295903805891746, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.06011606867077, "delta_v_total_min": 202.9590380589169, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1071.87, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5356671664167917, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8630736406237913, -4.025203318045743, -3.9948321497450094, -3.8409755553438147, -3.972518888392158, -3.7916748368531428, -4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8926620680777162, "mean_inference_ms": 8.674209572790643, "mean_action_processing_ms": 0.43693602449114705, "mean_env_wait_ms": 10.454784997755269, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 720356, "agent_timesteps_total": 720356, "timers": {"sample_time_ms": 42398.681, "sample_throughput": 283.169, "load_time_ms": 6.858, "load_throughput": 1750640.151, "learn_time_ms": 36108.015, "learn_throughput": 332.502, "update_time_ms": 25.698}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0026937953662127256, "policy_loss": -0.0012950953096151352, "vf_loss": 0.003988888580352068, "vf_explained_var": 0.13633045554161072, "kl": 1.8526309375488381e-09, "entropy": 2.715369939804077, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 720356, "num_agent_steps_sampled": 720356, "num_steps_trained": 720356, "num_agent_steps_trained": 720356}, "done": false, "episodes_total": 360, "training_iteration": 60, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-39-25", "timestamp": 1690843165, "time_this_iter_s": 77.70392632484436, "time_total_s": 5135.275027275085, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5135.275027275085, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 99.98738738738737, "ram_util_percent": 55.39999999999996}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7780264641070427, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.9231648281576126, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8421263679163578, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.7059341922328625, "reward_component_totals/delta_v_mean": -2.081038460241262, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.0295903805891746, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1038460241254, "delta_v_total_min": 202.9590380589169, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1074.9, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5371814092953524, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.030309225959117, -3.976521763245022, -3.8391212410949827, -3.9373664754188473, -3.7842880653300828, -3.9498262913332134, -3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8897549502171305, "mean_inference_ms": 8.659924757526714, "mean_action_processing_ms": 0.43616032400124544, "mean_env_wait_ms": 10.43409709128203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 732362, "agent_timesteps_total": 732362, "timers": {"sample_time_ms": 42462.183, "sample_throughput": 282.746, "load_time_ms": 6.612, "load_throughput": 1815818.155, "learn_time_ms": 35995.004, "learn_throughput": 333.546, "update_time_ms": 25.425}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004265671595931053, "policy_loss": 9.874703391687945e-05, "vf_loss": 0.004166924394667149, "vf_explained_var": 0.171358123421669, "kl": 7.38799155186598e-09, "entropy": 2.7148356437683105, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 732362, "num_agent_steps_sampled": 732362, "num_steps_trained": 732362, "num_agent_steps_trained": 732362}, "done": false, "episodes_total": 366, "training_iteration": 61, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-40-55", "timestamp": 1690843255, "time_this_iter_s": 90.49250149726868, "time_total_s": 5225.767528772354, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5225.767528772354, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 99.98527131782946, "ram_util_percent": 55.482945736434104}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7780264641070427, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.9221877458859846, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8418790597279265, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.7059341922328625, "reward_component_totals/delta_v_mean": -2.0803086861580646, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.0295903805891746, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0308686158057, "delta_v_total_min": 202.9590380589169, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1087.5, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5434782608695652, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8878476781604143, -3.866123137175874, -3.7837589561788985, -3.839098719416551, -3.8123533664349107, -3.8098970283544418, -3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8870057912928044, "mean_inference_ms": 8.645628228821037, "mean_action_processing_ms": 0.435432989861843, "mean_env_wait_ms": 10.414434436813787, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 744368, "agent_timesteps_total": 744368, "timers": {"sample_time_ms": 42713.966, "sample_throughput": 281.079, "load_time_ms": 7.015, "load_throughput": 1711361.557, "learn_time_ms": 36133.329, "learn_throughput": 332.269, "update_time_ms": 25.135}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003845048835501075, "policy_loss": -7.109135913196951e-05, "vf_loss": 0.003916139714419842, "vf_explained_var": 0.13642463088035583, "kl": 2.7789465173455596e-10, "entropy": 2.720579147338867, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 744368, "num_agent_steps_sampled": 744368, "num_steps_trained": 744368, "num_agent_steps_trained": 744368}, "done": false, "episodes_total": 372, "training_iteration": 62, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-42-15", "timestamp": 1690843335, "time_this_iter_s": 79.96026086807251, "time_total_s": 5305.727789640427, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5305.727789640427, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 99.9858407079646, "ram_util_percent": 55.4646017699115}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.756856253719245, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.9230668628669543, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8422516378185942, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.7059341922328625, "reward_component_totals/delta_v_mean": -2.080815225048367, "reward_component_totals/delta_v_min": -2.1669611006975167, "reward_component_totals/delta_v_max": -2.0295903805891746, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.08152250483587, "delta_v_total_min": 202.9590380589169, "delta_v_total_max": 216.69611006975097, "constraint_violation.max_vel_constraint.steps_mean": 1069.72, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5345927036481759, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.7961313111891064, -3.7928690405796606, -3.818508548747905, -3.9247058932329137, -4.047600073170431, -4.035417756552313, -3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8845553986244263, "mean_inference_ms": 8.632136093758382, "mean_action_processing_ms": 0.43471621811058336, "mean_env_wait_ms": 10.395924156094937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 756374, "agent_timesteps_total": 756374, "timers": {"sample_time_ms": 42712.3, "sample_throughput": 281.09, "load_time_ms": 7.231, "load_throughput": 1660242.452, "learn_time_ms": 36460.152, "learn_throughput": 329.291, "update_time_ms": 26.467}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0020408860873430967, "policy_loss": -0.001800851197913289, "vf_loss": 0.0038417389150708914, "vf_explained_var": 0.18714077770709991, "kl": -6.431633448045204e-09, "entropy": 2.7277586460113525, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 756374, "num_agent_steps_sampled": 756374, "num_steps_trained": 756374, "num_agent_steps_trained": 756374}, "done": false, "episodes_total": 378, "training_iteration": 63, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-43-37", "timestamp": 1690843417, "time_this_iter_s": 81.06392645835876, "time_total_s": 5386.791716098785, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5386.791716098785, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 99.98103448275862, "ram_util_percent": 55.52844827586209}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.756856253719245, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.9228206081842676, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8440998248180087, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.7059341922328625, "reward_component_totals/delta_v_mean": -2.078720783366266, "reward_component_totals/delta_v_min": -2.161606596559286, "reward_component_totals/delta_v_max": -2.0295903805891746, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8720783366259, "delta_v_total_min": 202.9590380589169, "delta_v_total_max": 216.16065965592796, "constraint_violation.max_vel_constraint.steps_mean": 1097.18, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5483158420789606, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.950279038480443, -4.017563773139634, -3.8979002534052682, -3.9706473187817566, -3.8764156520220423, -3.899145968460345, -3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8823342586349168, "mean_inference_ms": 8.619405853615362, "mean_action_processing_ms": 0.43407115424900267, "mean_env_wait_ms": 10.37875702449602, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 768380, "agent_timesteps_total": 768380, "timers": {"sample_time_ms": 42806.559, "sample_throughput": 280.471, "load_time_ms": 7.052, "load_throughput": 1702606.946, "learn_time_ms": 36788.462, "learn_throughput": 326.352, "update_time_ms": 26.465}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004034336656332016, "policy_loss": -0.000346267013810575, "vf_loss": 0.004380605649203062, "vf_explained_var": 0.16420899331569672, "kl": 5.0626894676497614e-08, "entropy": 2.6671037673950195, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 768380, "num_agent_steps_sampled": 768380, "num_steps_trained": 768380, "num_agent_steps_trained": 768380}, "done": false, "episodes_total": 384, "training_iteration": 64, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-44-58", "timestamp": 1690843498, "time_this_iter_s": 81.43825149536133, "time_total_s": 5468.229967594147, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5468.229967594147, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 99.9844827586207, "ram_util_percent": 55.41120689655173}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.599503949195606, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.9209123070449574, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.842050243854123, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.5202508853976509, "reward_component_totals/delta_v_mean": -2.0788620631908414, "reward_component_totals/delta_v_min": -2.161606596559286, "reward_component_totals/delta_v_max": -2.0295903805891746, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.88620631908339, "delta_v_total_min": 202.9590380589169, "delta_v_total_max": 216.16065965592796, "constraint_violation.max_vel_constraint.steps_mean": 1103.41, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5514292853573214, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.836162115318948, -4.048483796929672, -3.9147194243720853, -4.0735044041942015, -3.926949882629903, -3.9263142578574204, -4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8803110256583262, "mean_inference_ms": 8.6072268492428, "mean_action_processing_ms": 0.433462336937658, "mean_env_wait_ms": 10.362680448725405, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 780386, "agent_timesteps_total": 780386, "timers": {"sample_time_ms": 42796.846, "sample_throughput": 280.535, "load_time_ms": 6.653, "load_throughput": 1804567.386, "learn_time_ms": 36610.578, "learn_throughput": 327.938, "update_time_ms": 27.448}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00282187364064157, "policy_loss": -0.0005986586911603808, "vf_loss": 0.0034205298870801926, "vf_explained_var": 0.034242182970047, "kl": -3.745318721826152e-09, "entropy": 2.786105155944824, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 780386, "num_agent_steps_sampled": 780386, "num_steps_trained": 780386, "num_agent_steps_trained": 780386}, "done": false, "episodes_total": 390, "training_iteration": 65, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-46-16", "timestamp": 1690843576, "time_this_iter_s": 77.35532522201538, "time_total_s": 5545.585292816162, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5545.585292816162, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 99.98378378378379, "ram_util_percent": 55.300000000000004}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.599503949195606, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.917617127055048, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.839208892216903, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": -0.5202508853976509, "reward_component_totals/delta_v_mean": -2.078408234838151, "reward_component_totals/delta_v_min": -2.161606596559286, "reward_component_totals/delta_v_max": -2.0295903805891746, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.84082348381438, "delta_v_total_min": 202.9590380589169, "delta_v_total_max": 216.16065965592796, "constraint_violation.max_vel_constraint.steps_mean": 1102.08, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5507646176911545, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-4.050380496398311, -3.9672167458334906, -4.032345268902017, -3.977949162061276, -3.802251034862061, -3.8980554025441654, -3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8785545064841582, "mean_inference_ms": 8.59552945216792, "mean_action_processing_ms": 0.43288772526095093, "mean_env_wait_ms": 10.34757106061247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 792392, "agent_timesteps_total": 792392, "timers": {"sample_time_ms": 42894.808, "sample_throughput": 279.894, "load_time_ms": 6.811, "load_throughput": 1762835.762, "learn_time_ms": 36901.065, "learn_throughput": 325.356, "update_time_ms": 29.855}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003742910223081708, "policy_loss": -3.425881004659459e-05, "vf_loss": 0.0037771693896502256, "vf_explained_var": 0.12273813784122467, "kl": 9.833965641803388e-09, "entropy": 2.727815866470337, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 792392, "num_agent_steps_sampled": 792392, "num_steps_trained": 792392, "num_agent_steps_trained": 792392}, "done": false, "episodes_total": 396, "training_iteration": 66, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-47-36", "timestamp": 1690843656, "time_this_iter_s": 80.21710181236267, "time_total_s": 5625.802394628525, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5625.802394628525, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 99.9808695652174, "ram_util_percent": 55.37217391304346}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.895055590647104, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8155684082633721, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0794871823837395, "reward_component_totals/delta_v_min": -2.161606596559286, "reward_component_totals/delta_v_max": -2.0295903805891746, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.94871823837317, "delta_v_total_min": 202.9590380589169, "delta_v_total_max": 216.16065965592796, "constraint_violation.max_vel_constraint.steps_mean": 1107.64, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.553543228385807, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.9665721519684007, -3.837045853111688, -3.793221471764254, -3.9418562759143647, -3.8671611667456043, -3.9626459512899332, -4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8752927470738117, "mean_inference_ms": 8.585020326983862, "mean_action_processing_ms": 0.4323365969376281, "mean_env_wait_ms": 10.333310256413265, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 804398, "agent_timesteps_total": 804398, "timers": {"sample_time_ms": 42740.818, "sample_throughput": 280.902, "load_time_ms": 6.725, "load_throughput": 1785386.06, "learn_time_ms": 37234.59, "learn_throughput": 322.442, "update_time_ms": 29.105}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0031757999677211046, "policy_loss": -0.0003850493812933564, "vf_loss": 0.0035608503967523575, "vf_explained_var": 0.10665495693683624, "kl": -1.6848926698287414e-09, "entropy": 2.757930040359497, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 804398, "num_agent_steps_sampled": 804398, "num_steps_trained": 804398, "num_agent_steps_trained": 804398}, "done": false, "episodes_total": 402, "training_iteration": 67, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-48-54", "timestamp": 1690843734, "time_this_iter_s": 77.28140783309937, "time_total_s": 5703.083802461624, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5703.083802461624, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 99.9809090909091, "ram_util_percent": 55.32000000000001}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.894092791046231, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.816229307373894, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.077863483672344, "reward_component_totals/delta_v_min": -2.161606596559286, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.78634836723367, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 216.16065965592796, "constraint_violation.max_vel_constraint.steps_mean": 1113.64, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5565417291354322, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-4.01978741276413, -3.874082487856259, -3.8257612619957495, -3.865891660612831, -3.841995574855062, -3.8711724563713403, -3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8723169514659326, "mean_inference_ms": 8.575780488227092, "mean_action_processing_ms": 0.431837203793709, "mean_env_wait_ms": 10.320156213038423, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 816404, "agent_timesteps_total": 816404, "timers": {"sample_time_ms": 42863.295, "sample_throughput": 280.1, "load_time_ms": 6.752, "load_throughput": 1778192.592, "learn_time_ms": 37396.658, "learn_throughput": 321.045, "update_time_ms": 28.403}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004231726750731468, "policy_loss": 0.0005394007894210517, "vf_loss": 0.0036923240404576063, "vf_explained_var": 0.09213682264089584, "kl": 1.1416212419845806e-09, "entropy": 2.730346441268921, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 816404, "num_agent_steps_sampled": 816404, "num_steps_trained": 816404, "num_agent_steps_trained": 816404}, "done": false, "episodes_total": 408, "training_iteration": 68, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-50-14", "timestamp": 1690843814, "time_this_iter_s": 80.12592077255249, "time_total_s": 5783.209723234177, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5783.209723234177, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 99.97913043478262, "ram_util_percent": 55.35826086956521}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.8947775349975218, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8175187134942041, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0772588215033245, "reward_component_totals/delta_v_min": -2.161606596559286, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.72588215033167, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 216.16065965592796, "constraint_violation.max_vel_constraint.steps_mean": 1106.72, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5530834582708646, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.8271013425457356, -3.8912918750860657, -3.855183732700669, -3.985728155305341, -3.9551941137760336, -3.882077893247386, -3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.869426024905533, "mean_inference_ms": 8.567131288367717, "mean_action_processing_ms": 0.4313606494337613, "mean_env_wait_ms": 10.307714541835155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 828410, "agent_timesteps_total": 828410, "timers": {"sample_time_ms": 42904.86, "sample_throughput": 279.828, "load_time_ms": 6.843, "load_throughput": 1754562.249, "learn_time_ms": 37271.538, "learn_throughput": 322.122, "update_time_ms": 30.501}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004116786643862724, "policy_loss": -6.651894364040345e-05, "vf_loss": 0.004183304496109486, "vf_explained_var": 0.18346452713012695, "kl": 6.176271050151172e-09, "entropy": 2.6586742401123047, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 828410, "num_agent_steps_sampled": 828410, "num_steps_trained": 828410, "num_agent_steps_trained": 828410}, "done": false, "episodes_total": 414, "training_iteration": 69, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-51-32", "timestamp": 1690843892, "time_this_iter_s": 77.6442801952362, "time_total_s": 5860.854003429413, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5860.854003429413, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 99.97927927927928, "ram_util_percent": 55.313513513513485}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.081616129266392, "episode_reward_mean": -3.894134726553032, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8163136514786618, "reward_component_totals/dist_change_reward_min": -0.9999227956306624, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.077821075074378, "reward_component_totals/delta_v_min": -2.161606596559286, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.78210750743702, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 216.16065965592796, "constraint_violation.max_vel_constraint.steps_mean": 1098.59, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5490204897551224, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.909189553622303, -4.081616129266392, -3.9072850318214822, -3.8924427867233473, -3.859651804911132, -3.996697986091325, -3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8667327335600743, "mean_inference_ms": 8.558703960051801, "mean_action_processing_ms": 0.43092162366730735, "mean_env_wait_ms": 10.296010740094225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 840416, "agent_timesteps_total": 840416, "timers": {"sample_time_ms": 43152.379, "sample_throughput": 278.223, "load_time_ms": 6.935, "load_throughput": 1731146.934, "learn_time_ms": 37236.875, "learn_throughput": 322.422, "update_time_ms": 32.842}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004788970574736595, "policy_loss": 0.0008880113018676639, "vf_loss": 0.003900958923622966, "vf_explained_var": 0.06921534240245819, "kl": 3.7102689809387357e-09, "entropy": 2.750123977661133, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 840416, "num_agent_steps_sampled": 840416, "num_steps_trained": 840416, "num_agent_steps_trained": 840416}, "done": false, "episodes_total": 420, "training_iteration": 70, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-52-52", "timestamp": 1690843972, "time_this_iter_s": 79.81742477416992, "time_total_s": 5940.671428203583, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5940.671428203583, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 99.98482142857142, "ram_util_percent": 55.37857142857141}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.0814768346139205, "episode_reward_mean": -3.8957435280136132, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8192675679129269, "reward_component_totals/dist_change_reward_min": -0.999338970830332, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0764759601006935, "reward_component_totals/delta_v_min": -2.1343731534481067, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.64759601006867, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 213.43731534481003, "constraint_violation.max_vel_constraint.steps_mean": 1113.58, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.556511744127936, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.857072861118133, -4.028133850747849, -4.0258039614066226, -4.005258583080438, -3.8335805686056226, -3.9211322586180675, -3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8654549506184321, "mean_inference_ms": 8.550427356519469, "mean_action_processing_ms": 0.43051080361180594, "mean_env_wait_ms": 10.284906806925424, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 852422, "agent_timesteps_total": 852422, "timers": {"sample_time_ms": 43427.347, "sample_throughput": 276.462, "load_time_ms": 7.133, "load_throughput": 1683166.727, "learn_time_ms": 37071.417, "learn_throughput": 323.861, "update_time_ms": 32.042}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0044891550205647945, "policy_loss": 0.001000995165668428, "vf_loss": 0.0034881585743278265, "vf_explained_var": 0.044489067047834396, "kl": -3.1544797884919262e-09, "entropy": 2.7616183757781982, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 852422, "num_agent_steps_sampled": 852422, "num_steps_trained": 852422, "num_agent_steps_trained": 852422}, "done": false, "episodes_total": 426, "training_iteration": 71, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-54-24", "timestamp": 1690844064, "time_this_iter_s": 91.58699107170105, "time_total_s": 6032.258419275284, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6032.258419275284, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 99.97480916030534, "ram_util_percent": 55.327480916030545}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.0814768346139205, "episode_reward_mean": -3.8952206468443467, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8195831151451111, "reward_component_totals/dist_change_reward_min": -0.999338970830332, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0756375316992433, "reward_component_totals/delta_v_min": -2.1343731534481067, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5637531699236, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 213.43731534481003, "constraint_violation.max_vel_constraint.steps_mean": 1134.08, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5667566216891554, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.951622097917868, -4.039882959321248, -3.9730306553165784, -3.9984385153009283, -3.984860784335373, -3.843682712136604, -3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8641903399360404, "mean_inference_ms": 8.542316875491283, "mean_action_processing_ms": 0.43013935301009276, "mean_env_wait_ms": 10.274588670586887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 864428, "agent_timesteps_total": 864428, "timers": {"sample_time_ms": 43454.295, "sample_throughput": 276.29, "load_time_ms": 6.569, "load_throughput": 1827601.351, "learn_time_ms": 36739.785, "learn_throughput": 326.785, "update_time_ms": 32.96}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002684298437088728, "policy_loss": -0.0008792227599769831, "vf_loss": 0.003563522594049573, "vf_explained_var": 0.09690038859844208, "kl": -1.9978372289841673e-09, "entropy": 2.75390625, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 864428, "num_agent_steps_sampled": 864428, "num_steps_trained": 864428, "num_agent_steps_trained": 864428}, "done": false, "episodes_total": 432, "training_iteration": 72, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-55-41", "timestamp": 1690844141, "time_this_iter_s": 76.88015294075012, "time_total_s": 6109.138572216034, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6109.138572216034, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 99.97818181818182, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.0814768346139205, "episode_reward_mean": -3.8905405757095157, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8151425333495722, "reward_component_totals/dist_change_reward_min": -0.999338970830332, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.075398042359951, "reward_component_totals/delta_v_min": -2.1343731534481067, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.53980423599438, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 213.43731534481003, "constraint_violation.max_vel_constraint.steps_mean": 1124.11, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5617741129435282, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.928725877667504, -3.977113830731243, -4.0319031155575455, -3.9788817540141332, -3.889934991830229, -3.891022094339958, -3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8630819314247808, "mean_inference_ms": 8.534577064733313, "mean_action_processing_ms": 0.42977617468410423, "mean_env_wait_ms": 10.264860872050717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 876434, "agent_timesteps_total": 876434, "timers": {"sample_time_ms": 43472.762, "sample_throughput": 276.173, "load_time_ms": 6.842, "load_throughput": 1754739.554, "learn_time_ms": 36365.207, "learn_throughput": 330.151, "update_time_ms": 32.398}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0042023020796477795, "policy_loss": 0.0005764951347373426, "vf_loss": 0.003625808749347925, "vf_explained_var": 0.1629372537136078, "kl": 1.853632269899208e-08, "entropy": 2.7282397747039795, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 876434, "num_agent_steps_sampled": 876434, "num_steps_trained": 876434, "num_agent_steps_trained": 876434}, "done": false, "episodes_total": 438, "training_iteration": 73, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-56-59", "timestamp": 1690844219, "time_this_iter_s": 77.49308061599731, "time_total_s": 6186.631652832031, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6186.631652832031, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 99.97387387387386, "ram_util_percent": 55.300000000000004}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.0814768346139205, "episode_reward_mean": -3.8867116783572686, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8127019174296157, "reward_component_totals/dist_change_reward_min": -0.999338970830332, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.074009760927661, "reward_component_totals/delta_v_min": -2.1343731534481067, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.40097609276526, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 213.43731534481003, "constraint_violation.max_vel_constraint.steps_mean": 1137.06, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5682458770614692, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.9298305057967564, -3.8400323583194655, -4.078313876341075, -3.7780264641070427, -3.818841766375259, -3.8956277830212596, -3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8621398161173153, "mean_inference_ms": 8.527202558961426, "mean_action_processing_ms": 0.4294189463380419, "mean_env_wait_ms": 10.255612685971744, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 888440, "agent_timesteps_total": 888440, "timers": {"sample_time_ms": 43354.912, "sample_throughput": 276.924, "load_time_ms": 7.009, "load_throughput": 1712939.15, "learn_time_ms": 36318.622, "learn_throughput": 330.574, "update_time_ms": 32.52}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0031150246504694223, "policy_loss": -0.0002713979047257453, "vf_loss": 0.003386422758921981, "vf_explained_var": 0.022206606343388557, "kl": -3.0443232379440133e-09, "entropy": 2.7579073905944824, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 888440, "num_agent_steps_sampled": 888440, "num_steps_trained": 888440, "num_agent_steps_trained": 888440}, "done": false, "episodes_total": 444, "training_iteration": 74, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-58-19", "timestamp": 1690844299, "time_this_iter_s": 79.75646138191223, "time_total_s": 6266.3881142139435, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6266.3881142139435, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 99.97368421052632, "ram_util_percent": 55.29999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.0814768346139205, "episode_reward_mean": -3.888490235876073, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8133128587102239, "reward_component_totals/dist_change_reward_min": -0.9898864253847206, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0751773771658573, "reward_component_totals/delta_v_min": -2.1343731534481067, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.51773771658497, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 213.43731534481003, "constraint_violation.max_vel_constraint.steps_mean": 1157.82, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5786206896551724, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.984875675610292, -3.7953446595447593, -4.017798890589363, -3.942541623758097, -3.9320582398533777, -4.013548887807087, -3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8612937629025563, "mean_inference_ms": 8.520288396899662, "mean_action_processing_ms": 0.42906509526640996, "mean_env_wait_ms": 10.246894959653906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 900446, "agent_timesteps_total": 900446, "timers": {"sample_time_ms": 43311.704, "sample_throughput": 277.2, "load_time_ms": 7.419, "load_throughput": 1618269.147, "learn_time_ms": 36325.009, "learn_throughput": 330.516, "update_time_ms": 33.267}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004520445596426725, "policy_loss": 0.0009111221297644079, "vf_loss": 0.0036093227099627256, "vf_explained_var": 0.029705196619033813, "kl": 1.614793188053909e-09, "entropy": 2.7450733184814453, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 900446, "num_agent_steps_sampled": 900446, "num_steps_trained": 900446, "num_agent_steps_trained": 900446}, "done": false, "episodes_total": 450, "training_iteration": 75, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_15-59-36", "timestamp": 1690844376, "time_this_iter_s": 76.89350008964539, "time_total_s": 6343.281614303589, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6343.281614303589, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 99.9809090909091, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.0814768346139205, "episode_reward_mean": -3.888260623670358, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.812742273957276, "reward_component_totals/dist_change_reward_min": -0.9898864253847206, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0755183497130902, "reward_component_totals/delta_v_min": -2.1343731534481067, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5518349713083, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 213.43731534481003, "constraint_violation.max_vel_constraint.steps_mean": 1145.88, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5726536731634183, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.8382663141614017, -3.783606561424648, -3.8246816454947705, -4.021880187007686, -3.8966925540023, -4.047720218241063, -3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8606509617613554, "mean_inference_ms": 8.513907577421786, "mean_action_processing_ms": 0.4287499379918431, "mean_env_wait_ms": 10.239321291527784, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 912452, "agent_timesteps_total": 912452, "timers": {"sample_time_ms": 43490.85, "sample_throughput": 276.058, "load_time_ms": 6.881, "load_throughput": 1744720.253, "learn_time_ms": 36331.774, "learn_throughput": 330.455, "update_time_ms": 31.393}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00425759656354785, "policy_loss": 0.00013154781481716782, "vf_loss": 0.004126047249883413, "vf_explained_var": -0.010334325954318047, "kl": -2.881592076064976e-09, "entropy": 2.7765257358551025, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 912452, "num_agent_steps_sampled": 912452, "num_steps_trained": 912452, "num_agent_steps_trained": 912452}, "done": false, "episodes_total": 456, "training_iteration": 76, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-00-58", "timestamp": 1690844458, "time_this_iter_s": 82.12057566642761, "time_total_s": 6425.4021899700165, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6425.4021899700165, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 99.96923076923076, "ram_util_percent": 55.350427350427346}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.0814768346139205, "episode_reward_mean": -3.888524042776843, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8140668012843775, "reward_component_totals/dist_change_reward_min": -0.9898864253847206, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0744572414924733, "reward_component_totals/delta_v_min": -2.1343731534481067, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.44572414924653, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 213.43731534481003, "constraint_violation.max_vel_constraint.steps_mean": 1145.43, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5724287856071965, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9545743875275594, -3.9129811221781274, -4.058998089825559, -4.0814768346139205, -3.789815010409927, -3.9154890465927146, -3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.858735241463327, "mean_inference_ms": 8.508093914298625, "mean_action_processing_ms": 0.42845324295746545, "mean_env_wait_ms": 10.232122857599428, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 924458, "agent_timesteps_total": 924458, "timers": {"sample_time_ms": 43725.405, "sample_throughput": 274.577, "load_time_ms": 7.299, "load_throughput": 1644975.543, "learn_time_ms": 36477.413, "learn_throughput": 329.135, "update_time_ms": 31.538}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0032168312463909388, "policy_loss": -0.00022730679484084249, "vf_loss": 0.0034441377501934767, "vf_explained_var": 0.07934992760419846, "kl": -4.756754989898582e-09, "entropy": 2.746692657470703, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 924458, "num_agent_steps_sampled": 924458, "num_steps_trained": 924458, "num_agent_steps_trained": 924458}, "done": false, "episodes_total": 462, "training_iteration": 77, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-02-19", "timestamp": 1690844539, "time_this_iter_s": 81.1329116821289, "time_total_s": 6506.535101652145, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6506.535101652145, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 99.97652173913043, "ram_util_percent": 55.41739130434781}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.071048986643701, "episode_reward_mean": -3.883417817262581, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8089106262259438, "reward_component_totals/dist_change_reward_min": -0.9840589023129499, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0745071910366444, "reward_component_totals/delta_v_min": -2.130846652736271, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4507191036637, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 213.0846652736258, "constraint_violation.max_vel_constraint.steps_mean": 1156.1, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5777611194402799, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.787022028733138, -3.883491174425708, -4.020040789864809, -4.0238667851921335, -3.756856253719245, -3.9195961441613587, -3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.85696409875594, "mean_inference_ms": 8.502481643964389, "mean_action_processing_ms": 0.4281695717734832, "mean_env_wait_ms": 10.225539340803978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 936464, "agent_timesteps_total": 936464, "timers": {"sample_time_ms": 43772.939, "sample_throughput": 274.279, "load_time_ms": 9.332, "load_throughput": 1286539.124, "learn_time_ms": 36385.191, "learn_throughput": 329.969, "update_time_ms": 33.298}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004774892702698708, "policy_loss": 0.0006847268668934703, "vf_loss": 0.0040901657193899155, "vf_explained_var": 0.09814263135194778, "kl": 1.0029242325515497e-08, "entropy": 2.7083864212036133, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 936464, "num_agent_steps_sampled": 936464, "num_steps_trained": 936464, "num_agent_steps_trained": 936464}, "done": false, "episodes_total": 468, "training_iteration": 78, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-03-39", "timestamp": 1690844619, "time_this_iter_s": 79.6800856590271, "time_total_s": 6586.2151873111725, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6586.2151873111725, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 99.97719298245616, "ram_util_percent": 55.43245614035087}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.8857929721629274, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8089380181730492, "reward_component_totals/dist_change_reward_min": -0.9840589023129499, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0768549539898857, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.68549539898788, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1156.78, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5781009495252374, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.8036230548523946, -3.9606746625327696, -3.7855525475265632, -3.8606879210256895, -3.7895670898980907, -3.8148608918492872, -3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8553603564308785, "mean_inference_ms": 8.497066389488834, "mean_action_processing_ms": 0.4279060799655141, "mean_env_wait_ms": 10.219668788169034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 948470, "agent_timesteps_total": 948470, "timers": {"sample_time_ms": 43729.643, "sample_throughput": 274.551, "load_time_ms": 9.345, "load_throughput": 1284783.028, "learn_time_ms": 36549.334, "learn_throughput": 328.488, "update_time_ms": 31.604}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004695788025856018, "policy_loss": 0.0009862296283245087, "vf_loss": 0.0037095595616847277, "vf_explained_var": 0.17838217318058014, "kl": 4.769773553903178e-08, "entropy": 2.7154901027679443, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 948470, "num_agent_steps_sampled": 948470, "num_steps_trained": 948470, "num_agent_steps_trained": 948470}, "done": false, "episodes_total": 474, "training_iteration": 79, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-04-58", "timestamp": 1690844698, "time_this_iter_s": 78.82073187828064, "time_total_s": 6665.035919189453, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6665.035919189453, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 99.97522123893806, "ram_util_percent": 55.32477876106193}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.894729986774107, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8165817947225608, "reward_component_totals/dist_change_reward_min": -0.9840589023129499, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0781481920515525, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.81481920515446, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1155.22, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5773213393303349, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9812927615512583, -4.038048928218829, -3.8876681036954968, -3.8791693799907567, -3.8809598705046513, -3.599503949195606, -3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8538079094714042, "mean_inference_ms": 8.491763211107267, "mean_action_processing_ms": 0.4276585191001704, "mean_env_wait_ms": 10.214231509783776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 960476, "agent_timesteps_total": 960476, "timers": {"sample_time_ms": 43594.2, "sample_throughput": 275.404, "load_time_ms": 9.125, "load_throughput": 1315795.611, "learn_time_ms": 36387.9, "learn_throughput": 329.945, "update_time_ms": 30.809}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004544145427644253, "policy_loss": 0.001128751551732421, "vf_loss": 0.003415393875911832, "vf_explained_var": 0.0843350738286972, "kl": -3.3747924454985423e-09, "entropy": 2.7883188724517822, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 960476, "num_agent_steps_sampled": 960476, "num_steps_trained": 960476, "num_agent_steps_trained": 960476}, "done": false, "episodes_total": 480, "training_iteration": 80, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-06-15", "timestamp": 1690844775, "time_this_iter_s": 76.8919153213501, "time_total_s": 6741.927834510803, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6741.927834510803, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 99.97706422018351, "ram_util_percent": 55.34311926605503}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.898311534778941, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8196605326589667, "reward_component_totals/dist_change_reward_min": -0.9840589023129499, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0786510021199813, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.86510021199732, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1141.06, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5702448775612193, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.934848050595532, -4.002425520430996, -3.9849950544338206, -4.018389445197786, -3.9038717322326404, -3.726961381374921, -3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.853457292196422, "mean_inference_ms": 8.486456984195547, "mean_action_processing_ms": 0.4274189668154657, "mean_env_wait_ms": 10.209248174262363, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 972482, "agent_timesteps_total": 972482, "timers": {"sample_time_ms": 43456.895, "sample_throughput": 276.274, "load_time_ms": 8.708, "load_throughput": 1378724.622, "learn_time_ms": 36611.008, "learn_throughput": 327.934, "update_time_ms": 32.654}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004593304358422756, "policy_loss": 0.0007272267248481512, "vf_loss": 0.0038660764694213867, "vf_explained_var": 0.10365471988916397, "kl": 5.378638334718744e-08, "entropy": 2.6913697719573975, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 972482, "num_agent_steps_sampled": 972482, "num_steps_trained": 972482, "num_agent_steps_trained": 972482}, "done": false, "episodes_total": 486, "training_iteration": 81, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-07-48", "timestamp": 1690844868, "time_this_iter_s": 92.48085188865662, "time_total_s": 6834.40868639946, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6834.40868639946, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 99.98345864661654, "ram_util_percent": 55.396992481203}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.8978542050569938, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8204778414224316, "reward_component_totals/dist_change_reward_min": -0.9926844716318093, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.0773763636345692, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.73763636345615, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1141.29, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.570359820089955, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9938521857000406, -3.828912673002446, -3.97320881431585, -3.9698090956853567, -3.957437502507084, -3.9025856539031887, -2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8530739001215417, "mean_inference_ms": 8.481181419358322, "mean_action_processing_ms": 0.42716395363597953, "mean_env_wait_ms": 10.204133834476691, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 984488, "agent_timesteps_total": 984488, "timers": {"sample_time_ms": 43266.671, "sample_throughput": 277.488, "load_time_ms": 8.901, "load_throughput": 1348851.658, "learn_time_ms": 36536.635, "learn_throughput": 328.602, "update_time_ms": 33.848}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0032061703968793154, "policy_loss": -0.0005006564315408468, "vf_loss": 0.003706828225404024, "vf_explained_var": 0.15793275833129883, "kl": 9.137976597628494e-09, "entropy": 2.6901142597198486, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 984488, "num_agent_steps_sampled": 984488, "num_steps_trained": 984488, "num_agent_steps_trained": 984488}, "done": false, "episodes_total": 492, "training_iteration": 82, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-09-03", "timestamp": 1690844943, "time_this_iter_s": 74.32853674888611, "time_total_s": 6908.737223148346, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6908.737223148346, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 99.96981132075473, "ram_util_percent": 55.373584905660366}, "trial_id": "e0618_00000"}
{"episode_reward_max": -2.749373598169304, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.896688119751806, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8192437782214068, "reward_component_totals/dist_change_reward_min": -0.9926844716318093, "reward_component_totals/dist_change_reward_max": 0.3532559316644893, "reward_component_totals/delta_v_mean": -2.077444341530405, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7444341530398, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1136.0, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5677161419290355, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-2.749373598169304, -4.0233408436692155, -3.839381218738093, -2.999925652820105, -3.9520856011191325, -3.821123043745067, -3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8529085516933292, "mean_inference_ms": 8.476570232599835, "mean_action_processing_ms": 0.42693526902194245, "mean_env_wait_ms": 10.199705597975901, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 996494, "agent_timesteps_total": 996494, "timers": {"sample_time_ms": 43484.182, "sample_throughput": 276.1, "load_time_ms": 8.657, "load_throughput": 1386857.996, "learn_time_ms": 36523.872, "learn_throughput": 328.717, "update_time_ms": 37.014}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004505105782300234, "policy_loss": 0.0007857898017391562, "vf_loss": 0.003719315165653825, "vf_explained_var": 0.021231643855571747, "kl": 1.6298145055770874e-09, "entropy": 2.7236318588256836, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 996494, "num_agent_steps_sampled": 996494, "num_steps_trained": 996494, "num_agent_steps_trained": 996494}, "done": false, "episodes_total": 498, "training_iteration": 83, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-10-22", "timestamp": 1690845022, "time_this_iter_s": 79.61005592346191, "time_total_s": 6988.347279071808, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6988.347279071808, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 99.9780701754386, "ram_util_percent": 55.431578947368415}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.747097907098337, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.916880895500768, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8388648674491965, "reward_component_totals/dist_change_reward_min": -0.9926844716318093, "reward_component_totals/dist_change_reward_max": -0.6427012732057081, "reward_component_totals/delta_v_mean": -2.0780160280515783, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.02290157720447, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.801602805157, "delta_v_total_min": 202.29015772044627, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1121.77, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5606046976511743, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.789991643068985, -3.7604198396281507, -4.008376636628431, -3.9402261465171637, -3.887238895464388, -3.8212165923424584, -4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8527987880741135, "mean_inference_ms": 8.472172298860837, "mean_action_processing_ms": 0.42671833945908255, "mean_env_wait_ms": 10.195758950224985, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1008500, "agent_timesteps_total": 1008500, "timers": {"sample_time_ms": 43680.957, "sample_throughput": 274.857, "load_time_ms": 9.164, "load_throughput": 1310164.141, "learn_time_ms": 36372.321, "learn_throughput": 330.086, "update_time_ms": 37.577}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004049270413815975, "policy_loss": 0.0002601364685688168, "vf_loss": 0.0037891333922743797, "vf_explained_var": 0.06080755591392517, "kl": 1.9109638316194832e-08, "entropy": 2.745518207550049, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1008500, "num_agent_steps_sampled": 1008500, "num_steps_trained": 1008500, "num_agent_steps_trained": 1008500}, "done": false, "episodes_total": 504, "training_iteration": 84, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-11-43", "timestamp": 1690845103, "time_this_iter_s": 80.18272423744202, "time_total_s": 7068.53000330925, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7068.53000330925, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 99.9780701754386, "ram_util_percent": 55.44824561403507}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.916147974199539, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8354805426686893, "reward_component_totals/dist_change_reward_min": -0.9926844716318093, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.0806674315308564, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.06674315308481, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1105.17, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5523088455772113, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.061821288168603, -3.8691194321668263, -3.8460478023622393, -3.8817212390798748, -3.9630031257522775, -3.760670291575686, -3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8527494896041135, "mean_inference_ms": 8.467551146990896, "mean_action_processing_ms": 0.4265197308522968, "mean_env_wait_ms": 10.19244967559333, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1020506, "agent_timesteps_total": 1020506, "timers": {"sample_time_ms": 43836.701, "sample_throughput": 273.88, "load_time_ms": 8.97, "load_throughput": 1338511.591, "learn_time_ms": 36783.488, "learn_throughput": 326.396, "update_time_ms": 37.506}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002883504144847393, "policy_loss": -0.000376095122192055, "vf_loss": 0.003259599208831787, "vf_explained_var": 0.056927405297756195, "kl": -2.1355326396133023e-09, "entropy": 2.790208339691162, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1020506, "num_agent_steps_sampled": 1020506, "num_steps_trained": 1020506, "num_agent_steps_trained": 1020506}, "done": false, "episodes_total": 510, "training_iteration": 85, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-13-06", "timestamp": 1690845186, "time_this_iter_s": 82.65464878082275, "time_total_s": 7151.184652090073, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7151.184652090073, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 99.97863247863248, "ram_util_percent": 55.38205128205128}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.9161015078037353, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8355411658336129, "reward_component_totals/dist_change_reward_min": -0.9926844716318093, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.080560341970129, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05603419701208, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1119.33, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5593853073463269, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9189211763741767, -3.8410705073187423, -3.839327288945803, -4.009303878245635, -3.913732859161743, -3.9669764561748555, -4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8527350486747227, "mean_inference_ms": 8.463002600640172, "mean_action_processing_ms": 0.42634062131592926, "mean_env_wait_ms": 10.189287862588825, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1032512, "agent_timesteps_total": 1032512, "timers": {"sample_time_ms": 43611.726, "sample_throughput": 275.293, "load_time_ms": 9.089, "load_throughput": 1321004.242, "learn_time_ms": 36899.041, "learn_throughput": 325.374, "update_time_ms": 37.402}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003583015874028206, "policy_loss": 0.0003941203176509589, "vf_loss": 0.0031888955272734165, "vf_explained_var": 0.011454848572611809, "kl": 1.316870057443964e-09, "entropy": 2.7692201137542725, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1032512, "num_agent_steps_sampled": 1032512, "num_steps_trained": 1032512, "num_agent_steps_trained": 1032512}, "done": false, "episodes_total": 516, "training_iteration": 86, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-14-27", "timestamp": 1690845267, "time_this_iter_s": 81.01387429237366, "time_total_s": 7232.198526382446, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7232.198526382446, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 99.98017241379311, "ram_util_percent": 55.38706896551722}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.9166483851224085, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8372045828675168, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.0794438022548984, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.94438022548903, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1122.72, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.561079460269865, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.017018851151522, -3.964198164676815, -3.9823217989648123, -3.9635153083643218, -3.9855869297795845, -3.8280021406407645, -3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8514344203019013, "mean_inference_ms": 8.458801305224004, "mean_action_processing_ms": 0.4261661222110928, "mean_env_wait_ms": 10.18583447858514, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1044518, "agent_timesteps_total": 1044518, "timers": {"sample_time_ms": 43463.027, "sample_throughput": 276.235, "load_time_ms": 8.821, "load_throughput": 1361035.431, "learn_time_ms": 36830.756, "learn_throughput": 325.978, "update_time_ms": 37.681}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004693430848419666, "policy_loss": 0.0010064832167699933, "vf_loss": 0.0036869491450488567, "vf_explained_var": 0.1477484405040741, "kl": -2.2181501080353883e-09, "entropy": 2.719965696334839, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1044518, "num_agent_steps_sampled": 1044518, "num_steps_trained": 1044518, "num_agent_steps_trained": 1044518}, "done": false, "episodes_total": 522, "training_iteration": 87, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-15-46", "timestamp": 1690845346, "time_this_iter_s": 78.92293548583984, "time_total_s": 7311.121461868286, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7311.121461868286, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 99.97678571428573, "ram_util_percent": 55.452678571428564}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.91578335656657, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8362013393524735, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.0795820172141024, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.95820172140947, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1118.96, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5592003998000998, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9016227287614766, -3.9178246472386613, -4.0606698725120545, -3.9249876477175536, -3.8170281119452216, -3.882881754938393, -3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8502036320396393, "mean_inference_ms": 8.454610893014042, "mean_action_processing_ms": 0.425990649247251, "mean_env_wait_ms": 10.182493338065575, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1056524, "agent_timesteps_total": 1056524, "timers": {"sample_time_ms": 43501.432, "sample_throughput": 275.991, "load_time_ms": 6.957, "load_throughput": 1725813.227, "learn_time_ms": 36760.036, "learn_throughput": 326.605, "update_time_ms": 37.413}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004286367911845446, "policy_loss": 0.0007390708196908236, "vf_loss": 0.00354729569517076, "vf_explained_var": -0.014738554134964943, "kl": -1.0765287550285052e-09, "entropy": 2.7736566066741943, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1056524, "num_agent_steps_sampled": 1056524, "num_steps_trained": 1056524, "num_agent_steps_trained": 1056524}, "done": false, "episodes_total": 528, "training_iteration": 88, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-17-06", "timestamp": 1690845426, "time_this_iter_s": 79.33046960830688, "time_total_s": 7390.451931476593, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7390.451931476593, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 99.98245614035088, "ram_util_percent": 55.39824561403507}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.917150782964051, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8363445788894321, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.0808062040746242, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.08062040746162, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1139.45, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.56944027986007, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9090322336464878, -3.9829222219834772, -3.7707350609131796, -3.960911227418725, -3.907850707245312, -3.8355880661132264, -3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8490369104056257, "mean_inference_ms": 8.450437138092397, "mean_action_processing_ms": 0.4258155977467261, "mean_env_wait_ms": 10.179083596449045, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1068530, "agent_timesteps_total": 1068530, "timers": {"sample_time_ms": 43642.109, "sample_throughput": 275.101, "load_time_ms": 6.707, "load_throughput": 1790044.428, "learn_time_ms": 36551.227, "learn_throughput": 328.471, "update_time_ms": 36.28}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004517943598330021, "policy_loss": 0.0011168549535796046, "vf_loss": 0.0034010864328593016, "vf_explained_var": -0.014770842157304287, "kl": 3.6451766050049628e-09, "entropy": 2.746644973754883, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1068530, "num_agent_steps_sampled": 1068530, "num_steps_trained": 1068530, "num_agent_steps_trained": 1068530}, "done": false, "episodes_total": 534, "training_iteration": 89, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-18-24", "timestamp": 1690845504, "time_this_iter_s": 78.04329752922058, "time_total_s": 7468.495229005814, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7468.495229005814, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 99.98198198198199, "ram_util_percent": 55.39999999999996}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.920902059418961, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8397621285662129, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.081139930852754, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1139930852746, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1151.0, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5752123938030984, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9417014728605295, -3.832275724416312, -3.9610047507443196, -3.836271207536189, -3.981539675332235, -3.8246901130586926, -4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8478342579405458, "mean_inference_ms": 8.446550468942755, "mean_action_processing_ms": 0.42567177702018344, "mean_env_wait_ms": 10.175808857789274, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1080536, "agent_timesteps_total": 1080536, "timers": {"sample_time_ms": 43719.685, "sample_throughput": 274.613, "load_time_ms": 7.589, "load_throughput": 1582015.338, "learn_time_ms": 36820.857, "learn_throughput": 326.065, "update_time_ms": 37.116}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0026037786155939102, "policy_loss": -0.0008416227647103369, "vf_loss": 0.003445402951911092, "vf_explained_var": 0.05031444877386093, "kl": -3.404835302589504e-10, "entropy": 2.73953914642334, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1080536, "num_agent_steps_sampled": 1080536, "num_steps_trained": 1080536, "num_agent_steps_trained": 1080536}, "done": false, "episodes_total": 540, "training_iteration": 90, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-19-44", "timestamp": 1690845584, "time_this_iter_s": 80.33872175216675, "time_total_s": 7548.83395075798, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7548.83395075798, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 99.97652173913045, "ram_util_percent": 55.35391304347825}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.9269876967994555, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.844243972427966, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.082743724371496, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.27437243714883, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1134.57, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5670014992503749, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.071048986643701, -3.8644716806547716, -3.8300003506190756, -3.946777699532832, -4.018555409141118, -4.041121845595793, -4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8476374805691966, "mean_inference_ms": 8.44240171433297, "mean_action_processing_ms": 0.42553050299141126, "mean_env_wait_ms": 10.172501557448674, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1092542, "agent_timesteps_total": 1092542, "timers": {"sample_time_ms": 43592.638, "sample_throughput": 275.413, "load_time_ms": 7.542, "load_throughput": 1591983.113, "learn_time_ms": 36761.183, "learn_throughput": 326.594, "update_time_ms": 38.739}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0037293240893632174, "policy_loss": 0.0002640206948854029, "vf_loss": 0.003465301590040326, "vf_explained_var": 0.04178270697593689, "kl": -1.244267022748602e-09, "entropy": 2.7795329093933105, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1092542, "num_agent_steps_sampled": 1092542, "num_steps_trained": 1092542, "num_agent_steps_trained": 1092542}, "done": false, "episodes_total": 546, "training_iteration": 91, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-21-15", "timestamp": 1690845675, "time_this_iter_s": 90.59258508682251, "time_total_s": 7639.426535844803, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7639.426535844803, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 99.9829457364341, "ram_util_percent": 55.38372093023254}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.9235425219170383, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8430166821889243, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.0805258397281197, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05258397281122, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1121.46, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5610865578568206, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.055385488730527, -3.8498099869355142, -3.8733610162293175, -3.824973009959275, -3.9230339518351727, -3.8719834283461902, -3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.847439285843317, "mean_inference_ms": 8.437976481167379, "mean_action_processing_ms": 0.42538420091057594, "mean_env_wait_ms": 10.169109903490787, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1104396, "agent_timesteps_total": 1104396, "timers": {"sample_time_ms": 43548.285, "sample_throughput": 275.345, "load_time_ms": 8.223, "load_throughput": 1458255.952, "learn_time_ms": 36865.805, "learn_throughput": 325.255, "update_time_ms": 37.064}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0042334143072366714, "policy_loss": 0.0003881309530697763, "vf_loss": 0.0038452818989753723, "vf_explained_var": 0.07738177478313446, "kl": 2.932147680212438e-08, "entropy": 2.7015268802642822, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1104396, "num_agent_steps_sampled": 1104396, "num_steps_trained": 1104396, "num_agent_steps_trained": 1104396}, "done": false, "episodes_total": 552, "training_iteration": 92, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-22-30", "timestamp": 1690845750, "time_this_iter_s": 74.87322187423706, "time_total_s": 7714.29975771904, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7714.29975771904, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 99.97830188679247, "ram_util_percent": 55.39999999999998}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.925185120604405, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8442613888387599, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.08092373176565, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.09237317656434, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1122.0, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5613564229242869, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.871454200486702, -4.026707915757998, -3.803694575443288, -3.9423153191109406, -3.782238114129431, -3.854034982363043, -3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8471651879620672, "mean_inference_ms": 8.433467237371577, "mean_action_processing_ms": 0.42524865597683786, "mean_env_wait_ms": 10.165585862676261, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1116402, "agent_timesteps_total": 1116402, "timers": {"sample_time_ms": 43264.622, "sample_throughput": 277.15, "load_time_ms": 8.143, "load_throughput": 1472581.044, "learn_time_ms": 37051.911, "learn_throughput": 323.622, "update_time_ms": 34.185}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002051316201686859, "policy_loss": -0.0011622802121564746, "vf_loss": 0.0032135960645973682, "vf_explained_var": 0.016987424343824387, "kl": -1.0715216491874457e-09, "entropy": 2.7709641456604004, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1116402, "num_agent_steps_sampled": 1116402, "num_steps_trained": 1116402, "num_agent_steps_trained": 1116402}, "done": false, "episodes_total": 558, "training_iteration": 93, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-23-49", "timestamp": 1690845829, "time_this_iter_s": 78.58283233642578, "time_total_s": 7792.882590055466, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7792.882590055466, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 99.97678571428573, "ram_util_percent": 55.46160714285714}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.9292727503194236, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8482068563008168, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.0810658940186135, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10658940186056, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1108.4, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5545598212251364, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.747097907098337, -3.861819385917789, -4.004340035130733, -3.953181515082256, -3.94384245221479, -3.854884480958328, -3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8469291021257555, "mean_inference_ms": 8.42893261866283, "mean_action_processing_ms": 0.425118880450971, "mean_env_wait_ms": 10.162169388088946, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1128408, "agent_timesteps_total": 1128408, "timers": {"sample_time_ms": 42942.005, "sample_throughput": 279.232, "load_time_ms": 7.809, "load_throughput": 1535544.061, "learn_time_ms": 37127.931, "learn_throughput": 322.959, "update_time_ms": 33.138}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003651052014902234, "policy_loss": 0.0002820970839820802, "vf_loss": 0.0033689551055431366, "vf_explained_var": 0.0527808777987957, "kl": -3.0994014021956673e-09, "entropy": 2.7582285404205322, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1128408, "num_agent_steps_sampled": 1128408, "num_steps_trained": 1128408, "num_agent_steps_trained": 1128408}, "done": false, "episodes_total": 564, "training_iteration": 94, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-25-07", "timestamp": 1690845907, "time_this_iter_s": 77.75168180465698, "time_total_s": 7870.634271860123, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7870.634271860123, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 99.98108108108107, "ram_util_percent": 55.46306306306307}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.173010885143041, "episode_reward_mean": -3.931990573282941, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8524628005881175, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.079527772694829, "reward_component_totals/delta_v_min": -2.2020142263670652, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.95277726948214, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 220.2014226367062, "constraint_violation.max_vel_constraint.steps_mean": 1125.01, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5628606708003489, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.756463683786824, -4.002689389996966, -4.173010885143041, -3.897497774031156, -3.9465942378486476, -4.001039360881108, -3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8466882608391708, "mean_inference_ms": 8.424504218519683, "mean_action_processing_ms": 0.42498936517750024, "mean_env_wait_ms": 10.158570486886665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1140414, "agent_timesteps_total": 1140414, "timers": {"sample_time_ms": 42694.024, "sample_throughput": 280.854, "load_time_ms": 8.472, "load_throughput": 1415426.063, "learn_time_ms": 36892.635, "learn_throughput": 325.019, "update_time_ms": 32.134}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0044333734549582005, "policy_loss": 0.0007460684282705188, "vf_loss": 0.0036873093340545893, "vf_explained_var": 0.020573321729898453, "kl": 7.540708502062898e-09, "entropy": 2.703472137451172, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1140414, "num_agent_steps_sampled": 1140414, "num_steps_trained": 1140414, "num_agent_steps_trained": 1140414}, "done": false, "episodes_total": 570, "training_iteration": 95, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-26-25", "timestamp": 1690845985, "time_this_iter_s": 77.82252621650696, "time_total_s": 7948.45679807663, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7948.45679807663, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 99.98198198198199, "ram_util_percent": 55.68828828828829}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.933643393084464, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8537770319526996, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.0798663611317703, "reward_component_totals/delta_v_min": -2.13782858098546, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98663611317627, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 213.78285809854526, "constraint_violation.max_vel_constraint.steps_mean": 1134.89, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5677982020347316, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9164335836459268, -3.972592685352918, -4.0996423886932085, -3.972365372380865, -4.0234348542233604, -3.7636249389573675, -3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8464190479791456, "mean_inference_ms": 8.420148802803402, "mean_action_processing_ms": 0.4248465573692222, "mean_env_wait_ms": 10.154548458640738, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1152420, "agent_timesteps_total": 1152420, "timers": {"sample_time_ms": 42539.048, "sample_throughput": 281.877, "load_time_ms": 8.718, "load_throughput": 1375348.613, "learn_time_ms": 36592.384, "learn_throughput": 327.686, "update_time_ms": 32.781}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0025624579284340143, "policy_loss": -0.0008816191111691296, "vf_loss": 0.003444076981395483, "vf_explained_var": 0.07111678272485733, "kl": 3.875503473693698e-09, "entropy": 2.7020745277404785, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1152420, "num_agent_steps_sampled": 1152420, "num_steps_trained": 1152420, "num_agent_steps_trained": 1152420}, "done": false, "episodes_total": 576, "training_iteration": 96, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-27-41", "timestamp": 1690846061, "time_this_iter_s": 76.44088363647461, "time_total_s": 8024.897681713104, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8024.897681713104, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 99.98348623853212, "ram_util_percent": 55.68073394495413}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.92967737434401, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8496484189837598, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.0800289553602567, "reward_component_totals/delta_v_min": -2.13782858098546, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00289553602488, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 213.78285809854526, "constraint_violation.max_vel_constraint.steps_mean": 1153.55, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.577123539366066, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.941084908758368, -3.8296251151995513, -3.9920844364493897, -4.074943540051989, -3.7701478449173726, -3.9545850383329837, -3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.845031949096594, "mean_inference_ms": 8.41616876257289, "mean_action_processing_ms": 0.42467887350264105, "mean_env_wait_ms": 10.15031723723166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1164426, "agent_timesteps_total": 1164426, "timers": {"sample_time_ms": 42795.832, "sample_throughput": 280.186, "load_time_ms": 8.842, "load_throughput": 1356174.693, "learn_time_ms": 36663.01, "learn_throughput": 327.054, "update_time_ms": 35.586}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003498049918562174, "policy_loss": -0.0001360474416287616, "vf_loss": 0.0036340951919555664, "vf_explained_var": 0.022005941718816757, "kl": -5.107252953884256e-10, "entropy": 2.72360897064209, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1164426, "num_agent_steps_sampled": 1164426, "num_steps_trained": 1164426, "num_agent_steps_trained": 1164426}, "done": false, "episodes_total": 582, "training_iteration": 97, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-29-04", "timestamp": 1690846144, "time_this_iter_s": 82.29119873046875, "time_total_s": 8107.188880443573, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8107.188880443573, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 99.98559322033897, "ram_util_percent": 55.42288135593218}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.9270239080787688, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8468380477568535, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.0801858603219223, "reward_component_totals/delta_v_min": -2.13782858098546, "reward_component_totals/delta_v_max": -2.024527383993072, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.01858603219154, "delta_v_total_min": 202.45273839930636, "delta_v_total_max": 213.78285809854526, "constraint_violation.max_vel_constraint.steps_mean": 1155.83, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5782629696509236, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9537146685402353, -4.029889386817571, -3.8782239953638147, -3.9391972780990105, -3.9504908086149007, -3.9273405555507157, -4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8436599774865292, "mean_inference_ms": 8.412514389791573, "mean_action_processing_ms": 0.42450791725113973, "mean_env_wait_ms": 10.14598433063981, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1176432, "agent_timesteps_total": 1176432, "timers": {"sample_time_ms": 42722.966, "sample_throughput": 280.664, "load_time_ms": 9.326, "load_throughput": 1285803.851, "learn_time_ms": 36884.115, "learn_throughput": 325.094, "update_time_ms": 34.25}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0036908190231770277, "policy_loss": 0.0004864415095653385, "vf_loss": 0.0032043762039393187, "vf_explained_var": 0.01662917248904705, "kl": -1.83510606710513e-09, "entropy": 2.7671079635620117, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1176432, "num_agent_steps_sampled": 1176432, "num_steps_trained": 1176432, "num_agent_steps_trained": 1176432}, "done": false, "episodes_total": 588, "training_iteration": 98, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-30-25", "timestamp": 1690846225, "time_this_iter_s": 80.8335280418396, "time_total_s": 8188.022408485413, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8188.022408485413, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 99.98608695652175, "ram_util_percent": 55.42086956521738}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.9282776026033632, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8466077164454561, "reward_component_totals/dist_change_reward_min": -0.9947803643109877, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.081669886157913, "reward_component_totals/delta_v_min": -2.13782858098546, "reward_component_totals/delta_v_max": -2.027932135214415, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16698861579053, "delta_v_total_min": 202.79321352144072, "delta_v_total_max": 213.78285809854526, "constraint_violation.max_vel_constraint.steps_mean": 1154.47, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5775833094810084, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.071476559814339, -3.790717362774553, -3.8930082031847135, -3.876163904655858, -3.8723418905056355, -3.903654194548869, -3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8423430101410676, "mean_inference_ms": 8.408827486905102, "mean_action_processing_ms": 0.4243479178783114, "mean_env_wait_ms": 10.141990003378242, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1188438, "agent_timesteps_total": 1188438, "timers": {"sample_time_ms": 42616.185, "sample_throughput": 281.367, "load_time_ms": 9.355, "load_throughput": 1281812.33, "learn_time_ms": 37229.816, "learn_throughput": 322.075, "update_time_ms": 36.943}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0023466069251298904, "policy_loss": -0.0011929632164537907, "vf_loss": 0.0035395692102611065, "vf_explained_var": 0.10100321471691132, "kl": 5.141301073763316e-08, "entropy": 2.6893203258514404, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1188438, "num_agent_steps_sampled": 1188438, "num_steps_trained": 1188438, "num_agent_steps_trained": 1188438}, "done": false, "episodes_total": 594, "training_iteration": 99, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-31-46", "timestamp": 1690846306, "time_this_iter_s": 80.54540657997131, "time_total_s": 8268.567815065384, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8268.567815065384, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 99.97652173913043, "ram_util_percent": 55.5}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.6289578906590707, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.9327374652058107, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8515402612234395, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.5169702382281391, "reward_component_totals/delta_v_mean": -2.0811972039823763, "reward_component_totals/delta_v_min": -2.13782858098546, "reward_component_totals/delta_v_max": -2.027932135214415, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.11972039823686, "delta_v_total_min": 202.79321352144072, "delta_v_total_max": 213.78285809854526, "constraint_violation.max_vel_constraint.steps_mean": 1139.41, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5700570725994493, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.8364217892418027, -3.8323519151557353, -4.099264327257607, -3.86047341644751, -3.6289578906590707, -3.906451875939778, -3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8410038572651266, "mean_inference_ms": 8.40476301018028, "mean_action_processing_ms": 0.42418943848682217, "mean_env_wait_ms": 10.137937139068724, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1200444, "agent_timesteps_total": 1200444, "timers": {"sample_time_ms": 42547.962, "sample_throughput": 281.818, "load_time_ms": 8.499, "load_throughput": 1410796.478, "learn_time_ms": 37227.131, "learn_throughput": 322.098, "update_time_ms": 34.064}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004168346524238586, "policy_loss": 0.0008665444329380989, "vf_loss": 0.0033018016256392, "vf_explained_var": 0.06769008934497833, "kl": -3.091890743434078e-09, "entropy": 2.7476682662963867, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1200444, "num_agent_steps_sampled": 1200444, "num_steps_trained": 1200444, "num_agent_steps_trained": 1200444}, "done": false, "episodes_total": 600, "training_iteration": 100, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-33-05", "timestamp": 1690846385, "time_this_iter_s": 79.56219577789307, "time_total_s": 8348.130010843277, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8348.130010843277, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 99.97964601769912, "ram_util_percent": 55.49911504424779}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.782288900080469, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.9362925125011246, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.856404464253631, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.708480442301259, "reward_component_totals/delta_v_mean": -2.0798880482474993, "reward_component_totals/delta_v_min": -2.13782858098546, "reward_component_totals/delta_v_max": -2.027932135214415, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98880482474917, "delta_v_total_min": 202.79321352144072, "delta_v_total_max": 213.78285809854526, "constraint_violation.max_vel_constraint.steps_mean": 1145.73, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5732154933890545, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.784702474292743, -4.049025426175237, -3.783409426405221, -3.981630530054649, -3.8449968544921633, -3.906811304064801, -3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8405009303904079, "mean_inference_ms": 8.40032451051147, "mean_action_processing_ms": 0.4240230033813381, "mean_env_wait_ms": 10.133740697143352, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1212450, "agent_timesteps_total": 1212450, "timers": {"sample_time_ms": 42545.409, "sample_throughput": 281.835, "load_time_ms": 10.027, "load_throughput": 1195808.159, "learn_time_ms": 37588.201, "learn_throughput": 319.004, "update_time_ms": 30.343}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003582783043384552, "policy_loss": 0.0003234141622669995, "vf_loss": 0.0032593694049865007, "vf_explained_var": 0.006779965478926897, "kl": -4.278576160032799e-09, "entropy": 2.763437032699585, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1212450, "num_agent_steps_sampled": 1212450, "num_steps_trained": 1212450, "num_agent_steps_trained": 1212450}, "done": false, "episodes_total": 606, "training_iteration": 101, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-34-40", "timestamp": 1690846480, "time_this_iter_s": 94.1634874343872, "time_total_s": 8442.293498277664, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8442.293498277664, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 99.9837037037037, "ram_util_percent": 55.5}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.782288900080469, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.940650790854867, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8598561797599783, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.708480442301259, "reward_component_totals/delta_v_mean": -2.080794611094895, "reward_component_totals/delta_v_min": -2.13782858098546, "reward_component_totals/delta_v_max": -2.027932135214415, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07946110948876, "delta_v_total_min": 202.79321352144072, "delta_v_total_max": 213.78285809854526, "constraint_violation.max_vel_constraint.steps_mean": 1157.72, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5792074973870555, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.8589204323170456, -4.0127757253293765, -3.78819628569586, -3.9660359376259415, -3.782288900080469, -3.948088634367138, -4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.839932352990172, "mean_inference_ms": 8.39566563508731, "mean_action_processing_ms": 0.423844995523353, "mean_env_wait_ms": 10.128803305085667, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1224456, "agent_timesteps_total": 1224456, "timers": {"sample_time_ms": 42545.844, "sample_throughput": 282.19, "load_time_ms": 9.124, "load_throughput": 1315867.815, "learn_time_ms": 38059.277, "learn_throughput": 315.455, "update_time_ms": 29.066}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004213930107653141, "policy_loss": 0.0006448337226174772, "vf_loss": 0.003569095628336072, "vf_explained_var": 0.010064921341836452, "kl": 4.423782229423523e-09, "entropy": 2.7469851970672607, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1224456, "num_agent_steps_sampled": 1224456, "num_steps_trained": 1224456, "num_agent_steps_trained": 1224456}, "done": false, "episodes_total": 612, "training_iteration": 102, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-35-59", "timestamp": 1690846559, "time_this_iter_s": 79.60019969940186, "time_total_s": 8521.893697977066, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8521.893697977066, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 99.9858407079646, "ram_util_percent": 55.498230088495575}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7848955863624814, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.9462651987627795, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8646339976897519, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.708480442301259, "reward_component_totals/delta_v_mean": -2.081631201073034, "reward_component_totals/delta_v_min": -2.13782858098546, "reward_component_totals/delta_v_max": -2.027932135214415, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16312010730263, "delta_v_total_min": 202.79321352144072, "delta_v_total_max": 213.78285809854526, "constraint_violation.max_vel_constraint.steps_mean": 1145.46, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5730805608553214, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.062039944478373, -3.7947580172853588, -3.9241669810757616, -4.0326774208011615, -4.00047440041088, -3.9406988737572632, -3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8393474590581531, "mean_inference_ms": 8.391033598195909, "mean_action_processing_ms": 0.42364480871215265, "mean_env_wait_ms": 10.123652199637625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1236462, "agent_timesteps_total": 1236462, "timers": {"sample_time_ms": 42540.647, "sample_throughput": 282.224, "load_time_ms": 9.035, "load_throughput": 1328837.11, "learn_time_ms": 38235.835, "learn_throughput": 313.999, "update_time_ms": 28.902}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004119394347071648, "policy_loss": 0.0007903545629233122, "vf_loss": 0.003329040016978979, "vf_explained_var": 0.0652426928281784, "kl": 1.5344291171004443e-08, "entropy": 2.7265243530273438, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1236462, "num_agent_steps_sampled": 1236462, "num_steps_trained": 1236462, "num_agent_steps_trained": 1236462}, "done": false, "episodes_total": 618, "training_iteration": 103, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-37-20", "timestamp": 1690846640, "time_this_iter_s": 80.21628284454346, "time_total_s": 8602.10998082161, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8602.10998082161, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 99.98695652173913, "ram_util_percent": 55.5}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7848955863624814, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.9421685508077524, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8616091166208402, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.708480442301259, "reward_component_totals/delta_v_mean": -2.080559434186919, "reward_component_totals/delta_v_min": -2.13782858098546, "reward_component_totals/delta_v_max": -2.027932135214415, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05594341869113, "delta_v_total_min": 202.79321352144072, "delta_v_total_max": 213.78285809854526, "constraint_violation.max_vel_constraint.steps_mean": 1159.16, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5799271375669656, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.9183565714309254, -3.9945319658871306, -3.7848955863624814, -4.015182940145248, -4.021040071398469, -4.001321119547802, -3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8387673811911236, "mean_inference_ms": 8.38651013262009, "mean_action_processing_ms": 0.4234543318376418, "mean_env_wait_ms": 10.118553822719335, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1248468, "agent_timesteps_total": 1248468, "timers": {"sample_time_ms": 42522.699, "sample_throughput": 282.343, "load_time_ms": 8.685, "load_throughput": 1382399.747, "learn_time_ms": 38379.854, "learn_throughput": 312.82, "update_time_ms": 28.746}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0043470291420817375, "policy_loss": 0.0007745485054329038, "vf_loss": 0.003572481218725443, "vf_explained_var": 0.05825703218579292, "kl": 4.4738532878341175e-09, "entropy": 2.6858932971954346, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1248468, "num_agent_steps_sampled": 1248468, "num_steps_trained": 1248468, "num_agent_steps_trained": 1248468}, "done": false, "episodes_total": 624, "training_iteration": 104, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-38-39", "timestamp": 1690846719, "time_this_iter_s": 79.04261565208435, "time_total_s": 8681.152596473694, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8681.152596473694, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 99.98849557522124, "ram_util_percent": 55.5}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7882847760210314, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.9455068477614144, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8646783841394827, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.708480442301259, "reward_component_totals/delta_v_mean": -2.0808284636219376, "reward_component_totals/delta_v_min": -2.13782858098546, "reward_component_totals/delta_v_max": -2.027932135214415, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.08284636219298, "delta_v_total_min": 202.79321352144072, "delta_v_total_max": 213.78285809854526, "constraint_violation.max_vel_constraint.steps_mean": 1128.67, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5646897562576202, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.8555594491278735, -3.8266721567609023, -3.8920967369482904, -4.045067869078054, -3.8827588117569154, -3.9911419107297004, -4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8381178410666477, "mean_inference_ms": 8.38211239561282, "mean_action_processing_ms": 0.4232469301545742, "mean_env_wait_ms": 10.11314226418729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1260474, "agent_timesteps_total": 1260474, "timers": {"sample_time_ms": 42470.782, "sample_throughput": 282.688, "load_time_ms": 7.857, "load_throughput": 1528061.667, "learn_time_ms": 38391.312, "learn_throughput": 312.727, "update_time_ms": 28.559}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0037627066485583782, "policy_loss": 0.000676556839607656, "vf_loss": 0.0030861510895192623, "vf_explained_var": 0.021355124190449715, "kl": -2.9116349331559377e-09, "entropy": 2.792774200439453, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1260474, "num_agent_steps_sampled": 1260474, "num_steps_trained": 1260474, "num_agent_steps_trained": 1260474}, "done": false, "episodes_total": 630, "training_iteration": 105, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-39-57", "timestamp": 1690846797, "time_this_iter_s": 77.37479543685913, "time_total_s": 8758.527391910553, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8758.527391910553, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 99.98363636363635, "ram_util_percent": 55.4990909090909}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7882847760210314, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.9451112377952224, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8640721989289643, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.708480442301259, "reward_component_totals/delta_v_mean": -2.081039038866265, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.027932135214415, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10390388662572, "delta_v_total_min": 202.79321352144072, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1113.62, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5571685168773105, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.033479554447297, -3.869729460918604, -4.099634359200191, -3.8654230657587494, -4.09134331882937, -3.91248027666858, -3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8375320000387438, "mean_inference_ms": 8.37787801131188, "mean_action_processing_ms": 0.42304693171135666, "mean_env_wait_ms": 10.107521475252394, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1272480, "agent_timesteps_total": 1272480, "timers": {"sample_time_ms": 42538.989, "sample_throughput": 282.235, "load_time_ms": 8.163, "load_throughput": 1470692.748, "learn_time_ms": 38508.064, "learn_throughput": 311.779, "update_time_ms": 25.809}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004159179516136646, "policy_loss": 0.0005304670776240528, "vf_loss": 0.003628712147474289, "vf_explained_var": 0.07424521446228027, "kl": 4.825102095651346e-08, "entropy": 2.6651501655578613, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1272480, "num_agent_steps_sampled": 1272480, "num_steps_trained": 1272480, "num_agent_steps_trained": 1272480}, "done": false, "episodes_total": 636, "training_iteration": 106, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-41-15", "timestamp": 1690846875, "time_this_iter_s": 78.30058002471924, "time_total_s": 8836.827971935272, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8836.827971935272, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 99.98303571428572, "ram_util_percent": 55.49910714285714}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7882847760210314, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.940548578074045, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8595398403475375, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.708480442301259, "reward_component_totals/delta_v_mean": -2.0810087377265125, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.027932135214415, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10087377265052, "delta_v_total_min": 202.79321352144072, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1099.59, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5501570226244369, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.9963876601137978, -4.027696696554262, -4.018410166325248, -3.939728563506557, -3.8269232133139073, -3.8687718129062016, -4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8359690134428905, "mean_inference_ms": 8.37405908316199, "mean_action_processing_ms": 0.42282912428444375, "mean_env_wait_ms": 10.101887857450228, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1284486, "agent_timesteps_total": 1284486, "timers": {"sample_time_ms": 42567.615, "sample_throughput": 282.045, "load_time_ms": 8.209, "load_throughput": 1462496.154, "learn_time_ms": 38421.511, "learn_throughput": 312.481, "update_time_ms": 23.975}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004917041398584843, "policy_loss": 0.0013562999665737152, "vf_loss": 0.003560742363333702, "vf_explained_var": -0.005638345144689083, "kl": 1.339402144751034e-09, "entropy": 2.7234063148498535, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1284486, "num_agent_steps_sampled": 1284486, "num_steps_trained": 1284486, "num_agent_steps_trained": 1284486}, "done": false, "episodes_total": 642, "training_iteration": 107, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-42-37", "timestamp": 1690846957, "time_this_iter_s": 81.6413688659668, "time_total_s": 8918.469340801239, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8918.469340801239, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 99.98706896551724, "ram_util_percent": 55.5}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7882847760210314, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.939050269092355, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8576215893668306, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.708480442301259, "reward_component_totals/delta_v_mean": -2.0814286797255317, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.036630410850051, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1428679725523, "delta_v_total_min": 203.66304108500475, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1136.71, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5687077472621179, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.059339853344071, -4.016319661304672, -3.843146380137518, -3.812957562939151, -3.8825076941918755, -4.0893301189239075, -3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035], "episode_lengths": [2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8343705166483713, "mean_inference_ms": 8.370391967248207, "mean_action_processing_ms": 0.4226235410905356, "mean_env_wait_ms": 10.096130776977937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1296492, "agent_timesteps_total": 1296492, "timers": {"sample_time_ms": 42266.949, "sample_throughput": 284.052, "load_time_ms": 8.344, "load_throughput": 1438922.335, "learn_time_ms": 38510.257, "learn_throughput": 311.761, "update_time_ms": 25.547}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002723040757700801, "policy_loss": -0.0004762895405292511, "vf_loss": 0.003199326805770397, "vf_explained_var": -0.005274082999676466, "kl": 8.386910721469576e-09, "entropy": 2.699364423751831, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1296492, "num_agent_steps_sampled": 1296492, "num_steps_trained": 1296492, "num_agent_steps_trained": 1296492}, "done": false, "episodes_total": 648, "training_iteration": 108, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-43-56", "timestamp": 1690847036, "time_this_iter_s": 78.6702651977539, "time_total_s": 8997.139605998993, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8997.139605998993, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 99.98928571428571, "ram_util_percent": 55.5}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7882847760210314, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.937620908250701, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8561117681252902, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.7113632384031867, "reward_component_totals/delta_v_mean": -2.0815091401254175, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.036630410850051, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.15091401254097, "delta_v_total_min": 203.66304108500475, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1144.59, "constraint_violation.max_vel_constraint.steps_min": 477, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5720089955022488, "constraint_violation.max_vel_constraint.ratio_min": 0.2383808095952024, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.8032861909430697, -3.7882847760210314, -4.000407109999428, -3.9989908606933557, -3.978269418525543, -3.8135552606259537, -3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.832786811497159, "mean_inference_ms": 8.366873288101042, "mean_action_processing_ms": 0.4224100065154895, "mean_env_wait_ms": 10.09023316720816, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1308498, "agent_timesteps_total": 1308498, "timers": {"sample_time_ms": 42020.774, "sample_throughput": 285.716, "load_time_ms": 8.308, "load_throughput": 1445103.922, "learn_time_ms": 38512.554, "learn_throughput": 311.743, "update_time_ms": 24.746}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003013428533449769, "policy_loss": -0.00025674287462607026, "vf_loss": 0.003270173678174615, "vf_explained_var": 0.014566384255886078, "kl": -2.6763005145369334e-09, "entropy": 2.750770092010498, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1308498, "num_agent_steps_sampled": 1308498, "num_steps_trained": 1308498, "num_agent_steps_trained": 1308498}, "done": false, "episodes_total": 654, "training_iteration": 109, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-45-14", "timestamp": 1690847114, "time_this_iter_s": 78.09015798568726, "time_total_s": 9075.22976398468, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9075.22976398468, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 99.98392857142856, "ram_util_percent": 55.496428571428574}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7939932780368735, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.9404567304959364, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8590045908292627, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.7221161793035079, "reward_component_totals/delta_v_mean": -2.08145213966668, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.036630410850051, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.14521396666717, "delta_v_total_min": 203.66304108500475, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1158.92, "constraint_violation.max_vel_constraint.steps_min": 477, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5791704147926037, "constraint_violation.max_vel_constraint.ratio_min": 0.2383808095952024, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.8378920537871997, -4.000913400750314, -3.9990133719096788, -4.05956457319466, -3.892695302791819, -3.9719786183659362, -4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8311963662879691, "mean_inference_ms": 8.36320337639489, "mean_action_processing_ms": 0.4221826224134261, "mean_env_wait_ms": 10.08411652409217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1320504, "agent_timesteps_total": 1320504, "timers": {"sample_time_ms": 41728.393, "sample_throughput": 287.718, "load_time_ms": 8.831, "load_throughput": 1359576.599, "learn_time_ms": 38620.093, "learn_throughput": 310.874, "update_time_ms": 26.209}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0036384472623467445, "policy_loss": 0.00042178627336397767, "vf_loss": 0.003216660115867853, "vf_explained_var": -0.008773052133619785, "kl": 5.607964093101714e-10, "entropy": 2.725909948348999, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1320504, "num_agent_steps_sampled": 1320504, "num_steps_trained": 1320504, "num_agent_steps_trained": 1320504}, "done": false, "episodes_total": 660, "training_iteration": 110, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-46-32", "timestamp": 1690847192, "time_this_iter_s": 77.75894355773926, "time_total_s": 9152.98870754242, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9152.98870754242, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 99.97837837837837, "ram_util_percent": 55.444144144144104}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7939932780368735, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.9384665046142815, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8568157567354351, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.7221161793035079, "reward_component_totals/delta_v_mean": -2.0816507478788533, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0228060324986776, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16507478788455, "delta_v_total_min": 202.28060324986745, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1141.79, "constraint_violation.max_vel_constraint.steps_min": 477, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5706096951524238, "constraint_violation.max_vel_constraint.ratio_min": 0.2383808095952024, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.025637438665719, -4.058376015313357, -3.8367006246179214, -3.8515600729991295, -3.921271839967826, -3.924643460183761, -3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8304062848851088, "mean_inference_ms": 8.359341944324578, "mean_action_processing_ms": 0.42196086533477817, "mean_env_wait_ms": 10.078074365627618, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1332510, "agent_timesteps_total": 1332510, "timers": {"sample_time_ms": 41854.462, "sample_throughput": 286.851, "load_time_ms": 7.436, "load_throughput": 1614652.514, "learn_time_ms": 38480.424, "learn_throughput": 312.003, "update_time_ms": 31.34}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003271494759246707, "policy_loss": 0.00010812546679517254, "vf_loss": 0.003163369372487068, "vf_explained_var": 0.035446953028440475, "kl": -3.4098424084305634e-09, "entropy": 2.76041841506958, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1332510, "num_agent_steps_sampled": 1332510, "num_steps_trained": 1332510, "num_agent_steps_trained": 1332510}, "done": false, "episodes_total": 666, "training_iteration": 111, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-48-06", "timestamp": 1690847286, "time_this_iter_s": 94.05736207962036, "time_total_s": 9247.04606962204, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9247.04606962204, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 99.98518518518519, "ram_util_percent": 55.453333333333326}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7723583826154368, "episode_reward_min": -4.113885331552993, "episode_reward_mean": -3.9360911575580717, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8561346189300326, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.7221161793035079, "reward_component_totals/delta_v_mean": -2.079956538628045, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9956538628037, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1118.6, "constraint_violation.max_vel_constraint.steps_min": 477, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5590204897551224, "constraint_violation.max_vel_constraint.ratio_min": 0.2383808095952024, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.9363772078528347, -4.037258450299806, -4.00914102198287, -4.113885331552993, -3.8211547104960264, -4.002147782398116, -3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8297032026547655, "mean_inference_ms": 8.355771834798233, "mean_action_processing_ms": 0.42175014375922887, "mean_env_wait_ms": 10.072257150667786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1344516, "agent_timesteps_total": 1344516, "timers": {"sample_time_ms": 42684.281, "sample_throughput": 281.275, "load_time_ms": 7.459, "load_throughput": 1609594.693, "learn_time_ms": 38279.144, "learn_throughput": 313.643, "update_time_ms": 31.446}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0032634413801133633, "policy_loss": -0.00011259982420597225, "vf_loss": 0.003376039443537593, "vf_explained_var": 0.018372956663370132, "kl": 4.008192000526378e-09, "entropy": 2.723694086074829, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1344516, "num_agent_steps_sampled": 1344516, "num_steps_trained": 1344516, "num_agent_steps_trained": 1344516}, "done": false, "episodes_total": 672, "training_iteration": 112, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-49-32", "timestamp": 1690847372, "time_this_iter_s": 85.86506772041321, "time_total_s": 9332.911137342453, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9332.911137342453, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 99.98196721311474, "ram_util_percent": 55.50245901639344}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7723583826154368, "episode_reward_min": -4.092929023166418, "episode_reward_mean": -3.9306729767173185, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8511483594586138, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.7182702999412671, "reward_component_totals/delta_v_mean": -2.079524617258711, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.95246172587034, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1119.43, "constraint_violation.max_vel_constraint.steps_min": 477, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5594352823588207, "constraint_violation.max_vel_constraint.ratio_min": 0.2383808095952024, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.946485859321111, -3.847359183646395, -3.8895669275385187, -3.844777485808119, -3.84256300156314, -3.831382547129013, -3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8290618637633305, "mean_inference_ms": 8.352758668502435, "mean_action_processing_ms": 0.42154204187818856, "mean_env_wait_ms": 10.06667369992099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1356522, "agent_timesteps_total": 1356522, "timers": {"sample_time_ms": 42962.094, "sample_throughput": 279.456, "load_time_ms": 7.452, "load_throughput": 1611186.032, "learn_time_ms": 38076.35, "learn_throughput": 315.314, "update_time_ms": 32.078}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.851859946171657e-35, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0036650639958679676, "policy_loss": 0.0001927847770275548, "vf_loss": 0.003472276497632265, "vf_explained_var": 0.048694219440221786, "kl": 3.1795152621860723e-10, "entropy": 2.702761173248291, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1356522, "num_agent_steps_sampled": 1356522, "num_steps_trained": 1356522, "num_agent_steps_trained": 1356522}, "done": false, "episodes_total": 678, "training_iteration": 113, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-50-54", "timestamp": 1690847454, "time_this_iter_s": 81.05553722381592, "time_total_s": 9413.966674566269, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9413.966674566269, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 99.98189655172413, "ram_util_percent": 55.55344827586208}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7723583826154368, "episode_reward_min": -4.092929023166418, "episode_reward_mean": -3.931083944914344, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8519331672649648, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.7182702999412671, "reward_component_totals/delta_v_mean": -2.0791507776493865, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.91507776493782, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1119.93, "constraint_violation.max_vel_constraint.steps_min": 477, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5596851574212893, "constraint_violation.max_vel_constraint.ratio_min": 0.2383808095952024, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.878960511358917, -3.9689799548693445, -3.8575921305945915, -3.9176461116705354, -3.910738053115994, -4.0686257897716285, -3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8283993843571984, "mean_inference_ms": 8.349600881504987, "mean_action_processing_ms": 0.4213290946828947, "mean_env_wait_ms": 10.060899370280987, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1368528, "agent_timesteps_total": 1368528, "timers": {"sample_time_ms": 42926.522, "sample_throughput": 279.687, "load_time_ms": 8.505, "load_throughput": 1411666.152, "learn_time_ms": 38100.988, "learn_throughput": 315.11, "update_time_ms": 31.941}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004191587679088116, "policy_loss": 0.0005908660241402686, "vf_loss": 0.0036007235758006573, "vf_explained_var": -0.03715255856513977, "kl": 1.519658066051477e-09, "entropy": 2.7379164695739746, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1368528, "num_agent_steps_sampled": 1368528, "num_steps_trained": 1368528, "num_agent_steps_trained": 1368528}, "done": false, "episodes_total": 684, "training_iteration": 114, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-52-13", "timestamp": 1690847533, "time_this_iter_s": 78.87275576591492, "time_total_s": 9492.839430332184, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9492.839430332184, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 99.98468468468468, "ram_util_percent": 55.37927927927925}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7723583826154368, "episode_reward_min": -4.092929023166418, "episode_reward_mean": -3.930555264846609, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8505508091783824, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.7182702999412671, "reward_component_totals/delta_v_mean": -2.080004455668235, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00044556682263, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1134.02, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5667266366816591, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.8738130225373464, -3.9766530360089902, -3.975672932809872, -3.998723311201776, -3.8177249547174754, -3.949751166248806, -4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8277724445303294, "mean_inference_ms": 8.346295998352263, "mean_action_processing_ms": 0.42112225119145164, "mean_env_wait_ms": 10.05519603830733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1380534, "agent_timesteps_total": 1380534, "timers": {"sample_time_ms": 43063.63, "sample_throughput": 278.797, "load_time_ms": 8.533, "load_throughput": 1407066.902, "learn_time_ms": 38133.146, "learn_throughput": 314.844, "update_time_ms": 32.82}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.629649865429142e-36, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0032288790680468082, "policy_loss": -0.0003803900326602161, "vf_loss": 0.0036092696245759726, "vf_explained_var": 0.009937598370015621, "kl": -2.771435747561668e-09, "entropy": 2.79154634475708, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1380534, "num_agent_steps_sampled": 1380534, "num_steps_trained": 1380534, "num_agent_steps_trained": 1380534}, "done": false, "episodes_total": 690, "training_iteration": 115, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-53-32", "timestamp": 1690847612, "time_this_iter_s": 79.14754486083984, "time_total_s": 9571.986975193024, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9571.986975193024, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 99.9842105263158, "ram_util_percent": 55.385964912280684}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7723583826154368, "episode_reward_min": -4.092929023166418, "episode_reward_mean": -3.9303127125513075, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8507646794226329, "reward_component_totals/dist_change_reward_min": -0.9989304010706902, "reward_component_totals/dist_change_reward_max": -0.7182702999412671, "reward_component_totals/delta_v_mean": -2.079548033128683, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.95480331286748, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1133.94, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5666866566716642, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.04484041081247, -4.055016121049707, -3.9951160673135826, -3.9908996555866327, -4.021834981186232, -3.8274903764139863, -3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.827183786481526, "mean_inference_ms": 8.343203601038715, "mean_action_processing_ms": 0.4209102182881589, "mean_env_wait_ms": 10.049375053702155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1392540, "agent_timesteps_total": 1392540, "timers": {"sample_time_ms": 43172.347, "sample_throughput": 278.095, "load_time_ms": 8.084, "load_throughput": 1485066.231, "learn_time_ms": 38019.485, "learn_throughput": 315.785, "update_time_ms": 36.498}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00330077251419425, "policy_loss": -0.00016559724463149905, "vf_loss": 0.0034663702826946974, "vf_explained_var": 0.012411227449774742, "kl": -2.5486193155899173e-09, "entropy": 2.7664175033569336, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1392540, "num_agent_steps_sampled": 1392540, "num_steps_trained": 1392540, "num_agent_steps_trained": 1392540}, "done": false, "episodes_total": 696, "training_iteration": 116, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-54-51", "timestamp": 1690847691, "time_this_iter_s": 78.39786028862, "time_total_s": 9650.384835481644, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9650.384835481644, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 99.98303571428572, "ram_util_percent": 55.39464285714284}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7723583826154368, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.928388062460866, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8498224007776877, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.0785656616831854, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85656616831784, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1144.15, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5717891054472762, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.9378494790811116, -3.9513394517899334, -3.8525881429071003, -3.928323512854603, -3.8149742754468514, -4.0526380369866075, -3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8257442199795237, "mean_inference_ms": 8.34049658266621, "mean_action_processing_ms": 0.42068732591730623, "mean_env_wait_ms": 10.043246286882892, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1404546, "agent_timesteps_total": 1404546, "timers": {"sample_time_ms": 42760.678, "sample_throughput": 280.772, "load_time_ms": 7.911, "load_throughput": 1517594.293, "learn_time_ms": 37921.892, "learn_throughput": 316.598, "update_time_ms": 36.422}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4074124663572855e-36, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0031391209922730923, "policy_loss": -0.00021025170281063765, "vf_loss": 0.003349371487274766, "vf_explained_var": -0.0158845242112875, "kl": 9.756354835133152e-09, "entropy": 2.7110912799835205, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1404546, "num_agent_steps_sampled": 1404546, "num_steps_trained": 1404546, "num_agent_steps_trained": 1404546}, "done": false, "episodes_total": 702, "training_iteration": 117, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-56-08", "timestamp": 1690847768, "time_this_iter_s": 76.53860235214233, "time_total_s": 9726.923437833786, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9726.923437833786, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 99.9770642201835, "ram_util_percent": 55.305504587155966}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7723583826154368, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.929675612321981, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8511503993645239, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.0785252129574654, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85252129574576, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1143.85, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5716391804097951, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.924596830278838, -4.092929023166418, -3.915327052199567, -3.9859386327807806, -3.9461089264933866, -4.085336753835349, -4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8243292599006475, "mean_inference_ms": 8.337879880532835, "mean_action_processing_ms": 0.4204679066191209, "mean_env_wait_ms": 10.03720947159703, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1416552, "agent_timesteps_total": 1416552, "timers": {"sample_time_ms": 42866.24, "sample_throughput": 280.081, "load_time_ms": 7.408, "load_throughput": 1620617.966, "learn_time_ms": 37514.325, "learn_throughput": 320.038, "update_time_ms": 36.589}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2037062331786428e-36, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0027670019771903753, "policy_loss": -0.00045368343126028776, "vf_loss": 0.0032206850592046976, "vf_explained_var": -0.036079805344343185, "kl": 3.87825735970182e-08, "entropy": 2.6996662616729736, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1416552, "num_agent_steps_sampled": 1416552, "num_steps_trained": 1416552, "num_agent_steps_trained": 1416552}, "done": false, "episodes_total": 708, "training_iteration": 118, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-57-23", "timestamp": 1690847843, "time_this_iter_s": 75.63231658935547, "time_total_s": 9802.555754423141, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9802.555754423141, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 99.98148148148148, "ram_util_percent": 55.33796296296295}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7723583826154368, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.925195710296882, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8482836433892025, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.076912066907688, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.69120669076798, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1139.13, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5692803598200898, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-4.012133832886982, -3.959970921192176, -4.041533891682349, -3.8726623801168207, -3.905214186214762, -3.8100189420860096, -3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8229710453576211, "mean_inference_ms": 8.335448893051286, "mean_action_processing_ms": 0.4202524189534558, "mean_env_wait_ms": 10.031395589564593, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1428558, "agent_timesteps_total": 1428558, "timers": {"sample_time_ms": 42957.73, "sample_throughput": 279.484, "load_time_ms": 7.494, "load_throughput": 1602158.846, "learn_time_ms": 37306.425, "learn_throughput": 321.821, "update_time_ms": 35.579}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003507670946419239, "policy_loss": 0.00035981001565232873, "vf_loss": 0.0031478593591600657, "vf_explained_var": 0.04563518613576889, "kl": -2.403413024154588e-09, "entropy": 2.728346109390259, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1428558, "num_agent_steps_sampled": 1428558, "num_steps_trained": 1428558, "num_agent_steps_trained": 1428558}, "done": false, "episodes_total": 714, "training_iteration": 119, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-58-40", "timestamp": 1690847920, "time_this_iter_s": 76.87380957603455, "time_total_s": 9879.429563999176, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9879.429563999176, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 99.98454545454545, "ram_util_percent": 55.38999999999998}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7723583826154368, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.9261218203132326, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8490034068306297, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.0771184134826104, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.71184134826024, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1144.08, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5717541229385308, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.9240344152863247, -3.9351875868169732, -3.8744796028625634, -3.8962161090394467, -4.086270920483216, -4.037794011014867, -4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8216921767682541, "mean_inference_ms": 8.333391118360044, "mean_action_processing_ms": 0.42004309343088503, "mean_env_wait_ms": 10.025758978119065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1440564, "agent_timesteps_total": 1440564, "timers": {"sample_time_ms": 43075.212, "sample_throughput": 278.722, "load_time_ms": 7.072, "load_throughput": 1697767.875, "learn_time_ms": 37059.48, "learn_throughput": 323.966, "update_time_ms": 36.779}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.009265582946607e-37, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002585068577900529, "policy_loss": -0.000513075792696327, "vf_loss": 0.0030981421004980803, "vf_explained_var": 0.08658692240715027, "kl": -1.001422122309803e-11, "entropy": 2.7437751293182373, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1440564, "num_agent_steps_sampled": 1440564, "num_steps_trained": 1440564, "num_agent_steps_trained": 1440564}, "done": false, "episodes_total": 720, "training_iteration": 120, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_16-59-57", "timestamp": 1690847997, "time_this_iter_s": 76.49015235900879, "time_total_s": 9955.919716358185, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9955.919716358185, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 99.98532110091745, "ram_util_percent": 55.392660550458686}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7723583826154368, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.925720331446741, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8484870991273897, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.077233232319359, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7233232319351, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1143.23, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5713293353323338, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-4.0328669120772185, -3.8368758254418696, -4.043392995093298, -4.031957286027738, -3.923274477813081, -3.808655957246839, -3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8211884483089396, "mean_inference_ms": 8.331208141203557, "mean_action_processing_ms": 0.41983966792513366, "mean_env_wait_ms": 10.020151716580076, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1452570, "agent_timesteps_total": 1452570, "timers": {"sample_time_ms": 42868.096, "sample_throughput": 280.068, "load_time_ms": 7.244, "load_throughput": 1657280.973, "learn_time_ms": 36870.518, "learn_throughput": 325.626, "update_time_ms": 31.79}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5046327914733034e-37, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0013778614811599255, "policy_loss": -0.0016497357282787561, "vf_loss": 0.0030276007018983364, "vf_explained_var": -0.05455353111028671, "kl": 3.777865131837643e-08, "entropy": 2.7465944290161133, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1452570, "num_agent_steps_sampled": 1452570, "num_steps_trained": 1452570, "num_agent_steps_trained": 1452570}, "done": false, "episodes_total": 726, "training_iteration": 121, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-01-27", "timestamp": 1690848087, "time_this_iter_s": 90.09099769592285, "time_total_s": 10046.010714054108, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10046.010714054108, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 99.98604651162792, "ram_util_percent": 55.374418604651154}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7654457724158172, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.9223699815785666, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8453327305138919, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.077037251064682, "reward_component_totals/delta_v_min": -2.1508830241362253, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.70372510646743, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 215.08830241362182, "constraint_violation.max_vel_constraint.steps_mean": 1141.91, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5706696651674164, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.9277894579945167, -3.9679476187750957, -3.8907355423889385, -3.9353328835641417, -3.8387861599977624, -3.7939932780368735, -3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8206653778766244, "mean_inference_ms": 8.32877125901318, "mean_action_processing_ms": 0.4196282464454912, "mean_env_wait_ms": 10.014512108243359, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1464576, "agent_timesteps_total": 1464576, "timers": {"sample_time_ms": 41973.788, "sample_throughput": 286.036, "load_time_ms": 7.627, "load_throughput": 1574122.669, "learn_time_ms": 36819.655, "learn_throughput": 326.076, "update_time_ms": 31.863}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.523163957366517e-38, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00225424743257463, "policy_loss": -0.0009860014542937279, "vf_loss": 0.0032402491196990013, "vf_explained_var": 0.03262947499752045, "kl": -3.862985931135654e-09, "entropy": 2.7442758083343506, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1464576, "num_agent_steps_sampled": 1464576, "num_steps_trained": 1464576, "num_agent_steps_trained": 1464576}, "done": false, "episodes_total": 732, "training_iteration": 122, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-02-44", "timestamp": 1690848164, "time_this_iter_s": 76.41957569122314, "time_total_s": 10122.43028974533, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10122.43028974533, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 99.97870370370372, "ram_util_percent": 55.37499999999997}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7654457724158172, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.9241224714793077, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8481688876720618, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.075953583807254, "reward_component_totals/delta_v_min": -2.1362104843556873, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.59535838072458, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 213.621048435568, "constraint_violation.max_vel_constraint.steps_mean": 1126.84, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5631384307846077, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.883669533479719, -4.0168389571560725, -3.9899969341798505, -3.892539200854621, -3.927743586095932, -3.9675786231659087, -3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8201509877717263, "mean_inference_ms": 8.326278836045994, "mean_action_processing_ms": 0.41942108709729814, "mean_env_wait_ms": 10.00902118392379, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1476582, "agent_timesteps_total": 1476582, "timers": {"sample_time_ms": 41731.035, "sample_throughput": 287.7, "load_time_ms": 8.242, "load_throughput": 1456725.453, "learn_time_ms": 36896.863, "learn_throughput": 325.394, "update_time_ms": 30.65}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.7615819786832586e-38, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00403790595009923, "policy_loss": 0.0008791072177700698, "vf_loss": 0.003158798674121499, "vf_explained_var": 0.04286893084645271, "kl": 2.120511322090124e-09, "entropy": 2.6878933906555176, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1476582, "num_agent_steps_sampled": 1476582, "num_steps_trained": 1476582, "num_agent_steps_trained": 1476582}, "done": false, "episodes_total": 738, "training_iteration": 123, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-04-04", "timestamp": 1690848244, "time_this_iter_s": 79.35148930549622, "time_total_s": 10201.781779050827, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10201.781779050827, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 99.98584070796461, "ram_util_percent": 55.36637168141591}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7569122687586765, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.921797324665468, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8478901482319676, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.0739071764335075, "reward_component_totals/delta_v_min": -2.1362104843556873, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.39071764335, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 213.621048435568, "constraint_violation.max_vel_constraint.steps_mean": 1104.57, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1802, "constraint_violation.max_vel_constraint.ratio_mean": 0.5520089955022488, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9005497251374313}, "hist_stats": {"episode_reward": [-3.847954281302846, -3.960904018904184, -4.010760275438022, -3.8131464296442035, -3.9687705846490005, -3.905404079895357, -3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8196721790628223, "mean_inference_ms": 8.323721748287197, "mean_action_processing_ms": 0.4192151795572997, "mean_env_wait_ms": 10.00337483471881, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1488588, "agent_timesteps_total": 1488588, "timers": {"sample_time_ms": 41709.612, "sample_throughput": 287.847, "load_time_ms": 7.236, "load_throughput": 1659197.625, "learn_time_ms": 36816.975, "learn_throughput": 326.1, "update_time_ms": 30.175}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003996888641268015, "policy_loss": 0.0006252251914702356, "vf_loss": 0.0033716633915901184, "vf_explained_var": 0.0037781186401844025, "kl": 2.045404734474232e-09, "entropy": 2.721139430999756, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1488588, "num_agent_steps_sampled": 1488588, "num_steps_trained": 1488588, "num_agent_steps_trained": 1488588}, "done": false, "episodes_total": 744, "training_iteration": 124, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-05-22", "timestamp": 1690848322, "time_this_iter_s": 77.86313128471375, "time_total_s": 10279.64491033554, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10279.64491033554, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 99.98108108108107, "ram_util_percent": 55.35135135135134}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7569122687586765, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.9203337481683116, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8470492431258816, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.0732845050424378, "reward_component_totals/delta_v_min": -2.1362104843556873, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.32845050424297, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 213.621048435568, "constraint_violation.max_vel_constraint.steps_mean": 1082.28, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5408695652173914, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.9813399082896943, -3.9314524945837057, -3.853255886050228, -3.920442233207768, -4.0520021313477255, -3.947527097226562, -3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.819238680357988, "mean_inference_ms": 8.321273799230886, "mean_action_processing_ms": 0.41903199092694876, "mean_env_wait_ms": 9.998119341457462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1500594, "agent_timesteps_total": 1500594, "timers": {"sample_time_ms": 41636.503, "sample_throughput": 288.353, "load_time_ms": 7.361, "load_throughput": 1630968.791, "learn_time_ms": 36826.794, "learn_throughput": 326.013, "update_time_ms": 29.323}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0028584932442754507, "policy_loss": -0.0003810992348007858, "vf_loss": 0.003239591373130679, "vf_explained_var": 0.019629869610071182, "kl": 3.4899561018875147e-09, "entropy": 2.717787504196167, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1500594, "num_agent_steps_sampled": 1500594, "num_steps_trained": 1500594, "num_agent_steps_trained": 1500594}, "done": false, "episodes_total": 750, "training_iteration": 125, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-06-40", "timestamp": 1690848400, "time_this_iter_s": 78.45472383499146, "time_total_s": 10358.099634170532, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10358.099634170532, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 99.98230088495575, "ram_util_percent": 55.39557522123893}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.731268253025723, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.916911320318695, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8431159370575542, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.073795383261148, "reward_component_totals/delta_v_min": -2.1362104843556873, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.37953832611402, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 213.621048435568, "constraint_violation.max_vel_constraint.steps_mean": 1062.07, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5307696151924037, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.890926846469454, -3.988414329214754, -3.8505283006484206, -3.9369771364249937, -3.9073131175140636, -4.004205564867226, -3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.818887972410805, "mean_inference_ms": 8.318950579961662, "mean_action_processing_ms": 0.4188675730644119, "mean_env_wait_ms": 9.993162671830914, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1512600, "agent_timesteps_total": 1512600, "timers": {"sample_time_ms": 41615.125, "sample_throughput": 288.501, "load_time_ms": 7.195, "load_throughput": 1668615.512, "learn_time_ms": 36939.387, "learn_throughput": 325.019, "update_time_ms": 26.466}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002406834624707699, "policy_loss": -0.0006043610628694296, "vf_loss": 0.0030111961532384157, "vf_explained_var": 0.010000014677643776, "kl": -2.0879651341232375e-09, "entropy": 2.771667718887329, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1512600, "num_agent_steps_sampled": 1512600, "num_steps_trained": 1512600, "num_agent_steps_trained": 1512600}, "done": false, "episodes_total": 756, "training_iteration": 126, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-08-00", "timestamp": 1690848480, "time_this_iter_s": 79.16621041297913, "time_total_s": 10437.265844583511, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10437.265844583511, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 99.98584070796461, "ram_util_percent": 55.374336283185826}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.731268253025723, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.9160377990830764, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8420587087798965, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.0739790903031867, "reward_component_totals/delta_v_min": -2.1362104843556873, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.3979090303179, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 213.621048435568, "constraint_violation.max_vel_constraint.steps_mean": 1055.2, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5273363318340829, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.978159175222034, -3.9278264201733686, -3.928082682259003, -3.817447772598465, -3.8257371634486264, -3.8109180897120414, -3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8178304772575118, "mean_inference_ms": 8.316999525667397, "mean_action_processing_ms": 0.4187044775400494, "mean_env_wait_ms": 9.988313265326397, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1524606, "agent_timesteps_total": 1524606, "timers": {"sample_time_ms": 41633.533, "sample_throughput": 288.373, "load_time_ms": 7.16, "load_throughput": 1676877.993, "learn_time_ms": 36992.944, "learn_throughput": 324.548, "update_time_ms": 25.53}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0037286134902387857, "policy_loss": 0.0006534873973578215, "vf_loss": 0.0030751272570341825, "vf_explained_var": 0.07661215215921402, "kl": -1.096557178392743e-09, "entropy": 2.7493040561676025, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1524606, "num_agent_steps_sampled": 1524606, "num_steps_trained": 1524606, "num_agent_steps_trained": 1524606}, "done": false, "episodes_total": 762, "training_iteration": 127, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-09-17", "timestamp": 1690848557, "time_this_iter_s": 77.26308727264404, "time_total_s": 10514.528931856155, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10514.528931856155, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 99.98636363636365, "ram_util_percent": 55.37454545454542}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.731268253025723, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.9169621142804356, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8413519445493586, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.709223605573379, "reward_component_totals/delta_v_mean": -2.0756101697310845, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0050315017998264, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.56101697310768, "delta_v_total_min": 200.50315017998216, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1055.49, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.527481259370315, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.9958185849826267, -3.9352187875047973, -3.7723583826154368, -4.0406037378632025, -3.840978506614726, -3.957879979096721, -3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8167326449434007, "mean_inference_ms": 8.31520831787465, "mean_action_processing_ms": 0.4185476043635037, "mean_env_wait_ms": 9.983585207202855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1536612, "agent_timesteps_total": 1536612, "timers": {"sample_time_ms": 41931.987, "sample_throughput": 286.321, "load_time_ms": 6.964, "load_throughput": 1724017.044, "learn_time_ms": 37165.652, "learn_throughput": 323.04, "update_time_ms": 23.128}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0041971090249717236, "policy_loss": 0.0009588190005160868, "vf_loss": 0.0032382907811552286, "vf_explained_var": -0.02774864062666893, "kl": 1.5346793835746553e-09, "entropy": 2.7203900814056396, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1536612, "num_agent_steps_sampled": 1536612, "num_steps_trained": 1536612, "num_agent_steps_trained": 1536612}, "done": false, "episodes_total": 768, "training_iteration": 128, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-10-38", "timestamp": 1690848638, "time_this_iter_s": 80.41282629966736, "time_total_s": 10594.941758155823, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10594.941758155823, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 99.98434782608695, "ram_util_percent": 55.341739130434775}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.9133212143402485, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8380396942596853, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.0752815200805705, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.52815200805628, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1049.96, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1932, "constraint_violation.max_vel_constraint.ratio_mean": 0.5247176411794103, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9655172413793104}, "hist_stats": {"episode_reward": [-3.8412762378343226, -3.8731838144820765, -3.9286196236783377, -3.9362082588011216, -3.9626896056292638, -3.944102422761588, -3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.815638951772627, "mean_inference_ms": 8.313236267919066, "mean_action_processing_ms": 0.4183795610318885, "mean_env_wait_ms": 9.978612851851508, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1548618, "agent_timesteps_total": 1548618, "timers": {"sample_time_ms": 42017.421, "sample_throughput": 285.739, "load_time_ms": 6.865, "load_throughput": 1748761.58, "learn_time_ms": 37129.22, "learn_throughput": 323.357, "update_time_ms": 22.782}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0023394054733216763, "policy_loss": -0.0008088505710475147, "vf_loss": 0.0031482551712542772, "vf_explained_var": 0.008568995632231236, "kl": -2.606201032762101e-09, "entropy": 2.7620091438293457, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1548618, "num_agent_steps_sampled": 1548618, "num_steps_trained": 1548618, "num_agent_steps_trained": 1548618}, "done": false, "episodes_total": 774, "training_iteration": 129, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-11-56", "timestamp": 1690848716, "time_this_iter_s": 77.43138408660889, "time_total_s": 10672.373142242432, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10672.373142242432, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 99.98454545454545, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.913951795051018, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.839194608405753, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.0747571866452734, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.47571866452654, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1051.81, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1932, "constraint_violation.max_vel_constraint.ratio_mean": 0.5256421789105448, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9655172413793104}, "hist_stats": {"episode_reward": [-3.8708411153273152, -3.8213071192839965, -3.7906680326387887, -3.8536235290679417, -3.884113874543143, -3.94558904394703, -3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.814535098737291, "mean_inference_ms": 8.311127944733366, "mean_action_processing_ms": 0.4182232841337958, "mean_env_wait_ms": 9.973544044479276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1560624, "agent_timesteps_total": 1560624, "timers": {"sample_time_ms": 41940.059, "sample_throughput": 286.266, "load_time_ms": 7.134, "load_throughput": 1682829.238, "learn_time_ms": 37418.488, "learn_throughput": 320.857, "update_time_ms": 21.677}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0031887644436210394, "policy_loss": 0.00010558145731920376, "vf_loss": 0.0030831824988126755, "vf_explained_var": -0.028508063405752182, "kl": 4.67664129644163e-09, "entropy": 2.7549402713775635, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1560624, "num_agent_steps_sampled": 1560624, "num_steps_trained": 1560624, "num_agent_steps_trained": 1560624}, "done": false, "episodes_total": 780, "training_iteration": 130, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-13-14", "timestamp": 1690848794, "time_this_iter_s": 78.58884882926941, "time_total_s": 10750.961991071701, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10750.961991071701, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 99.98571428571428, "ram_util_percent": 55.330357142857125}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.9155865917002672, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8409731602430895, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.074613431457186, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.46134314571776, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1043.14, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1932, "constraint_violation.max_vel_constraint.ratio_mean": 0.5213093453273363, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9655172413793104}, "hist_stats": {"episode_reward": [-3.9808244882951964, -3.8744259918107335, -3.96317964683126, -3.9015414991802224, -3.919553601225645, -3.837781782365954, -3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.814112848790539, "mean_inference_ms": 8.308874874275466, "mean_action_processing_ms": 0.4180714813109314, "mean_env_wait_ms": 9.968530112438573, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1572630, "agent_timesteps_total": 1572630, "timers": {"sample_time_ms": 42198.988, "sample_throughput": 284.509, "load_time_ms": 7.044, "load_throughput": 1704549.154, "learn_time_ms": 37617.821, "learn_throughput": 319.157, "update_time_ms": 23.54}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003349647158756852, "policy_loss": 0.00038052810123190284, "vf_loss": 0.0029691187664866447, "vf_explained_var": -0.005497238133102655, "kl": -3.998177788844259e-09, "entropy": 2.7955551147460938, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1572630, "num_agent_steps_sampled": 1572630, "num_steps_trained": 1572630, "num_agent_steps_trained": 1572630}, "done": false, "episodes_total": 786, "training_iteration": 131, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-14-49", "timestamp": 1690848889, "time_this_iter_s": 94.6751594543457, "time_total_s": 10845.637150526047, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10845.637150526047, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 99.98592592592591, "ram_util_percent": 55.3288888888889}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.096704849112463, "episode_reward_mean": -3.914405298518586, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.840162583244296, "reward_component_totals/dist_change_reward_min": -0.9993330069963399, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.074242715274298, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.42427152742906, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1039.86, "constraint_violation.max_vel_constraint.steps_min": 405, "constraint_violation.max_vel_constraint.steps_max": 1932, "constraint_violation.max_vel_constraint.ratio_mean": 0.5196701649175413, "constraint_violation.max_vel_constraint.ratio_min": 0.20239880059970014, "constraint_violation.max_vel_constraint.ratio_max": 0.9655172413793104}, "hist_stats": {"episode_reward": [-3.9286303107896456, -4.023480767446436, -3.9206327931479974, -3.938003939018441, -4.000377342700579, -4.096704849112463, -3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8136676566369767, "mean_inference_ms": 8.306643191681713, "mean_action_processing_ms": 0.4179212745958957, "mean_env_wait_ms": 9.96350361142502, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1584636, "agent_timesteps_total": 1584636, "timers": {"sample_time_ms": 42423.948, "sample_throughput": 283.001, "load_time_ms": 6.7, "load_throughput": 1792063.809, "learn_time_ms": 37666.064, "learn_throughput": 318.748, "update_time_ms": 25.033}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004569161683320999, "policy_loss": 0.0012582250637933612, "vf_loss": 0.003310935106128454, "vf_explained_var": -0.01654050126671791, "kl": -1.5772398942459631e-09, "entropy": 2.751915454864502, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1584636, "num_agent_steps_sampled": 1584636, "num_steps_trained": 1584636, "num_agent_steps_trained": 1584636}, "done": false, "episodes_total": 792, "training_iteration": 132, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-16-09", "timestamp": 1690848969, "time_this_iter_s": 79.1281566619873, "time_total_s": 10924.765307188034, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10924.765307188034, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 99.98407079646019, "ram_util_percent": 55.3088495575221}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.092746657412734, "episode_reward_mean": -3.9119373449777117, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8377335334553908, "reward_component_totals/dist_change_reward_min": -0.9952008023267082, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.074203811522329, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.42038115223207, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1046.4, "constraint_violation.max_vel_constraint.steps_min": 405, "constraint_violation.max_vel_constraint.steps_max": 1932, "constraint_violation.max_vel_constraint.ratio_mean": 0.5229385307346326, "constraint_violation.max_vel_constraint.ratio_min": 0.20239880059970014, "constraint_violation.max_vel_constraint.ratio_max": 0.9655172413793104}, "hist_stats": {"episode_reward": [-3.7773070940675275, -3.803294559589894, -4.038365582921243, -4.026683174926644, -3.989166858485718, -4.012320890561575, -3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8132217793047434, "mean_inference_ms": 8.304363229663855, "mean_action_processing_ms": 0.4177767879507983, "mean_env_wait_ms": 9.958465228011827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1596642, "agent_timesteps_total": 1596642, "timers": {"sample_time_ms": 42266.07, "sample_throughput": 284.058, "load_time_ms": 6.0, "load_throughput": 2001049.617, "learn_time_ms": 37680.696, "learn_throughput": 318.625, "update_time_ms": 24.967}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003103064838796854, "policy_loss": 1.263714580090891e-06, "vf_loss": 0.0031018045265227556, "vf_explained_var": 0.018207186833024025, "kl": 4.0307240878334483e-10, "entropy": 2.7160680294036865, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1596642, "num_agent_steps_sampled": 1596642, "num_steps_trained": 1596642, "num_agent_steps_trained": 1596642}, "done": false, "episodes_total": 798, "training_iteration": 133, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-17-27", "timestamp": 1690849047, "time_this_iter_s": 77.95348334312439, "time_total_s": 11002.718790531158, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11002.718790531158, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 99.98392857142856, "ram_util_percent": 55.38839285714284}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.092746657412734, "episode_reward_mean": -3.910694380090601, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8354160802324319, "reward_component_totals/dist_change_reward_min": -0.9952008023267082, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.075278299858177, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.52782998581682, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1037.74, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1932, "constraint_violation.max_vel_constraint.ratio_mean": 0.5186106946526736, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9655172413793104}, "hist_stats": {"episode_reward": [-3.8808966126467297, -3.9479868909366793, -3.875659209205564, -3.960437423341541, -3.970667445837161, -3.968492706683109, -3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8127755935727523, "mean_inference_ms": 8.302058739665515, "mean_action_processing_ms": 0.41764214774363945, "mean_env_wait_ms": 9.95352432405542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1608648, "agent_timesteps_total": 1608648, "timers": {"sample_time_ms": 42303.967, "sample_throughput": 283.803, "load_time_ms": 5.997, "load_throughput": 2001988.352, "learn_time_ms": 37564.241, "learn_throughput": 319.612, "update_time_ms": 27.445}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0035378981847316027, "policy_loss": 0.0003671223239507526, "vf_loss": 0.0031707752496004105, "vf_explained_var": 0.05361075699329376, "kl": 2.4900360884316797e-08, "entropy": 2.6849024295806885, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1608648, "num_agent_steps_sampled": 1608648, "num_steps_trained": 1608648, "num_agent_steps_trained": 1608648}, "done": false, "episodes_total": 804, "training_iteration": 134, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-18-44", "timestamp": 1690849124, "time_this_iter_s": 77.11622977256775, "time_total_s": 11079.835020303726, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11079.835020303726, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 99.9809090909091, "ram_util_percent": 55.39636363636361}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.912113274505316, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8372150959080281, "reward_component_totals/dist_change_reward_min": -0.9952008023267082, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.074898178597295, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.48981785972873, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1027.13, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1932, "constraint_violation.max_vel_constraint.ratio_mean": 0.5133083458270864, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9655172413793104}, "hist_stats": {"episode_reward": [-3.8301759783073397, -4.053419638375159, -3.850716085175989, -3.828775161865657, -4.08282867872765, -3.8616792819088492, -3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8123826095329898, "mean_inference_ms": 8.300043689018327, "mean_action_processing_ms": 0.41750235075510667, "mean_env_wait_ms": 9.94862180888238, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1620654, "agent_timesteps_total": 1620654, "timers": {"sample_time_ms": 42457.482, "sample_throughput": 282.777, "load_time_ms": 5.884, "load_throughput": 2040480.484, "learn_time_ms": 37373.75, "learn_throughput": 321.242, "update_time_ms": 27.664}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004179519601166248, "policy_loss": 0.0008726558298803866, "vf_loss": 0.0033068633638322353, "vf_explained_var": 0.013740243390202522, "kl": -2.1255184279311834e-09, "entropy": 2.7873587608337402, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1620654, "num_agent_steps_sampled": 1620654, "num_steps_trained": 1620654, "num_agent_steps_trained": 1620654}, "done": false, "episodes_total": 810, "training_iteration": 135, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-20-02", "timestamp": 1690849202, "time_this_iter_s": 78.02996182441711, "time_total_s": 11157.864982128143, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11157.864982128143, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 99.98108108108107, "ram_util_percent": 55.381981981981944}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.9139553114246537, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8380503099169567, "reward_component_totals/dist_change_reward_min": -0.9939979006736959, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.0759050015077034, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.59050015076957, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1021.78, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5106346826586706, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.9977764273813827, -3.876344580853919, -3.934530538639787, -3.940985648302484, -3.824978440678322, -3.9564003564572063, -4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.812008630282267, "mean_inference_ms": 8.297999789219881, "mean_action_processing_ms": 0.41736503881626547, "mean_env_wait_ms": 9.943792565247039, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1632660, "agent_timesteps_total": 1632660, "timers": {"sample_time_ms": 42337.798, "sample_throughput": 283.576, "load_time_ms": 6.028, "load_throughput": 1991545.041, "learn_time_ms": 37369.016, "learn_throughput": 321.282, "update_time_ms": 27.748}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003594575682654977, "policy_loss": 0.0004528727731667459, "vf_loss": 0.003141702152788639, "vf_explained_var": 0.08347094058990479, "kl": 4.073284376460151e-09, "entropy": 2.7583227157592773, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1632660, "num_agent_steps_sampled": 1632660, "num_steps_trained": 1632660, "num_agent_steps_trained": 1632660}, "done": false, "episodes_total": 816, "training_iteration": 136, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-21-20", "timestamp": 1690849280, "time_this_iter_s": 77.92064118385315, "time_total_s": 11235.785623311996, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11235.785623311996, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 99.97857142857143, "ram_util_percent": 55.400892857142836}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.9119051117748684, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8352845151961533, "reward_component_totals/dist_change_reward_min": -0.9939979006736959, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.0766205965787212, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.66205965787137, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1013.06, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5062768615692156, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-4.034890421604556, -4.092746657412734, -3.84136473563284, -3.9634531470686, -3.843123391943969, -4.066609786725857, -3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8109154432756807, "mean_inference_ms": 8.296056437032199, "mean_action_processing_ms": 0.4172181056089086, "mean_env_wait_ms": 9.93899935288884, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1644666, "agent_timesteps_total": 1644666, "timers": {"sample_time_ms": 42437.425, "sample_throughput": 282.911, "load_time_ms": 5.902, "load_throughput": 2034248.877, "learn_time_ms": 37381.374, "learn_throughput": 321.176, "update_time_ms": 28.713}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0021935252007097006, "policy_loss": -0.0006666783010587096, "vf_loss": 0.00286020222119987, "vf_explained_var": -0.013061493635177612, "kl": 7.585772565654736e-10, "entropy": 2.759789228439331, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1644666, "num_agent_steps_sampled": 1644666, "num_steps_trained": 1644666, "num_agent_steps_trained": 1644666}, "done": false, "episodes_total": 822, "training_iteration": 137, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-22-39", "timestamp": 1690849359, "time_this_iter_s": 78.39939951896667, "time_total_s": 11314.185022830963, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11314.185022830963, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 99.98181818181818, "ram_util_percent": 55.33909090909091}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.908137751114792, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8323413439203597, "reward_component_totals/dist_change_reward_min": -0.9939979006736959, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.075796407194439, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.57964071944315, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1004.42, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5019590204897552, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.88973370937496, -3.9779758966433794, -3.7654457724158172, -3.799099909778601, -3.9141763727180314, -4.027549066709612, -3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8098845105547638, "mean_inference_ms": 8.294218083629518, "mean_action_processing_ms": 0.4170929541165438, "mean_env_wait_ms": 9.934537780150071, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1656672, "agent_timesteps_total": 1656672, "timers": {"sample_time_ms": 42473.509, "sample_throughput": 282.67, "load_time_ms": 6.947, "load_throughput": 1728111.168, "learn_time_ms": 37604.837, "learn_throughput": 319.267, "update_time_ms": 28.691}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002790942322462797, "policy_loss": -0.0002610454976093024, "vf_loss": 0.0030519862193614244, "vf_explained_var": 0.0940275639295578, "kl": 4.456328639435014e-09, "entropy": 2.711890935897827, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1656672, "num_agent_steps_sampled": 1656672, "num_steps_trained": 1656672, "num_agent_steps_trained": 1656672}, "done": false, "episodes_total": 828, "training_iteration": 138, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-24-02", "timestamp": 1690849442, "time_this_iter_s": 82.96140027046204, "time_total_s": 11397.146423101425, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11397.146423101425, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 99.9831932773109, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.9107626167718545, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8340816377663625, "reward_component_totals/dist_change_reward_min": -0.9939979006736959, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.0766809790054994, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6680979005492, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1033.24, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5163618190904548, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.963397487465733, -3.837993241890696, -3.9131201185263302, -3.8735976435211303, -3.7569122687586765, -4.009424562647402, -3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8088699507600732, "mean_inference_ms": 8.292541065448814, "mean_action_processing_ms": 0.4169850494902527, "mean_env_wait_ms": 9.930424064775147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1668678, "agent_timesteps_total": 1668678, "timers": {"sample_time_ms": 42472.554, "sample_throughput": 282.677, "load_time_ms": 7.036, "load_throughput": 1706449.534, "learn_time_ms": 37826.066, "learn_throughput": 317.4, "update_time_ms": 29.799}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0034038370940834284, "policy_loss": 0.0004039729537907988, "vf_loss": 0.0029998652171343565, "vf_explained_var": 0.04883768782019615, "kl": -2.0579224990768807e-09, "entropy": 2.756507396697998, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1668678, "num_agent_steps_sampled": 1668678, "num_steps_trained": 1668678, "num_agent_steps_trained": 1668678}, "done": false, "episodes_total": 834, "training_iteration": 139, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-25-22", "timestamp": 1690849522, "time_this_iter_s": 79.62698316574097, "time_total_s": 11476.773406267166, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11476.773406267166, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 99.98070175438598, "ram_util_percent": 55.29999999999999}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.278454380790834, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.9101114267073376, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.834646908463769, "reward_component_totals/dist_change_reward_min": -0.9939979006736959, "reward_component_totals/dist_change_reward_max": -0.21440189605995263, "reward_component_totals/delta_v_mean": -2.0754645182435745, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.54645182435678, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1042.35, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5209145427286357, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.9365651429136266, -3.959269571676666, -3.9349550049775486, -3.848725602574123, -3.9434965960810517, -3.914351261988986, -3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.807870882556404, "mean_inference_ms": 8.290935350364064, "mean_action_processing_ms": 0.4168804923182595, "mean_env_wait_ms": 9.92623594342946, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1680684, "agent_timesteps_total": 1680684, "timers": {"sample_time_ms": 42520.409, "sample_throughput": 282.359, "load_time_ms": 6.991, "load_throughput": 1717437.521, "learn_time_ms": 37647.434, "learn_throughput": 318.906, "update_time_ms": 30.174}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0034445326309651136, "policy_loss": 0.00040707786683924496, "vf_loss": 0.0030374545603990555, "vf_explained_var": 0.0389108881354332, "kl": -2.1805965921828374e-09, "entropy": 2.6897826194763184, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1680684, "num_agent_steps_sampled": 1680684, "num_steps_trained": 1680684, "num_agent_steps_trained": 1680684}, "done": false, "episodes_total": 840, "training_iteration": 140, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-26-39", "timestamp": 1690849599, "time_this_iter_s": 77.32009625434875, "time_total_s": 11554.093502521515, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11554.093502521515, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 99.98727272727272, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.906504045815978, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8297374430042666, "reward_component_totals/dist_change_reward_min": -0.9939979006736959, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.0767666028117175, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0203944022456883, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.67666028117102, "delta_v_total_min": 202.0394402245671, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1055.09, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5272813593203398, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.8708908062272545, -3.8066595001343884, -3.935472732892074, -3.8897111227942576, -3.9097168628034034, -3.731268253025723, -3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.80753239658128, "mean_inference_ms": 8.289090659097473, "mean_action_processing_ms": 0.4167811530809811, "mean_env_wait_ms": 9.92228431053798, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1692690, "agent_timesteps_total": 1692690, "timers": {"sample_time_ms": 42361.404, "sample_throughput": 283.418, "load_time_ms": 7.329, "load_throughput": 1638227.305, "learn_time_ms": 37608.926, "learn_throughput": 319.233, "update_time_ms": 29.035}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003940402064472437, "policy_loss": 0.0006045909249223769, "vf_loss": 0.0033358081709593534, "vf_explained_var": 0.05695963278412819, "kl": 1.1265999244614022e-09, "entropy": 2.776583194732666, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1692690, "num_agent_steps_sampled": 1692690, "num_steps_trained": 1692690, "num_agent_steps_trained": 1692690}, "done": false, "episodes_total": 846, "training_iteration": 141, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-28-12", "timestamp": 1690849692, "time_this_iter_s": 92.65089583396912, "time_total_s": 11646.744398355484, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11646.744398355484, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 99.98484848484848, "ram_util_percent": 55.30000000000001}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.9121683153408884, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8354471795169665, "reward_component_totals/dist_change_reward_min": -0.9939979006736959, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.076721135823929, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.67211358239211, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1070.76, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.535112443778111, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.9846586745730797, -4.058253998373713, -3.8072886804916033, -3.852590496476443, -3.9460640728807377, -3.918787974409363, -3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8071781090656274, "mean_inference_ms": 8.287219396158859, "mean_action_processing_ms": 0.4166707596113355, "mean_env_wait_ms": 9.918153683639595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1704696, "agent_timesteps_total": 1704696, "timers": {"sample_time_ms": 42308.543, "sample_throughput": 283.772, "load_time_ms": 7.349, "load_throughput": 1633593.088, "learn_time_ms": 37974.599, "learn_throughput": 316.159, "update_time_ms": 31.255}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0019493148429319263, "policy_loss": -0.0010554312029853463, "vf_loss": 0.0030047467444092035, "vf_explained_var": 0.009914282709360123, "kl": 4.231008432498129e-09, "entropy": 2.748825788497925, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1704696, "num_agent_steps_sampled": 1704696, "num_steps_trained": 1704696, "num_agent_steps_trained": 1704696}, "done": false, "episodes_total": 852, "training_iteration": 142, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-29-35", "timestamp": 1690849775, "time_this_iter_s": 82.333655834198, "time_total_s": 11729.078054189682, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11729.078054189682, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 99.98389830508476, "ram_util_percent": 55.3}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.9108920669436884, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8347914136862209, "reward_component_totals/dist_change_reward_min": -0.9939979006736959, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.076100653257473, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.61006532574658, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1075.17, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5373163418290854, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.951533197232032, -3.9407204934561104, -3.958828645527282, -3.7750787880715, -3.811019358343395, -3.9692906678223023, -3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8067844253805605, "mean_inference_ms": 8.28557733107664, "mean_action_processing_ms": 0.41655191398948, "mean_env_wait_ms": 9.913978097110567, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1716702, "agent_timesteps_total": 1716702, "timers": {"sample_time_ms": 42362.131, "sample_throughput": 283.414, "load_time_ms": 7.514, "load_throughput": 1597903.613, "learn_time_ms": 38154.116, "learn_throughput": 314.671, "update_time_ms": 31.361}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0017999891424551606, "policy_loss": -0.0012542122276499867, "vf_loss": 0.0030542018357664347, "vf_explained_var": 0.027712658047676086, "kl": -3.8404537328062816e-09, "entropy": 2.784425735473633, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1716702, "num_agent_steps_sampled": 1716702, "num_steps_trained": 1716702, "num_agent_steps_trained": 1716702}, "done": false, "episodes_total": 858, "training_iteration": 143, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-30-55", "timestamp": 1690849855, "time_this_iter_s": 80.29223847389221, "time_total_s": 11809.370292663574, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11809.370292663574, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 99.98521739130435, "ram_util_percent": 55.3878260869565}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.913138335004238, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8366983098037938, "reward_component_totals/dist_change_reward_min": -0.9939979006736959, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.0764400252004496, "reward_component_totals/delta_v_min": -2.148625065535309, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.64400252004427, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 214.8625065535304, "constraint_violation.max_vel_constraint.steps_mean": 1085.51, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5424837581209395, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.9106244217403856, -3.8581210342723606, -3.8716362178292165, -3.959911123141845, -3.932808647338994, -4.02236263819102, -3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.806390499136761, "mean_inference_ms": 8.283843800777088, "mean_action_processing_ms": 0.4164238755914652, "mean_env_wait_ms": 9.909730710609102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1728708, "agent_timesteps_total": 1728708, "timers": {"sample_time_ms": 42383.474, "sample_throughput": 283.271, "load_time_ms": 7.874, "load_throughput": 1524693.477, "learn_time_ms": 38371.974, "learn_throughput": 312.885, "update_time_ms": 27.942}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0013006057124584913, "policy_loss": -0.001522966893389821, "vf_loss": 0.002823570976033807, "vf_explained_var": 0.01698237843811512, "kl": -4.0883056939833295e-09, "entropy": 2.7755980491638184, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1728708, "num_agent_steps_sampled": 1728708, "num_steps_trained": 1728708, "num_agent_steps_trained": 1728708}, "done": false, "episodes_total": 864, "training_iteration": 144, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-32-15", "timestamp": 1690849935, "time_this_iter_s": 79.45498967170715, "time_total_s": 11888.825282335281, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11888.825282335281, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 99.98125, "ram_util_percent": 55.399999999999984}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.911355241691083, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8353960550909362, "reward_component_totals/dist_change_reward_min": -0.9939979006736959, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.0759591866001523, "reward_component_totals/delta_v_min": -2.13339732641975, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.59591866001446, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.3397326419744, "constraint_violation.max_vel_constraint.steps_mean": 1081.35, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5404047976011994, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-3.999626477116342, -3.938074189927171, -3.278454380790834, -4.0074416512943865, -4.065485602235763, -3.969467778841632, -4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8060119967699177, "mean_inference_ms": 8.281902404089234, "mean_action_processing_ms": 0.41630380767560426, "mean_env_wait_ms": 9.905600968013488, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1740714, "agent_timesteps_total": 1740714, "timers": {"sample_time_ms": 42176.044, "sample_throughput": 284.664, "load_time_ms": 8.006, "load_throughput": 1499638.582, "learn_time_ms": 38593.211, "learn_throughput": 311.091, "update_time_ms": 26.768}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.004038503859192133, "policy_loss": 0.001015805290080607, "vf_loss": 0.0030226977542042732, "vf_explained_var": 0.023068668320775032, "kl": -2.98173441493077e-09, "entropy": 2.753178834915161, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1740714, "num_agent_steps_sampled": 1740714, "num_steps_trained": 1740714, "num_agent_steps_trained": 1740714}, "done": false, "episodes_total": 870, "training_iteration": 145, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-33-33", "timestamp": 1690850013, "time_this_iter_s": 78.16335320472717, "time_total_s": 11966.988635540009, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11966.988635540009, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 99.98198198198199, "ram_util_percent": 55.44684684684685}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.9137387791328404, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.837780298252682, "reward_component_totals/dist_change_reward_min": -0.9939979006736959, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.075958480880165, "reward_component_totals/delta_v_min": -2.13339732641975, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.59584808801574, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.3397326419744, "constraint_violation.max_vel_constraint.steps_mean": 1095.29, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5473713143428286, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-4.010901190901624, -3.816741186893261, -3.766376686807992, -3.9201655885835383, -3.8510725172089004, -3.807000197720195, -4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8056274929746952, "mean_inference_ms": 8.279950632950474, "mean_action_processing_ms": 0.4161809814676935, "mean_env_wait_ms": 9.901409261421392, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1752720, "agent_timesteps_total": 1752720, "timers": {"sample_time_ms": 42138.862, "sample_throughput": 284.915, "load_time_ms": 8.041, "load_throughput": 1493057.963, "learn_time_ms": 38760.513, "learn_throughput": 309.748, "update_time_ms": 25.879}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003332559484988451, "policy_loss": 0.00026007380802184343, "vf_loss": 0.003072486026212573, "vf_explained_var": -0.016752159222960472, "kl": -2.954195332804943e-09, "entropy": 2.752709150314331, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1752720, "num_agent_steps_sampled": 1752720, "num_steps_trained": 1752720, "num_agent_steps_trained": 1752720}, "done": false, "episodes_total": 876, "training_iteration": 146, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-34-53", "timestamp": 1690850093, "time_this_iter_s": 79.19869327545166, "time_total_s": 12046.18732881546, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12046.18732881546, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 99.9780701754386, "ram_util_percent": 55.42982456140349}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.9206202952119917, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.844039347940012, "reward_component_totals/dist_change_reward_min": -0.9967921926091939, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.0765809472719865, "reward_component_totals/delta_v_min": -2.13339732641975, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.65809472719792, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.3397326419744, "constraint_violation.max_vel_constraint.steps_mean": 1110.54, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5549925037481259, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-4.009829070124067, -4.029522076089017, -3.770261020261642, -3.8619374983293104, -3.8661567210232306, -3.9615073779004923, -3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8046040087633242, "mean_inference_ms": 8.278112491903583, "mean_action_processing_ms": 0.41604005235189156, "mean_env_wait_ms": 9.897244039456936, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1764726, "agent_timesteps_total": 1764726, "timers": {"sample_time_ms": 42048.236, "sample_throughput": 285.529, "load_time_ms": 8.294, "load_throughput": 1447496.581, "learn_time_ms": 38792.556, "learn_throughput": 309.492, "update_time_ms": 26.669}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0036857561208307743, "policy_loss": 0.000703732599504292, "vf_loss": 0.002982024336233735, "vf_explained_var": -0.00016761402366682887, "kl": -6.058603618797065e-10, "entropy": 2.782731533050537, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1764726, "num_agent_steps_sampled": 1764726, "num_steps_trained": 1764726, "num_agent_steps_trained": 1764726}, "done": false, "episodes_total": 882, "training_iteration": 147, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-36-11", "timestamp": 1690850171, "time_this_iter_s": 77.82083988189697, "time_total_s": 12124.008168697357, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12124.008168697357, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 99.98198198198199, "ram_util_percent": 55.39999999999996}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.9189916266820704, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8427025304125639, "reward_component_totals/dist_change_reward_min": -0.9967921926091939, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.076289096269511, "reward_component_totals/delta_v_min": -2.13339732641975, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.62890962695042, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.3397326419744, "constraint_violation.max_vel_constraint.steps_mean": 1105.86, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5526536731634182, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-3.8281626864211793, -3.9338439356564097, -3.94721081647549, -3.822296154064076, -3.873416184271766, -3.9705116862359415, -4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8035502109909276, "mean_inference_ms": 8.276127374737081, "mean_action_processing_ms": 0.4159048323090789, "mean_env_wait_ms": 9.892969775167634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1776732, "agent_timesteps_total": 1776732, "timers": {"sample_time_ms": 41524.482, "sample_throughput": 289.131, "load_time_ms": 7.207, "load_throughput": 1665932.691, "learn_time_ms": 38912.647, "learn_throughput": 308.537, "update_time_ms": 28.221}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.001043825875967741, "policy_loss": -0.0020764977671205997, "vf_loss": 0.0031203252729028463, "vf_explained_var": 0.06298502534627914, "kl": 2.871577864382857e-09, "entropy": 2.7110719680786133, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1776732, "num_agent_steps_sampled": 1776732, "num_steps_trained": 1776732, "num_agent_steps_trained": 1776732}, "done": false, "episodes_total": 888, "training_iteration": 148, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-37-30", "timestamp": 1690850250, "time_this_iter_s": 78.96389436721802, "time_total_s": 12202.972063064575, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12202.972063064575, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 99.98230088495575, "ram_util_percent": 55.423893805309724}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.9223116108904152, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8463151565303302, "reward_component_totals/dist_change_reward_min": -0.9967921926091939, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.0759964543600913, "reward_component_totals/delta_v_min": -2.13339732641975, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.59964543600836, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.3397326419744, "constraint_violation.max_vel_constraint.steps_mean": 1114.21, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5568265867066466, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-4.0593319924226385, -4.042556407166705, -3.9664624436814195, -3.7487559343496306, -4.060459105063425, -3.8680643564248234, -3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8025131577794034, "mean_inference_ms": 8.274236808161634, "mean_action_processing_ms": 0.4157940567937306, "mean_env_wait_ms": 9.889100865278692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1788738, "agent_timesteps_total": 1788738, "timers": {"sample_time_ms": 41776.955, "sample_throughput": 287.383, "load_time_ms": 7.332, "load_throughput": 1637502.807, "learn_time_ms": 38775.189, "learn_throughput": 309.631, "update_time_ms": 28.17}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003590464359149337, "policy_loss": 0.00047220164560712874, "vf_loss": 0.003118263091892004, "vf_explained_var": 0.0003474284312687814, "kl": 8.099001469474842e-09, "entropy": 2.751477003097534, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1788738, "num_agent_steps_sampled": 1788738, "num_steps_trained": 1788738, "num_agent_steps_trained": 1788738}, "done": false, "episodes_total": 894, "training_iteration": 149, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-38-51", "timestamp": 1690850331, "time_this_iter_s": 80.75267958641052, "time_total_s": 12283.724742650986, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12283.724742650986, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 99.98173913043478, "ram_util_percent": 55.48434782608695}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.918549040025246, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8423581188865235, "reward_component_totals/dist_change_reward_min": -0.9967921926091939, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.0761909211387266, "reward_component_totals/delta_v_min": -2.13339732641975, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.61909211387191, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.3397326419744, "constraint_violation.max_vel_constraint.steps_mean": 1111.99, "constraint_violation.max_vel_constraint.steps_min": 234, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5557171414292854, "constraint_violation.max_vel_constraint.ratio_min": 0.11694152923538231, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.8730351817142026, -3.9648724102541175, -3.9636188545135496, -3.7927917638713944, -3.9154731211823277, -4.018241620010983, -3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8014763401521006, "mean_inference_ms": 8.272532924148118, "mean_action_processing_ms": 0.4156752024406971, "mean_env_wait_ms": 9.885319300420997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1800744, "agent_timesteps_total": 1800744, "timers": {"sample_time_ms": 41959.311, "sample_throughput": 286.134, "load_time_ms": 7.115, "load_throughput": 1687475.959, "learn_time_ms": 38912.467, "learn_throughput": 308.539, "update_time_ms": 28.975}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0033910723868757486, "policy_loss": 0.00020238420984242111, "vf_loss": 0.0031886869110167027, "vf_explained_var": 0.08400999754667282, "kl": -3.782872237678703e-09, "entropy": 2.768486976623535, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1800744, "num_agent_steps_sampled": 1800744, "num_steps_trained": 1800744, "num_agent_steps_trained": 1800744}, "done": false, "episodes_total": 900, "training_iteration": 150, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-40-12", "timestamp": 1690850412, "time_this_iter_s": 80.58370399475098, "time_total_s": 12364.308446645737, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12364.308446645737, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 99.98086956521739, "ram_util_percent": 55.402608695652155}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.115496719604263, "episode_reward_mean": -3.921528706488583, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8444493857781836, "reward_component_totals/dist_change_reward_min": -0.9967921926091939, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.077079320710404, "reward_component_totals/delta_v_min": -2.1302346552908444, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7079320710397, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.0234655290838, "constraint_violation.max_vel_constraint.steps_mean": 1108.62, "constraint_violation.max_vel_constraint.steps_min": 496, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5540329835082459, "constraint_violation.max_vel_constraint.ratio_min": 0.2478760619690155, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9922967003610603, -4.115496719604263, -3.8778215907631326, -3.826699978200523, -3.8815505501842202, -4.089780845188706, -3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.80114384471818, "mean_inference_ms": 8.27078116266904, "mean_action_processing_ms": 0.4155696262843096, "mean_env_wait_ms": 9.881996396478925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1812750, "agent_timesteps_total": 1812750, "timers": {"sample_time_ms": 42643.526, "sample_throughput": 281.543, "load_time_ms": 6.478, "load_throughput": 1853424.924, "learn_time_ms": 38720.538, "learn_throughput": 310.068, "update_time_ms": 28.27}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0038077151402831078, "policy_loss": 0.000535587256308645, "vf_loss": 0.0032721280585974455, "vf_explained_var": 0.013358617201447487, "kl": -6.386569495475669e-09, "entropy": 2.781398296356201, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1812750, "num_agent_steps_sampled": 1812750, "num_steps_trained": 1812750, "num_agent_steps_trained": 1812750}, "done": false, "episodes_total": 906, "training_iteration": 151, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-41-50", "timestamp": 1690850510, "time_this_iter_s": 97.60838508605957, "time_total_s": 12461.916831731796, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12461.916831731796, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 99.98642857142856, "ram_util_percent": 55.4542857142857}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.11007547373345, "episode_reward_mean": -3.9178462406275947, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8413735636237571, "reward_component_totals/dist_change_reward_min": -0.9967921926091939, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.0764726770038435, "reward_component_totals/delta_v_min": -2.1302346552908444, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.64726770038362, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.0234655290838, "constraint_violation.max_vel_constraint.steps_mean": 1133.83, "constraint_violation.max_vel_constraint.steps_min": 496, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5666316841579211, "constraint_violation.max_vel_constraint.ratio_min": 0.2478760619690155, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.906659868278865, -3.8267557952767906, -3.905134998849806, -4.081916458515994, -3.8814066746906697, -3.859372045758231, -3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8008096510622675, "mean_inference_ms": 8.26882411910831, "mean_action_processing_ms": 0.41546371881652233, "mean_env_wait_ms": 9.878704991478495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1824756, "agent_timesteps_total": 1824756, "timers": {"sample_time_ms": 42569.948, "sample_throughput": 282.03, "load_time_ms": 6.313, "load_throughput": 1901893.472, "learn_time_ms": 38273.748, "learn_throughput": 313.688, "update_time_ms": 24.743}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0042125154286623, "policy_loss": 0.0011267104418948293, "vf_loss": 0.003085806267336011, "vf_explained_var": 0.03862183913588524, "kl": 4.674137965565706e-09, "entropy": 2.692873477935791, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1824756, "num_agent_steps_sampled": 1824756, "num_steps_trained": 1824756, "num_agent_steps_trained": 1824756}, "done": false, "episodes_total": 912, "training_iteration": 152, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-43-08", "timestamp": 1690850588, "time_this_iter_s": 77.1005802154541, "time_total_s": 12539.01741194725, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12539.01741194725, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 99.99009009009006, "ram_util_percent": 55.4252252252252}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.11007547373345, "episode_reward_mean": -3.918558453887556, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8429866567833788, "reward_component_totals/dist_change_reward_min": -0.9967921926091939, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.075571797104183, "reward_component_totals/delta_v_min": -2.1302346552908444, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.55717971041756, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.0234655290838, "constraint_violation.max_vel_constraint.steps_mean": 1138.59, "constraint_violation.max_vel_constraint.steps_min": 508, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5690104947526237, "constraint_violation.max_vel_constraint.ratio_min": 0.2538730634682659, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9829050549739575, -3.861135822449211, -3.943224350301628, -3.7979520791608357, -3.878826016087663, -3.942071106267415, -3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8005012027758867, "mean_inference_ms": 8.266849196729309, "mean_action_processing_ms": 0.4153597464973189, "mean_env_wait_ms": 9.875474706888731, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1836762, "agent_timesteps_total": 1836762, "timers": {"sample_time_ms": 42724.189, "sample_throughput": 281.012, "load_time_ms": 6.969, "load_throughput": 1722760.759, "learn_time_ms": 38185.781, "learn_throughput": 314.41, "update_time_ms": 24.042}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003846184117719531, "policy_loss": 0.0009223644156008959, "vf_loss": 0.0029238215647637844, "vf_explained_var": 0.033822305500507355, "kl": -3.915560320422173e-09, "entropy": 2.776024341583252, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1836762, "num_agent_steps_sampled": 1836762, "num_steps_trained": 1836762, "num_agent_steps_trained": 1836762}, "done": false, "episodes_total": 918, "training_iteration": 153, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-44-29", "timestamp": 1690850669, "time_this_iter_s": 80.93752193450928, "time_total_s": 12619.95493388176, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12619.95493388176, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 99.98260869565217, "ram_util_percent": 55.43565217391304}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.11007547373345, "episode_reward_mean": -3.919387190625646, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8444173328956773, "reward_component_totals/dist_change_reward_min": -0.9967921926091939, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.074969857729975, "reward_component_totals/delta_v_min": -2.1302346552908444, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.49698577299674, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.0234655290838, "constraint_violation.max_vel_constraint.steps_mean": 1128.92, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5641779110444778, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9210097172415477, -3.908564494075847, -3.7902286570785004, -4.0247520836300446, -3.8005641067863065, -3.927894490429174, -4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.80022189794514, "mean_inference_ms": 8.264874776629751, "mean_action_processing_ms": 0.41524453562601693, "mean_env_wait_ms": 9.87212992995482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1848768, "agent_timesteps_total": 1848768, "timers": {"sample_time_ms": 42885.085, "sample_throughput": 279.957, "load_time_ms": 6.772, "load_throughput": 1772946.207, "learn_time_ms": 37838.35, "learn_throughput": 317.297, "update_time_ms": 25.278}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0036607920192182064, "policy_loss": 0.0008059489191509783, "vf_loss": 0.0028548422269523144, "vf_explained_var": 0.012706546112895012, "kl": 2.198371973349822e-08, "entropy": 2.7003707885742188, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1848768, "num_agent_steps_sampled": 1848768, "num_steps_trained": 1848768, "num_agent_steps_trained": 1848768}, "done": false, "episodes_total": 924, "training_iteration": 154, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-45-47", "timestamp": 1690850747, "time_this_iter_s": 77.60355257987976, "time_total_s": 12697.55848646164, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12697.55848646164, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 99.99009009009009, "ram_util_percent": 55.45225225225223}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.11007547373345, "episode_reward_mean": -3.9216803037198837, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8465618946688853, "reward_component_totals/dist_change_reward_min": -0.9967921926091939, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.0751184090510044, "reward_component_totals/delta_v_min": -2.1302346552908444, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.51184090509972, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.0234655290838, "constraint_violation.max_vel_constraint.steps_mean": 1147.16, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5732933533233383, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.04100173944798, -4.05733478974337, -3.786525479810071, -4.023146687129742, -3.802640190323209, -3.8825676979038084, -3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7999643756034656, "mean_inference_ms": 8.262990851972885, "mean_action_processing_ms": 0.4151209959727904, "mean_env_wait_ms": 9.868816711875548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1860774, "agent_timesteps_total": 1860774, "timers": {"sample_time_ms": 43047.197, "sample_throughput": 278.903, "load_time_ms": 6.688, "load_throughput": 1795245.43, "learn_time_ms": 37873.002, "learn_throughput": 317.007, "update_time_ms": 28.35}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003597147995606065, "policy_loss": 0.000606878602411598, "vf_loss": 0.0029902698006480932, "vf_explained_var": 0.0929560735821724, "kl": 2.651264985331636e-09, "entropy": 2.735168218612671, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1860774, "num_agent_steps_sampled": 1860774, "num_steps_trained": 1860774, "num_agent_steps_trained": 1860774}, "done": false, "episodes_total": 930, "training_iteration": 155, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-47-07", "timestamp": 1690850827, "time_this_iter_s": 80.2157666683197, "time_total_s": 12777.77425312996, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12777.77425312996, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 99.98434782608695, "ram_util_percent": 55.50521739130435}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.1847940244376947, "episode_reward_min": -4.11007547373345, "episode_reward_mean": -3.922464006493663, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8476722997523121, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.06903152998291301, "reward_component_totals/delta_v_mean": -2.074791706741356, "reward_component_totals/delta_v_min": -2.1302346552908444, "reward_component_totals/delta_v_max": -2.0266928126911345, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.47917067413488, "delta_v_total_min": 202.66928126911264, "delta_v_total_max": 213.0234655290838, "constraint_violation.max_vel_constraint.steps_mean": 1159.7, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.579560219890055, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.8462785926009726, -3.978167652456582, -3.8962459724448255, -3.8834262106287802, -3.1847940244376947, -4.0715950336949795, -4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7997306951963123, "mean_inference_ms": 8.26117622467231, "mean_action_processing_ms": 0.41499627847234327, "mean_env_wait_ms": 9.865596058620024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1872780, "agent_timesteps_total": 1872780, "timers": {"sample_time_ms": 43297.356, "sample_throughput": 277.292, "load_time_ms": 6.628, "load_throughput": 1811402.697, "learn_time_ms": 37984.739, "learn_throughput": 316.074, "update_time_ms": 31.155}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0029607671312987804, "policy_loss": 0.0002381737867835909, "vf_loss": 0.0027225918602198362, "vf_explained_var": 0.15715919435024261, "kl": -1.0264576966179106e-09, "entropy": 2.748884677886963, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1872780, "num_agent_steps_sampled": 1872780, "num_steps_trained": 1872780, "num_agent_steps_trained": 1872780}, "done": false, "episodes_total": 936, "training_iteration": 156, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-48-31", "timestamp": 1690850911, "time_this_iter_s": 82.83320307731628, "time_total_s": 12860.607456207275, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12860.607456207275, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 99.98474576271187, "ram_util_percent": 55.52711864406778}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.755802674773649, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.9323532107101977, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8550114589688311, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.6752248552275845, "reward_component_totals/delta_v_mean": -2.077341751741373, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.029784970333182, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.73417517413654, "delta_v_total_min": 202.9784970333172, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1173.72, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5865667166416791, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.038672452266488, -3.912762387037478, -3.966975178746141, -4.001826014893319, -4.097306483630256, -3.9237261812617064, -4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7988825820948822, "mean_inference_ms": 8.259815435937718, "mean_action_processing_ms": 0.41486751429514035, "mean_env_wait_ms": 9.86247779596092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1884786, "agent_timesteps_total": 1884786, "timers": {"sample_time_ms": 43645.63, "sample_throughput": 275.079, "load_time_ms": 6.79, "load_throughput": 1768307.985, "learn_time_ms": 38043.234, "learn_throughput": 315.588, "update_time_ms": 29.674}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.001389829209074378, "policy_loss": -0.001290930900722742, "vf_loss": 0.002680760808289051, "vf_explained_var": 0.17254959046840668, "kl": 2.5408583681496566e-08, "entropy": 2.563023328781128, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1884786, "num_agent_steps_sampled": 1884786, "num_steps_trained": 1884786, "num_agent_steps_trained": 1884786}, "done": false, "episodes_total": 942, "training_iteration": 157, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-49-53", "timestamp": 1690850993, "time_this_iter_s": 81.8906364440918, "time_total_s": 12942.498092651367, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12942.498092651367, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 99.98376068376069, "ram_util_percent": 55.42564102564102}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.755802674773649, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.9258192286429203, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8479612748972996, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.6752248552275845, "reward_component_totals/delta_v_mean": -2.0778579537456268, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.029784970333182, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7857953745619, "delta_v_total_min": 202.9784970333172, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1190.46, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5949325337331335, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.01282863638592, -3.9989421293900134, -3.8792154598811712, -3.7981273398191586, -4.05164536423603, -3.8867771911104776, -3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7980600862602094, "mean_inference_ms": 8.258505883251027, "mean_action_processing_ms": 0.41474097420914824, "mean_env_wait_ms": 9.859488753973123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1896792, "agent_timesteps_total": 1896792, "timers": {"sample_time_ms": 43943.266, "sample_throughput": 273.216, "load_time_ms": 6.8, "load_throughput": 1765703.831, "learn_time_ms": 37814.764, "learn_throughput": 317.495, "update_time_ms": 31.225}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0033937834668904543, "policy_loss": 0.0005164793692529202, "vf_loss": 0.002877303399145603, "vf_explained_var": -0.005579047836363316, "kl": -2.9667130974075917e-09, "entropy": 2.7688381671905518, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1896792, "num_agent_steps_sampled": 1896792, "num_steps_trained": 1896792, "num_agent_steps_trained": 1896792}, "done": false, "episodes_total": 948, "training_iteration": 158, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-51-13", "timestamp": 1690851073, "time_this_iter_s": 79.67795538902283, "time_total_s": 13022.17604804039, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13022.17604804039, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 99.98508771929825, "ram_util_percent": 55.43070175438594}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.755802674773649, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.926691574265904, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8467700470207636, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.6752248552275845, "reward_component_totals/delta_v_mean": -2.0799215272451463, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.029784970333182, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.99215272451397, "delta_v_total_min": 202.9784970333172, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1176.33, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5878710644677662, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9218686192758234, -3.755802674773649, -3.9246837387628184, -3.8992414693260327, -4.0013566358816, -3.9479618977601847, -3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7973415070860177, "mean_inference_ms": 8.257273787468362, "mean_action_processing_ms": 0.4146242807562042, "mean_env_wait_ms": 9.85673350720007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1908798, "agent_timesteps_total": 1908798, "timers": {"sample_time_ms": 43840.003, "sample_throughput": 273.859, "load_time_ms": 6.798, "load_throughput": 1766075.383, "learn_time_ms": 37609.495, "learn_throughput": 319.228, "update_time_ms": 29.801}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0036777376662939787, "policy_loss": 0.000918720499612391, "vf_loss": 0.002759017515927553, "vf_explained_var": 0.1289214789867401, "kl": 2.7161071614045795e-08, "entropy": 2.736095905303955, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1908798, "num_agent_steps_sampled": 1908798, "num_steps_trained": 1908798, "num_agent_steps_trained": 1908798}, "done": false, "episodes_total": 954, "training_iteration": 159, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-52-30", "timestamp": 1690851150, "time_this_iter_s": 77.64566445350647, "time_total_s": 13099.821712493896, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13099.821712493896, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 99.98545454545454, "ram_util_percent": 55.39545454545451}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7421171402713567, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.9257579343712696, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.84548223580881, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.0802756985624664, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.018993490934374, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.02756985624586, "delta_v_total_min": 201.89934909343685, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1169.26, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5843378310844577, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9538141832773293, -3.943435346222824, -3.780032677865485, -4.004497215500194, -3.9722396388726775, -3.780532604160829, -3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7966903363467344, "mean_inference_ms": 8.255912157004342, "mean_action_processing_ms": 0.41451995285822635, "mean_env_wait_ms": 9.854134910426161, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1920804, "agent_timesteps_total": 1920804, "timers": {"sample_time_ms": 43705.369, "sample_throughput": 274.703, "load_time_ms": 7.907, "load_throughput": 1518321.835, "learn_time_ms": 37385.48, "learn_throughput": 321.141, "update_time_ms": 28.878}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0031406767666339874, "policy_loss": 0.0003466879716143012, "vf_loss": 0.002793988911435008, "vf_explained_var": 0.10215086489915848, "kl": 2.0551684798419956e-08, "entropy": 2.7003467082977295, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1920804, "num_agent_steps_sampled": 1920804, "num_steps_trained": 1920804, "num_agent_steps_trained": 1920804}, "done": false, "episodes_total": 960, "training_iteration": 160, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-53-48", "timestamp": 1690851228, "time_this_iter_s": 76.93046450614929, "time_total_s": 13176.752177000046, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13176.752177000046, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 99.97999999999999, "ram_util_percent": 55.487272727272725}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7421171402713567, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.9275862568600335, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8477942657027043, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.0797919911573364, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.018993490934374, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.97919911573285, "delta_v_total_min": 201.89934909343685, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1172.54, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5859770114942529, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.8836895530909294, -3.8380738989608103, -3.9743477454803466, -3.92827131063269, -4.016306588882069, -3.893627057506053, -3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7966434390433492, "mean_inference_ms": 8.254485192014657, "mean_action_processing_ms": 0.4144350611340258, "mean_env_wait_ms": 9.851945742046501, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1932810, "agent_timesteps_total": 1932810, "timers": {"sample_time_ms": 43573.714, "sample_throughput": 275.533, "load_time_ms": 8.351, "load_throughput": 1437665.268, "learn_time_ms": 37162.43, "learn_throughput": 323.068, "update_time_ms": 29.448}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003347993129864335, "policy_loss": 0.000295695208478719, "vf_loss": 0.0030522970482707024, "vf_explained_var": 0.0018938190769404173, "kl": -5.858319385154687e-10, "entropy": 2.7035951614379883, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1932810, "num_agent_steps_sampled": 1932810, "num_steps_trained": 1932810, "num_agent_steps_trained": 1932810}, "done": false, "episodes_total": 966, "training_iteration": 161, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-55-22", "timestamp": 1690851322, "time_this_iter_s": 94.07142066955566, "time_total_s": 13270.823597669601, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13270.823597669601, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 99.9865671641791, "ram_util_percent": 55.4679104477612}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7421171402713567, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.925599369554961, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8466441596609833, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.0789552098939845, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.0158899921178848, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8955209893977, "delta_v_total_min": 201.5889992117882, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1165.84, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5826286856571714, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.855063067871336, -3.802546051091004, -4.05573868871962, -3.873622370311852, -3.887093637656066, -4.06657621741631, -4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7966348569856496, "mean_inference_ms": 8.253352574470155, "mean_action_processing_ms": 0.4143631543893998, "mean_env_wait_ms": 9.849965852885152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1944816, "agent_timesteps_total": 1944816, "timers": {"sample_time_ms": 44167.939, "sample_throughput": 271.826, "load_time_ms": 8.605, "load_throughput": 1395188.396, "learn_time_ms": 37220.188, "learn_throughput": 322.567, "update_time_ms": 30.759}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003521325532346964, "policy_loss": 0.0007696629036217928, "vf_loss": 0.0027516621630638838, "vf_explained_var": 0.034959468990564346, "kl": -8.136554763282788e-10, "entropy": 2.7144649028778076, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1944816, "num_agent_steps_sampled": 1944816, "num_steps_trained": 1944816, "num_agent_steps_trained": 1944816}, "done": false, "episodes_total": 972, "training_iteration": 162, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-56-46", "timestamp": 1690851406, "time_this_iter_s": 83.59656000137329, "time_total_s": 13354.420157670975, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13354.420157670975, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 99.98250000000002, "ram_util_percent": 55.455833333333324}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7421171402713567, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.9250962260928612, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.844335307811886, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.0807609182809825, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.0158899921178848, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07609182809745, "delta_v_total_min": 201.5889992117882, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1142.54, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.570984507746127, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.001344556045889, -4.0683157874157905, -3.931773976911413, -3.9053048005852347, -4.011241076915693, -3.7562235645950395, -3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.796677722258361, "mean_inference_ms": 8.252260244270396, "mean_action_processing_ms": 0.4142977365056291, "mean_env_wait_ms": 9.848154691122652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1956822, "agent_timesteps_total": 1956822, "timers": {"sample_time_ms": 44076.191, "sample_throughput": 272.392, "load_time_ms": 8.05, "load_throughput": 1491382.069, "learn_time_ms": 36968.811, "learn_throughput": 324.76, "update_time_ms": 34.161}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00338839297182858, "policy_loss": 0.000514696235768497, "vf_loss": 0.002873696619644761, "vf_explained_var": 0.12395092844963074, "kl": 2.0736948158628365e-08, "entropy": 2.7605624198913574, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1956822, "num_agent_steps_sampled": 1956822, "num_steps_trained": 1956822, "num_agent_steps_trained": 1956822}, "done": false, "episodes_total": 978, "training_iteration": 163, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-58-03", "timestamp": 1690851483, "time_this_iter_s": 77.5564169883728, "time_total_s": 13431.976574659348, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13431.976574659348, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 99.98828828828829, "ram_util_percent": 55.39909909909906}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7421171402713567, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.9284716388802137, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8473906809558912, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.0810809579243297, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.0158899921178848, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10809579243218, "delta_v_total_min": 201.5889992117882, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1156.19, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5778060969515242, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.930236088322075, -3.7963674541461963, -3.868171153246225, -3.9741075735102283, -3.879769449089675, -3.975335174303387, -4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7967899395728986, "mean_inference_ms": 8.251286813476803, "mean_action_processing_ms": 0.4142482008582639, "mean_env_wait_ms": 9.846640013449266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1968828, "agent_timesteps_total": 1968828, "timers": {"sample_time_ms": 44221.452, "sample_throughput": 271.497, "load_time_ms": 9.242, "load_throughput": 1299138.423, "learn_time_ms": 36991.563, "learn_throughput": 324.56, "update_time_ms": 33.81}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0029727371875196695, "policy_loss": 0.00014039753295946866, "vf_loss": 0.0028323428705334663, "vf_explained_var": 0.04029304161667824, "kl": -2.819003253051733e-09, "entropy": 2.7621946334838867, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1968828, "num_agent_steps_sampled": 1968828, "num_steps_trained": 1968828, "num_agent_steps_trained": 1968828}, "done": false, "episodes_total": 984, "training_iteration": 164, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_17-59-23", "timestamp": 1690851563, "time_this_iter_s": 79.33195090293884, "time_total_s": 13511.308525562286, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13511.308525562286, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 99.98141592920354, "ram_util_percent": 55.496460176991164}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7421171402713567, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.929843072496266, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8488856432640693, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.0809574292322033, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.0158899921178848, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.09574292321958, "delta_v_total_min": 201.5889992117882, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1143.26, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5713443278360819, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.0472100697368125, -3.9683980595517196, -3.862007714940737, -3.9747194163371606, -3.8798259755780418, -3.8144228356000736, -3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.796964792392255, "mean_inference_ms": 8.250594706463833, "mean_action_processing_ms": 0.4141987926150359, "mean_env_wait_ms": 9.845278858688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1980834, "agent_timesteps_total": 1980834, "timers": {"sample_time_ms": 44250.17, "sample_throughput": 271.321, "load_time_ms": 9.471, "load_throughput": 1267670.441, "learn_time_ms": 37043.822, "learn_throughput": 324.103, "update_time_ms": 30.229}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0018989847740158439, "policy_loss": -0.0010493292938917875, "vf_loss": 0.0029483113903552294, "vf_explained_var": -0.00644841231405735, "kl": -2.5461157626693875e-09, "entropy": 2.798135757446289, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1980834, "num_agent_steps_sampled": 1980834, "num_steps_trained": 1980834, "num_agent_steps_trained": 1980834}, "done": false, "episodes_total": 990, "training_iteration": 165, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-00-44", "timestamp": 1690851644, "time_this_iter_s": 80.98034143447876, "time_total_s": 13592.288866996765, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13592.288866996765, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 99.9793103448276, "ram_util_percent": 55.41379310344826}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7421171402713567, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.9289172185825465, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.847500116185566, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.081417102396988, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.0158899921178848, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.14171023969809, "delta_v_total_min": 201.5889992117882, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1152.31, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5758670664667667, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.895803948357253, -3.851201482856808, -3.9306428377537372, -3.9974760724456786, -4.078523926064812, -3.975365012185824, -3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.79714364939746, "mean_inference_ms": 8.249805575204672, "mean_action_processing_ms": 0.4141464900406094, "mean_env_wait_ms": 9.8437697566444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1992840, "agent_timesteps_total": 1992840, "timers": {"sample_time_ms": 44172.754, "sample_throughput": 271.797, "load_time_ms": 9.465, "load_throughput": 1268487.916, "learn_time_ms": 36720.709, "learn_throughput": 326.954, "update_time_ms": 27.477}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0024943803437054157, "policy_loss": -0.0002597076236270368, "vf_loss": 0.002754087094217539, "vf_explained_var": 0.10480713844299316, "kl": 2.3077772581814315e-08, "entropy": 2.6824491024017334, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1992840, "num_agent_steps_sampled": 1992840, "num_steps_trained": 1992840, "num_agent_steps_trained": 1992840}, "done": false, "episodes_total": 996, "training_iteration": 166, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-02-03", "timestamp": 1690851723, "time_this_iter_s": 78.78516149520874, "time_total_s": 13671.074028491974, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13671.074028491974, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 99.98198198198196, "ram_util_percent": 55.449549549549516}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7421171402713567, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.925700492326492, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8450208668625143, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.080679625463986, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.0158899921178848, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.06796254639778, "delta_v_total_min": 201.5889992117882, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1137.92, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5686756621689155, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.840435948895041, -4.066147158423436, -3.856394539477046, -4.00913301283416, -3.827570577532155, -3.8948805093819945, -3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7967160333318912, "mean_inference_ms": 8.249091028711256, "mean_action_processing_ms": 0.4140967114186068, "mean_env_wait_ms": 9.842236476236152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2004846, "agent_timesteps_total": 2004846, "timers": {"sample_time_ms": 44063.049, "sample_throughput": 272.473, "load_time_ms": 8.984, "load_throughput": 1336348.37, "learn_time_ms": 36604.921, "learn_throughput": 327.989, "update_time_ms": 26.418}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0022671332117170095, "policy_loss": -0.0009167403331957757, "vf_loss": 0.003183875698596239, "vf_explained_var": 0.03100370615720749, "kl": -4.150894739041178e-09, "entropy": 2.6981639862060547, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2004846, "num_agent_steps_sampled": 2004846, "num_steps_trained": 2004846, "num_agent_steps_trained": 2004846}, "done": false, "episodes_total": 1002, "training_iteration": 167, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-03-23", "timestamp": 1690851803, "time_this_iter_s": 79.58536291122437, "time_total_s": 13750.659391403198, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13750.659391403198, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 99.9780701754386, "ram_util_percent": 55.444736842105264}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7421171402713567, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.926780510066611, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8462306209233074, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.0805498891433114, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.0158899921178848, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05498891433044, "delta_v_total_min": 201.5889992117882, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1144.58, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5720039980009995, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.7836859294047915, -3.817670793851283, -3.9815165142994795, -4.11007547373345, -3.8855418783202897, -4.070923464182176, -3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7962763865674904, "mean_inference_ms": 8.248360575456807, "mean_action_processing_ms": 0.4140467753319769, "mean_env_wait_ms": 9.840590436487101, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2016852, "agent_timesteps_total": 2016852, "timers": {"sample_time_ms": 43931.654, "sample_throughput": 273.288, "load_time_ms": 8.756, "load_throughput": 1371104.082, "learn_time_ms": 36456.78, "learn_throughput": 329.321, "update_time_ms": 23.75}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0032815448939800262, "policy_loss": 0.000563040201086551, "vf_loss": 0.002718502888455987, "vf_explained_var": 0.08775437623262405, "kl": -2.1881072509444266e-09, "entropy": 2.7625861167907715, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2016852, "num_agent_steps_sampled": 2016852, "num_steps_trained": 2016852, "num_agent_steps_trained": 2016852}, "done": false, "episodes_total": 1008, "training_iteration": 168, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-04-40", "timestamp": 1690851880, "time_this_iter_s": 76.8706407546997, "time_total_s": 13827.530032157898, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13827.530032157898, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 99.98073394495412, "ram_util_percent": 55.45688073394493}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.7421171402713567, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.9243351015849997, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8437676014482117, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.0805675001367963, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.0158899921178848, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05675001367882, "delta_v_total_min": 201.5889992117882, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1153.24, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5763318340829584, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.84251634533827, -3.8020303054488602, -3.9570141373913765, -3.974441036685482, -4.086030326065633, -3.964490476170633, -3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7958751347642308, "mean_inference_ms": 8.247678625955526, "mean_action_processing_ms": 0.41400390633291484, "mean_env_wait_ms": 9.83910611688664, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2028858, "agent_timesteps_total": 2028858, "timers": {"sample_time_ms": 43872.249, "sample_throughput": 273.658, "load_time_ms": 8.584, "load_throughput": 1398695.482, "learn_time_ms": 36793.819, "learn_throughput": 326.305, "update_time_ms": 25.304}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003291674191132188, "policy_loss": 0.00019216105283703655, "vf_loss": 0.0030995155684649944, "vf_explained_var": 0.1382679045200348, "kl": 6.631918125776792e-09, "entropy": 2.7241933345794678, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2028858, "num_agent_steps_sampled": 2028858, "num_steps_trained": 2028858, "num_agent_steps_trained": 2028858}, "done": false, "episodes_total": 1014, "training_iteration": 169, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-06-01", "timestamp": 1690851961, "time_this_iter_s": 80.48629665374756, "time_total_s": 13908.016328811646, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13908.016328811646, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 99.98521739130436, "ram_util_percent": 55.39826086956519}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.733635835752247, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.92003260368895, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8401513787263825, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.079881224962576, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98812249625684, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1167.21, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5833133433283358, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.931105921464588, -3.867320400292021, -3.7987704875019563, -3.8412704915548384, -4.050662215892738, -3.8419998328626366, -4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7955012594961102, "mean_inference_ms": 8.246934552288186, "mean_action_processing_ms": 0.413961778297272, "mean_env_wait_ms": 9.837730128881896, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2040864, "agent_timesteps_total": 2040864, "timers": {"sample_time_ms": 44192.963, "sample_throughput": 271.672, "load_time_ms": 7.404, "load_throughput": 1621473.774, "learn_time_ms": 36887.93, "learn_throughput": 325.472, "update_time_ms": 24.42}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0029718552250415087, "policy_loss": 0.00026323526981286705, "vf_loss": 0.0027086182963103056, "vf_explained_var": 0.19697901606559753, "kl": 1.7174389688179303e-09, "entropy": 2.733111619949341, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2040864, "num_agent_steps_sampled": 2040864, "num_steps_trained": 2040864, "num_agent_steps_trained": 2040864}, "done": false, "episodes_total": 1020, "training_iteration": 170, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-07-22", "timestamp": 1690852042, "time_this_iter_s": 81.06457924842834, "time_total_s": 13989.080908060074, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13989.080908060074, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 99.98620689655172, "ram_util_percent": 55.39655172413791}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.733635835752247, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.9211006861379754, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8400313113913994, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.081069374746584, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10693747465766, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1166.42, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5829185407296352, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-4.015364409553026, -4.028148477265464, -3.80954779301299, -3.8566021300783726, -3.8349792017523203, -3.830830123120724, -4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7956521063265993, "mean_inference_ms": 8.246251385219423, "mean_action_processing_ms": 0.4139424933157456, "mean_env_wait_ms": 9.836674058196735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2052870, "agent_timesteps_total": 2052870, "timers": {"sample_time_ms": 44212.504, "sample_throughput": 271.552, "load_time_ms": 7.134, "load_throughput": 1682958.593, "learn_time_ms": 37113.076, "learn_throughput": 323.498, "update_time_ms": 24.056}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0035486442502588034, "policy_loss": 0.0007917953771539032, "vf_loss": 0.0027568500954657793, "vf_explained_var": 0.19983863830566406, "kl": 1.600022159209402e-08, "entropy": 2.726090669631958, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2052870, "num_agent_steps_sampled": 2052870, "num_steps_trained": 2052870, "num_agent_steps_trained": 2052870}, "done": false, "episodes_total": 1026, "training_iteration": 171, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-08-59", "timestamp": 1690852139, "time_this_iter_s": 96.5242612361908, "time_total_s": 14085.605169296265, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14085.605169296265, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 99.98333333333333, "ram_util_percent": 55.47898550724638}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.733635835752247, "episode_reward_min": -4.114157687197035, "episode_reward_mean": -3.9230626752044526, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8416791508829413, "reward_component_totals/dist_change_reward_min": -0.9987213127724777, "reward_component_totals/dist_change_reward_max": -0.7075956421448776, "reward_component_totals/delta_v_mean": -2.0813835243215193, "reward_component_totals/delta_v_min": -2.171489836821949, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.13835243215124, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 217.14898368219428, "constraint_violation.max_vel_constraint.steps_mean": 1132.92, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5661769115442279, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-4.03086665998246, -4.0237528160537614, -4.053259121518581, -3.89789893930823, -3.9669127523123744, -4.114157687197035, -4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7958425447372983, "mean_inference_ms": 8.245756687893566, "mean_action_processing_ms": 0.4139354045185486, "mean_env_wait_ms": 9.835873683514217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2064876, "agent_timesteps_total": 2064876, "timers": {"sample_time_ms": 44391.518, "sample_throughput": 270.457, "load_time_ms": 7.049, "load_throughput": 1703177.046, "learn_time_ms": 36994.382, "learn_throughput": 324.536, "update_time_ms": 21.923}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002110700821503997, "policy_loss": -0.0006307007861323655, "vf_loss": 0.0027414015494287014, "vf_explained_var": 0.11823027580976486, "kl": 1.279567118928071e-08, "entropy": 2.7363927364349365, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2064876, "num_agent_steps_sampled": 2064876, "num_steps_trained": 2064876, "num_agent_steps_trained": 2064876}, "done": false, "episodes_total": 1032, "training_iteration": 172, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-10-23", "timestamp": 1690852223, "time_this_iter_s": 84.17763090133667, "time_total_s": 14169.782800197601, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14169.782800197601, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 99.9775, "ram_util_percent": 55.39916666666665}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.089128224168499, "episode_reward_mean": -3.9125629821652326, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8322359081868522, "reward_component_totals/dist_change_reward_min": -0.9963727932628175, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.0803270739783875, "reward_component_totals/delta_v_min": -2.1563306927680954, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.032707397838, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 215.63306927680912, "constraint_violation.max_vel_constraint.steps_mean": 1103.92, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1943, "constraint_violation.max_vel_constraint.ratio_mean": 0.5516841579210395, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9710144927536232}, "hist_stats": {"episode_reward": [-4.089128224168499, -3.9683245760793744, -3.856343224722898, -3.85456144343713, -3.800062103455657, -3.7798025366557955, -3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7961219823335355, "mean_inference_ms": 8.24523486267354, "mean_action_processing_ms": 0.4139423665168176, "mean_env_wait_ms": 9.835395794430731, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2076882, "agent_timesteps_total": 2076882, "timers": {"sample_time_ms": 44655.906, "sample_throughput": 268.856, "load_time_ms": 6.998, "load_throughput": 1715676.257, "learn_time_ms": 37100.448, "learn_throughput": 323.608, "update_time_ms": 18.489}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0037131481803953648, "policy_loss": 0.0008273124694824219, "vf_loss": 0.00288583617657423, "vf_explained_var": -0.010737522505223751, "kl": -2.3908952595519395e-09, "entropy": 2.77968692779541, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2076882, "num_agent_steps_sampled": 2076882, "num_steps_trained": 2076882, "num_agent_steps_trained": 2076882}, "done": false, "episodes_total": 1038, "training_iteration": 173, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-11-44", "timestamp": 1690852304, "time_this_iter_s": 81.22600769996643, "time_total_s": 14251.008807897568, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14251.008807897568, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 99.97758620689656, "ram_util_percent": 55.452586206896555}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.088830368889523, "episode_reward_mean": -3.9146507895405342, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.835174503292669, "reward_component_totals/dist_change_reward_min": -0.9963727932628175, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.079476286247873, "reward_component_totals/delta_v_min": -2.1563306927680954, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.94762862478652, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 215.63306927680912, "constraint_violation.max_vel_constraint.steps_mean": 1091.44, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5454472763618191, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.927240831017945, -3.827527272016574, -4.088830368889523, -3.864407379072124, -4.047509963862772, -4.015458723729668, -3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7963964250845927, "mean_inference_ms": 8.244729068957101, "mean_action_processing_ms": 0.4139875440105469, "mean_env_wait_ms": 9.835034445697358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2088888, "agent_timesteps_total": 2088888, "timers": {"sample_time_ms": 44625.564, "sample_throughput": 269.039, "load_time_ms": 5.969, "load_throughput": 2011263.702, "learn_time_ms": 37290.984, "learn_throughput": 321.954, "update_time_ms": 18.476}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003860733937472105, "policy_loss": 0.0009573742863722146, "vf_loss": 0.0029033594764769077, "vf_explained_var": 0.10975993424654007, "kl": 9.223097841015715e-09, "entropy": 2.732296943664551, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2088888, "num_agent_steps_sampled": 2088888, "num_steps_trained": 2088888, "num_agent_steps_trained": 2088888}, "done": false, "episodes_total": 1044, "training_iteration": 174, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-13-06", "timestamp": 1690852386, "time_this_iter_s": 80.90118670463562, "time_total_s": 14331.909994602203, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14331.909994602203, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 99.9780701754386, "ram_util_percent": 55.40263157894735}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.088040136442204, "episode_reward_mean": -3.9122506451294363, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8344994023929618, "reward_component_totals/dist_change_reward_min": -0.9963727932628175, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.077751242736482, "reward_component_totals/delta_v_min": -2.1563306927680954, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7751242736474, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 215.63306927680912, "constraint_violation.max_vel_constraint.steps_mean": 1077.19, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5383258370814593, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.8564816150784527, -3.9782027091639725, -3.9685057892568993, -3.8486118820294353, -3.911143218862665, -3.9973199387575167, -3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7967066572306698, "mean_inference_ms": 8.244211066758206, "mean_action_processing_ms": 0.4140279848258306, "mean_env_wait_ms": 9.834767952481675, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2100894, "agent_timesteps_total": 2100894, "timers": {"sample_time_ms": 44559.878, "sample_throughput": 269.435, "load_time_ms": 6.01, "load_throughput": 1997541.148, "learn_time_ms": 37079.65, "learn_throughput": 323.789, "update_time_ms": 21.345}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003122459864243865, "policy_loss": 0.00010523702803766355, "vf_loss": 0.0030172239057719707, "vf_explained_var": 0.11775371432304382, "kl": -3.870496367852638e-09, "entropy": 2.791005849838257, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2100894, "num_agent_steps_sampled": 2100894, "num_steps_trained": 2100894, "num_agent_steps_trained": 2100894}, "done": false, "episodes_total": 1050, "training_iteration": 175, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-14-24", "timestamp": 1690852464, "time_this_iter_s": 78.25008249282837, "time_total_s": 14410.160077095032, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14410.160077095032, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 99.98035714285713, "ram_util_percent": 55.41785714285714}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.088040136442204, "episode_reward_mean": -3.9114723946696057, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8359654943253179, "reward_component_totals/dist_change_reward_min": -0.9963727932628175, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.075506900344296, "reward_component_totals/delta_v_min": -2.135945722162721, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.55069003442884, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 213.59457221627176, "constraint_violation.max_vel_constraint.steps_mean": 1086.0, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.542728635682159, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9654113401162334, -3.7421171402713567, -3.834198747856283, -3.90736066045257, -4.022025324212276, -4.040340930619769, -3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.796988045578379, "mean_inference_ms": 8.243679591302765, "mean_action_processing_ms": 0.41407289458415447, "mean_env_wait_ms": 9.834573297707076, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2112900, "agent_timesteps_total": 2112900, "timers": {"sample_time_ms": 44595.577, "sample_throughput": 269.22, "load_time_ms": 5.822, "load_throughput": 2062079.811, "learn_time_ms": 36848.307, "learn_throughput": 325.822, "update_time_ms": 22.567}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0024630939587950706, "policy_loss": -0.0003390015917830169, "vf_loss": 0.0028020988684147596, "vf_explained_var": 0.11873085051774979, "kl": 9.996695915504006e-09, "entropy": 2.7106950283050537, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2112900, "num_agent_steps_sampled": 2112900, "num_steps_trained": 2112900, "num_agent_steps_trained": 2112900}, "done": false, "episodes_total": 1056, "training_iteration": 176, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-15-41", "timestamp": 1690852541, "time_this_iter_s": 76.84356760978699, "time_total_s": 14487.003644704819, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14487.003644704819, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 99.98198198198199, "ram_util_percent": 55.44324324324322}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.088040136442204, "episode_reward_mean": -3.9085325337400127, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8307900979822003, "reward_component_totals/dist_change_reward_min": -0.9963727932628175, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.0777424357578194, "reward_component_totals/delta_v_min": -2.135945722162721, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.77424357578107, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 213.59457221627176, "constraint_violation.max_vel_constraint.steps_mean": 1111.99, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5557171414292853, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.826771413494458, -3.965764189787312, -3.908856499184796, -3.8536255574771374, -3.9164383794153546, -3.9897982434365455, -3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.79672661341115, "mean_inference_ms": 8.243240069923718, "mean_action_processing_ms": 0.41410814931783885, "mean_env_wait_ms": 9.834330757073797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2124906, "agent_timesteps_total": 2124906, "timers": {"sample_time_ms": 44531.953, "sample_throughput": 269.604, "load_time_ms": 6.023, "load_throughput": 1993231.996, "learn_time_ms": 36869.844, "learn_throughput": 325.632, "update_time_ms": 23.995}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0036434954963624477, "policy_loss": 0.0007165526039898396, "vf_loss": 0.0029269421938806772, "vf_explained_var": 0.19478623569011688, "kl": 9.418375412906244e-09, "entropy": 2.7513275146484375, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2124906, "num_agent_steps_sampled": 2124906, "num_steps_trained": 2124906, "num_agent_steps_trained": 2124906}, "done": false, "episodes_total": 1062, "training_iteration": 177, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-17-01", "timestamp": 1690852621, "time_this_iter_s": 79.18672561645508, "time_total_s": 14566.190370321274, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14566.190370321274, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 99.98053097345134, "ram_util_percent": 55.45398230088495}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.088040136442204, "episode_reward_mean": -3.9075141911391857, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8288435540357715, "reward_component_totals/dist_change_reward_min": -0.9963727932628175, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.078670637103422, "reward_component_totals/delta_v_min": -2.142147245903812, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8670637103414, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 214.21472459038063, "constraint_violation.max_vel_constraint.steps_mean": 1115.75, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5575962018990505, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9566394082074106, -3.815712068171769, -3.7948599172159563, -3.862179407598597, -4.0080134379605985, -4.074978018757488, -3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.796515643122977, "mean_inference_ms": 8.242851030804628, "mean_action_processing_ms": 0.41414184049454, "mean_env_wait_ms": 9.834033012331458, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2136912, "agent_timesteps_total": 2136912, "timers": {"sample_time_ms": 44537.896, "sample_throughput": 269.568, "load_time_ms": 6.092, "load_throughput": 1970650.239, "learn_time_ms": 36838.399, "learn_throughput": 325.91, "update_time_ms": 26.108}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0033391432370990515, "policy_loss": 0.0005138437845744193, "vf_loss": 0.0028252999763935804, "vf_explained_var": 0.05283316597342491, "kl": -4.008192000526378e-09, "entropy": 2.7468883991241455, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2136912, "num_agent_steps_sampled": 2136912, "num_steps_trained": 2136912, "num_agent_steps_trained": 2136912}, "done": false, "episodes_total": 1068, "training_iteration": 178, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-18-18", "timestamp": 1690852698, "time_this_iter_s": 76.64477777481079, "time_total_s": 14642.835148096085, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14642.835148096085, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 99.98715596330274, "ram_util_percent": 55.402752293577954}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.088040136442204, "episode_reward_mean": -3.902186296261432, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8244604335880145, "reward_component_totals/dist_change_reward_min": -0.9963727932628175, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.0777258626734247, "reward_component_totals/delta_v_min": -2.142147245903812, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7725862673418, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 214.21472459038063, "constraint_violation.max_vel_constraint.steps_mean": 1128.27, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5638530734632683, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9167022196212047, -3.8915607993046137, -3.7897120522168777, -3.8093591589954237, -4.081528303994362, -4.088040136442204, -4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.796283365022529, "mean_inference_ms": 8.242508660191156, "mean_action_processing_ms": 0.4141726555780128, "mean_env_wait_ms": 9.833749835357139, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2148918, "agent_timesteps_total": 2148918, "timers": {"sample_time_ms": 44605.216, "sample_throughput": 269.161, "load_time_ms": 6.405, "load_throughput": 1874578.931, "learn_time_ms": 36763.209, "learn_throughput": 326.576, "update_time_ms": 25.027}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0037700228858739138, "policy_loss": 0.0005877877702005208, "vf_loss": 0.0031822349410504103, "vf_explained_var": 0.03061353974044323, "kl": -3.810411097759925e-09, "entropy": 2.774301767349243, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2148918, "num_agent_steps_sampled": 2148918, "num_steps_trained": 2148918, "num_agent_steps_trained": 2148918}, "done": false, "episodes_total": 1074, "training_iteration": 179, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-19-38", "timestamp": 1690852778, "time_this_iter_s": 80.37418842315674, "time_total_s": 14723.209336519241, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14723.209336519241, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 99.97652173913045, "ram_util_percent": 55.46173913043477}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.082833831821409, "episode_reward_mean": -3.9037275705078964, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8254712012792386, "reward_component_totals/dist_change_reward_min": -0.9884808742018066, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.078256369228664, "reward_component_totals/delta_v_min": -2.142147245903812, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.82563692286575, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 214.21472459038063, "constraint_violation.max_vel_constraint.steps_mean": 1128.94, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5641879060469764, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.002552463877047, -3.8167634120458596, -4.02279390413171, -4.000066820713103, -3.9029389914102266, -3.8278118449458693, -4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7960432199607406, "mean_inference_ms": 8.242149867160611, "mean_action_processing_ms": 0.41420570346265945, "mean_env_wait_ms": 9.833616336571577, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2160924, "agent_timesteps_total": 2160924, "timers": {"sample_time_ms": 44350.852, "sample_throughput": 270.705, "load_time_ms": 6.476, "load_throughput": 1853895.74, "learn_time_ms": 36698.167, "learn_throughput": 327.155, "update_time_ms": 26.019}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.002671981928870082, "policy_loss": -8.528030593879521e-05, "vf_loss": 0.0027572638355195522, "vf_explained_var": 0.2362976223230362, "kl": 3.3394925935681385e-08, "entropy": 2.7131783962249756, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2160924, "num_agent_steps_sampled": 2160924, "num_steps_trained": 2160924, "num_agent_steps_trained": 2160924}, "done": false, "episodes_total": 1080, "training_iteration": 180, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-20-56", "timestamp": 1690852856, "time_this_iter_s": 77.90874814987183, "time_total_s": 14801.118084669113, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14801.118084669113, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 99.98125, "ram_util_percent": 55.48392857142857}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.082833831821409, "episode_reward_mean": -3.902990127222328, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8240083610649824, "reward_component_totals/dist_change_reward_min": -0.9884808742018066, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.0789817661573524, "reward_component_totals/delta_v_min": -2.142147245903812, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89817661573449, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 214.21472459038063, "constraint_violation.max_vel_constraint.steps_mean": 1123.9, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5616691654172913, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.015350116960756, -4.005350504074532, -3.9579230990540264, -3.851755697777545, -3.816939251170268, -3.8863196510145652, -4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.796282743624512, "mean_inference_ms": 8.24166296523709, "mean_action_processing_ms": 0.4142423288279082, "mean_env_wait_ms": 9.833525663424538, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2172930, "agent_timesteps_total": 2172930, "timers": {"sample_time_ms": 44345.942, "sample_throughput": 270.735, "load_time_ms": 6.838, "load_throughput": 1755828.626, "learn_time_ms": 36617.844, "learn_throughput": 327.873, "update_time_ms": 27.385}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0032118551898747683, "policy_loss": 0.00022004192578606308, "vf_loss": 0.0029918125364929438, "vf_explained_var": 0.005908588413149118, "kl": -5.560396143522439e-09, "entropy": 2.800471067428589, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2172930, "num_agent_steps_sampled": 2172930, "num_steps_trained": 2172930, "num_agent_steps_trained": 2172930}, "done": false, "episodes_total": 1086, "training_iteration": 181, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-22-32", "timestamp": 1690852952, "time_this_iter_s": 95.6707284450531, "time_total_s": 14896.788813114166, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14896.788813114166, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 99.98518518518519, "ram_util_percent": 55.45259259259259}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.9028002893616325, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8229461573704682, "reward_component_totals/dist_change_reward_min": -0.9929432591465522, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.079854131991171, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98541319911638, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1132.31, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.565872063968016, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.02852925212567, -4.047702791320289, -3.773884994912252, -3.9006227398296507, -4.082833831821409, -4.017038159373136, -3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.796550776691031, "mean_inference_ms": 8.241192513654049, "mean_action_processing_ms": 0.41428701447863703, "mean_env_wait_ms": 9.83372234456428, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2184936, "agent_timesteps_total": 2184936, "timers": {"sample_time_ms": 43868.107, "sample_throughput": 273.684, "load_time_ms": 7.082, "load_throughput": 1695355.785, "learn_time_ms": 36513.351, "learn_throughput": 328.811, "update_time_ms": 27.731}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003621726995334029, "policy_loss": 0.000583791930694133, "vf_loss": 0.0030379323288798332, "vf_explained_var": 0.15907816588878632, "kl": 6.9423586879224786e-09, "entropy": 2.762126922607422, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2184936, "num_agent_steps_sampled": 2184936, "num_steps_trained": 2184936, "num_agent_steps_trained": 2184936}, "done": false, "episodes_total": 1092, "training_iteration": 182, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-23-51", "timestamp": 1690853031, "time_this_iter_s": 78.37170553207397, "time_total_s": 14975.16051864624, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14975.16051864624, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 99.98482142857142, "ram_util_percent": 55.45267857142858}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.9016352268580605, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8225872182855053, "reward_component_totals/dist_change_reward_min": -0.9929432591465522, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.0790480085725616, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90480085725542, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1130.35, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5648925537231384, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.826468687354576, -3.9210974730370918, -3.7892380219136683, -3.77066448055879, -3.818858882550017, -4.048180540907329, -3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.796849392001726, "mean_inference_ms": 8.240745138040234, "mean_action_processing_ms": 0.4143383741217154, "mean_env_wait_ms": 9.834030852870978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2196942, "agent_timesteps_total": 2196942, "timers": {"sample_time_ms": 43675.529, "sample_throughput": 274.891, "load_time_ms": 7.429, "load_throughput": 1616202.0, "learn_time_ms": 36452.251, "learn_throughput": 329.362, "update_time_ms": 28.529}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0036050891503691673, "policy_loss": 0.0007442724891006947, "vf_loss": 0.002860815729945898, "vf_explained_var": 0.19536791741847992, "kl": 6.081136039171042e-09, "entropy": 2.7144691944122314, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2196942, "num_agent_steps_sampled": 2196942, "num_steps_trained": 2196942, "num_agent_steps_trained": 2196942}, "done": false, "episodes_total": 1098, "training_iteration": 183, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-25-10", "timestamp": 1690853110, "time_this_iter_s": 78.71466493606567, "time_total_s": 15053.875183582306, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15053.875183582306, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 99.9849557522124, "ram_util_percent": 55.472566371681424}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.9064109312175903, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8271516179054207, "reward_component_totals/dist_change_reward_min": -0.9929432591465522, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.079259313312176, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.92593133121684, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1133.21, "constraint_violation.max_vel_constraint.steps_min": 350, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5663218390804596, "constraint_violation.max_vel_constraint.ratio_min": 0.17491254372813594, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.8921924429790673, -4.020969876721472, -3.8499327197025606, -3.9724290576952104, -3.910676443341858, -3.7844047473789892, -3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7971588965917553, "mean_inference_ms": 8.24025448149753, "mean_action_processing_ms": 0.4143903693963162, "mean_env_wait_ms": 9.834439376176329, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2208948, "agent_timesteps_total": 2208948, "timers": {"sample_time_ms": 43521.966, "sample_throughput": 275.861, "load_time_ms": 7.534, "load_throughput": 1593489.375, "learn_time_ms": 36324.75, "learn_throughput": 330.518, "update_time_ms": 28.276}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0017178074922412634, "policy_loss": -0.0009771737968549132, "vf_loss": 0.002694979775696993, "vf_explained_var": 0.1434936821460724, "kl": -3.827936190248238e-09, "entropy": 2.751072645187378, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2208948, "num_agent_steps_sampled": 2208948, "num_steps_trained": 2208948, "num_agent_steps_trained": 2208948}, "done": false, "episodes_total": 1104, "training_iteration": 184, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-26-28", "timestamp": 1690853188, "time_this_iter_s": 78.03539681434631, "time_total_s": 15131.910580396652, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15131.910580396652, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 99.98288288288289, "ram_util_percent": 55.48828828828826}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.907496717429822, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8276310964556224, "reward_component_totals/dist_change_reward_min": -0.9929432591465522, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.079865620974206, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98656209741984, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1124.1, "constraint_violation.max_vel_constraint.steps_min": 350, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5617691154422789, "constraint_violation.max_vel_constraint.ratio_min": 0.17491254372813594, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.894611146276448, -3.940515196760943, -3.9881178533034634, -3.886547818568686, -3.9454729621923836, -3.838143338508087, -4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7974979128158075, "mean_inference_ms": 8.239806974307651, "mean_action_processing_ms": 0.41445058441055244, "mean_env_wait_ms": 9.835037248425813, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2220954, "agent_timesteps_total": 2220954, "timers": {"sample_time_ms": 43634.077, "sample_throughput": 275.152, "load_time_ms": 7.27, "load_throughput": 1651362.52, "learn_time_ms": 36343.006, "learn_throughput": 330.352, "update_time_ms": 26.308}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.00316980155184865, "policy_loss": 0.0005461043328978121, "vf_loss": 0.0026236968114972115, "vf_explained_var": 0.3029404580593109, "kl": 2.2514472064472102e-08, "entropy": 2.7311811447143555, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2220954, "num_agent_steps_sampled": 2220954, "num_steps_trained": 2220954, "num_agent_steps_trained": 2220954}, "done": false, "episodes_total": 1110, "training_iteration": 185, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-27-48", "timestamp": 1690853268, "time_this_iter_s": 79.56280422210693, "time_total_s": 15211.47338461876, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15211.47338461876, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 99.97894736842106, "ram_util_percent": 55.45526315789473}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.9050364114805007, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8254032802893696, "reward_component_totals/dist_change_reward_min": -0.9929432591465522, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.0796331311911374, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.0142626854280663, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.96331311911308, "delta_v_total_min": 201.42626854280573, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1104.14, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5517941029485258, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.0236078314113675, -3.8136250266605747, -3.8417878429706542, -3.733635835752247, -3.8666835340686823, -4.0010333536459886, -3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.797836230415864, "mean_inference_ms": 8.239465459444041, "mean_action_processing_ms": 0.4145155981618159, "mean_env_wait_ms": 9.835698608097163, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2232960, "agent_timesteps_total": 2232960, "timers": {"sample_time_ms": 43707.517, "sample_throughput": 274.69, "load_time_ms": 8.523, "load_throughput": 1408597.965, "learn_time_ms": 36727.371, "learn_throughput": 326.895, "update_time_ms": 26.49}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0026369397528469563, "policy_loss": -0.00026143461582250893, "vf_loss": 0.0028983738739043474, "vf_explained_var": 0.10515107214450836, "kl": 1.1456268822485072e-08, "entropy": 2.721364736557007, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2232960, "num_agent_steps_sampled": 2232960, "num_steps_trained": 2232960, "num_agent_steps_trained": 2232960}, "done": false, "episodes_total": 1116, "training_iteration": 186, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-29-09", "timestamp": 1690853349, "time_this_iter_s": 81.47010469436646, "time_total_s": 15292.943489313126, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15292.943489313126, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 99.98017241379311, "ram_util_percent": 55.41896551724137}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.906281384674003, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8270279183981759, "reward_component_totals/dist_change_reward_min": -0.9929432591465522, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.0792534662758344, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.02560149600109, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.92534662758274, "delta_v_total_min": 202.5601496001085, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1076.35, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5379060469765117, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9191866573969643, -3.8710584894433104, -3.89233555290497, -3.887640007011367, -3.8924894058342314, -4.027605407794715, -3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7976718187296308, "mean_inference_ms": 8.239314316006743, "mean_action_processing_ms": 0.4145708438128157, "mean_env_wait_ms": 9.836328783795942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2244966, "agent_timesteps_total": 2244966, "timers": {"sample_time_ms": 43682.275, "sample_throughput": 274.848, "load_time_ms": 8.371, "load_throughput": 1434229.845, "learn_time_ms": 36771.174, "learn_throughput": 326.506, "update_time_ms": 25.693}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0023924033157527447, "policy_loss": -0.00043191760778427124, "vf_loss": 0.0028243206907063723, "vf_explained_var": 0.06965622305870056, "kl": -2.1956179097060158e-09, "entropy": 2.732081651687622, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2244966, "num_agent_steps_sampled": 2244966, "num_steps_trained": 2244966, "num_agent_steps_trained": 2244966}, "done": false, "episodes_total": 1122, "training_iteration": 187, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-30-29", "timestamp": 1690853429, "time_this_iter_s": 79.37961792945862, "time_total_s": 15372.323107242584, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15372.323107242584, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 99.98157894736843, "ram_util_percent": 55.49912280701756}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.904515602631153, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8256053517667294, "reward_component_totals/dist_change_reward_min": -0.9929432591465522, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.0789102508644293, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.02560149600109, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89102508644226, "delta_v_total_min": 202.5601496001085, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1101.88, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.550664667666167, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.827728300535761, -3.99690269417595, -3.944678308340306, -3.882266924749674, -3.800392530881263, -3.937635553335694, -3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.79752458178777, "mean_inference_ms": 8.239124929253155, "mean_action_processing_ms": 0.4146272838395983, "mean_env_wait_ms": 9.836964888285237, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2256972, "agent_timesteps_total": 2256972, "timers": {"sample_time_ms": 43890.397, "sample_throughput": 273.545, "load_time_ms": 8.833, "load_throughput": 1359169.273, "learn_time_ms": 37164.575, "learn_throughput": 323.05, "update_time_ms": 24.629}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0022665217984467745, "policy_loss": -0.00040049487142823637, "vf_loss": 0.002667014952749014, "vf_explained_var": 0.11601286381483078, "kl": 1.1391176890640509e-09, "entropy": 2.7554337978363037, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2256972, "num_agent_steps_sampled": 2256972, "num_steps_trained": 2256972, "num_agent_steps_trained": 2256972}, "done": false, "episodes_total": 1128, "training_iteration": 188, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-31-52", "timestamp": 1690853512, "time_this_iter_s": 82.65437126159668, "time_total_s": 15454.97747850418, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15454.97747850418, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 99.97606837606838, "ram_util_percent": 55.52820512820512}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.558251896920907, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.9052827371160985, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8261268434505502, "reward_component_totals/dist_change_reward_min": -0.9932254113544232, "reward_component_totals/dist_change_reward_max": -0.4780140929650341, "reward_component_totals/delta_v_mean": -2.079155893665555, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.91558936655474, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1129.32, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5643778110944527, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.8138026776825917, -3.870191314816994, -3.558251896920907, -4.056604698812909, -3.9305223668883786, -3.833690774231795, -4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7973528835403123, "mean_inference_ms": 8.23872359866311, "mean_action_processing_ms": 0.4146763941635369, "mean_env_wait_ms": 9.837446380121547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2268978, "agent_timesteps_total": 2268978, "timers": {"sample_time_ms": 43805.264, "sample_throughput": 274.077, "load_time_ms": 8.343, "load_throughput": 1439058.032, "learn_time_ms": 36945.45, "learn_throughput": 324.966, "update_time_ms": 24.116}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003043979173526168, "policy_loss": 0.0001086593110812828, "vf_loss": 0.002935317810624838, "vf_explained_var": 0.08347763866186142, "kl": -8.436981113746356e-10, "entropy": 2.751673936843872, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2268978, "num_agent_steps_sampled": 2268978, "num_steps_trained": 2268978, "num_agent_steps_trained": 2268978}, "done": false, "episodes_total": 1134, "training_iteration": 189, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-33-10", "timestamp": 1690853590, "time_this_iter_s": 77.29718708992004, "time_total_s": 15532.274665594101, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15532.274665594101, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 99.97999999999999, "ram_util_percent": 55.56181818181822}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.712363726368155, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.907355266603986, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8285614491007355, "reward_component_totals/dist_change_reward_min": -0.9932254113544232, "reward_component_totals/dist_change_reward_max": -0.6091711563772368, "reward_component_totals/delta_v_mean": -2.0787938175032568, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.87938175032497, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1124.0, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5617191404297853, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-4.062896282077986, -3.8489317099047144, -4.037422886541547, -3.8435388264051493, -4.061936049329618, -4.026413106008086, -3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686, -3.734520527959506, -3.7889951318285666, -3.9416320388821324, -3.8227108027189645, -3.953653235608485, -4.028804941144581], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.797139399325026, "mean_inference_ms": 8.238298442534274, "mean_action_processing_ms": 0.4146840651986872, "mean_env_wait_ms": 9.837741207638668, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2280984, "agent_timesteps_total": 2280984, "timers": {"sample_time_ms": 43889.109, "sample_throughput": 273.553, "load_time_ms": 8.308, "load_throughput": 1445186.868, "learn_time_ms": 36984.452, "learn_throughput": 324.623, "update_time_ms": 24.092}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0034124699886888266, "policy_loss": 0.0005253137787804008, "vf_loss": 0.002887157956138253, "vf_explained_var": 0.07356132566928864, "kl": 5.673056246990882e-09, "entropy": 2.730503559112549, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2280984, "num_agent_steps_sampled": 2280984, "num_steps_trained": 2280984, "num_agent_steps_trained": 2280984}, "done": false, "episodes_total": 1140, "training_iteration": 190, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-34-29", "timestamp": 1690853669, "time_this_iter_s": 79.1437635421753, "time_total_s": 15611.418429136276, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15611.418429136276, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 99.97964601769911, "ram_util_percent": 55.525663716814165}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.712363726368155, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.903872467383451, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8250744544071057, "reward_component_totals/dist_change_reward_min": -0.9932254113544232, "reward_component_totals/dist_change_reward_max": -0.6091711563772368, "reward_component_totals/delta_v_mean": -2.0787980129763515, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8798012976344, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1131.23, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5653323338330835, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.8398578958283345, -3.827817324797337, -3.8935692924171112, -3.88136642909835, -3.9673031349090886, -4.002528875816672, -3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686, -3.734520527959506, -3.7889951318285666, -3.9416320388821324, -3.8227108027189645, -3.953653235608485, -4.028804941144581, -4.02758880621456, -3.924986997477179, -3.8346949783174686, -3.8570467747103416, -3.994749169605119, -3.8937922118889268], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7973575546639113, "mean_inference_ms": 8.237664988271113, "mean_action_processing_ms": 0.4146965649101058, "mean_env_wait_ms": 9.837986250347711, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2292990, "agent_timesteps_total": 2292990, "timers": {"sample_time_ms": 43792.717, "sample_throughput": 274.155, "load_time_ms": 8.162, "load_throughput": 1470873.169, "learn_time_ms": 37102.282, "learn_throughput": 323.592, "update_time_ms": 22.52}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0028672858607023954, "policy_loss": 5.552941729547456e-05, "vf_loss": 0.002811758080497384, "vf_explained_var": 0.1818283647298813, "kl": 2.240682084320156e-09, "entropy": 2.7099714279174805, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2292990, "num_agent_steps_sampled": 2292990, "num_steps_trained": 2292990, "num_agent_steps_trained": 2292990}, "done": false, "episodes_total": 1146, "training_iteration": 191, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-36-05", "timestamp": 1690853765, "time_this_iter_s": 95.9099109172821, "time_total_s": 15707.328340053558, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15707.328340053558, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 99.98540145985402, "ram_util_percent": 55.538686131386854}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.712363726368155, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.9023779278743427, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8244052180308289, "reward_component_totals/dist_change_reward_min": -0.9932254113544232, "reward_component_totals/dist_change_reward_max": -0.6091711563772368, "reward_component_totals/delta_v_mean": -2.077972709843519, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7972709843512, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1140.33, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5698800599700149, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.9458854850788154, -3.7743201925270484, -3.971464668797478, -3.820937750036804, -3.833509331233135, -3.928037121871821, -3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686, -3.734520527959506, -3.7889951318285666, -3.9416320388821324, -3.8227108027189645, -3.953653235608485, -4.028804941144581, -4.02758880621456, -3.924986997477179, -3.8346949783174686, -3.8570467747103416, -3.994749169605119, -3.8937922118889268, -3.7893253692024587, -3.8786800531372023, -3.890929312293317, -3.8795414469392346, -3.818761035890697, -4.0057517844931185], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7975489004874432, "mean_inference_ms": 8.236987097848562, "mean_action_processing_ms": 0.41470417469633825, "mean_env_wait_ms": 9.838144840665624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2304996, "agent_timesteps_total": 2304996, "timers": {"sample_time_ms": 43545.574, "sample_throughput": 275.711, "load_time_ms": 8.439, "load_throughput": 1422605.313, "learn_time_ms": 37176.324, "learn_throughput": 322.947, "update_time_ms": 23.906}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0031293954234570265, "policy_loss": 0.0004922505468130112, "vf_loss": 0.002637147204950452, "vf_explained_var": 0.15406544506549835, "kl": -2.4459736458481984e-09, "entropy": 2.730257511138916, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2304996, "num_agent_steps_sampled": 2304996, "num_steps_trained": 2304996, "num_agent_steps_trained": 2304996}, "done": false, "episodes_total": 1152, "training_iteration": 192, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-37-22", "timestamp": 1690853842, "time_this_iter_s": 76.69020366668701, "time_total_s": 15784.018543720245, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15784.018543720245, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 99.97999999999999, "ram_util_percent": 55.60727272727273}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.712363726368155, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.903641804831771, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8257361580879001, "reward_component_totals/dist_change_reward_min": -0.9932254113544232, "reward_component_totals/dist_change_reward_max": -0.6091711563772368, "reward_component_totals/delta_v_mean": -2.0779056467438775, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.790564674387, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1150.94, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5751824087956021, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.9824297480144923, -3.8255879279660627, -3.845184345483902, -3.8027195759997374, -3.8528740132629338, -3.8820196046669215, -3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686, -3.734520527959506, -3.7889951318285666, -3.9416320388821324, -3.8227108027189645, -3.953653235608485, -4.028804941144581, -4.02758880621456, -3.924986997477179, -3.8346949783174686, -3.8570467747103416, -3.994749169605119, -3.8937922118889268, -3.7893253692024587, -3.8786800531372023, -3.890929312293317, -3.8795414469392346, -3.818761035890697, -4.0057517844931185, -3.8196451105093256, -3.849512938265995, -3.8590772793591754, -4.026462539808943, -4.046175087173438, -3.7996692901710833], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.797715726208955, "mean_inference_ms": 8.236275616076533, "mean_action_processing_ms": 0.41470214980524406, "mean_env_wait_ms": 9.838084570970667, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2317002, "agent_timesteps_total": 2317002, "timers": {"sample_time_ms": 43329.374, "sample_throughput": 277.087, "load_time_ms": 8.115, "load_throughput": 1479559.683, "learn_time_ms": 37275.006, "learn_throughput": 322.093, "update_time_ms": 24.402}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0025619463995099068, "policy_loss": -0.00030206816154532135, "vf_loss": 0.0028640159871429205, "vf_explained_var": 0.16151955723762512, "kl": -3.9556175002175564e-10, "entropy": 2.7419066429138184, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2317002, "num_agent_steps_sampled": 2317002, "num_steps_trained": 2317002, "num_agent_steps_trained": 2317002}, "done": false, "episodes_total": 1158, "training_iteration": 193, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-38-40", "timestamp": 1690853920, "time_this_iter_s": 77.49120044708252, "time_total_s": 15861.509744167328, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15861.509744167328, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 99.97927927927928, "ram_util_percent": 55.54234234234236}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.712363726368155, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.904150814231829, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8282836785436665, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6091711563772368, "reward_component_totals/delta_v_mean": -2.075867135688169, "reward_component_totals/delta_v_min": -2.1465085878968284, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5867135688162, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 214.6508587896818, "constraint_violation.max_vel_constraint.steps_mean": 1137.37, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5684007996001998, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.83081484761365, -4.00490849699777, -3.807157860811645, -3.981645199360062, -3.8256090441461197, -3.849304847157377, -3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686, -3.734520527959506, -3.7889951318285666, -3.9416320388821324, -3.8227108027189645, -3.953653235608485, -4.028804941144581, -4.02758880621456, -3.924986997477179, -3.8346949783174686, -3.8570467747103416, -3.994749169605119, -3.8937922118889268, -3.7893253692024587, -3.8786800531372023, -3.890929312293317, -3.8795414469392346, -3.818761035890697, -4.0057517844931185, -3.8196451105093256, -3.849512938265995, -3.8590772793591754, -4.026462539808943, -4.046175087173438, -3.7996692901710833, -3.852429391567365, -3.7986236509163565, -3.8710386386581916, -4.043739834123224, -3.8052426863226003, -3.870641953812134], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7978475891551906, "mean_inference_ms": 8.23574934611484, "mean_action_processing_ms": 0.41469595781210616, "mean_env_wait_ms": 9.837921689901714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2329008, "agent_timesteps_total": 2329008, "timers": {"sample_time_ms": 43317.861, "sample_throughput": 277.16, "load_time_ms": 7.804, "load_throughput": 1538444.1, "learn_time_ms": 37481.331, "learn_throughput": 320.319, "update_time_ms": 25.783}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003638629103079438, "policy_loss": 0.001068683690391481, "vf_loss": 0.002569944132119417, "vf_explained_var": 0.2553352117538452, "kl": 9.438403392181272e-10, "entropy": 2.6927003860473633, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2329008, "num_agent_steps_sampled": 2329008, "num_steps_trained": 2329008, "num_agent_steps_trained": 2329008}, "done": false, "episodes_total": 1164, "training_iteration": 194, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-40-00", "timestamp": 1690854000, "time_this_iter_s": 80.071617603302, "time_total_s": 15941.58136177063, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15941.58136177063, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 99.98070175438596, "ram_util_percent": 55.61403508771931}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.712363726368155, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.90732313949741, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8298054161188749, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6091711563772368, "reward_component_totals/delta_v_mean": -2.077517723378542, "reward_component_totals/delta_v_min": -2.1875349560379926, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.75177233785348, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 218.75349560379863, "constraint_violation.max_vel_constraint.steps_mean": 1143.25, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5713393303348326, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.712363726368155, -3.8607509332098164, -3.9262150179906854, -3.8053492012642893, -4.041584028276071, -3.92136458433755, -3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686, -3.734520527959506, -3.7889951318285666, -3.9416320388821324, -3.8227108027189645, -3.953653235608485, -4.028804941144581, -4.02758880621456, -3.924986997477179, -3.8346949783174686, -3.8570467747103416, -3.994749169605119, -3.8937922118889268, -3.7893253692024587, -3.8786800531372023, -3.890929312293317, -3.8795414469392346, -3.818761035890697, -4.0057517844931185, -3.8196451105093256, -3.849512938265995, -3.8590772793591754, -4.026462539808943, -4.046175087173438, -3.7996692901710833, -3.852429391567365, -3.7986236509163565, -3.8710386386581916, -4.043739834123224, -3.8052426863226003, -3.870641953812134, -3.966415999954717, -4.092844166675338, -3.839230772322476, -4.035439160639793, -3.807513141184434, -3.875229581868009], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7979651888903634, "mean_inference_ms": 8.235155757688206, "mean_action_processing_ms": 0.4146885638407925, "mean_env_wait_ms": 9.837729717878853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2341014, "agent_timesteps_total": 2341014, "timers": {"sample_time_ms": 43166.583, "sample_throughput": 278.132, "load_time_ms": 8.816, "load_throughput": 1361778.911, "learn_time_ms": 37445.189, "learn_throughput": 320.629, "update_time_ms": 26.377}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0031138290651142597, "policy_loss": 0.0004874813021160662, "vf_loss": 0.002626348752528429, "vf_explained_var": 0.32383397221565247, "kl": 1.472340915853465e-08, "entropy": 2.6938109397888184, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2341014, "num_agent_steps_sampled": 2341014, "num_steps_trained": 2341014, "num_agent_steps_trained": 2341014}, "done": false, "episodes_total": 1170, "training_iteration": 195, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-41-18", "timestamp": 1690854078, "time_this_iter_s": 77.70178127288818, "time_total_s": 16019.283143043518, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16019.283143043518, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 99.98288288288288, "ram_util_percent": 55.597297297297295}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.734520527959506, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.9103653693155893, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8337667034160576, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6091711563772368, "reward_component_totals/delta_v_mean": -2.0765986658995383, "reward_component_totals/delta_v_min": -2.1875349560379926, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.65986658995305, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 218.75349560379863, "constraint_violation.max_vel_constraint.steps_mean": 1115.8, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5576211894052973, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.8947689456671277, -3.928367429446025, -3.9820868942517684, -3.962858213242497, -3.885494506538583, -3.8669802799084434, -3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686, -3.734520527959506, -3.7889951318285666, -3.9416320388821324, -3.8227108027189645, -3.953653235608485, -4.028804941144581, -4.02758880621456, -3.924986997477179, -3.8346949783174686, -3.8570467747103416, -3.994749169605119, -3.8937922118889268, -3.7893253692024587, -3.8786800531372023, -3.890929312293317, -3.8795414469392346, -3.818761035890697, -4.0057517844931185, -3.8196451105093256, -3.849512938265995, -3.8590772793591754, -4.026462539808943, -4.046175087173438, -3.7996692901710833, -3.852429391567365, -3.7986236509163565, -3.8710386386581916, -4.043739834123224, -3.8052426863226003, -3.870641953812134, -3.966415999954717, -4.092844166675338, -3.839230772322476, -4.035439160639793, -3.807513141184434, -3.875229581868009, -3.7811572246406784, -3.875608968724971, -3.9944616510261115, -4.037048104444775, -3.8765545209083596, -4.007020003519513], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7980974760868176, "mean_inference_ms": 8.234484486980657, "mean_action_processing_ms": 0.4146796436855357, "mean_env_wait_ms": 9.837574037349444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2353020, "agent_timesteps_total": 2353020, "timers": {"sample_time_ms": 43092.647, "sample_throughput": 278.609, "load_time_ms": 7.751, "load_throughput": 1548963.821, "learn_time_ms": 37120.3, "learn_throughput": 323.435, "update_time_ms": 26.535}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0033340011723339558, "policy_loss": 0.0005803264211863279, "vf_loss": 0.0027536749839782715, "vf_explained_var": 0.05909314751625061, "kl": 1.4520620261748718e-09, "entropy": 2.722147226333618, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2353020, "num_agent_steps_sampled": 2353020, "num_steps_trained": 2353020, "num_agent_steps_trained": 2353020}, "done": false, "episodes_total": 1176, "training_iteration": 196, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-42-36", "timestamp": 1690854156, "time_this_iter_s": 77.51177620887756, "time_total_s": 16096.794919252396, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16096.794919252396, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 99.98818181818183, "ram_util_percent": 54.69090909090908}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.734520527959506, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.9083146280184904, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8338702977583354, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6091711563772368, "reward_component_totals/delta_v_mean": -2.0744443302601607, "reward_component_totals/delta_v_min": -2.1875349560379926, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.44443302601528, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 218.75349560379863, "constraint_violation.max_vel_constraint.steps_mean": 1121.46, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5604497751124439, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.996039836530267, -3.912985173248217, -3.843908844140419, -3.993774468201078, -3.9940698212420145, -3.8346686674270387, -3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686, -3.734520527959506, -3.7889951318285666, -3.9416320388821324, -3.8227108027189645, -3.953653235608485, -4.028804941144581, -4.02758880621456, -3.924986997477179, -3.8346949783174686, -3.8570467747103416, -3.994749169605119, -3.8937922118889268, -3.7893253692024587, -3.8786800531372023, -3.890929312293317, -3.8795414469392346, -3.818761035890697, -4.0057517844931185, -3.8196451105093256, -3.849512938265995, -3.8590772793591754, -4.026462539808943, -4.046175087173438, -3.7996692901710833, -3.852429391567365, -3.7986236509163565, -3.8710386386581916, -4.043739834123224, -3.8052426863226003, -3.870641953812134, -3.966415999954717, -4.092844166675338, -3.839230772322476, -4.035439160639793, -3.807513141184434, -3.875229581868009, -3.7811572246406784, -3.875608968724971, -3.9944616510261115, -4.037048104444775, -3.8765545209083596, -4.007020003519513, -3.943545337173335, -3.807961139616114, -3.9763843321006034, -3.8831547886881195, -3.7937631629256225, -3.910673378840702], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.797684580088681, "mean_inference_ms": 8.233713793706047, "mean_action_processing_ms": 0.41464394062341847, "mean_env_wait_ms": 9.836782134141965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2365026, "agent_timesteps_total": 2365026, "timers": {"sample_time_ms": 42700.207, "sample_throughput": 281.17, "load_time_ms": 8.015, "load_throughput": 1498028.101, "learn_time_ms": 36792.837, "learn_throughput": 326.314, "update_time_ms": 27.257}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0026226548943668604, "policy_loss": 6.498276343336329e-05, "vf_loss": 0.002557670697569847, "vf_explained_var": 0.16891157627105713, "kl": 6.158746290729766e-10, "entropy": 2.6858537197113037, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2365026, "num_agent_steps_sampled": 2365026, "num_steps_trained": 2365026, "num_agent_steps_trained": 2365026}, "done": false, "episodes_total": 1182, "training_iteration": 197, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-43-48", "timestamp": 1690854228, "time_this_iter_s": 72.2581033706665, "time_total_s": 16169.053022623062, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16169.053022623062, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 99.98058252427184, "ram_util_percent": 51.80679611650484}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.734520527959506, "episode_reward_min": -4.139451847043372, "episode_reward_mean": -3.908139089290068, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8329459475246764, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6091711563772368, "reward_component_totals/delta_v_mean": -2.0751931417653986, "reward_component_totals/delta_v_min": -2.1875349560379926, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.51931417653913, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 218.75349560379863, "constraint_violation.max_vel_constraint.steps_mean": 1116.16, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5578010994502749, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.836649865198358, -3.77396691857693, -3.935847414494423, -4.139451847043372, -4.038648623542594, -3.819601323195564, -4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686, -3.734520527959506, -3.7889951318285666, -3.9416320388821324, -3.8227108027189645, -3.953653235608485, -4.028804941144581, -4.02758880621456, -3.924986997477179, -3.8346949783174686, -3.8570467747103416, -3.994749169605119, -3.8937922118889268, -3.7893253692024587, -3.8786800531372023, -3.890929312293317, -3.8795414469392346, -3.818761035890697, -4.0057517844931185, -3.8196451105093256, -3.849512938265995, -3.8590772793591754, -4.026462539808943, -4.046175087173438, -3.7996692901710833, -3.852429391567365, -3.7986236509163565, -3.8710386386581916, -4.043739834123224, -3.8052426863226003, -3.870641953812134, -3.966415999954717, -4.092844166675338, -3.839230772322476, -4.035439160639793, -3.807513141184434, -3.875229581868009, -3.7811572246406784, -3.875608968724971, -3.9944616510261115, -4.037048104444775, -3.8765545209083596, -4.007020003519513, -3.943545337173335, -3.807961139616114, -3.9763843321006034, -3.8831547886881195, -3.7937631629256225, -3.910673378840702, -3.87632220389487, -4.043839787483383, -4.029917272027419, -3.8034874022333347, -3.8711739198841117, -3.933152352423793], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7971965656176678, "mean_inference_ms": 8.232729995630379, "mean_action_processing_ms": 0.41459210357146964, "mean_env_wait_ms": 9.835543499210736, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2377032, "agent_timesteps_total": 2377032, "timers": {"sample_time_ms": 42067.93, "sample_throughput": 285.396, "load_time_ms": 7.979, "load_throughput": 1504724.639, "learn_time_ms": 36197.007, "learn_throughput": 331.685, "update_time_ms": 26.518}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.0022736056707799435, "policy_loss": -0.0003914156404789537, "vf_loss": 0.0026650207582861185, "vf_explained_var": 0.3039122223854065, "kl": 8.675820595271944e-08, "entropy": 2.6556060314178467, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2377032, "num_agent_steps_sampled": 2377032, "num_steps_trained": 2377032, "num_agent_steps_trained": 2377032}, "done": false, "episodes_total": 1188, "training_iteration": 198, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-44-59", "timestamp": 1690854299, "time_this_iter_s": 70.31395053863525, "time_total_s": 16239.366973161697, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16239.366973161697, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 99.97227722772278, "ram_util_percent": 51.748514851485155}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.734520527959506, "episode_reward_min": -4.092844166675338, "episode_reward_mean": -3.9091836106667204, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8339949992889469, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6091711563772368, "reward_component_totals/delta_v_mean": -2.075188611377779, "reward_component_totals/delta_v_min": -2.1875349560379926, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5188611377771, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 218.75349560379863, "constraint_violation.max_vel_constraint.steps_mean": 1092.46, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5459570214892553, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-4.030906332038171, -3.9484120377066185, -3.9053059472899383, -3.9912312552523357, -3.871704345922348, -3.8333663859119507, -4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686, -3.734520527959506, -3.7889951318285666, -3.9416320388821324, -3.8227108027189645, -3.953653235608485, -4.028804941144581, -4.02758880621456, -3.924986997477179, -3.8346949783174686, -3.8570467747103416, -3.994749169605119, -3.8937922118889268, -3.7893253692024587, -3.8786800531372023, -3.890929312293317, -3.8795414469392346, -3.818761035890697, -4.0057517844931185, -3.8196451105093256, -3.849512938265995, -3.8590772793591754, -4.026462539808943, -4.046175087173438, -3.7996692901710833, -3.852429391567365, -3.7986236509163565, -3.8710386386581916, -4.043739834123224, -3.8052426863226003, -3.870641953812134, -3.966415999954717, -4.092844166675338, -3.839230772322476, -4.035439160639793, -3.807513141184434, -3.875229581868009, -3.7811572246406784, -3.875608968724971, -3.9944616510261115, -4.037048104444775, -3.8765545209083596, -4.007020003519513, -3.943545337173335, -3.807961139616114, -3.9763843321006034, -3.8831547886881195, -3.7937631629256225, -3.910673378840702, -3.87632220389487, -4.043839787483383, -4.029917272027419, -3.8034874022333347, -3.8711739198841117, -3.933152352423793, -4.058267242724224, -3.9488275120969236, -3.871016849459818, -3.84678593196847, -4.079412623100584, -3.8443079703663234], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.79663385074334, "mean_inference_ms": 8.2314659078477, "mean_action_processing_ms": 0.4145261321856993, "mean_env_wait_ms": 9.833866449349282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2389038, "agent_timesteps_total": 2389038, "timers": {"sample_time_ms": 41579.944, "sample_throughput": 288.745, "load_time_ms": 8.534, "load_throughput": 1406882.14, "learn_time_ms": 35872.048, "learn_throughput": 334.69, "update_time_ms": 27.142}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003046259982511401, "policy_loss": 4.6559721340599936e-06, "vf_loss": 0.003041601972654462, "vf_explained_var": 0.04427943751215935, "kl": -4.148390964076043e-09, "entropy": 2.771817684173584, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2389038, "num_agent_steps_sampled": 2389038, "num_steps_trained": 2389038, "num_agent_steps_trained": 2389038}, "done": false, "episodes_total": 1194, "training_iteration": 199, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-46-08", "timestamp": 1690854368, "time_this_iter_s": 69.17571759223938, "time_total_s": 16308.542690753937, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16308.542690753937, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 99.98686868686869, "ram_util_percent": 51.55454545454547}, "trial_id": "e0618_00000"}
{"episode_reward_max": -3.734520527959506, "episode_reward_min": -4.092844166675338, "episode_reward_mean": -3.905772564644487, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8312024685138205, "reward_component_totals/dist_change_reward_min": -0.999019090924036, "reward_component_totals/dist_change_reward_max": -0.6091711563772368, "reward_component_totals/delta_v_mean": -2.0745700961306723, "reward_component_totals/delta_v_min": -2.1875349560379926, "reward_component_totals/delta_v_max": -2.0229921125372305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.45700961306648, "delta_v_total_min": 202.2992112537224, "delta_v_total_max": 218.75349560379863, "constraint_violation.max_vel_constraint.steps_mean": 1097.94, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1962, "constraint_violation.max_vel_constraint.ratio_mean": 0.548695652173913, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9805097451274363}, "hist_stats": {"episode_reward": [-4.034356185880564, -4.01775565956694, -4.021497246179973, -3.873398698812643, -3.823759774677714, -3.874967738481049, -3.887233733214117, -3.9142724623004064, -3.9914615819109915, -4.04748861845806, -3.976024391989533, -3.792765741688167, -3.8366544372369837, -3.839704615620006, -3.9555156081824263, -3.846712925960776, -3.9168274709075757, -3.874773600595995, -3.8808709693753656, -3.824315658382391, -3.8695067051638703, -4.0385763394346395, -3.7934596105034144, -3.8610473866189956, -3.7955192905408413, -3.8857242650932173, -4.009496027133568, -3.9684907362104216, -3.8985767930805117, -3.7903269641923485, -3.948109551690786, -3.8970245787761355, -3.853785469183854, -4.078494403589686, -3.734520527959506, -3.7889951318285666, -3.9416320388821324, -3.8227108027189645, -3.953653235608485, -4.028804941144581, -4.02758880621456, -3.924986997477179, -3.8346949783174686, -3.8570467747103416, -3.994749169605119, -3.8937922118889268, -3.7893253692024587, -3.8786800531372023, -3.890929312293317, -3.8795414469392346, -3.818761035890697, -4.0057517844931185, -3.8196451105093256, -3.849512938265995, -3.8590772793591754, -4.026462539808943, -4.046175087173438, -3.7996692901710833, -3.852429391567365, -3.7986236509163565, -3.8710386386581916, -4.043739834123224, -3.8052426863226003, -3.870641953812134, -3.966415999954717, -4.092844166675338, -3.839230772322476, -4.035439160639793, -3.807513141184434, -3.875229581868009, -3.7811572246406784, -3.875608968724971, -3.9944616510261115, -4.037048104444775, -3.8765545209083596, -4.007020003519513, -3.943545337173335, -3.807961139616114, -3.9763843321006034, -3.8831547886881195, -3.7937631629256225, -3.910673378840702, -3.87632220389487, -4.043839787483383, -4.029917272027419, -3.8034874022333347, -3.8711739198841117, -3.933152352423793, -4.058267242724224, -3.9488275120969236, -3.871016849459818, -3.84678593196847, -4.079412623100584, -3.8443079703663234, -4.0255115971198006, -3.8199021523321193, -3.9065022226976964, -3.8122216563669, -3.87737710126334, -3.798306972118189], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7960107847467714, "mean_inference_ms": 8.23002280887362, "mean_action_processing_ms": 0.41443930327104317, "mean_env_wait_ms": 9.831655534888887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2401044, "agent_timesteps_total": 2401044, "timers": {"sample_time_ms": 40992.566, "sample_throughput": 292.882, "load_time_ms": 9.208, "load_throughput": 1303921.952, "learn_time_ms": 35302.028, "learn_throughput": 340.094, "update_time_ms": 26.945}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.000000013351432e-10, "total_loss": 0.003356311237439513, "policy_loss": 0.0006062231259420514, "vf_loss": 0.0027500875294208527, "vf_explained_var": 0.18198096752166748, "kl": -2.7939677238464355e-09, "entropy": 2.752291440963745, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2401044, "num_agent_steps_sampled": 2401044, "num_steps_trained": 2401044, "num_agent_steps_trained": 2401044}, "done": true, "episodes_total": 1200, "training_iteration": 200, "experiment_id": "550c5d9b39e04222961c052ea2f0b70d", "date": "2023-07-31_18-47-16", "timestamp": 1690854436, "time_this_iter_s": 67.4926381111145, "time_total_s": 16376.035328865051, "pid": 3552125, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-10, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16376.035328865051, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 99.97604166666666, "ram_util_percent": 49.848958333333336}, "trial_id": "e0618_00000"}
