{"episode_reward_max": -3.801279160038309, "episode_reward_min": -3.906790602502561, "episode_reward_mean": -3.868041636231275, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7860437416030971, "reward_component_totals/dist_change_reward_min": -0.8221965123810681, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0819978946281843, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.0715022702018433, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.19978946281765, "delta_v_total_min": 207.15022702018368, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1262.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 984, "constraint_violation.max_vel_constraint.steps_max": 1657, "constraint_violation.max_vel_constraint.ratio_mean": 0.630767949358654, "constraint_violation.max_vel_constraint.ratio_min": 0.4917541229385307, "constraint_violation.max_vel_constraint.ratio_max": 0.8280859570214892}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.408474125069775, "mean_inference_ms": 9.55043637351596, "mean_action_processing_ms": 0.4831946495569352, "mean_env_wait_ms": 12.476186751525402, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 12006, "agent_timesteps_total": 12006, "timers": {"sample_time_ms": 61559.711, "sample_throughput": 195.03, "load_time_ms": 480.467, "load_throughput": 24988.172, "learn_time_ms": 46127.41, "learn_throughput": 260.279, "update_time_ms": 46.775}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005040216725319624, "policy_loss": -8.788378181634471e-05, "vf_loss": 0.005128101911395788, "vf_explained_var": 0.38810449838638306, "kl": -1.0915500725516836e-09, "entropy": 2.7273218631744385, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 12006, "num_agent_steps_sampled": 12006, "num_steps_trained": 12006, "num_agent_steps_trained": 12006}, "done": false, "episodes_total": 6, "training_iteration": 1, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-18-30", "timestamp": 1690838310, "time_this_iter_s": 108.68379759788513, "time_total_s": 108.68379759788513, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 108.68379759788513, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 99.97354838709677, "ram_util_percent": 62.88129032258063}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.801279160038309, "episode_reward_min": -4.0375853898646445, "episode_reward_mean": -3.9101176641469757, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.838057988037891, "reward_component_totals/dist_change_reward_min": -0.9770711120984963, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.072059676109093, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.0375955082476196, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.2059676109084, "delta_v_total_min": 203.75955082476065, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1314.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 702, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6567549558554057, "constraint_violation.max_vel_constraint.ratio_min": 0.35082458770614694, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9906149566280757, "mean_inference_ms": 9.526680751505106, "mean_action_processing_ms": 0.4781200205423655, "mean_env_wait_ms": 12.328650571790027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 24012, "agent_timesteps_total": 24012, "timers": {"sample_time_ms": 55703.773, "sample_throughput": 215.533, "load_time_ms": 244.801, "load_throughput": 49043.837, "learn_time_ms": 44978.003, "learn_throughput": 266.93, "update_time_ms": 40.946}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006098355166614056, "policy_loss": 0.0006640666979365051, "vf_loss": 0.005434291437268257, "vf_explained_var": 0.173601433634758, "kl": -2.423441447518826e-09, "entropy": 2.7046051025390625, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 24012, "num_agent_steps_sampled": 24012, "num_steps_trained": 24012, "num_agent_steps_trained": 24012}, "done": false, "episodes_total": 12, "training_iteration": 2, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-20-05", "timestamp": 1690838405, "time_this_iter_s": 93.8189001083374, "time_total_s": 202.50269770622253, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 202.50269770622253, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 99.97851851851853, "ram_util_percent": 62.97037037037037}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.789009616367638, "episode_reward_min": -4.042159633006114, "episode_reward_mean": -3.9069382999469604, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8381490685726554, "reward_component_totals/dist_change_reward_min": -0.9770711120984963, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.068789231374313, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.87892313743038, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1306.611111111111, "constraint_violation.max_vel_constraint.steps_min": 702, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6529790660225443, "constraint_violation.max_vel_constraint.ratio_min": 0.35082458770614694, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7494552233604947, "mean_inference_ms": 9.507470919576813, "mean_action_processing_ms": 0.47495948333932564, "mean_env_wait_ms": 12.2232910819953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 36018, "agent_timesteps_total": 36018, "timers": {"sample_time_ms": 52959.731, "sample_throughput": 226.701, "load_time_ms": 166.444, "load_throughput": 72132.376, "learn_time_ms": 44364.745, "learn_throughput": 270.62, "update_time_ms": 46.447}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004325455985963345, "policy_loss": -0.0001611728803254664, "vf_loss": 0.004486629739403725, "vf_explained_var": 0.2434706687927246, "kl": -3.3172107283263585e-09, "entropy": 2.7477993965148926, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 36018, "num_agent_steps_sampled": 36018, "num_steps_trained": 36018, "num_agent_steps_trained": 36018}, "done": false, "episodes_total": 18, "training_iteration": 3, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-21-36", "timestamp": 1690838496, "time_this_iter_s": 90.73843312263489, "time_total_s": 293.2411308288574, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 293.2411308288574, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 99.97054263565892, "ram_util_percent": 62.944186046511625}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.789009616367638, "episode_reward_min": -4.042159633006114, "episode_reward_mean": -3.908936311280647, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8354651546818551, "reward_component_totals/dist_change_reward_min": -0.9770711120984963, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0734711565987975, "reward_component_totals/delta_v_min": -2.1187567292650575, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.3471156598789, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 211.87567292650522, "constraint_violation.max_vel_constraint.steps_mean": 1246.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6227719473596535, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6027485247641757, "mean_inference_ms": 9.524906643909569, "mean_action_processing_ms": 0.47500842187673475, "mean_env_wait_ms": 12.182819244599225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 48024, "agent_timesteps_total": 48024, "timers": {"sample_time_ms": 52762.976, "sample_throughput": 227.546, "load_time_ms": 126.684, "load_throughput": 94771.279, "learn_time_ms": 44064.599, "learn_throughput": 272.464, "update_time_ms": 41.132}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0030551841482520103, "policy_loss": -0.00041786092333495617, "vf_loss": 0.003473043441772461, "vf_explained_var": 0.11175769567489624, "kl": -1.7324602863411087e-09, "entropy": 2.7983195781707764, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 48024, "num_agent_steps_sampled": 48024, "num_steps_trained": 48024, "num_agent_steps_trained": 48024}, "done": false, "episodes_total": 24, "training_iteration": 4, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-23-11", "timestamp": 1690838591, "time_this_iter_s": 95.4374828338623, "time_total_s": 388.6786136627197, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 388.6786136627197, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 99.97372262773722, "ram_util_percent": 62.94525547445255}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.789009616367638, "episode_reward_min": -4.084506583710401, "episode_reward_mean": -3.9173509960193367, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8432548259349945, "reward_component_totals/dist_change_reward_min": -0.9910339589415847, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0740961700843483, "reward_component_totals/delta_v_min": -2.1187567292650575, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.409617008434, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 211.87567292650522, "constraint_violation.max_vel_constraint.steps_mean": 1189.3, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.594352823588206, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5067041252810633, "mean_inference_ms": 9.547283156105696, "mean_action_processing_ms": 0.475560271133111, "mean_env_wait_ms": 12.167299756246928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 60030, "agent_timesteps_total": 60030, "timers": {"sample_time_ms": 52980.487, "sample_throughput": 226.612, "load_time_ms": 102.882, "load_throughput": 116696.253, "learn_time_ms": 43923.372, "learn_throughput": 273.34, "update_time_ms": 51.606}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0053831725381314754, "policy_loss": 0.0005582590820267797, "vf_loss": 0.0048249103128910065, "vf_explained_var": 0.335527628660202, "kl": -1.9027019959594327e-09, "entropy": 2.723376750946045, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 60030, "num_agent_steps_sampled": 60030, "num_steps_trained": 60030, "num_agent_steps_trained": 60030}, "done": false, "episodes_total": 30, "training_iteration": 5, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-24-49", "timestamp": 1690838689, "time_this_iter_s": 97.37860941886902, "time_total_s": 486.05722308158875, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 486.05722308158875, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 99.98029197080291, "ram_util_percent": 62.94598540145984}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.789009616367638, "episode_reward_min": -4.084506583710401, "episode_reward_mean": -3.908799223089592, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.834852097185884, "reward_component_totals/dist_change_reward_min": -0.9910339589415847, "reward_component_totals/dist_change_reward_max": -0.7221796729571103, "reward_component_totals/delta_v_mean": -2.0739471259037146, "reward_component_totals/delta_v_min": -2.1187567292650575, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.39471259037066, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 211.87567292650522, "constraint_violation.max_vel_constraint.steps_mean": 1189.3055555555557, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5943555999777889, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.436705069307228, "mean_inference_ms": 9.552585724726192, "mean_action_processing_ms": 0.4756240594161542, "mean_env_wait_ms": 12.143634064432819, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 72036, "agent_timesteps_total": 72036, "timers": {"sample_time_ms": 52262.726, "sample_throughput": 229.724, "load_time_ms": 86.619, "load_throughput": 138607.035, "learn_time_ms": 44311.28, "learn_throughput": 270.947, "update_time_ms": 49.421}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005226087756454945, "policy_loss": 0.0003962755436077714, "vf_loss": 0.00482981139793992, "vf_explained_var": 0.23656240105628967, "kl": -2.082958028282178e-09, "entropy": 2.7357919216156006, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 72036, "num_agent_steps_sampled": 72036, "num_steps_trained": 72036, "num_agent_steps_trained": 72036}, "done": false, "episodes_total": 36, "training_iteration": 6, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-26-24", "timestamp": 1690838784, "time_this_iter_s": 95.06217861175537, "time_total_s": 581.1194016933441, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 581.1194016933441, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 99.97279411764706, "ram_util_percent": 62.95661764705881}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.789009616367638, "episode_reward_min": -4.084506583710401, "episode_reward_mean": -3.9135979605160225, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8394128772014853, "reward_component_totals/dist_change_reward_min": -0.9910339589415847, "reward_component_totals/dist_change_reward_max": -0.7221796729571103, "reward_component_totals/delta_v_mean": -2.074185083314544, "reward_component_totals/delta_v_min": -2.1187567292650575, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.41850833145358, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 211.87567292650522, "constraint_violation.max_vel_constraint.steps_mean": 1184.142857142857, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.591775540801028, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.380015592571268, "mean_inference_ms": 9.549833121154, "mean_action_processing_ms": 0.47487104688027515, "mean_env_wait_ms": 12.111048805758346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 84042, "agent_timesteps_total": 84042, "timers": {"sample_time_ms": 51569.509, "sample_throughput": 232.812, "load_time_ms": 74.904, "load_throughput": 160284.875, "learn_time_ms": 43922.31, "learn_throughput": 273.346, "update_time_ms": 46.647}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0028412367682904005, "policy_loss": -0.0014875342603772879, "vf_loss": 0.004328771494328976, "vf_explained_var": 0.19775597751140594, "kl": -2.5260873393051497e-09, "entropy": 2.748148202896118, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 84042, "num_agent_steps_sampled": 84042, "num_steps_trained": 84042, "num_agent_steps_trained": 84042}, "done": false, "episodes_total": 42, "training_iteration": 7, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-27-53", "timestamp": 1690838873, "time_this_iter_s": 89.12715935707092, "time_total_s": 670.246561050415, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 670.246561050415, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 99.97086614173229, "ram_util_percent": 63.0}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.789009616367638, "episode_reward_min": -4.084506583710401, "episode_reward_mean": -3.9173545731305985, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8412116473604757, "reward_component_totals/dist_change_reward_min": -0.9910339589415847, "reward_component_totals/dist_change_reward_max": -0.7221796729571103, "reward_component_totals/delta_v_mean": -2.07614292577013, "reward_component_totals/delta_v_min": -2.130406213651101, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.61429257701215, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.0406213651097, "constraint_violation.max_vel_constraint.steps_mean": 1170.7916666666667, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.585103281692487, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3359284552948814, "mean_inference_ms": 9.544966522763863, "mean_action_processing_ms": 0.4744059785254418, "mean_env_wait_ms": 12.087215990584582, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 96048, "agent_timesteps_total": 96048, "timers": {"sample_time_ms": 51359.492, "sample_throughput": 233.764, "load_time_ms": 66.178, "load_throughput": 181419.66, "learn_time_ms": 43407.925, "learn_throughput": 276.585, "update_time_ms": 47.406}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003423499409109354, "policy_loss": -0.0002688017557375133, "vf_loss": 0.0036923016887158155, "vf_explained_var": 0.14906185865402222, "kl": -1.802559768115941e-10, "entropy": 2.7835943698883057, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 96048, "num_agent_steps_sampled": 96048, "num_steps_trained": 96048, "num_agent_steps_trained": 96048}, "done": false, "episodes_total": 48, "training_iteration": 8, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-29-24", "timestamp": 1690838964, "time_this_iter_s": 89.84170198440552, "time_total_s": 760.0882630348206, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 760.0882630348206, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 99.97906976744186, "ram_util_percent": 63.0}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.789009616367638, "episode_reward_min": -4.084506583710401, "episode_reward_mean": -3.917868184118495, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8403928823185469, "reward_component_totals/dist_change_reward_min": -0.9910339589415847, "reward_component_totals/dist_change_reward_max": -0.7221796729571103, "reward_component_totals/delta_v_mean": -2.0774753017999554, "reward_component_totals/delta_v_min": -2.130406213651101, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.74753017999467, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.0406213651097, "constraint_violation.max_vel_constraint.steps_mean": 1146.388888888889, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5729079904492198, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3003147160714397, "mean_inference_ms": 9.542199573529771, "mean_action_processing_ms": 0.47410354096253826, "mean_env_wait_ms": 12.067938147280861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 108054, "agent_timesteps_total": 108054, "timers": {"sample_time_ms": 51171.928, "sample_throughput": 234.621, "load_time_ms": 59.628, "load_throughput": 201347.074, "learn_time_ms": 43166.517, "learn_throughput": 278.132, "update_time_ms": 45.475}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0038204817101359367, "policy_loss": -0.0004435438895598054, "vf_loss": 0.004264028277248144, "vf_explained_var": 0.1411099135875702, "kl": -2.626229456126339e-09, "entropy": 2.7559309005737305, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 108054, "num_agent_steps_sampled": 108054, "num_steps_trained": 108054, "num_agent_steps_trained": 108054}, "done": false, "episodes_total": 54, "training_iteration": 9, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-30-55", "timestamp": 1690839055, "time_this_iter_s": 90.99359464645386, "time_total_s": 851.0818576812744, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 851.0818576812744, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 99.97923076923077, "ram_util_percent": 63.05}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.789009616367638, "episode_reward_min": -4.084506583710401, "episode_reward_mean": -3.922262619897261, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8424308674769634, "reward_component_totals/dist_change_reward_min": -0.9910339589415847, "reward_component_totals/dist_change_reward_max": -0.7221796729571103, "reward_component_totals/delta_v_mean": -2.079831752420304, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9831752420296, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1127.6833333333334, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5635598867233048, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2715328684805836, "mean_inference_ms": 9.539543933718038, "mean_action_processing_ms": 0.4741134063316433, "mean_env_wait_ms": 12.055911773153094, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 120060, "agent_timesteps_total": 120060, "timers": {"sample_time_ms": 51175.147, "sample_throughput": 234.606, "load_time_ms": 54.246, "load_throughput": 221326.062, "learn_time_ms": 43002.335, "learn_throughput": 279.194, "update_time_ms": 45.239}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0032180077396333218, "policy_loss": -0.00024709056015126407, "vf_loss": 0.0034650966990739107, "vf_explained_var": 0.07741229236125946, "kl": 8.51208825647376e-11, "entropy": 2.8052327632904053, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 120060, "num_agent_steps_sampled": 120060, "num_steps_trained": 120060, "num_agent_steps_trained": 120060}, "done": false, "episodes_total": 60, "training_iteration": 10, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-32-28", "timestamp": 1690839148, "time_this_iter_s": 92.88415741920471, "time_total_s": 943.9660151004791, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 943.9660151004791, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 99.9751879699248, "ram_util_percent": 63.10000000000002}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.084506583710401, "episode_reward_mean": -3.9161750915353144, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8348287036059296, "reward_component_totals/dist_change_reward_min": -0.9910339589415847, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.0813463879293908, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1346387929383, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1153.939393939394, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5766813562915513, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.26141261884242, "mean_inference_ms": 9.538361121986254, "mean_action_processing_ms": 0.47404544823867956, "mean_env_wait_ms": 12.043285925462099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 132066, "agent_timesteps_total": 132066, "timers": {"sample_time_ms": 51156.044, "sample_throughput": 234.694, "load_time_ms": 6.997, "load_throughput": 1715875.023, "learn_time_ms": 42691.936, "learn_throughput": 281.224, "update_time_ms": 45.128}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 9.999999960041972e-13, "total_loss": 0.00449312524870038, "policy_loss": 5.722398418583907e-05, "vf_loss": 0.0044359005987644196, "vf_explained_var": 0.11633556336164474, "kl": -3.2070543998230505e-09, "entropy": 2.7632107734680176, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 132066, "num_agent_steps_sampled": 132066, "num_steps_trained": 132066, "num_agent_steps_trained": 132066}, "done": false, "episodes_total": 66, "training_iteration": 11, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-34-13", "timestamp": 1690839253, "time_this_iter_s": 104.57744526863098, "time_total_s": 1048.54346036911, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1048.54346036911, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 99.97919463087247, "ram_util_percent": 63.10000000000002}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.085586985108549, "episode_reward_mean": -3.9160709243134866, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8367761632922471, "reward_component_totals/dist_change_reward_min": -0.9910339589415847, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.0792947610212464, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9294761021238, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1146.4583333333333, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5729426953190072, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.251189133731215, "mean_inference_ms": 9.536629111103288, "mean_action_processing_ms": 0.4739893817632098, "mean_env_wait_ms": 12.035823516391124, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 144072, "agent_timesteps_total": 144072, "timers": {"sample_time_ms": 51360.017, "sample_throughput": 233.762, "load_time_ms": 6.528, "load_throughput": 1839283.154, "learn_time_ms": 42445.122, "learn_throughput": 282.859, "update_time_ms": 47.666}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005931990221142769, "policy_loss": 0.0005974654341116548, "vf_loss": 0.005334523506462574, "vf_explained_var": 0.2666860818862915, "kl": -1.3444092505920935e-09, "entropy": 2.708552837371826, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 144072, "num_agent_steps_sampled": 144072, "num_steps_trained": 144072, "num_agent_steps_trained": 144072}, "done": false, "episodes_total": 72, "training_iteration": 12, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-35-47", "timestamp": 1690839347, "time_this_iter_s": 93.37796020507812, "time_total_s": 1141.9214205741882, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1141.9214205741882, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 99.98106060606061, "ram_util_percent": 63.12575757575757}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.085586985108549, "episode_reward_mean": -3.9201548728077786, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.841105208578245, "reward_component_totals/dist_change_reward_min": -0.9910339589415847, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.0790496642295406, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90496642295327, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1160.5, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.579960019990005, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2410875010187508, "mean_inference_ms": 9.533966971385698, "mean_action_processing_ms": 0.4739552862786225, "mean_env_wait_ms": 12.028537510727475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 156078, "agent_timesteps_total": 156078, "timers": {"sample_time_ms": 51538.268, "sample_throughput": 232.953, "load_time_ms": 6.497, "load_throughput": 1847970.034, "learn_time_ms": 42293.652, "learn_throughput": 283.872, "update_time_ms": 45.332}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006131331901997328, "policy_loss": 0.00038213972584344447, "vf_loss": 0.005749191623181105, "vf_explained_var": 0.28205639123916626, "kl": -1.972801477734265e-09, "entropy": 2.694674491882324, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 156078, "num_agent_steps_sampled": 156078, "num_steps_trained": 156078, "num_agent_steps_trained": 156078}, "done": false, "episodes_total": 78, "training_iteration": 13, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-37-18", "timestamp": 1690839438, "time_this_iter_s": 91.06242156028748, "time_total_s": 1232.9838421344757, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1232.9838421344757, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 99.97480916030534, "ram_util_percent": 63.19999999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.085586985108549, "episode_reward_mean": -3.916114519853479, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8371115938456228, "reward_component_totals/dist_change_reward_min": -0.9910339589415847, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.0790029260078633, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90029260078558, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1151.9166666666667, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5756704980842912, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.232051273193412, "mean_inference_ms": 9.532897051109117, "mean_action_processing_ms": 0.47404507028202614, "mean_env_wait_ms": 12.023500899541782, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 168084, "agent_timesteps_total": 168084, "timers": {"sample_time_ms": 51353.579, "sample_throughput": 233.791, "load_time_ms": 6.505, "load_throughput": 1845707.755, "learn_time_ms": 42058.751, "learn_throughput": 285.458, "update_time_ms": 45.763}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004291343502700329, "policy_loss": 0.0007668316829949617, "vf_loss": 0.0035245113540440798, "vf_explained_var": 0.019225379452109337, "kl": -6.083639148002362e-10, "entropy": 2.81142258644104, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 168084, "num_agent_steps_sampled": 168084, "num_steps_trained": 168084, "num_agent_steps_trained": 168084}, "done": false, "episodes_total": 84, "training_iteration": 14, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-38-50", "timestamp": 1690839530, "time_this_iter_s": 91.32234048843384, "time_total_s": 1324.3061826229095, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1324.3061826229095, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 99.97461538461538, "ram_util_percent": 63.2}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.9167719354020036, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.838109493417083, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.078662441984927, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.86624419849184, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1155.0222222222221, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5772224998611805, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2238774920834965, "mean_inference_ms": 9.532206851342492, "mean_action_processing_ms": 0.4741531781040696, "mean_env_wait_ms": 12.01994731044396, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 180090, "agent_timesteps_total": 180090, "timers": {"sample_time_ms": 51047.316, "sample_throughput": 235.194, "load_time_ms": 6.481, "load_throughput": 1852627.131, "learn_time_ms": 41782.11, "learn_throughput": 287.348, "update_time_ms": 39.754}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003566318191587925, "policy_loss": -0.0004131420573685318, "vf_loss": 0.003979460336267948, "vf_explained_var": 0.251228928565979, "kl": -2.265717613525453e-09, "entropy": 2.76737380027771, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 180090, "num_agent_steps_sampled": 180090, "num_steps_trained": 180090, "num_agent_steps_trained": 180090}, "done": false, "episodes_total": 90, "training_iteration": 15, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-40-21", "timestamp": 1690839621, "time_this_iter_s": 91.62759351730347, "time_total_s": 1415.933776140213, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1415.933776140213, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 99.96946564885496, "ram_util_percent": 63.19999999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.914409632571065, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.836015316686205, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.0783943158848666, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.83943158848584, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1153.3020833333333, "constraint_violation.max_vel_constraint.steps_min": 400, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5763628602365484, "constraint_violation.max_vel_constraint.ratio_min": 0.19990004997501248, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.21642169589482, "mean_inference_ms": 9.532894318700242, "mean_action_processing_ms": 0.4743185826473298, "mean_env_wait_ms": 12.018172698665316, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 192096, "agent_timesteps_total": 192096, "timers": {"sample_time_ms": 51314.667, "sample_throughput": 233.968, "load_time_ms": 6.608, "load_throughput": 1816964.72, "learn_time_ms": 41342.39, "learn_throughput": 290.404, "update_time_ms": 37.652}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006249201018363237, "policy_loss": 0.0004808362282346934, "vf_loss": 0.005768363829702139, "vf_explained_var": 0.19737957417964935, "kl": -2.891606287747095e-09, "entropy": 2.695222854614258, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 192096, "num_agent_steps_sampled": 192096, "num_steps_trained": 192096, "num_agent_steps_trained": 192096}, "done": false, "episodes_total": 96, "training_iteration": 16, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-41-55", "timestamp": 1690839715, "time_this_iter_s": 93.32809138298035, "time_total_s": 1509.2618675231934, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1509.2618675231934, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 99.97462686567162, "ram_util_percent": 63.199999999999996}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.915007762214407, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8369803676663508, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.0780273945480623, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.80273945480542, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1145.62, "constraint_violation.max_vel_constraint.steps_min": 400, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5725237381309344, "constraint_violation.max_vel_constraint.ratio_min": 0.19990004997501248, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.0375853898646445, -3.9841855485382816, -4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.11686590385921, "mean_inference_ms": 9.565659515057922, "mean_action_processing_ms": 0.47375449454790924, "mean_env_wait_ms": 12.00264179838647, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 204102, "agent_timesteps_total": 204102, "timers": {"sample_time_ms": 51945.839, "sample_throughput": 231.125, "load_time_ms": 6.773, "load_throughput": 1772540.561, "learn_time_ms": 41231.114, "learn_throughput": 291.188, "update_time_ms": 37.914}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 9.999999960041972e-13, "total_loss": 0.00308068934828043, "policy_loss": -0.0007101299124769866, "vf_loss": 0.003790820250287652, "vf_explained_var": 0.15447625517845154, "kl": -1.7599993684669357e-09, "entropy": 2.7722349166870117, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 204102, "num_agent_steps_sampled": 204102, "num_steps_trained": 204102, "num_agent_steps_trained": 204102}, "done": false, "episodes_total": 102, "training_iteration": 17, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-43-30", "timestamp": 1690839810, "time_this_iter_s": 94.33844470977783, "time_total_s": 1603.6003122329712, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1603.6003122329712, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 99.97388059701491, "ram_util_percent": 63.199999999999996}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.9128881656755627, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8352566755806065, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.077631490094964, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.76314900949558, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1135.84, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5676361819090454, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-4.0099248725605126, -3.919498828230528, -3.871354422305731, -3.890613090876366, -3.9060897119326947, -4.042159633006114, -3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.089211782709783, "mean_inference_ms": 9.55740356302827, "mean_action_processing_ms": 0.47420927814102526, "mean_env_wait_ms": 11.988081136733632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 216108, "agent_timesteps_total": 216108, "timers": {"sample_time_ms": 52011.666, "sample_throughput": 230.833, "load_time_ms": 6.874, "load_throughput": 1746620.437, "learn_time_ms": 41593.149, "learn_throughput": 288.653, "update_time_ms": 33.618}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003311349079012871, "policy_loss": -0.0009409125777892768, "vf_loss": 0.004252261016517878, "vf_explained_var": 0.12741237878799438, "kl": -1.9477659485289678e-09, "entropy": 2.7482187747955322, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 216108, "num_agent_steps_sampled": 216108, "num_steps_trained": 216108, "num_agent_steps_trained": 216108}, "done": false, "episodes_total": 108, "training_iteration": 18, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-45-04", "timestamp": 1690839904, "time_this_iter_s": 94.12413787841797, "time_total_s": 1697.7244501113892, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1697.7244501113892, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 99.9686567164179, "ram_util_percent": 63.25597014925374}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.916740722142357, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8384207127374423, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.078320009404922, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.027510511477797, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.83200094049138, "delta_v_total_min": 202.75105114777864, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1125.13, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5622838580709645, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8911451432082753, -3.789009616367638, -3.795066385678936, -3.9800069390879207, -3.845786756330839, -3.9086167431528893, -3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.077350410314953, "mean_inference_ms": 9.559277815174108, "mean_action_processing_ms": 0.4744392161095422, "mean_env_wait_ms": 11.979022070220362, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 228114, "agent_timesteps_total": 228114, "timers": {"sample_time_ms": 52038.218, "sample_throughput": 230.715, "load_time_ms": 6.8, "load_throughput": 1765679.066, "learn_time_ms": 41724.892, "learn_throughput": 287.742, "update_time_ms": 33.005}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0053623938001692295, "policy_loss": 0.0008792118751443923, "vf_loss": 0.0044831810519099236, "vf_explained_var": 0.20418822765350342, "kl": -1.7549922626258763e-09, "entropy": 2.7589941024780273, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 228114, "num_agent_steps_sampled": 228114, "num_steps_trained": 228114, "num_agent_steps_trained": 228114}, "done": false, "episodes_total": 114, "training_iteration": 19, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-46-37", "timestamp": 1690839997, "time_this_iter_s": 92.63121271133423, "time_total_s": 1790.3556628227234, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1790.3556628227234, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 99.97651515151514, "ram_util_percent": 63.10757575757577}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.9229576444926026, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8440311211275261, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.0789265233650833, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.028095944275464, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89265233650755, "delta_v_total_min": 202.80959442754533, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1114.42, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5569315342328836, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.885427375661764, -4.0186742973373555, -3.8902461749933837, -3.940830724214011, -4.0149937988535225, -3.856888005631096, -4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0735504102941458, "mean_inference_ms": 9.563054403853469, "mean_action_processing_ms": 0.4745575850043016, "mean_env_wait_ms": 11.972287013555873, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 240120, "agent_timesteps_total": 240120, "timers": {"sample_time_ms": 51834.676, "sample_throughput": 231.621, "load_time_ms": 6.715, "load_throughput": 1787845.497, "learn_time_ms": 41848.056, "learn_throughput": 286.895, "update_time_ms": 32.626}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0038680918514728546, "policy_loss": -0.0005070518236607313, "vf_loss": 0.004375141579657793, "vf_explained_var": 0.20327550172805786, "kl": -7.585772565654736e-10, "entropy": 2.749708652496338, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 240120, "num_agent_steps_sampled": 240120, "num_steps_trained": 240120, "num_agent_steps_trained": 240120}, "done": false, "episodes_total": 120, "training_iteration": 20, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-48-09", "timestamp": 1690840089, "time_this_iter_s": 92.1482744216919, "time_total_s": 1882.5039372444153, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1882.5039372444153, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 99.9810606060606, "ram_util_percent": 63.10000000000002}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.923001404428118, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8444009831752736, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.07860042125285, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.028095944275464, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.86004212528422, "delta_v_total_min": 202.80959442754533, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1116.66, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5580509745127437, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-4.084506583710401, -4.0315850916022855, -3.838027064837622, -3.8800578652096442, -3.9519151559504806, -3.842536752880787, -3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.077582130247061, "mean_inference_ms": 9.55862056450025, "mean_action_processing_ms": 0.4744946827378257, "mean_env_wait_ms": 11.962785174895568, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 252126, "agent_timesteps_total": 252126, "timers": {"sample_time_ms": 51894.253, "sample_throughput": 231.355, "load_time_ms": 6.345, "load_throughput": 1892273.872, "learn_time_ms": 41656.344, "learn_throughput": 288.215, "update_time_ms": 30.496}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0036689674016088247, "policy_loss": -0.001049228711053729, "vf_loss": 0.0047181942500174046, "vf_explained_var": 0.30070748925209045, "kl": -3.787879343519762e-09, "entropy": 2.732022762298584, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 252126, "num_agent_steps_sampled": 252126, "num_steps_trained": 252126, "num_agent_steps_trained": 252126}, "done": false, "episodes_total": 126, "training_iteration": 21, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-49-53", "timestamp": 1690840193, "time_this_iter_s": 103.18551301956177, "time_total_s": 1985.689450263977, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1985.689450263977, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 99.97162162162162, "ram_util_percent": 63.13783783783785}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.923378018115996, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8454900674283915, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.0778879506876105, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.028095944275464, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.78879506876027, "delta_v_total_min": 202.80959442754533, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1119.77, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5596051974012993, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8935309105136016, -3.8051283970382244, -3.864056912857032, -3.8390740214050867, -3.991309215035725, -3.8545389157893366, -3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.08141327343518, "mean_inference_ms": 9.553943074406263, "mean_action_processing_ms": 0.47424947201617657, "mean_env_wait_ms": 11.954033898404445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 264132, "agent_timesteps_total": 264132, "timers": {"sample_time_ms": 51511.004, "sample_throughput": 233.076, "load_time_ms": 6.621, "load_throughput": 1813411.808, "learn_time_ms": 41295.352, "learn_throughput": 290.735, "update_time_ms": 27.448}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004559900611639023, "policy_loss": 0.0006392817595042288, "vf_loss": 0.0039206198416650295, "vf_explained_var": 0.10125778615474701, "kl": -1.6172967409744388e-09, "entropy": 2.7804625034332275, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 264132, "num_agent_steps_sampled": 264132, "num_steps_trained": 264132, "num_agent_steps_trained": 264132}, "done": false, "episodes_total": 132, "training_iteration": 22, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-51-19", "timestamp": 1690840279, "time_this_iter_s": 85.97122406959534, "time_total_s": 2071.6606743335724, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2071.6606743335724, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 99.97642276422765, "ram_util_percent": 60.60162601626015}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.9295130731956, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8516273895279427, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.077885683667663, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.028095944275464, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7885683667656, "delta_v_total_min": 202.80959442754533, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1101.9, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5506746626686657, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.851329841782052, -3.9891915224879257, -3.9391388175526068, -4.028833997800001, -3.940397277808709, -3.87948188705963, -3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0858885810163468, "mean_inference_ms": 9.547332385027682, "mean_action_processing_ms": 0.47404306388761724, "mean_env_wait_ms": 11.944385148803173, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 276138, "agent_timesteps_total": 276138, "timers": {"sample_time_ms": 50656.837, "sample_throughput": 237.007, "load_time_ms": 6.384, "load_throughput": 1880557.4, "learn_time_ms": 40762.146, "learn_throughput": 294.538, "update_time_ms": 26.365}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0028916513547301292, "policy_loss": -0.0011506912996992469, "vf_loss": 0.004042342305183411, "vf_explained_var": 0.16322851181030273, "kl": -2.904124163372046e-10, "entropy": 2.7714486122131348, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 276138, "num_agent_steps_sampled": 276138, "num_steps_trained": 276138, "num_agent_steps_trained": 276138}, "done": false, "episodes_total": 138, "training_iteration": 23, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-52-37", "timestamp": 1690840357, "time_this_iter_s": 77.18185186386108, "time_total_s": 2148.8425261974335, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2148.8425261974335, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 99.98363636363636, "ram_util_percent": 55.58272727272727}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.9317500668404888, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8528849569204864, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.078865109920008, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.028095944275464, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.88651099200007, "delta_v_total_min": 202.80959442754533, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1085.21, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5423338330834582, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9119352263250153, -3.86024993564308, -4.052019349398474, -4.017821492360877, -3.8698440766582127, -3.893901226690539, -3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.090769993453962, "mean_inference_ms": 9.54062848797949, "mean_action_processing_ms": 0.47391220238782344, "mean_env_wait_ms": 11.934005534948234, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 288144, "agent_timesteps_total": 288144, "timers": {"sample_time_ms": 49711.433, "sample_throughput": 241.514, "load_time_ms": 6.478, "load_throughput": 1853418.103, "learn_time_ms": 40158.844, "learn_throughput": 298.963, "update_time_ms": 25.27}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003955317661166191, "policy_loss": 0.00020136107923462987, "vf_loss": 0.003753956174477935, "vf_explained_var": 0.15872704982757568, "kl": -2.2782353781281017e-10, "entropy": 2.790476083755493, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 288144, "num_agent_steps_sampled": 288144, "num_steps_trained": 288144, "num_agent_steps_trained": 288144}, "done": false, "episodes_total": 144, "training_iteration": 24, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-53-53", "timestamp": 1690840433, "time_this_iter_s": 75.73901963233948, "time_total_s": 2224.581545829773, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2224.581545829773, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 99.97798165137615, "ram_util_percent": 55.31284403669725}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.929653906884965, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8521273221777669, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.077526584707204, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.028095944275464, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.75265847071958, "delta_v_total_min": 202.80959442754533, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1078.54, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.539000499750125, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8962511459553983, -3.9576979972795012, -3.9819083903270807, -3.932259595219273, -3.7941479492384675, -3.9991895838858245, -3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.094743939661169, "mean_inference_ms": 9.529899517916274, "mean_action_processing_ms": 0.47338825197301765, "mean_env_wait_ms": 11.916475009938578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 300150, "agent_timesteps_total": 300150, "timers": {"sample_time_ms": 48735.253, "sample_throughput": 246.351, "load_time_ms": 6.263, "load_throughput": 1916843.245, "learn_time_ms": 39631.387, "learn_throughput": 302.942, "update_time_ms": 23.912}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004775471054017544, "policy_loss": 0.00028725556330755353, "vf_loss": 0.0044882153160870075, "vf_explained_var": 0.2381005883216858, "kl": -3.3797997733842067e-09, "entropy": 2.738252878189087, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 300150, "num_agent_steps_sampled": 300150, "num_steps_trained": 300150, "num_agent_steps_trained": 300150}, "done": false, "episodes_total": 150, "training_iteration": 25, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-55-09", "timestamp": 1690840509, "time_this_iter_s": 76.49525022506714, "time_total_s": 2301.07679605484, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2301.07679605484, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 99.98317757009345, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.9279945064855974, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8503200824413087, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.077674424044295, "reward_component_totals/delta_v_min": -2.135935090631255, "reward_component_totals/delta_v_max": -2.028095944275464, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7674424044286, "delta_v_total_min": 202.80959442754533, "delta_v_total_max": 213.59350906312403, "constraint_violation.max_vel_constraint.steps_mean": 1073.14, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5363018490754622, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9006786651475145, -4.010190803223455, -4.031122434251285, -4.035545815690355, -3.9439356881717726, -3.9866958701771216, -3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.097858295448398, "mean_inference_ms": 9.515031834288886, "mean_action_processing_ms": 0.4726627953065032, "mean_env_wait_ms": 11.892526903777448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 312156, "agent_timesteps_total": 312156, "timers": {"sample_time_ms": 47781.862, "sample_throughput": 251.267, "load_time_ms": 6.382, "load_throughput": 1881147.506, "learn_time_ms": 39000.174, "learn_throughput": 307.845, "update_time_ms": 25.513}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0033737251069396734, "policy_loss": -0.0004845500225201249, "vf_loss": 0.00385827524587512, "vf_explained_var": 0.08593130856752396, "kl": -1.6498429289413252e-09, "entropy": 2.7852959632873535, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 312156, "num_agent_steps_sampled": 312156, "num_steps_trained": 312156, "num_agent_steps_trained": 312156}, "done": false, "episodes_total": 156, "training_iteration": 26, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-56-28", "timestamp": 1690840588, "time_this_iter_s": 77.53280591964722, "time_total_s": 2378.6096019744873, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2378.6096019744873, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 99.98125, "ram_util_percent": 55.29999999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.391886410042238, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.9236505852809205, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8465134537180944, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.3146259604141997, "reward_component_totals/delta_v_mean": -2.077137131562832, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.028095944275464, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.71371315628247, "delta_v_total_min": 202.80959442754533, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1100.5, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5499922697639662, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9352367550051026, -3.847660683311445, -4.0263834407874, -3.391886410042238, -3.91235892138913, -3.9673219221819513, -3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.09081049270663, "mean_inference_ms": 9.499288427893388, "mean_action_processing_ms": 0.471737391333481, "mean_env_wait_ms": 11.865234913218353, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 324158, "agent_timesteps_total": 324158, "timers": {"sample_time_ms": 46342.111, "sample_throughput": 259.065, "load_time_ms": 6.381, "load_throughput": 1881380.015, "learn_time_ms": 38614.205, "learn_throughput": 310.911, "update_time_ms": 25.388}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006433706730604172, "policy_loss": -1.6486612366861664e-05, "vf_loss": 0.006450193002820015, "vf_explained_var": 0.2754039168357849, "kl": -4.150894739041178e-09, "entropy": 2.676225185394287, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 324158, "num_agent_steps_sampled": 324158, "num_steps_trained": 324158, "num_agent_steps_trained": 324158}, "done": false, "episodes_total": 162, "training_iteration": 27, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-57-44", "timestamp": 1690840664, "time_this_iter_s": 76.10432267189026, "time_total_s": 2454.7139246463776, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2454.7139246463776, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 99.98256880733945, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.924247813844988, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8469642511177194, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.0772835627272754, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.028095944275464, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.72835627272678, "delta_v_total_min": 202.80959442754533, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1076.34, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5379183067454756, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.7875748914149376, -4.085586985108549, -3.9612408893569544, -3.7754668997887997, -3.8548520796855694, -4.036366992098129, -3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.083792255437876, "mean_inference_ms": 9.477373417433583, "mean_action_processing_ms": 0.4706476568827437, "mean_env_wait_ms": 11.834097599538477, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 336164, "agent_timesteps_total": 336164, "timers": {"sample_time_ms": 45436.674, "sample_throughput": 264.227, "load_time_ms": 6.376, "load_throughput": 1882913.642, "learn_time_ms": 38018.18, "learn_throughput": 315.786, "update_time_ms": 27.654}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005384922027587891, "policy_loss": 0.0011230695527046919, "vf_loss": 0.0042618559673428535, "vf_explained_var": 0.2425953447818756, "kl": -1.1992029591567643e-09, "entropy": 2.7638967037200928, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 336164, "num_agent_steps_sampled": 336164, "num_steps_trained": 336164, "num_agent_steps_trained": 336164}, "done": false, "episodes_total": 168, "training_iteration": 28, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_14-59-03", "timestamp": 1690840743, "time_this_iter_s": 79.10780906677246, "time_total_s": 2533.82173371315, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2533.82173371315, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 99.9849557522124, "ram_util_percent": 55.29999999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.922125717766674, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8436282649612378, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.0784974528054425, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0315313246846256, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.84974528054354, "delta_v_total_min": 203.15313246846154, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1081.42, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.540457037380158, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.991928494664603, -3.920411133327584, -4.060722631620928, -3.9506921970389053, -3.8536610297658864, -3.8477289631117424, -3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0768350535269438, "mean_inference_ms": 9.45297463680329, "mean_action_processing_ms": 0.4694485565844431, "mean_env_wait_ms": 11.796073395928966, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 348170, "agent_timesteps_total": 348170, "timers": {"sample_time_ms": 44491.843, "sample_throughput": 269.838, "load_time_ms": 6.972, "load_throughput": 1721978.761, "learn_time_ms": 37582.757, "learn_throughput": 319.444, "update_time_ms": 27.364}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004965502303093672, "policy_loss": 0.0005797682679258287, "vf_loss": 0.0043857344426214695, "vf_explained_var": 0.1455773264169693, "kl": -1.8125740908203625e-09, "entropy": 2.748189687728882, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 348170, "num_agent_steps_sampled": 348170, "num_steps_trained": 348170, "num_agent_steps_trained": 348170}, "done": false, "episodes_total": 174, "training_iteration": 29, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-00-22", "timestamp": 1690840822, "time_this_iter_s": 78.83175754547119, "time_total_s": 2612.653491258621, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2612.653491258621, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.29999999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.089391401196886, "episode_reward_mean": -3.9228524059638037, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8446201173493947, "reward_component_totals/dist_change_reward_min": -0.9997473658972621, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.078232288614415, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0315313246846256, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.82322886144075, "delta_v_total_min": 203.15313246846154, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1065.39, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5324460428774096, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9050351780605768, -3.8255906709236056, -3.8067357619187963, -3.9427879849048977, -4.089391401196886, -3.8840577112351733, -3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.069516406194639, "mean_inference_ms": 9.426055284116996, "mean_action_processing_ms": 0.4680539750820635, "mean_env_wait_ms": 11.753628040199635, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 360176, "agent_timesteps_total": 360176, "timers": {"sample_time_ms": 43475.521, "sample_throughput": 276.146, "load_time_ms": 7.079, "load_throughput": 1695847.403, "learn_time_ms": 37199.356, "learn_throughput": 322.737, "update_time_ms": 26.346}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005602903198450804, "policy_loss": 0.0008085296140052378, "vf_loss": 0.004794374108314514, "vf_explained_var": 0.19786961376667023, "kl": -3.2170686115051694e-09, "entropy": 2.7309482097625732, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 360176, "num_agent_steps_sampled": 360176, "num_steps_trained": 360176, "num_agent_steps_trained": 360176}, "done": false, "episodes_total": 180, "training_iteration": 30, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-01-41", "timestamp": 1690840901, "time_this_iter_s": 78.07076811790466, "time_total_s": 2690.724259376526, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2690.724259376526, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 99.97767857142857, "ram_util_percent": 55.29999999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.087158517148788, "episode_reward_mean": -3.9209580615224215, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8435107483999742, "reward_component_totals/dist_change_reward_min": -0.9968870606700874, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.077447313122454, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0315313246846256, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.74473131224468, "delta_v_total_min": 203.15313246846154, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1094.89, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5471886715630667, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8446826944219907, -3.841028720796003, -3.9718982125745304, -3.924795778263431, -3.850450088022275, -3.9217132077875396, -3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0641700617744294, "mean_inference_ms": 9.395295566428818, "mean_action_processing_ms": 0.46646686528045095, "mean_env_wait_ms": 11.706311429367052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 372182, "agent_timesteps_total": 372182, "timers": {"sample_time_ms": 42171.024, "sample_throughput": 284.688, "load_time_ms": 8.042, "load_throughput": 1492773.64, "learn_time_ms": 36743.702, "learn_throughput": 326.739, "update_time_ms": 27.716}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0052638729102909565, "policy_loss": 0.0008544203010387719, "vf_loss": 0.004409452434629202, "vf_explained_var": 0.03819788247346878, "kl": -3.8805106350459084e-10, "entropy": 2.751943588256836, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 372182, "num_agent_steps_sampled": 372182, "num_steps_trained": 372182, "num_agent_steps_trained": 372182}, "done": false, "episodes_total": 186, "training_iteration": 31, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-03-06", "timestamp": 1690840986, "time_this_iter_s": 85.61650037765503, "time_total_s": 2776.340759754181, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2776.340759754181, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 99.97622950819672, "ram_util_percent": 55.29999999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.087158517148788, "episode_reward_mean": -3.921059406787366, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8448532867061228, "reward_component_totals/dist_change_reward_min": -0.9968870606700874, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.076206120081249, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.62061200812414, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1078.04, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5387678819578694, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.799700559142657, -3.792298277035355, -4.044766062826879, -3.864922345827213, -4.061137724102554, -3.8021955272836996, -3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.057842232015559, "mean_inference_ms": 9.36073755312682, "mean_action_processing_ms": 0.4646790259852859, "mean_env_wait_ms": 11.653818627822737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 384188, "agent_timesteps_total": 384188, "timers": {"sample_time_ms": 41087.81, "sample_throughput": 292.194, "load_time_ms": 8.184, "load_throughput": 1466929.321, "learn_time_ms": 36921.927, "learn_throughput": 325.162, "update_time_ms": 27.034}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0038712751120328903, "policy_loss": -0.0004217932582832873, "vf_loss": 0.0042930725030601025, "vf_explained_var": 0.29916656017303467, "kl": -3.039316132102954e-09, "entropy": 2.7410471439361572, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 384188, "num_agent_steps_sampled": 384188, "num_steps_trained": 384188, "num_agent_steps_trained": 384188}, "done": false, "episodes_total": 192, "training_iteration": 32, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-04-23", "timestamp": 1690841063, "time_this_iter_s": 76.87903499603271, "time_total_s": 2853.2197947502136, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2853.2197947502136, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 99.97272727272725, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.087158517148788, "episode_reward_mean": -3.921405272887006, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8457665796894404, "reward_component_totals/dist_change_reward_min": -0.9968870606700874, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.0756386931975714, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5638693197564, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1084.52, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5420062627674646, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.7819513026145826, -3.8638271065114624, -4.037737296471201, -3.867001999277341, -3.976017917181309, -3.941605878682972, -3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0512020965371662, "mean_inference_ms": 9.323544080173743, "mean_action_processing_ms": 0.46270184647178764, "mean_env_wait_ms": 11.597339344064224, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 396194, "agent_timesteps_total": 396194, "timers": {"sample_time_ms": 41103.895, "sample_throughput": 292.079, "load_time_ms": 9.683, "load_throughput": 1239916.972, "learn_time_ms": 37122.572, "learn_throughput": 323.404, "update_time_ms": 26.728}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005586118903011084, "policy_loss": 0.00038187066093087196, "vf_loss": 0.005204248707741499, "vf_explained_var": 0.14775939285755157, "kl": -1.7149354158974006e-09, "entropy": 2.721266746520996, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 396194, "num_agent_steps_sampled": 396194, "num_steps_trained": 396194, "num_agent_steps_trained": 396194}, "done": false, "episodes_total": 198, "training_iteration": 33, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-05-43", "timestamp": 1690841143, "time_this_iter_s": 79.33701133728027, "time_total_s": 2932.556806087494, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2932.556806087494, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 99.98407079646019, "ram_util_percent": 55.29999999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.087158517148788, "episode_reward_mean": -3.9199392777792803, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8449755441578454, "reward_component_totals/dist_change_reward_min": -0.9968870606700874, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.0749637336214413, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.49637336214343, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1082.82, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5411566875550707, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9096993341004396, -3.8345060485603413, -3.8149508605415785, -3.8448816011972253, -3.9988120786415386, -3.9892708149282745, -4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.043795911648217, "mean_inference_ms": 9.282438307880135, "mean_action_processing_ms": 0.4605717017033594, "mean_env_wait_ms": 11.53544258916623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 408200, "agent_timesteps_total": 408200, "timers": {"sample_time_ms": 40810.516, "sample_throughput": 294.179, "load_time_ms": 9.413, "load_throughput": 1275443.221, "learn_time_ms": 37500.707, "learn_throughput": 320.143, "update_time_ms": 26.896}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005452257115393877, "policy_loss": 0.00017254646809305996, "vf_loss": 0.005279713310301304, "vf_explained_var": 0.27737390995025635, "kl": -1.6974105454536925e-09, "entropy": 2.6995224952697754, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 408200, "num_agent_steps_sampled": 408200, "num_steps_trained": 408200, "num_agent_steps_trained": 408200}, "done": false, "episodes_total": 204, "training_iteration": 34, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-07-00", "timestamp": 1690841220, "time_this_iter_s": 76.64952540397644, "time_total_s": 3009.2063314914703, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3009.2063314914703, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 99.97706422018346, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.087158517148788, "episode_reward_mean": -3.9197199706490444, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8452650510286923, "reward_component_totals/dist_change_reward_min": -0.9968870606700874, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.0744549196203583, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.44549196203508, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1102.68, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.55108172503633, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-4.052555101991175, -3.9334879730032193, -4.003052428816637, -4.047717808210465, -4.019411837731482, -3.878297150723331, -4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.035969997704929, "mean_inference_ms": 9.237073323580654, "mean_action_processing_ms": 0.4583836620332163, "mean_env_wait_ms": 11.470635329837362, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 420206, "agent_timesteps_total": 420206, "timers": {"sample_time_ms": 40898.489, "sample_throughput": 293.546, "load_time_ms": 10.193, "load_throughput": 1177776.699, "learn_time_ms": 37837.77, "learn_throughput": 317.291, "update_time_ms": 26.625}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003952519968152046, "policy_loss": -0.00012962002074345946, "vf_loss": 0.004082141909748316, "vf_explained_var": 0.09582357853651047, "kl": -2.9066276052702733e-09, "entropy": 2.7706613540649414, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 420206, "num_agent_steps_sampled": 420206, "num_steps_trained": 420206, "num_agent_steps_trained": 420206}, "done": false, "episodes_total": 210, "training_iteration": 35, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-08-21", "timestamp": 1690841301, "time_this_iter_s": 80.69583511352539, "time_total_s": 3089.9021666049957, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3089.9021666049957, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 99.98103448275862, "ram_util_percent": 55.369827586206895}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.087158517148788, "episode_reward_mean": -3.917173178620763, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8434656454862464, "reward_component_totals/dist_change_reward_min": -0.9968870606700874, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.0737075331345234, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.37075331345156, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1079.59, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5395424946515225, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-4.005119106145427, -4.082173073905733, -3.8259494802957397, -4.020373170049439, -4.0284873840317355, -4.061440575472567, -3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.02794285345697, "mean_inference_ms": 9.189575214721437, "mean_action_processing_ms": 0.45614160102249296, "mean_env_wait_ms": 11.403811829994659, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 432212, "agent_timesteps_total": 432212, "timers": {"sample_time_ms": 40598.077, "sample_throughput": 295.718, "load_time_ms": 10.101, "load_throughput": 1188582.653, "learn_time_ms": 38087.276, "learn_throughput": 315.213, "update_time_ms": 27.198}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005177568644285202, "policy_loss": 0.0008551802020519972, "vf_loss": 0.0043223886750638485, "vf_explained_var": 0.1913611888885498, "kl": -3.026798367500305e-09, "entropy": 2.757359743118286, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 432212, "num_agent_steps_sampled": 432212, "num_steps_trained": 432212, "num_agent_steps_trained": 432212}, "done": false, "episodes_total": 216, "training_iteration": 36, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-09-38", "timestamp": 1690841378, "time_this_iter_s": 77.01631593704224, "time_total_s": 3166.918482542038, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3166.918482542038, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 99.98, "ram_util_percent": 55.36454545454546}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.087158517148788, "episode_reward_mean": -3.9123631141076056, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8383500398307636, "reward_component_totals/dist_change_reward_min": -0.9968466991499547, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.074013074276848, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.40130742768403, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1075.0, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5372486415780593, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.8679510845080323, -3.8679951617941457, -3.885401803924939, -3.900160360511073, -4.059690091674258, -3.9838791819279713, -3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.014522285002414, "mean_inference_ms": 9.142080923414774, "mean_action_processing_ms": 0.4538569347400949, "mean_env_wait_ms": 11.335447523242186, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 444218, "agent_timesteps_total": 444218, "timers": {"sample_time_ms": 40573.871, "sample_throughput": 295.905, "load_time_ms": 10.039, "load_throughput": 1195930.677, "learn_time_ms": 38079.651, "learn_throughput": 315.287, "update_time_ms": 27.698}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003650604747235775, "policy_loss": -0.000771733873989433, "vf_loss": 0.004422335885465145, "vf_explained_var": 0.21662773191928864, "kl": -2.4910375984177335e-09, "entropy": 2.7428946495056152, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 444218, "num_agent_steps_sampled": 444218, "num_steps_trained": 444218, "num_agent_steps_trained": 444218}, "done": false, "episodes_total": 222, "training_iteration": 37, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-10-54", "timestamp": 1690841454, "time_this_iter_s": 75.82145690917969, "time_total_s": 3242.7399394512177, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3242.7399394512177, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 99.9824074074074, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.087158517148788, "episode_reward_mean": -3.910012989116556, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8356769542618088, "reward_component_totals/dist_change_reward_min": -0.9968466991499547, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.0743360348547526, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4336034854746, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1072.23, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5358643337319823, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.9008877534169404, -3.798622642777061, -4.0240936551870945, -3.8991165579957903, -3.9514595890637887, -4.087158517148788, -3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0010775048598437, "mean_inference_ms": 9.093667208921657, "mean_action_processing_ms": 0.4515629582975811, "mean_env_wait_ms": 11.265385133128122, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 456224, "agent_timesteps_total": 456224, "timers": {"sample_time_ms": 40337.615, "sample_throughput": 297.638, "load_time_ms": 10.25, "load_throughput": 1171328.407, "learn_time_ms": 37990.89, "learn_throughput": 316.023, "update_time_ms": 26.654}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0028404942713677883, "policy_loss": -0.001312184613198042, "vf_loss": 0.00415267888456583, "vf_explained_var": 0.13663464784622192, "kl": 1.2517777092657667e-10, "entropy": 2.766509771347046, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 456224, "num_agent_steps_sampled": 456224, "num_steps_trained": 456224, "num_agent_steps_trained": 456224}, "done": false, "episodes_total": 228, "training_iteration": 38, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-12-10", "timestamp": 1690841530, "time_this_iter_s": 75.85578727722168, "time_total_s": 3318.5957267284393, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3318.5957267284393, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 99.98073394495412, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.910087954091765, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8351994670716352, "reward_component_totals/dist_change_reward_min": -0.9968466991499547, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.0748884870201385, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4888487020131, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1080.35, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5399223047464751, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.973955534031417, -3.916386129230123, -4.061044519569754, -3.8711395915555027, -4.0194484995503625, -4.024117937147176, -4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.987716352137606, "mean_inference_ms": 9.04494647050354, "mean_action_processing_ms": 0.4492703027370154, "mean_env_wait_ms": 11.19492545717542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 468230, "agent_timesteps_total": 468230, "timers": {"sample_time_ms": 40254.503, "sample_throughput": 298.252, "load_time_ms": 9.403, "load_throughput": 1276853.757, "learn_time_ms": 37964.237, "learn_throughput": 316.245, "update_time_ms": 28.114}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005064106080681086, "policy_loss": -0.00038755053537897766, "vf_loss": 0.005451656877994537, "vf_explained_var": 0.24991083145141602, "kl": -4.145887633200118e-09, "entropy": 2.7017710208892822, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 468230, "num_agent_steps_sampled": 468230, "num_steps_trained": 468230, "num_agent_steps_trained": 468230}, "done": false, "episodes_total": 234, "training_iteration": 39, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-13-28", "timestamp": 1690841608, "time_this_iter_s": 77.79721927642822, "time_total_s": 3396.3929460048676, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3396.3929460048676, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 99.98108108108107, "ram_util_percent": 55.300000000000004}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.9116419239821063, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8362334114364848, "reward_component_totals/dist_change_reward_min": -0.9968466991499547, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.075408512545629, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.54085125456214, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1104.38, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5519313002487238, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-4.019333249284374, -3.828836275080529, -4.057685197474111, -3.9026515504432524, -3.9357198277539833, -3.883829974933586, -3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9750821660508202, "mean_inference_ms": 8.998794201670878, "mean_action_processing_ms": 0.4470343539012988, "mean_env_wait_ms": 11.127936973062878, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 480236, "agent_timesteps_total": 480236, "timers": {"sample_time_ms": 40459.035, "sample_throughput": 296.745, "load_time_ms": 9.416, "load_throughput": 1275085.239, "learn_time_ms": 37844.691, "learn_throughput": 317.244, "update_time_ms": 26.973}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004915154539048672, "policy_loss": 0.0002763021329883486, "vf_loss": 0.004638851620256901, "vf_explained_var": 0.0787547305226326, "kl": -2.368363283267172e-09, "entropy": 2.756544589996338, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 480236, "num_agent_steps_sampled": 480236, "num_steps_trained": 480236, "num_agent_steps_trained": 480236}, "done": false, "episodes_total": 240, "training_iteration": 40, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-14-47", "timestamp": 1690841687, "time_this_iter_s": 78.87313294410706, "time_total_s": 3475.2660789489746, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3475.2660789489746, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 99.98018018018017, "ram_util_percent": 55.37297297297298}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.914567171303891, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8383260131323996, "reward_component_totals/dist_change_reward_min": -0.9946794955997474, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.076241158171498, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.62411581714915, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1114.08, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.556778876460618, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.905818313097595, -3.8386739243493198, -4.012525621916092, -3.8195876494732084, -3.948859490381762, -4.054551141000718, -3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9650832305636519, "mean_inference_ms": 8.953903880476675, "mean_action_processing_ms": 0.4449600597870962, "mean_env_wait_ms": 11.06508937805851, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 492242, "agent_timesteps_total": 492242, "timers": {"sample_time_ms": 40709.949, "sample_throughput": 294.916, "load_time_ms": 8.807, "load_throughput": 1363168.67, "learn_time_ms": 38086.432, "learn_throughput": 315.23, "update_time_ms": 26.154}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003737751627340913, "policy_loss": -1.2753271221299656e-05, "vf_loss": 0.003750505391508341, "vf_explained_var": 0.16617077589035034, "kl": -1.079032307949035e-09, "entropy": 2.789853096008301, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 492242, "num_agent_steps_sampled": 492242, "num_steps_trained": 492242, "num_agent_steps_trained": 492242}, "done": false, "episodes_total": 246, "training_iteration": 41, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-16-18", "timestamp": 1690841778, "time_this_iter_s": 90.53326058387756, "time_total_s": 3565.799339532852, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3565.799339532852, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 99.98372093023255, "ram_util_percent": 55.36434108527132}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.916845029030116, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.840046532024815, "reward_component_totals/dist_change_reward_min": -0.9946794955997474, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.076798497005307, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.67984970052996, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1106.72, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5531007155410778, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.658329491238053, -3.8369774557693694, -3.8272022266796393, -4.0695948168992695, -3.9379234895271282, -3.839707796843676, -3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9555871715498745, "mean_inference_ms": 8.911726606407006, "mean_action_processing_ms": 0.44302063421562204, "mean_env_wait_ms": 11.005990440629324, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 504248, "agent_timesteps_total": 504248, "timers": {"sample_time_ms": 40936.704, "sample_throughput": 293.282, "load_time_ms": 8.449, "load_throughput": 1420983.516, "learn_time_ms": 37804.393, "learn_throughput": 317.582, "update_time_ms": 26.364}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0038367314264178276, "policy_loss": -0.0010322770103812218, "vf_loss": 0.004869009368121624, "vf_explained_var": 0.30786821246147156, "kl": -1.244267022748602e-09, "entropy": 2.740781307220459, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 504248, "num_agent_steps_sampled": 504248, "num_steps_trained": 504248, "num_agent_steps_trained": 504248}, "done": false, "episodes_total": 252, "training_iteration": 42, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-17-35", "timestamp": 1690841855, "time_this_iter_s": 76.39292645454407, "time_total_s": 3642.1922659873962, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3642.1922659873962, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 99.98545454545454, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.919199452370809, "episode_len_mean": 2000.96, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8428236833546662, "reward_component_totals/dist_change_reward_min": -0.9946794955997474, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.07637576901615, "reward_component_totals/delta_v_min": -2.2033675187826085, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6375769016143, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 220.33675187826034, "constraint_violation.max_vel_constraint.steps_mean": 1097.89, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5486879219378794, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.978848068517987, -3.9738765261133264, -3.7625614723859826, -3.980859802805692, -3.945771973635267, -3.9325375746219695, -3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456], "episode_lengths": [2001, 1997, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9467569666879316, "mean_inference_ms": 8.871867110776945, "mean_action_processing_ms": 0.4411778047498634, "mean_env_wait_ms": 10.949626186206082, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 516254, "agent_timesteps_total": 516254, "timers": {"sample_time_ms": 40934.099, "sample_throughput": 293.301, "load_time_ms": 7.419, "load_throughput": 1618206.743, "learn_time_ms": 37941.785, "learn_throughput": 316.432, "update_time_ms": 29.131}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 9.999999960041972e-13, "total_loss": 0.002616876969113946, "policy_loss": -0.0013668842148035765, "vf_loss": 0.003983763046562672, "vf_explained_var": 0.2076866179704666, "kl": -1.5071403014488283e-09, "entropy": 2.7692782878875732, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 516254, "num_agent_steps_sampled": 516254, "num_steps_trained": 516254, "num_agent_steps_trained": 516254}, "done": false, "episodes_total": 258, "training_iteration": 43, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-18-56", "timestamp": 1690841936, "time_this_iter_s": 80.65977334976196, "time_total_s": 3722.852039337158, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3722.852039337158, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 99.98173913043478, "ram_util_percent": 55.37130434782608}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.5506642766914047, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.9203788115908975, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8450082197020753, "reward_component_totals/dist_change_reward_min": -0.9946794955997474, "reward_component_totals/dist_change_reward_max": -0.4438586867472769, "reward_component_totals/delta_v_mean": -2.0753705918888286, "reward_component_totals/delta_v_min": -2.13753612155716, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.53705918888213, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 213.75361215571542, "constraint_violation.max_vel_constraint.steps_mean": 1074.42, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5369415292353823, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.847396996158255, -3.5506642766914047, -3.9393309701034998, -3.9248691979136794, -3.902687997731519, -3.7893104595502445, -3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9384986121544936, "mean_inference_ms": 8.834318114440874, "mean_action_processing_ms": 0.4394401890026339, "mean_env_wait_ms": 10.895794764053806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 528260, "agent_timesteps_total": 528260, "timers": {"sample_time_ms": 41136.929, "sample_throughput": 291.855, "load_time_ms": 7.92, "load_throughput": 1515935.91, "learn_time_ms": 37842.192, "learn_throughput": 317.265, "update_time_ms": 29.541}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005107121076434851, "policy_loss": 0.0010702820727601647, "vf_loss": 0.0040368372574448586, "vf_explained_var": 0.12824779748916626, "kl": -1.8376096200256598e-09, "entropy": 2.7822647094726562, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 528260, "num_agent_steps_sampled": 528260, "num_steps_trained": 528260, "num_agent_steps_trained": 528260}, "done": false, "episodes_total": 264, "training_iteration": 44, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-20-14", "timestamp": 1690842014, "time_this_iter_s": 77.73967242240906, "time_total_s": 3800.5917117595673, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3800.5917117595673, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 99.98288288288289, "ram_util_percent": 55.37927927927928}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7614766474344536, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.9263073548525758, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8512220567465038, "reward_component_totals/dist_change_reward_min": -0.9946794955997474, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.075085298106078, "reward_component_totals/delta_v_min": -2.13753612155716, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.50852981060703, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 213.75361215571542, "constraint_violation.max_vel_constraint.steps_mean": 1073.68, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5365717141429286, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.9802630705803344, -3.82844152681928, -3.9082710178613596, -3.8799050570787865, -3.843686571780392, -4.025560358666508, -4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.930806393019708, "mean_inference_ms": 8.798713231745, "mean_action_processing_ms": 0.43779668187768456, "mean_env_wait_ms": 10.84428471259457, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 540266, "agent_timesteps_total": 540266, "timers": {"sample_time_ms": 40927.317, "sample_throughput": 293.349, "load_time_ms": 7.313, "load_throughput": 1641709.554, "learn_time_ms": 37635.893, "learn_throughput": 319.004, "update_time_ms": 31.225}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004215027205646038, "policy_loss": -0.00023951542971190065, "vf_loss": 0.004454543348401785, "vf_explained_var": 0.3013823330402374, "kl": -1.9277375529203056e-10, "entropy": 2.748318672180176, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 540266, "num_agent_steps_sampled": 540266, "num_steps_trained": 540266, "num_agent_steps_trained": 540266}, "done": false, "episodes_total": 270, "training_iteration": 45, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-21-30", "timestamp": 1690842090, "time_this_iter_s": 76.51651000976562, "time_total_s": 3877.108221769333, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3877.108221769333, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 99.98348623853212, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7614766474344536, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.922751872591093, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8486673960729605, "reward_component_totals/dist_change_reward_min": -0.9946794955997474, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.0740844765181383, "reward_component_totals/delta_v_min": -2.13753612155716, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.40844765181305, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 213.75361215571542, "constraint_violation.max_vel_constraint.steps_mean": 1057.31, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5283908045977012, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-4.006124792811903, -3.9250394915816393, -3.982158892652069, -3.91524316175009, -3.8475952330703587, -3.890032243993777, -3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.923590196023693, "mean_inference_ms": 8.765686078042688, "mean_action_processing_ms": 0.4362602663566687, "mean_env_wait_ms": 10.795845970571644, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 552272, "agent_timesteps_total": 552272, "timers": {"sample_time_ms": 41092.328, "sample_throughput": 292.171, "load_time_ms": 7.089, "load_throughput": 1693536.973, "learn_time_ms": 37541.593, "learn_throughput": 319.805, "update_time_ms": 29.371}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005476190708577633, "policy_loss": 0.0006787286838516593, "vf_loss": 0.0047974600456655025, "vf_explained_var": 0.1705121546983719, "kl": -2.4634985162919065e-09, "entropy": 2.7266290187835693, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 552272, "num_agent_steps_sampled": 552272, "num_steps_trained": 552272, "num_agent_steps_trained": 552272}, "done": false, "episodes_total": 276, "training_iteration": 46, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-22-48", "timestamp": 1690842168, "time_this_iter_s": 77.7193078994751, "time_total_s": 3954.827529668808, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3954.827529668808, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 99.98648648648647, "ram_util_percent": 55.300000000000004}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7614766474344536, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.916632535597192, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8425713939959891, "reward_component_totals/dist_change_reward_min": -0.9946794955997474, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.0740611416012085, "reward_component_totals/delta_v_min": -2.13753612155716, "reward_component_totals/delta_v_max": -2.0206924226880085, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.40611416012013, "delta_v_total_min": 202.0692422688004, "delta_v_total_max": 213.75361215571542, "constraint_violation.max_vel_constraint.steps_mean": 1027.96, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5137231384307847, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.821875768066156, -4.06098831274434, -3.84796822681426, -3.7957044794128754, -3.7703432383406454, -4.022998584539451, -3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9142995088847627, "mean_inference_ms": 8.73515211916546, "mean_action_processing_ms": 0.4347975506360878, "mean_env_wait_ms": 10.750302170067574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 564278, "agent_timesteps_total": 564278, "timers": {"sample_time_ms": 41165.922, "sample_throughput": 291.649, "load_time_ms": 7.296, "load_throughput": 1645625.999, "learn_time_ms": 37448.046, "learn_throughput": 320.604, "update_time_ms": 28.275}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004182776901870966, "policy_loss": 0.0002521417336538434, "vf_loss": 0.0039306338876485825, "vf_explained_var": 0.14834022521972656, "kl": -3.3823033263047364e-09, "entropy": 2.7717854976654053, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 564278, "num_agent_steps_sampled": 564278, "num_steps_trained": 564278, "num_agent_steps_trained": 564278}, "done": false, "episodes_total": 282, "training_iteration": 47, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-24-04", "timestamp": 1690842244, "time_this_iter_s": 75.60558748245239, "time_total_s": 4030.4331171512604, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4030.4331171512604, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 99.97981651376146, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7614766474344536, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.922645069037438, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8460477525662017, "reward_component_totals/dist_change_reward_min": -0.9946794955997474, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.076597316471242, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.023494186153017, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6597316471235, "delta_v_total_min": 202.34941861530126, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1007.63, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5035632183908045, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-3.9181012920796325, -3.8948964408841027, -3.7614766474344536, -3.99688702508185, -4.042036010580137, -3.8318561759575136, -4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9056504025148364, "mean_inference_ms": 8.706256492049157, "mean_action_processing_ms": 0.43345764851322327, "mean_env_wait_ms": 10.708045730199064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 576284, "agent_timesteps_total": 576284, "timers": {"sample_time_ms": 41429.881, "sample_throughput": 289.791, "load_time_ms": 7.254, "load_throughput": 1655004.234, "learn_time_ms": 37467.151, "learn_throughput": 320.441, "update_time_ms": 28.061}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006219405215233564, "policy_loss": 0.0010946155525743961, "vf_loss": 0.005124789196997881, "vf_explained_var": 0.29488757252693176, "kl": -1.3444092505920935e-09, "entropy": 2.728787899017334, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 576284, "num_agent_steps_sampled": 576284, "num_steps_trained": 576284, "num_agent_steps_trained": 576284}, "done": false, "episodes_total": 288, "training_iteration": 48, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-25-23", "timestamp": 1690842323, "time_this_iter_s": 78.70210528373718, "time_total_s": 4109.135222434998, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4109.135222434998, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 99.97657657657656, "ram_util_percent": 55.300000000000004}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.762879815399666, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.9246725254161583, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8469877644512502, "reward_component_totals/dist_change_reward_min": -0.993735374654849, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.077684760964914, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.023494186153017, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7684760964906, "delta_v_total_min": 202.34941861530126, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1008.53, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1957, "constraint_violation.max_vel_constraint.ratio_mean": 0.5040129935032485, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9780109945027486}, "hist_stats": {"episode_reward": [-4.019707685575644, -3.8349883639591034, -3.9016916458421442, -3.7693272242678177, -3.9678464344239996, -3.8705490680063543, -3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.897692239975425, "mean_inference_ms": 8.679057649585285, "mean_action_processing_ms": 0.43222165213647223, "mean_env_wait_ms": 10.668852759169562, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 588290, "agent_timesteps_total": 588290, "timers": {"sample_time_ms": 41423.96, "sample_throughput": 289.832, "load_time_ms": 7.401, "load_throughput": 1622299.127, "learn_time_ms": 37185.965, "learn_throughput": 322.864, "update_time_ms": 28.079}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004883165471255779, "policy_loss": 0.0007717867265455425, "vf_loss": 0.0041113789193332195, "vf_explained_var": 0.26559731364250183, "kl": -3.3622746808958937e-09, "entropy": 2.7774507999420166, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 588290, "num_agent_steps_sampled": 588290, "num_steps_trained": 588290, "num_agent_steps_trained": 588290}, "done": false, "episodes_total": 294, "training_iteration": 49, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-26-38", "timestamp": 1690842398, "time_this_iter_s": 74.90014457702637, "time_total_s": 4184.035367012024, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4184.035367012024, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 99.98411214953272, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.762879815399666, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.929837077091555, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8504588740740434, "reward_component_totals/dist_change_reward_min": -0.9965790308781807, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.0793782030175167, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.023494186153017, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93782030175092, "delta_v_total_min": 202.34941861530126, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1034.37, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5169265367316341, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.815711008376451, -3.9921829538876725, -3.8838374396451014, -3.7914150856267534, -3.823538090031777, -3.762879815399666, -3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.890131482986974, "mean_inference_ms": 8.652962935417136, "mean_action_processing_ms": 0.43106634342212574, "mean_env_wait_ms": 10.631458773580846, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 600296, "agent_timesteps_total": 600296, "timers": {"sample_time_ms": 41286.321, "sample_throughput": 290.798, "load_time_ms": 7.416, "load_throughput": 1618966.311, "learn_time_ms": 37160.477, "learn_throughput": 323.085, "update_time_ms": 28.917}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004927649162709713, "policy_loss": 0.00021425921295303851, "vf_loss": 0.004713390488177538, "vf_explained_var": 0.18342339992523193, "kl": -2.551122868510447e-09, "entropy": 2.7491276264190674, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 600296, "num_agent_steps_sampled": 600296, "num_steps_trained": 600296, "num_agent_steps_trained": 600296}, "done": false, "episodes_total": 300, "training_iteration": 50, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-27-56", "timestamp": 1690842476, "time_this_iter_s": 77.32770252227783, "time_total_s": 4261.363069534302, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4261.363069534302, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 99.98198198198199, "ram_util_percent": 55.300000000000004}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.771894178795852, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.9315141210404296, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8521906838364679, "reward_component_totals/dist_change_reward_min": -0.9965790308781807, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.0793234372039673, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.023494186153017, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93234372039595, "delta_v_total_min": 202.34941861530126, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1022.74, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5111144427786107, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.9243904378602785, -4.051573999176061, -3.9395389265759286, -3.8682687559020765, -3.9615297601049693, -3.852035305240806, -3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8848198797380553, "mean_inference_ms": 8.627967830942227, "mean_action_processing_ms": 0.429997106640934, "mean_env_wait_ms": 10.597083078263449, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 612302, "agent_timesteps_total": 612302, "timers": {"sample_time_ms": 41333.084, "sample_throughput": 290.469, "load_time_ms": 7.243, "load_throughput": 1657537.362, "learn_time_ms": 37009.08, "learn_throughput": 324.407, "update_time_ms": 28.11}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005412606988102198, "policy_loss": 0.0010796046117320657, "vf_loss": 0.004333003424108028, "vf_explained_var": 0.23631852865219116, "kl": -1.299345187000256e-09, "entropy": 2.741157054901123, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 612302, "num_agent_steps_sampled": 612302, "num_steps_trained": 612302, "num_agent_steps_trained": 612302}, "done": false, "episodes_total": 306, "training_iteration": 51, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-29-26", "timestamp": 1690842566, "time_this_iter_s": 89.51784539222717, "time_total_s": 4350.880914926529, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4350.880914926529, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 99.984375, "ram_util_percent": 55.29999999999998}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.771894178795852, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.9296919832298314, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8506069764886471, "reward_component_totals/dist_change_reward_min": -0.9965790308781807, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.07908500674119, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.023494186153017, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9085006741182, "delta_v_total_min": 202.34941861530126, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1036.57, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5180259870064967, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.9977207421440077, -3.9247678303866267, -4.07483643034241, -3.8689530294294157, -3.997157334455352, -3.8599645738257626, -3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8798762408780638, "mean_inference_ms": 8.604375875747936, "mean_action_processing_ms": 0.4289696256520671, "mean_env_wait_ms": 10.564921526525639, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 624308, "agent_timesteps_total": 624308, "timers": {"sample_time_ms": 41335.313, "sample_throughput": 290.454, "load_time_ms": 9.469, "load_throughput": 1267884.288, "learn_time_ms": 37177.508, "learn_throughput": 322.937, "update_time_ms": 29.898}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0027789121959358454, "policy_loss": -0.0012009881902486086, "vf_loss": 0.003979899454861879, "vf_explained_var": 0.0545673593878746, "kl": -1.4420478144927529e-09, "entropy": 2.7803449630737305, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 624308, "num_agent_steps_sampled": 624308, "num_steps_trained": 624308, "num_agent_steps_trained": 624308}, "done": false, "episodes_total": 312, "training_iteration": 52, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-30-44", "timestamp": 1690842644, "time_this_iter_s": 78.05362248420715, "time_total_s": 4428.934537410736, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4428.934537410736, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 99.97657657657658, "ram_util_percent": 55.354054054054025}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.771894178795852, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.9251805324680094, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8454129248476522, "reward_component_totals/dist_change_reward_min": -0.9965790308781807, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.0797676076203624, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.023494186153017, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9767607620354, "delta_v_total_min": 202.34941861530126, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1050.22, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5248475762118939, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8397963646090583, -4.041339480162094, -3.966328976262248, -3.8379496092703125, -3.79522572738178, -4.014433810418632, -3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8753602846388946, "mean_inference_ms": 8.582488824456467, "mean_action_processing_ms": 0.4279848400783489, "mean_env_wait_ms": 10.534788253539983, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 636314, "agent_timesteps_total": 636314, "timers": {"sample_time_ms": 41391.049, "sample_throughput": 290.063, "load_time_ms": 8.847, "load_throughput": 1357114.355, "learn_time_ms": 36759.361, "learn_throughput": 326.611, "update_time_ms": 27.88}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 9.999999960041972e-13, "total_loss": 0.002441281918436289, "policy_loss": -0.0012688044225797057, "vf_loss": 0.0037100885529071093, "vf_explained_var": 0.15443800389766693, "kl": -3.0493303437850727e-09, "entropy": 2.779909133911133, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 636314, "num_agent_steps_sampled": 636314, "num_steps_trained": 636314, "num_agent_steps_trained": 636314}, "done": false, "episodes_total": 318, "training_iteration": 53, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-32-01", "timestamp": 1690842721, "time_this_iter_s": 77.01785683631897, "time_total_s": 4505.952394247055, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4505.952394247055, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 99.9846846846847, "ram_util_percent": 55.42432432432431}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.771894178795852, "episode_reward_min": -4.1042170397065645, "episode_reward_mean": -3.926502820619653, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8449117589679492, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.081591061651711, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.029519183437037, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.15910616517027, "delta_v_total_min": 202.95191834370263, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1052.58, "constraint_violation.max_vel_constraint.steps_min": 376, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5260269865067467, "constraint_violation.max_vel_constraint.ratio_min": 0.18790604697651175, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8089880958312747, -3.955453680859522, -3.8522805901588875, -3.903683280585331, -4.072498635347204, -4.1042170397065645, -3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8712603408818385, "mean_inference_ms": 8.56225119080277, "mean_action_processing_ms": 0.4270796148000139, "mean_env_wait_ms": 10.506706621534668, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 648320, "agent_timesteps_total": 648320, "timers": {"sample_time_ms": 41613.237, "sample_throughput": 288.514, "load_time_ms": 8.266, "load_throughput": 1452423.036, "learn_time_ms": 36849.256, "learn_throughput": 325.814, "update_time_ms": 29.366}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005707068368792534, "policy_loss": -2.4631819542264566e-05, "vf_loss": 0.00573169719427824, "vf_explained_var": 0.2884177565574646, "kl": -5.287508653140094e-09, "entropy": 2.7004618644714355, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 648320, "num_agent_steps_sampled": 648320, "num_steps_trained": 648320, "num_agent_steps_trained": 648320}, "done": false, "episodes_total": 324, "training_iteration": 54, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-33-22", "timestamp": 1690842802, "time_this_iter_s": 80.85613322257996, "time_total_s": 4586.808527469635, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4586.808527469635, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 99.97913043478259, "ram_util_percent": 55.43304347826085}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.771894178795852, "episode_reward_min": -4.091415364222349, "episode_reward_mean": -3.9272560567421966, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8454533390187493, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.081802717723453, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.029519183437037, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1802717723445, "delta_v_total_min": 202.95191834370263, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1038.45, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5189655172413792, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.771894178795852, -3.8501055658505954, -3.9498190567142784, -3.9203007366960723, -3.9671846205216523, -4.056835462769952, -3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.867685802742965, "mean_inference_ms": 8.543157653081257, "mean_action_processing_ms": 0.4262558165671589, "mean_env_wait_ms": 10.481184398177238, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 660326, "agent_timesteps_total": 660326, "timers": {"sample_time_ms": 41807.15, "sample_throughput": 287.176, "load_time_ms": 8.056, "load_throughput": 1490230.143, "learn_time_ms": 36945.522, "learn_throughput": 324.965, "update_time_ms": 28.745}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004226364195346832, "policy_loss": 0.0008511713240295649, "vf_loss": 0.0033751940354704857, "vf_explained_var": 0.1097443476319313, "kl": -6.359030524372145e-10, "entropy": 2.80942702293396, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 660326, "num_agent_steps_sampled": 660326, "num_steps_trained": 660326, "num_agent_steps_trained": 660326}, "done": false, "episodes_total": 330, "training_iteration": 55, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-34-42", "timestamp": 1690842882, "time_this_iter_s": 79.49752378463745, "time_total_s": 4666.3060512542725, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4666.3060512542725, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 99.9830357142857, "ram_util_percent": 55.399999999999984}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7752658653989206, "episode_reward_min": -4.091415364222349, "episode_reward_mean": -3.9292648738079943, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8477885543161336, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.0814763194918675, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.029519183437037, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.14763194918586, "delta_v_total_min": 202.95191834370263, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1031.54, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5155122438780609, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.997029591430344, -3.955852073066976, -4.070910942370644, -3.973676509958789, -4.091415364222349, -4.025821492868214, -4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8645077971612978, "mean_inference_ms": 8.52531676061631, "mean_action_processing_ms": 0.4254957246702261, "mean_env_wait_ms": 10.457355314980166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 672332, "agent_timesteps_total": 672332, "timers": {"sample_time_ms": 41773.466, "sample_throughput": 287.407, "load_time_ms": 8.153, "load_throughput": 1472593.69, "learn_time_ms": 36899.406, "learn_throughput": 325.371, "update_time_ms": 28.766}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004815556574612856, "policy_loss": 0.00030015065567567945, "vf_loss": 0.004515407606959343, "vf_explained_var": 0.21324047446250916, "kl": -4.343668535966572e-09, "entropy": 2.752720594406128, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 672332, "num_agent_steps_sampled": 672332, "num_steps_trained": 672332, "num_agent_steps_trained": 672332}, "done": false, "episodes_total": 336, "training_iteration": 56, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-35-59", "timestamp": 1690842959, "time_this_iter_s": 76.96351194381714, "time_total_s": 4743.26956319809, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4743.26956319809, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 99.97999999999999, "ram_util_percent": 55.432727272727284}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7752658653989206, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.925558500457447, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8438000628850301, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7063780899767867, "reward_component_totals/delta_v_mean": -2.0817584375724234, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.029519183437037, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.17584375724152, "delta_v_total_min": 202.95191834370263, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1022.78, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5111344327836082, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.057335551862481, -3.908592366588091, -4.034933043326637, -3.8024829882805373, -3.9259373809590095, -3.8480929524336505, -4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.859711266517598, "mean_inference_ms": 8.508836356966164, "mean_action_processing_ms": 0.4247338473941098, "mean_env_wait_ms": 10.434170873188116, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 684338, "agent_timesteps_total": 684338, "timers": {"sample_time_ms": 41871.924, "sample_throughput": 286.732, "load_time_ms": 8.304, "load_throughput": 1445747.002, "learn_time_ms": 37048.317, "learn_throughput": 324.063, "update_time_ms": 30.934}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005613537039607763, "policy_loss": 0.0004867719835601747, "vf_loss": 0.0051267677918076515, "vf_explained_var": 0.2710261046886444, "kl": -6.709528488357819e-10, "entropy": 2.7283120155334473, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 684338, "num_agent_steps_sampled": 684338, "num_steps_trained": 684338, "num_agent_steps_trained": 684338}, "done": false, "episodes_total": 342, "training_iteration": 57, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-37-17", "timestamp": 1690843037, "time_this_iter_s": 78.00884509086609, "time_total_s": 4821.278408288956, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4821.278408288956, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 99.98571428571428, "ram_util_percent": 55.444642857142846}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7752658653989206, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.9238478942452177, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8430695104676807, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7117513273009466, "reward_component_totals/delta_v_mean": -2.0807783837775427, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.029519183437037, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0778383777535, "delta_v_total_min": 202.95191834370263, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1034.66, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5170714642678661, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.037423726445452, -4.075421173485257, -4.0391879966511794, -3.8817386828665774, -3.7752658653989206, -3.9179741619940263, -4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8551931104395103, "mean_inference_ms": 8.49306805016058, "mean_action_processing_ms": 0.4240178164072655, "mean_env_wait_ms": 10.412018482893405, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 696344, "agent_timesteps_total": 696344, "timers": {"sample_time_ms": 41590.245, "sample_throughput": 288.673, "load_time_ms": 8.037, "load_throughput": 1493828.633, "learn_time_ms": 37007.915, "learn_throughput": 324.417, "update_time_ms": 33.668}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 9.999999960041972e-13, "total_loss": 0.002691101748496294, "policy_loss": -0.0013487465912476182, "vf_loss": 0.004039847292006016, "vf_explained_var": 0.17950353026390076, "kl": -1.6598571406234441e-09, "entropy": 2.7594802379608154, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 696344, "num_agent_steps_sampled": 696344, "num_steps_trained": 696344, "num_agent_steps_trained": 696344}, "done": false, "episodes_total": 348, "training_iteration": 58, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-38-33", "timestamp": 1690843113, "time_this_iter_s": 75.48117566108704, "time_total_s": 4896.759583950043, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4896.759583950043, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 99.98333333333333, "ram_util_percent": 55.39999999999997}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.77779568118096, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.9211201666217095, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8404794839144819, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7117513273009466, "reward_component_totals/delta_v_mean": -2.080640682707234, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.029519183437037, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0640682707227, "delta_v_total_min": 202.95191834370263, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1056.0, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5277361319340329, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.024231376657268, -3.8996874840787488, -3.827965971839447, -3.9600527510581456, -4.004112113008484, -3.9643917221989406, -3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8511040661541804, "mean_inference_ms": 8.477949553498156, "mean_action_processing_ms": 0.4233542383289357, "mean_env_wait_ms": 10.391568663681468, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 708350, "agent_timesteps_total": 708350, "timers": {"sample_time_ms": 41688.582, "sample_throughput": 287.993, "load_time_ms": 8.156, "load_throughput": 1471991.05, "learn_time_ms": 37392.418, "learn_throughput": 321.081, "update_time_ms": 32.107}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004807997960597277, "policy_loss": 0.0002623923064675182, "vf_loss": 0.004545607138425112, "vf_explained_var": 0.22425518929958344, "kl": -3.469927678523277e-09, "entropy": 2.7519915103912354, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 708350, "num_agent_steps_sampled": 708350, "num_steps_trained": 708350, "num_agent_steps_trained": 708350}, "done": false, "episodes_total": 354, "training_iteration": 59, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-39-53", "timestamp": 1690843193, "time_this_iter_s": 79.65592384338379, "time_total_s": 4976.4155077934265, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4976.4155077934265, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 99.98421052631579, "ram_util_percent": 55.41842105263156}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.77779568118096, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.9184460736275124, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.837938223536356, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7060316456188441, "reward_component_totals/delta_v_mean": -2.0805078500911627, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.0293816331525685, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0507850091155, "delta_v_total_min": 202.93816331525602, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1071.66, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5355622188905548, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8630417873060328, -4.0251853934886075, -3.9947326088458097, -3.8409277152411594, -3.972535982059669, -3.7915150538374833, -4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8471340845549324, "mean_inference_ms": 8.463316856767682, "mean_action_processing_ms": 0.4226943630588657, "mean_env_wait_ms": 10.371781531014497, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 720356, "agent_timesteps_total": 720356, "timers": {"sample_time_ms": 41641.256, "sample_throughput": 288.32, "load_time_ms": 8.161, "load_throughput": 1471122.396, "learn_time_ms": 37548.676, "learn_throughput": 319.745, "update_time_ms": 31.323}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0037361467257142067, "policy_loss": -0.0013434800785034895, "vf_loss": 0.0050796279683709145, "vf_explained_var": 0.25362709164619446, "kl": -2.9141384860764674e-09, "entropy": 2.7149882316589355, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 720356, "num_agent_steps_sampled": 720356, "num_steps_trained": 720356, "num_agent_steps_trained": 720356}, "done": false, "episodes_total": 360, "training_iteration": 60, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-41-12", "timestamp": 1690843272, "time_this_iter_s": 78.33536314964294, "time_total_s": 5054.7508709430695, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5054.7508709430695, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 99.98660714285714, "ram_util_percent": 55.47499999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.77779568118096, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.923083011946013, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8421425664026869, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7060316456188441, "reward_component_totals/delta_v_mean": -2.0809404455433325, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.0293816331525685, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0940445543325, "delta_v_total_min": 202.93816331525602, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1074.71, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5370864567716143, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.030088897141365, -3.976486118425691, -3.8391141532723343, -3.937374019579835, -3.7842218157608327, -3.94983180437045, -3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8447640167564636, "mean_inference_ms": 8.449289596752605, "mean_action_processing_ms": 0.42211219182589543, "mean_env_wait_ms": 10.353546642776775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 732362, "agent_timesteps_total": 732362, "timers": {"sample_time_ms": 41881.572, "sample_throughput": 286.665, "load_time_ms": 8.432, "load_throughput": 1423812.015, "learn_time_ms": 37573.639, "learn_throughput": 319.533, "update_time_ms": 30.675}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005518563557416201, "policy_loss": 5.3591626056004316e-05, "vf_loss": 0.00546497106552124, "vf_explained_var": 0.31334254145622253, "kl": -3.7478224967912865e-09, "entropy": 2.7143819332122803, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 732362, "num_agent_steps_sampled": 732362, "num_steps_trained": 732362, "num_agent_steps_trained": 732362}, "done": false, "episodes_total": 366, "training_iteration": 61, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-42-44", "timestamp": 1690843364, "time_this_iter_s": 92.19181728363037, "time_total_s": 5146.9426882267, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5146.9426882267, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 99.98778625954198, "ram_util_percent": 55.48854961832061}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.77779568118096, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.922097190281713, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8418952582721569, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7060316456188441, "reward_component_totals/delta_v_mean": -2.0802019320095613, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.0293816331525685, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0201932009554, "delta_v_total_min": 202.93816331525602, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1087.35, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5434032983508247, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8877484935976465, -3.866067913969208, -3.7836801298309135, -3.839029219109311, -3.8122660474184538, -3.8099432622866187, -3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8426338717552526, "mean_inference_ms": 8.436025147594215, "mean_action_processing_ms": 0.4215918871386265, "mean_env_wait_ms": 10.336701468174306, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 744368, "agent_timesteps_total": 744368, "timers": {"sample_time_ms": 42013.5, "sample_throughput": 285.765, "load_time_ms": 6.305, "load_throughput": 1904079.655, "learn_time_ms": 37389.823, "learn_throughput": 321.103, "update_time_ms": 30.017}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004974849987775087, "policy_loss": -8.067136150202714e-06, "vf_loss": 0.0049829185009002686, "vf_explained_var": 0.24964693188667297, "kl": -2.403413024154588e-09, "entropy": 2.720209836959839, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 744368, "num_agent_steps_sampled": 744368, "num_steps_trained": 744368, "num_agent_steps_trained": 744368}, "done": false, "episodes_total": 372, "training_iteration": 62, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-44-02", "timestamp": 1690843442, "time_this_iter_s": 77.57072281837463, "time_total_s": 5224.5134110450745, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5224.5134110450745, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 99.97927927927927, "ram_util_percent": 55.51261261261259}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7565520614146246, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.9229682981863623, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8422678364987213, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7060316456188441, "reward_component_totals/delta_v_mean": -2.080700461687648, "reward_component_totals/delta_v_min": -2.1664755484461735, "reward_component_totals/delta_v_max": -2.0293816331525685, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.070046168764, "delta_v_total_min": 202.93816331525602, "delta_v_total_max": 216.64755484461722, "constraint_violation.max_vel_constraint.steps_mean": 1069.64, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5345527236381808, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.7960703604727692, -3.7928238425318384, -3.8184579117616835, -3.9246986919984135, -4.047114520919088, -4.035755093110211, -3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.840729623877649, "mean_inference_ms": 8.42299464362257, "mean_action_processing_ms": 0.42109896207840064, "mean_env_wait_ms": 10.321337208277312, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 756374, "agent_timesteps_total": 756374, "timers": {"sample_time_ms": 42121.733, "sample_throughput": 285.031, "load_time_ms": 6.284, "load_throughput": 1910545.231, "learn_time_ms": 37586.385, "learn_throughput": 319.424, "update_time_ms": 30.361}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 9.999999960041972e-13, "total_loss": 0.002830098383128643, "policy_loss": -0.0018705605762079358, "vf_loss": 0.0047006611712276936, "vf_explained_var": 0.29350796341896057, "kl": -2.3258028836181666e-09, "entropy": 2.727410316467285, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 756374, "num_agent_steps_sampled": 756374, "num_steps_trained": 756374, "num_agent_steps_trained": 756374}, "done": false, "episodes_total": 378, "training_iteration": 63, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-45-22", "timestamp": 1690843522, "time_this_iter_s": 80.04354095458984, "time_total_s": 5304.556951999664, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5304.556951999664, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 99.98318584070795, "ram_util_percent": 55.36371681415928}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7565520614146246, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.9227109141786065, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8441124281475146, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.7060316456188441, "reward_component_totals/delta_v_mean": -2.078598486031099, "reward_component_totals/delta_v_min": -2.161509278317289, "reward_component_totals/delta_v_max": -2.0293816331525685, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85984860310907, "delta_v_total_min": 202.93816331525602, "delta_v_total_max": 216.15092783172832, "constraint_violation.max_vel_constraint.steps_mean": 1097.09, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5482708645677162, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.950330154587392, -4.017559615969296, -3.9000970823294905, -3.9702754870269032, -3.876399095403549, -3.898822978936931, -3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.83891484869984, "mean_inference_ms": 8.410411549443765, "mean_action_processing_ms": 0.4206438259341824, "mean_env_wait_ms": 10.30646857817758, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 768380, "agent_timesteps_total": 768380, "timers": {"sample_time_ms": 41995.063, "sample_throughput": 285.891, "load_time_ms": 6.427, "load_throughput": 1868153.091, "learn_time_ms": 37490.903, "learn_throughput": 320.238, "update_time_ms": 30.161}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005760518368333578, "policy_loss": -0.00033177604200318456, "vf_loss": 0.0060922931879758835, "vf_explained_var": 0.2902088761329651, "kl": -2.84654233517756e-09, "entropy": 2.66654109954834, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 768380, "num_agent_steps_sampled": 768380, "num_steps_trained": 768380, "num_agent_steps_trained": 768380}, "done": false, "episodes_total": 384, "training_iteration": 64, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-46-41", "timestamp": 1690843601, "time_this_iter_s": 78.58128142356873, "time_total_s": 5383.138233423233, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5383.138233423233, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 99.98571428571428, "ram_util_percent": 55.30535714285713}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6019551674857953, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.9208023086108112, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8420620685574781, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.5227240982984642, "reward_component_totals/delta_v_mean": -2.0787402400533397, "reward_component_totals/delta_v_min": -2.161509278317289, "reward_component_totals/delta_v_max": -2.0293816331525685, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.87402400533315, "delta_v_total_min": 202.93816331525602, "delta_v_total_max": 216.15092783172832, "constraint_violation.max_vel_constraint.steps_mean": 1103.31, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5513793103448276, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.836113909863803, -4.04848328743388, -3.914703617369298, -4.0734763408822126, -3.9266398025784848, -3.926300118227287, -4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8373175989867068, "mean_inference_ms": 8.398424106539558, "mean_action_processing_ms": 0.4202101336440869, "mean_env_wait_ms": 10.291934045904577, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 780386, "agent_timesteps_total": 780386, "timers": {"sample_time_ms": 41834.49, "sample_throughput": 286.988, "load_time_ms": 6.405, "load_throughput": 1874592.888, "learn_time_ms": 37467.435, "learn_throughput": 320.438, "update_time_ms": 31.353}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0031763112638145685, "policy_loss": -0.0006423100712709129, "vf_loss": 0.0038186211604624987, "vf_explained_var": 0.07612620294094086, "kl": -8.487052727268463e-10, "entropy": 2.785921096801758, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 780386, "num_agent_steps_sampled": 780386, "num_steps_trained": 780386, "num_agent_steps_trained": 780386}, "done": false, "episodes_total": 390, "training_iteration": 65, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-47-59", "timestamp": 1690843679, "time_this_iter_s": 77.71373343467712, "time_total_s": 5460.85196685791, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5460.85196685791, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 99.98108108108107, "ram_util_percent": 55.390090090090084}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6019551674857953, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.917505295961856, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8392260772523907, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": -0.5227240982984642, "reward_component_totals/delta_v_mean": -2.078279218709473, "reward_component_totals/delta_v_min": -2.161509278317289, "reward_component_totals/delta_v_max": -2.0293816331525685, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.82792187094645, "delta_v_total_min": 202.93816331525602, "delta_v_total_max": 216.15092783172832, "constraint_violation.max_vel_constraint.steps_mean": 1101.97, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5507096451774113, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-4.0503632842332635, -3.967190846522593, -4.032263017671136, -3.977808520381905, -3.802179680353664, -3.8979050616493067, -3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8358495742729826, "mean_inference_ms": 8.386980400505125, "mean_action_processing_ms": 0.4198092222718796, "mean_env_wait_ms": 10.278281053706001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 792392, "agent_timesteps_total": 792392, "timers": {"sample_time_ms": 41806.682, "sample_throughput": 287.179, "load_time_ms": 6.41, "load_throughput": 1872877.773, "learn_time_ms": 37316.544, "learn_throughput": 321.734, "update_time_ms": 31.666}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004898096434772015, "policy_loss": 8.561230060877278e-05, "vf_loss": 0.004812484607100487, "vf_explained_var": 0.2522476017475128, "kl": -2.9867415207718295e-09, "entropy": 2.727426290512085, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 792392, "num_agent_steps_sampled": 792392, "num_steps_trained": 792392, "num_agent_steps_trained": 792392}, "done": false, "episodes_total": 396, "training_iteration": 66, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-49-14", "timestamp": 1690843754, "time_this_iter_s": 75.16352343559265, "time_total_s": 5536.015490293503, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5536.015490293503, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 99.98055555555555, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.8951515899363773, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8157965890475755, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.079355000888808, "reward_component_totals/delta_v_min": -2.161509278317289, "reward_component_totals/delta_v_max": -2.0293816331525685, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93550008888, "delta_v_total_min": 202.93816331525602, "delta_v_total_max": 216.15092783172832, "constraint_violation.max_vel_constraint.steps_mean": 1107.55, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5534982508745628, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.965412516933026, -3.8369292189414637, -3.793049330967275, -3.9417929790102004, -3.867096262006151, -3.9626309925605874, -4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.83286002299001, "mean_inference_ms": 8.376764430632278, "mean_action_processing_ms": 0.4194341078307435, "mean_env_wait_ms": 10.265505408261065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 804398, "agent_timesteps_total": 804398, "timers": {"sample_time_ms": 41838.912, "sample_throughput": 286.958, "load_time_ms": 6.02, "load_throughput": 1994289.769, "learn_time_ms": 37295.912, "learn_throughput": 321.912, "update_time_ms": 29.255}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0042876191437244415, "policy_loss": -0.00014383225061465055, "vf_loss": 0.004431450739502907, "vf_explained_var": 0.26882684230804443, "kl": -1.1766709828719968e-09, "entropy": 2.7576518058776855, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 804398, "num_agent_steps_sampled": 804398, "num_steps_trained": 804398, "num_agent_steps_trained": 804398}, "done": false, "episodes_total": 402, "training_iteration": 67, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-50-32", "timestamp": 1690843832, "time_this_iter_s": 78.13159680366516, "time_total_s": 5614.147087097168, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5614.147087097168, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 99.97678571428571, "ram_util_percent": 55.35803571428571}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.894192610370333, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.816468839013793, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.077723771356547, "reward_component_totals/delta_v_min": -2.161509278317289, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.77237713565387, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 216.15092783172832, "constraint_violation.max_vel_constraint.steps_mean": 1113.56, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5565017491254373, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-4.019767104319238, -3.873990827386489, -3.8257594447579626, -3.8658787727698796, -3.8419935424803073, -3.8711445684507995, -3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8300429031946424, "mean_inference_ms": 8.367134254461696, "mean_action_processing_ms": 0.4190748740913198, "mean_env_wait_ms": 10.253039283055779, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 816404, "agent_timesteps_total": 816404, "timers": {"sample_time_ms": 41906.952, "sample_throughput": 286.492, "load_time_ms": 6.207, "load_throughput": 1934271.1, "learn_time_ms": 37189.181, "learn_throughput": 322.836, "update_time_ms": 26.732}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005264376290142536, "policy_loss": 0.0005805289838463068, "vf_loss": 0.004683845676481724, "vf_explained_var": 0.20208288729190826, "kl": -9.213083629333596e-10, "entropy": 2.7300283908843994, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 816404, "num_agent_steps_sampled": 816404, "num_steps_trained": 816404, "num_agent_steps_trained": 816404}, "done": false, "episodes_total": 408, "training_iteration": 68, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-51-48", "timestamp": 1690843908, "time_this_iter_s": 75.05542707443237, "time_total_s": 5689.2025141716, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5689.2025141716, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 99.97943925233646, "ram_util_percent": 55.33457943925232}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.8948624346032603, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8177582450891425, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.0771041895141242, "reward_component_totals/delta_v_min": -2.161509278317289, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.71041895141164, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 216.15092783172832, "constraint_violation.max_vel_constraint.steps_mean": 1106.64, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5530434782608695, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.827071598735232, -3.891264647634659, -3.8550815840982704, -3.9856989230020403, -3.95504748366769, -3.8819358827970234, -3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8275324581905974, "mean_inference_ms": 8.358482383543222, "mean_action_processing_ms": 0.4187773035021348, "mean_env_wait_ms": 10.241754893923897, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 828410, "agent_timesteps_total": 828410, "timers": {"sample_time_ms": 42221.64, "sample_throughput": 284.357, "load_time_ms": 6.382, "load_throughput": 1881112.37, "learn_time_ms": 36853.394, "learn_throughput": 325.777, "update_time_ms": 26.996}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006091579329222441, "policy_loss": -7.365099008893594e-05, "vf_loss": 0.006165230181068182, "vf_explained_var": 0.30994129180908203, "kl": -2.2632140606049234e-09, "entropy": 2.6581833362579346, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 828410, "num_agent_steps_sampled": 828410, "num_steps_trained": 828410, "num_agent_steps_trained": 828410}, "done": false, "episodes_total": 414, "training_iteration": 69, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-53-07", "timestamp": 1690843987, "time_this_iter_s": 79.40781164169312, "time_total_s": 5768.6103258132935, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5768.6103258132935, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 99.98584070796461, "ram_util_percent": 55.37876106194689}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.081564926695897, "episode_reward_mean": -3.8942176914778552, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8165531830784913, "reward_component_totals/dist_change_reward_min": -0.9999227956355342, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.077664508399371, "reward_component_totals/delta_v_min": -2.161509278317289, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.76645083993634, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 216.15092783172832, "constraint_violation.max_vel_constraint.steps_mean": 1098.51, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5489805097451275, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.909092235380304, -4.081564926695897, -3.9072628858157783, -3.8923993689119483, -3.8596028751103812, -3.996640456406304, -3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8250843513918786, "mean_inference_ms": 8.350050204742638, "mean_action_processing_ms": 0.4184645056406238, "mean_env_wait_ms": 10.230676997913065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 840416, "agent_timesteps_total": 840416, "timers": {"sample_time_ms": 42296.044, "sample_throughput": 283.856, "load_time_ms": 6.384, "load_throughput": 1880782.158, "learn_time_ms": 36662.751, "learn_throughput": 327.471, "update_time_ms": 30.618}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005802216939628124, "policy_loss": 0.0008756596362218261, "vf_loss": 0.004926555790007114, "vf_explained_var": 0.20562337338924408, "kl": -2.0053478877457565e-09, "entropy": 2.749861240386963, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 840416, "num_agent_steps_sampled": 840416, "num_steps_trained": 840416, "num_agent_steps_trained": 840416}, "done": false, "episodes_total": 420, "training_iteration": 70, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-54-25", "timestamp": 1690844065, "time_this_iter_s": 77.25820398330688, "time_total_s": 5845.8685297966, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5845.8685297966, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 99.97207207207207, "ram_util_percent": 55.31261261261262}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.081337784080546, "episode_reward_mean": -3.8958229011525405, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8195071007683593, "reward_component_totals/dist_change_reward_min": -0.9993389742971657, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.0763158003841875, "reward_component_totals/delta_v_min": -2.134166417270896, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.631580038418, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 213.41664172708914, "constraint_violation.max_vel_constraint.steps_mean": 1113.48, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5564617691154423, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.857093794799034, -4.028144010457482, -4.025764274041928, -4.005199523927894, -3.833501022233521, -3.920916737510946, -3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.823924953731043, "mean_inference_ms": 8.341467116483322, "mean_action_processing_ms": 0.4182057148774072, "mean_env_wait_ms": 10.220749320553319, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 852422, "agent_timesteps_total": 852422, "timers": {"sample_time_ms": 42481.405, "sample_throughput": 282.618, "load_time_ms": 6.167, "load_throughput": 1946886.903, "learn_time_ms": 36624.647, "learn_throughput": 327.812, "update_time_ms": 30.901}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0052415006794035435, "policy_loss": 0.0010669658659026027, "vf_loss": 0.004174536559730768, "vf_explained_var": 0.11652804911136627, "kl": -2.0579224990768807e-09, "entropy": 2.7613935470581055, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 852422, "num_agent_steps_sampled": 852422, "num_steps_trained": 852422, "num_agent_steps_trained": 852422}, "done": false, "episodes_total": 426, "training_iteration": 71, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-55-59", "timestamp": 1690844159, "time_this_iter_s": 93.59156608581543, "time_total_s": 5939.460095882416, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5939.460095882416, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 99.98045112781955, "ram_util_percent": 55.30000000000001}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.081337784080546, "episode_reward_mean": -3.8952962775344586, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8198216621731689, "reward_component_totals/dist_change_reward_min": -0.9993389742971657, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.075474615361297, "reward_component_totals/delta_v_min": -2.134166417270896, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5474615361289, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 213.41664172708914, "constraint_violation.max_vel_constraint.steps_mean": 1133.98, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5667066466766617, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.951499442287761, -4.039828815706649, -3.9728800035834984, -3.998395306605881, -3.9845148169730393, -3.8433850932805664, -3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.822855089111971, "mean_inference_ms": 8.333153138687353, "mean_action_processing_ms": 0.4179324589328162, "mean_env_wait_ms": 10.21091407878368, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 864428, "agent_timesteps_total": 864428, "timers": {"sample_time_ms": 42379.951, "sample_throughput": 283.294, "load_time_ms": 6.091, "load_throughput": 1970943.335, "learn_time_ms": 36612.368, "learn_throughput": 327.922, "update_time_ms": 29.135}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003385883290320635, "policy_loss": -0.0009639126947149634, "vf_loss": 0.004349797032773495, "vf_explained_var": 0.20170839130878448, "kl": -1.0389754612205593e-09, "entropy": 2.7537119388580322, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 864428, "num_agent_steps_sampled": 864428, "num_steps_trained": 864428, "num_agent_steps_trained": 864428}, "done": false, "episodes_total": 432, "training_iteration": 72, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-57-15", "timestamp": 1690844235, "time_this_iter_s": 76.40781092643738, "time_total_s": 6015.867906808853, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6015.867906808853, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 99.97522935779816, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.081337784080546, "episode_reward_mean": -3.8906201728820453, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8153810803105115, "reward_component_totals/dist_change_reward_min": -0.9993389742971657, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.0752390925715405, "reward_component_totals/delta_v_min": -2.134166417270896, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5239092571533, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 213.41664172708914, "constraint_violation.max_vel_constraint.steps_mean": 1124.03, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5617341329335332, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.9286503858612782, -3.976831453428595, -4.031845034068134, -3.9788418552509714, -3.8898559817012517, -3.8909379462409417, -3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8218589226042448, "mean_inference_ms": 8.325097278778825, "mean_action_processing_ms": 0.4176633120743372, "mean_env_wait_ms": 10.201589372947437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 876434, "agent_timesteps_total": 876434, "timers": {"sample_time_ms": 42150.603, "sample_throughput": 284.836, "load_time_ms": 6.113, "load_throughput": 1963910.044, "learn_time_ms": 36575.079, "learn_throughput": 328.256, "update_time_ms": 29.169}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005210916046053171, "policy_loss": 0.0005590528598986566, "vf_loss": 0.004651863127946854, "vf_explained_var": 0.24644078314304352, "kl": -3.369785339657483e-09, "entropy": 2.7279374599456787, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 876434, "num_agent_steps_sampled": 876434, "num_steps_trained": 876434, "num_agent_steps_trained": 876434}, "done": false, "episodes_total": 438, "training_iteration": 73, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-58-33", "timestamp": 1690844313, "time_this_iter_s": 77.3879566192627, "time_total_s": 6093.255863428116, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6093.255863428116, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 99.97181818181818, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.081337784080546, "episode_reward_mean": -3.8867916704481136, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8129403665011453, "reward_component_totals/dist_change_reward_min": -0.9993389742971657, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.0738513039469755, "reward_component_totals/delta_v_min": -2.134166417270896, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.38513039469683, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 213.41664172708914, "constraint_violation.max_vel_constraint.steps_mean": 1137.02, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1965, "constraint_violation.max_vel_constraint.ratio_mean": 0.5682258870564718, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9820089955022488}, "hist_stats": {"episode_reward": [-3.929655879933123, -3.839846799821556, -4.0782213733495425, -3.77779568118096, -3.818781649676663, -3.8956170126538425, -3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8209751277059019, "mean_inference_ms": 8.317410121715142, "mean_action_processing_ms": 0.4174057157792062, "mean_env_wait_ms": 10.192560917971024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 888440, "agent_timesteps_total": 888440, "timers": {"sample_time_ms": 42043.366, "sample_throughput": 285.562, "load_time_ms": 5.956, "load_throughput": 2015852.982, "learn_time_ms": 36455.27, "learn_throughput": 329.335, "update_time_ms": 30.155}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0038544367998838425, "policy_loss": -0.0002958050463348627, "vf_loss": 0.0041502416133880615, "vf_explained_var": 0.15256021916866302, "kl": -2.3833846007903503e-09, "entropy": 2.7576653957366943, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 888440, "num_agent_steps_sampled": 888440, "num_steps_trained": 888440, "num_agent_steps_trained": 888440}, "done": false, "episodes_total": 444, "training_iteration": 74, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_15-59-49", "timestamp": 1690844389, "time_this_iter_s": 76.30409669876099, "time_total_s": 6169.559960126877, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6169.559960126877, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 99.98165137614679, "ram_util_percent": 55.310091743119244}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.081337784080546, "episode_reward_mean": -3.8885714025090983, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8135511112084862, "reward_component_totals/dist_change_reward_min": -0.9898864253847224, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.075020291300618, "reward_component_totals/delta_v_min": -2.134166417270896, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.50202913006106, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 213.41664172708914, "constraint_violation.max_vel_constraint.steps_mean": 1157.83, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5786256871564218, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9846232068256553, -3.795043572542795, -4.01769305782387, -3.942480344967878, -3.931754920309772, -4.013340140370493, -3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8202459910054491, "mean_inference_ms": 8.310244464287956, "mean_action_processing_ms": 0.41716589835896606, "mean_env_wait_ms": 10.184311205520713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 900446, "agent_timesteps_total": 900446, "timers": {"sample_time_ms": 42149.851, "sample_throughput": 284.841, "load_time_ms": 5.907, "load_throughput": 2032458.996, "learn_time_ms": 36356.804, "learn_throughput": 330.227, "update_time_ms": 29.695}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005693507380783558, "policy_loss": 0.0009713617619127035, "vf_loss": 0.004722144454717636, "vf_explained_var": 0.20298278331756592, "kl": -1.3744518856384502e-09, "entropy": 2.744812250137329, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 900446, "num_agent_steps_sampled": 900446, "num_steps_trained": 900446, "num_agent_steps_trained": 900446}, "done": false, "episodes_total": 450, "training_iteration": 75, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-01-07", "timestamp": 1690844467, "time_this_iter_s": 77.7387342453003, "time_total_s": 6247.298694372177, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6247.298694372177, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 99.96785714285714, "ram_util_percent": 55.35535714285714}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.081337784080546, "episode_reward_mean": -3.88834894521542, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8129802554230682, "reward_component_totals/dist_change_reward_min": -0.9898864253847224, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.075368689792359, "reward_component_totals/delta_v_min": -2.134166417270896, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.53686897923504, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 213.41664172708914, "constraint_violation.max_vel_constraint.steps_mean": 1145.9, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5726636681659171, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.8383437816132795, -3.783356630158749, -3.8243875656645216, -4.021849081304498, -3.8964215611867994, -4.047652352277423, -3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8195914930192354, "mean_inference_ms": 8.30399701182354, "mean_action_processing_ms": 0.4169537002647397, "mean_env_wait_ms": 10.17656133497776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 912452, "agent_timesteps_total": 912452, "timers": {"sample_time_ms": 42375.411, "sample_throughput": 283.325, "load_time_ms": 6.078, "load_throughput": 1975435.491, "learn_time_ms": 36583.771, "learn_throughput": 328.178, "update_time_ms": 30.379}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004900823812931776, "policy_loss": 0.00019263583817519248, "vf_loss": 0.0047081890515983105, "vf_explained_var": 0.05856165289878845, "kl": -2.7464002183563707e-09, "entropy": 2.7763078212738037, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 912452, "num_agent_steps_sampled": 912452, "num_steps_trained": 912452, "num_agent_steps_trained": 912452}, "done": false, "episodes_total": 456, "training_iteration": 76, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-02-27", "timestamp": 1690844547, "time_this_iter_s": 79.62953042984009, "time_total_s": 6326.928224802017, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6326.928224802017, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 99.97631578947369, "ram_util_percent": 55.42456140350877}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.081337784080546, "episode_reward_mean": -3.8886117497275436, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8143039171075018, "reward_component_totals/dist_change_reward_min": -0.9898864253847224, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.0743078326200486, "reward_component_totals/delta_v_min": -2.134166417270896, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.43078326200407, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 213.41664172708914, "constraint_violation.max_vel_constraint.steps_mean": 1145.45, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5724387806096951, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9543676513503536, -3.9128867510877967, -4.058966272645886, -4.081337784080546, -3.7895241815660166, -3.9152104032230417, -3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8178257846975567, "mean_inference_ms": 8.29840496705063, "mean_action_processing_ms": 0.4167730954821466, "mean_env_wait_ms": 10.169765087378208, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 924458, "agent_timesteps_total": 924458, "timers": {"sample_time_ms": 42459.045, "sample_throughput": 282.767, "load_time_ms": 6.196, "load_throughput": 1937553.197, "learn_time_ms": 36324.716, "learn_throughput": 330.519, "update_time_ms": 31.515}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0041808513924479485, "policy_loss": -9.87653766060248e-05, "vf_loss": 0.004279616754502058, "vf_explained_var": 0.17460550367832184, "kl": -2.3458313069824044e-09, "entropy": 2.746408224105835, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 924458, "num_agent_steps_sampled": 924458, "num_steps_trained": 924458, "num_agent_steps_trained": 924458}, "done": false, "episodes_total": 462, "training_iteration": 77, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-03-44", "timestamp": 1690844624, "time_this_iter_s": 76.46355056762695, "time_total_s": 6403.391775369644, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6403.391775369644, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 99.97614678899082, "ram_util_percent": 55.42844036697248}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.070884875685121, "episode_reward_mean": -3.8835114421471753, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8091500541532861, "reward_component_totals/dist_change_reward_min": -0.9840589023129498, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.074361387993896, "reward_component_totals/delta_v_min": -2.1308077949782285, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.43613879938874, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 213.08077949782162, "constraint_violation.max_vel_constraint.steps_mean": 1156.12, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5777711144427786, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.7869399681377858, -3.883125424778483, -4.019917956265175, -4.023816708149877, -3.7565520614146246, -3.9195090776281827, -3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8161207086055908, "mean_inference_ms": 8.292858269248512, "mean_action_processing_ms": 0.4165931801418589, "mean_env_wait_ms": 10.16323997672126, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 936464, "agent_timesteps_total": 936464, "timers": {"sample_time_ms": 42530.774, "sample_throughput": 282.29, "load_time_ms": 6.197, "load_throughput": 1937486.104, "learn_time_ms": 36195.007, "learn_throughput": 331.703, "update_time_ms": 31.638}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006376306992024183, "policy_loss": 0.0006401187856681645, "vf_loss": 0.005736187100410461, "vf_explained_var": 0.2914951741695404, "kl": -5.683070680717606e-10, "entropy": 2.70804500579834, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 936464, "num_agent_steps_sampled": 936464, "num_steps_trained": 936464, "num_agent_steps_trained": 936464}, "done": false, "episodes_total": 468, "training_iteration": 78, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-04-59", "timestamp": 1690844699, "time_this_iter_s": 74.50688409805298, "time_total_s": 6477.898659467697, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6477.898659467697, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 99.97428571428573, "ram_util_percent": 55.318095238095225}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.8858921728825964, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8091765491516822, "reward_component_totals/dist_change_reward_min": -0.9840589023129498, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.076715623730921, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.67156237309138, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1156.78, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5781009495252374, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.8033217090669433, -3.960602831832934, -3.785287276607965, -3.8605729001265545, -3.789378573668703, -3.814551784893358, -3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8146071026967767, "mean_inference_ms": 8.287516983287604, "mean_action_processing_ms": 0.41640837833299776, "mean_env_wait_ms": 10.157063173337297, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 948470, "agent_timesteps_total": 948470, "timers": {"sample_time_ms": 42511.675, "sample_throughput": 282.417, "load_time_ms": 6.405, "load_throughput": 1874390.536, "learn_time_ms": 36184.427, "learn_throughput": 331.8, "update_time_ms": 32.801}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006764258723706007, "policy_loss": 0.001346458331681788, "vf_loss": 0.005417802836745977, "vf_explained_var": 0.36842823028564453, "kl": -2.3082780131744585e-09, "entropy": 2.715172052383423, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 948470, "num_agent_steps_sampled": 948470, "num_steps_trained": 948470, "num_agent_steps_trained": 948470}, "done": false, "episodes_total": 474, "training_iteration": 79, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-06-18", "timestamp": 1690844778, "time_this_iter_s": 79.25367379188538, "time_total_s": 6557.1523332595825, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6557.1523332595825, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 99.9780701754386, "ram_util_percent": 55.345614035087706}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.8948383801151554, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8168204952601863, "reward_component_totals/dist_change_reward_min": -0.9840589023129498, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.0780178848549755, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.80178848549676, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1155.21, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5773163418290854, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.981056825157917, -4.03786928036585, -3.887436706742235, -3.8788888491903384, -3.8807886033627534, -3.6019551674857953, -3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8132078063925872, "mean_inference_ms": 8.282606776555108, "mean_action_processing_ms": 0.4162534497708442, "mean_env_wait_ms": 10.151568651038792, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 960476, "agent_timesteps_total": 960476, "timers": {"sample_time_ms": 42754.648, "sample_throughput": 280.812, "load_time_ms": 6.279, "load_throughput": 1912141.264, "learn_time_ms": 35871.495, "learn_throughput": 334.695, "update_time_ms": 29.518}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 9.999999960041972e-13, "total_loss": 0.00502841966226697, "policy_loss": 0.0011279131285846233, "vf_loss": 0.00390050420537591, "vf_explained_var": 0.20344281196594238, "kl": -2.0779508669299673e-10, "entropy": 2.788209915161133, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 960476, "num_agent_steps_sampled": 960476, "num_steps_trained": 960476, "num_agent_steps_trained": 960476}, "done": false, "episodes_total": 480, "training_iteration": 80, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-07-35", "timestamp": 1690844855, "time_this_iter_s": 76.55586004257202, "time_total_s": 6633.7081933021545, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6633.7081933021545, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 99.98073394495412, "ram_util_percent": 55.39633027522933}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.898401316859281, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8198744496772289, "reward_component_totals/dist_change_reward_min": -0.9840589023129498, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.0785268671820596, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85268671820518, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1141.06, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5702448775612193, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.934465956856631, -4.002264480403067, -3.984871301613056, -4.018278347752702, -3.903728544342189, -3.7274670633588767, -3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.813015535230428, "mean_inference_ms": 8.277920484142943, "mean_action_processing_ms": 0.4161248478204979, "mean_env_wait_ms": 10.146964713892151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 972482, "agent_timesteps_total": 972482, "timers": {"sample_time_ms": 42822.507, "sample_throughput": 280.367, "load_time_ms": 6.469, "load_throughput": 1855904.509, "learn_time_ms": 35509.894, "learn_throughput": 338.103, "update_time_ms": 30.706}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006218343507498503, "policy_loss": 0.0005899282987229526, "vf_loss": 0.00562841584905982, "vf_explained_var": 0.28584593534469604, "kl": -5.147309689590429e-09, "entropy": 2.690854787826538, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 972482, "num_agent_steps_sampled": 972482, "num_steps_trained": 972482, "num_agent_steps_trained": 972482}, "done": false, "episodes_total": 486, "training_iteration": 81, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-09-06", "timestamp": 1690844946, "time_this_iter_s": 90.70403718948364, "time_total_s": 6724.412230491638, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6724.412230491638, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 99.97461538461539, "ram_util_percent": 55.378461538461536}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.8979365730394226, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8206898512308141, "reward_component_totals/dist_change_reward_min": -0.9926844716318098, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.0772467218086157, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7246721808608, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1141.31, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5703698150924538, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9936538306312803, -3.8285747404455748, -3.972921994480343, -3.9696696382012706, -3.95720945309969, -3.9024858648499814, -2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8128693070010025, "mean_inference_ms": 8.27340423165808, "mean_action_processing_ms": 0.4160119447434578, "mean_env_wait_ms": 10.142759878310146, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 984488, "agent_timesteps_total": 984488, "timers": {"sample_time_ms": 42964.817, "sample_throughput": 279.438, "load_time_ms": 6.529, "load_throughput": 1838873.448, "learn_time_ms": 35545.208, "learn_throughput": 337.767, "update_time_ms": 33.535}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004892781842499971, "policy_loss": -0.0004926145193167031, "vf_loss": 0.005385397467762232, "vf_explained_var": 0.27668553590774536, "kl": -2.4434698708830638e-09, "entropy": 2.6896936893463135, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 984488, "num_agent_steps_sampled": 984488, "num_steps_trained": 984488, "num_agent_steps_trained": 984488}, "done": false, "episodes_total": 492, "training_iteration": 82, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-10-24", "timestamp": 1690845024, "time_this_iter_s": 78.19273519515991, "time_total_s": 6802.604965686798, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6802.604965686798, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 99.97747747747748, "ram_util_percent": 55.434234234234225}, "trial_id": "41a83_00000"}
{"episode_reward_max": -2.7624327521432797, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.89677953945464, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8194557880298938, "reward_component_totals/dist_change_reward_min": -0.9926844716318098, "reward_component_totals/dist_change_reward_max": 0.34016908244198907, "reward_component_totals/delta_v_mean": -2.0773237514247525, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.73237514247452, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1136.04, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.567736131934033, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-2.7624327521432797, -4.022952000649428, -3.8393625998230023, -3.007897137698522, -3.9519260820527187, -3.820944841602748, -3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8127872839847832, "mean_inference_ms": 8.269312934578947, "mean_action_processing_ms": 0.41591230092246667, "mean_env_wait_ms": 10.138931325273854, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 996494, "agent_timesteps_total": 996494, "timers": {"sample_time_ms": 43067.443, "sample_throughput": 278.772, "load_time_ms": 6.949, "load_throughput": 1727636.865, "learn_time_ms": 35562.264, "learn_throughput": 337.605, "update_time_ms": 34.524}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005862668622285128, "policy_loss": 0.0007331937085837126, "vf_loss": 0.005129477009177208, "vf_explained_var": 0.20299212634563446, "kl": -1.8476238317077787e-09, "entropy": 2.72331166267395, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 996494, "num_agent_steps_sampled": 996494, "num_steps_trained": 996494, "num_agent_steps_trained": 996494}, "done": false, "episodes_total": 498, "training_iteration": 83, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-11-43", "timestamp": 1690845103, "time_this_iter_s": 78.6713011264801, "time_total_s": 6881.276266813278, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6881.276266813278, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 99.97787610619469, "ram_util_percent": 55.44601769911503}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.746894759716789, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.916767008204337, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8388645795192118, "reward_component_totals/dist_change_reward_min": -0.9926844716318098, "reward_component_totals/dist_change_reward_max": -0.6426115873696376, "reward_component_totals/delta_v_mean": -2.0779024286851318, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.0225590235988347, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7902428685124, "delta_v_total_min": 202.2559023598826, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1121.84, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5606396801599199, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.7897498180844282, -3.760077286022517, -4.00813889555546, -3.9401764204964156, -3.8870200141950932, -3.8208419873325044, -4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8128451734227204, "mean_inference_ms": 8.26570086883203, "mean_action_processing_ms": 0.4158248950064644, "mean_env_wait_ms": 10.135574446326904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1008500, "agent_timesteps_total": 1008500, "timers": {"sample_time_ms": 43388.563, "sample_throughput": 276.709, "load_time_ms": 6.98, "load_throughput": 1720106.773, "learn_time_ms": 35205.829, "learn_throughput": 341.023, "update_time_ms": 33.5}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005476079881191254, "policy_loss": 0.0004395670257508755, "vf_loss": 0.005036513786762953, "vf_explained_var": 0.2654734253883362, "kl": -6.684492404041009e-10, "entropy": 2.7453136444091797, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1008500, "num_agent_steps_sampled": 1008500, "num_steps_trained": 1008500, "num_agent_steps_trained": 1008500}, "done": false, "episodes_total": 504, "training_iteration": 84, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-12-59", "timestamp": 1690845179, "time_this_iter_s": 75.94292378425598, "time_total_s": 6957.219190597534, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6957.219190597534, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 99.97685185185185, "ram_util_percent": 55.39074074074074}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.916062300977146, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8354966229066637, "reward_component_totals/dist_change_reward_min": -0.9926844716318098, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.0805656780704886, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0565678070481, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1105.24, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.552343828085957, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.061765596121511, -3.868866104230891, -3.8456815192037803, -3.881341462373586, -3.962920680756633, -3.7605415975976886, -3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.812987331958622, "mean_inference_ms": 8.262222330741395, "mean_action_processing_ms": 0.41575099713473485, "mean_env_wait_ms": 10.13285797302637, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1020506, "agent_timesteps_total": 1020506, "timers": {"sample_time_ms": 43587.308, "sample_throughput": 275.447, "load_time_ms": 7.089, "load_throughput": 1693690.765, "learn_time_ms": 35115.262, "learn_throughput": 341.903, "update_time_ms": 32.577}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003350514220073819, "policy_loss": -0.00033661010093055665, "vf_loss": 0.0036871235352009535, "vf_explained_var": 0.147823303937912, "kl": -9.263154687744191e-10, "entropy": 2.7901134490966797, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1020506, "num_agent_steps_sampled": 1020506, "num_steps_trained": 1020506, "num_agent_steps_trained": 1020506}, "done": false, "episodes_total": 510, "training_iteration": 85, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-14-18", "timestamp": 1690845258, "time_this_iter_s": 78.74960160255432, "time_total_s": 7035.9687922000885, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7035.9687922000885, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 99.98141592920354, "ram_util_percent": 55.377876106194684}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.9160254803077508, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8355572523987456, "reward_component_totals/dist_change_reward_min": -0.9926844716318098, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.0804682279090114, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0468227909004, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1119.42, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5594302848575712, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9188254671595812, -3.841018551283418, -3.8390984024408343, -4.0092211081563285, -3.9136318565579717, -3.9668555089132065, -4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.813371634484973, "mean_inference_ms": 8.258677626439265, "mean_action_processing_ms": 0.4156743138464695, "mean_env_wait_ms": 10.130320140531676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1032512, "agent_timesteps_total": 1032512, "timers": {"sample_time_ms": 43737.602, "sample_throughput": 274.501, "load_time_ms": 8.915, "load_throughput": 1346748.552, "learn_time_ms": 34821.603, "learn_throughput": 344.786, "update_time_ms": 35.189}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004302186891436577, "policy_loss": 0.0003693443431984633, "vf_loss": 0.003932842519134283, "vf_explained_var": 0.1855686902999878, "kl": -4.957039778652472e-10, "entropy": 2.7690768241882324, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1032512, "num_agent_steps_sampled": 1032512, "num_steps_trained": 1032512, "num_agent_steps_trained": 1032512}, "done": false, "episodes_total": 516, "training_iteration": 86, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-15-37", "timestamp": 1690845337, "time_this_iter_s": 78.2754282951355, "time_total_s": 7114.244220495224, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7114.244220495224, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 99.97727272727273, "ram_util_percent": 55.452727272727245}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.9165770587968645, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8372201019344593, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.0793569568624126, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93569568624054, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1122.8, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5611194402798599, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.016890751233154, -3.9640518264325326, -3.9822931502123224, -3.9633606224398736, -3.985474805793496, -3.827918248941046, -3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8127079830063897, "mean_inference_ms": 8.255454036483368, "mean_action_processing_ms": 0.4156179619981101, "mean_env_wait_ms": 10.12805171964206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1044518, "agent_timesteps_total": 1044518, "timers": {"sample_time_ms": 43766.1, "sample_throughput": 274.322, "load_time_ms": 8.978, "load_throughput": 1337288.813, "learn_time_ms": 34844.591, "learn_throughput": 344.559, "update_time_ms": 34.366}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0063460031524300575, "policy_loss": 0.0011587379267439246, "vf_loss": 0.005187265109270811, "vf_explained_var": 0.31737303733825684, "kl": -2.175589486341778e-09, "entropy": 2.7197678089141846, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1044518, "num_agent_steps_sampled": 1044518, "num_steps_trained": 1044518, "num_agent_steps_trained": 1044518}, "done": false, "episodes_total": 522, "training_iteration": 87, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-16-54", "timestamp": 1690845414, "time_this_iter_s": 76.91584873199463, "time_total_s": 7191.160069227219, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7191.160069227219, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 99.9809090909091, "ram_util_percent": 55.39818181818179}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.9157161261026374, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8362168248002088, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.0794993013024357, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.94993013024288, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1119.03, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5592353823088455, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9015228643580833, -3.9176863932220267, -4.06055564830664, -3.9247990405413997, -3.816913729042444, -3.882815447055936, -3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8119792157494536, "mean_inference_ms": 8.252255995572899, "mean_action_processing_ms": 0.41556479973921284, "mean_env_wait_ms": 10.125594496644297, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1056524, "agent_timesteps_total": 1056524, "timers": {"sample_time_ms": 43751.638, "sample_throughput": 274.413, "load_time_ms": 8.775, "load_throughput": 1368127.721, "learn_time_ms": 34899.821, "learn_throughput": 344.013, "update_time_ms": 34.048}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004935551434755325, "policy_loss": 0.0006864762399345636, "vf_loss": 0.004249076824635267, "vf_explained_var": 0.0749199166893959, "kl": -4.005688558628151e-10, "entropy": 2.7735793590545654, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1056524, "num_agent_steps_sampled": 1056524, "num_steps_trained": 1056524, "num_agent_steps_trained": 1056524}, "done": false, "episodes_total": 528, "training_iteration": 88, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-18-09", "timestamp": 1690845489, "time_this_iter_s": 74.92689490318298, "time_total_s": 7266.086964130402, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7266.086964130402, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 99.97962962962963, "ram_util_percent": 55.39999999999997}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.9170918054434516, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8363603069382808, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.080731498505178, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07314985051707, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1139.53, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5694802598700649, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9089359583367695, -3.982810999219619, -3.7706340210068534, -3.960782858534396, -3.9077929981149415, -3.8355315519692716, -3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8112986663124122, "mean_inference_ms": 8.249293114128536, "mean_action_processing_ms": 0.4155229559803717, "mean_env_wait_ms": 10.123387550144537, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1068530, "agent_timesteps_total": 1068530, "timers": {"sample_time_ms": 43475.896, "sample_throughput": 276.153, "load_time_ms": 8.229, "load_throughput": 1459046.861, "learn_time_ms": 34930.752, "learn_throughput": 343.709, "update_time_ms": 34.316}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005696005187928677, "policy_loss": 0.001109061180613935, "vf_loss": 0.00458694389089942, "vf_explained_var": 0.20096057653427124, "kl": -5.858319385154687e-10, "entropy": 2.7465670108795166, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1068530, "num_agent_steps_sampled": 1068530, "num_steps_trained": 1068530, "num_agent_steps_trained": 1068530}, "done": false, "episodes_total": 534, "training_iteration": 89, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-19-26", "timestamp": 1690845566, "time_this_iter_s": 76.67685723304749, "time_total_s": 7342.763821363449, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7342.763821363449, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 99.9788990825688, "ram_util_percent": 55.350458715596304}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.920848308408349, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8397778310185602, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.0810704773897952, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10704773897885, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1151.07, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5752473763118441, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.94165117910706, -3.832128963773776, -3.960911558385514, -3.836096161807499, -3.981412418571252, -3.824515059829764, -4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8107329977263442, "mean_inference_ms": 8.246738822878767, "mean_action_processing_ms": 0.41551640711025684, "mean_env_wait_ms": 10.121941757956572, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1080536, "agent_timesteps_total": 1080536, "timers": {"sample_time_ms": 43491.831, "sample_throughput": 276.052, "load_time_ms": 8.219, "load_throughput": 1460790.659, "learn_time_ms": 34911.085, "learn_throughput": 343.902, "update_time_ms": 34.949}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003980286885052919, "policy_loss": -0.0006098936428315938, "vf_loss": 0.004590177908539772, "vf_explained_var": 0.19746100902557373, "kl": -3.1244369314009646e-09, "entropy": 2.739469528198242, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1080536, "num_agent_steps_sampled": 1080536, "num_steps_trained": 1080536, "num_agent_steps_trained": 1080536}, "done": false, "episodes_total": 540, "training_iteration": 90, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-20-43", "timestamp": 1690845643, "time_this_iter_s": 76.47048997879028, "time_total_s": 7419.234311342239, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7419.234311342239, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 99.9790909090909, "ram_util_percent": 55.384545454545446}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.9269419482256795, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8442596725191532, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.0826822757065324, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.26822757065253, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1134.64, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5670364817591205, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.070884875685121, -3.8644121253328385, -3.829967911754557, -3.946699211540555, -4.01840149862343, -4.041061652951214, -4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8112022975709992, "mean_inference_ms": 8.244338125879192, "mean_action_processing_ms": 0.4155218794306124, "mean_env_wait_ms": 10.120767876976887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1092542, "agent_timesteps_total": 1092542, "timers": {"sample_time_ms": 43588.37, "sample_throughput": 275.44, "load_time_ms": 8.108, "load_throughput": 1480782.248, "learn_time_ms": 34981.616, "learn_throughput": 343.209, "update_time_ms": 35.101}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 9.999999960041972e-13, "total_loss": 0.00427701510488987, "policy_loss": 0.00011135365639347583, "vf_loss": 0.004165659658610821, "vf_explained_var": 0.16693595051765442, "kl": -2.440966317962534e-09, "entropy": 2.779470682144165, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1092542, "num_agent_steps_sampled": 1092542, "num_steps_trained": 1092542, "num_agent_steps_trained": 1092542}, "done": false, "episodes_total": 546, "training_iteration": 91, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-22-16", "timestamp": 1690845736, "time_this_iter_s": 92.39249300956726, "time_total_s": 7511.626804351807, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7511.626804351807, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 99.98181818181818, "ram_util_percent": 55.39696969696969}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.923502907257601, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8430325861720531, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.080470321085555, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.04703210855482, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1121.5, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5611073695169722, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.0552994327364855, -3.8496870065594324, -3.873321709849733, -3.82491821275239, -3.9228833763463697, -3.8718600438506137, -3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8116619697946144, "mean_inference_ms": 8.242306840553123, "mean_action_processing_ms": 0.4155367334635626, "mean_env_wait_ms": 10.119725119966146, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1104396, "agent_timesteps_total": 1104396, "timers": {"sample_time_ms": 43499.965, "sample_throughput": 275.651, "load_time_ms": 8.022, "load_throughput": 1494739.764, "learn_time_ms": 34831.093, "learn_throughput": 344.256, "update_time_ms": 32.329}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006119474768638611, "policy_loss": 0.00027548958314582705, "vf_loss": 0.005843983497470617, "vf_explained_var": 0.3221336901187897, "kl": -4.001143860676848e-09, "entropy": 2.7012405395507812, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1104396, "num_agent_steps_sampled": 1104396, "num_steps_trained": 1104396, "num_agent_steps_trained": 1104396}, "done": false, "episodes_total": 552, "training_iteration": 92, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-23-32", "timestamp": 1690845812, "time_this_iter_s": 75.79112005233765, "time_total_s": 7587.417924404144, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7587.417924404144, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 99.98055555555555, "ram_util_percent": 55.44444444444444}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.9251484936834338, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8442775637910769, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.080870929892364, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0870929892357, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1122.05, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5613822320856877, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.8712779498004446, -4.0266287918878385, -3.803512708509385, -3.9421285530229273, -3.7820361416051176, -3.854232235210948, -3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8121765357703714, "mean_inference_ms": 8.23995154177482, "mean_action_processing_ms": 0.41553033881040446, "mean_env_wait_ms": 10.118441583169554, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1116402, "agent_timesteps_total": 1116402, "timers": {"sample_time_ms": 43463.398, "sample_throughput": 275.883, "load_time_ms": 7.434, "load_throughput": 1613047.94, "learn_time_ms": 34741.385, "learn_throughput": 345.145, "update_time_ms": 32.453}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0028716837987303734, "policy_loss": -0.0011075795628130436, "vf_loss": 0.00397926289588213, "vf_explained_var": 0.2166815549135208, "kl": -2.0504118403152916e-09, "entropy": 2.7708353996276855, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1116402, "num_agent_steps_sampled": 1116402, "num_steps_trained": 1116402, "num_agent_steps_trained": 1116402}, "done": false, "episodes_total": 558, "training_iteration": 93, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-24-49", "timestamp": 1690845889, "time_this_iter_s": 77.37031245231628, "time_total_s": 7664.788236856461, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7664.788236856461, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 99.97818181818184, "ram_util_percent": 55.46636363636361}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.9292383458717963, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8482206878393218, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.0810176580324793, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10176580324725, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1108.46, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5545906278877868, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.746894759716789, -3.8617768227290763, -4.004248346547435, -3.953073980107437, -3.9437423979209196, -3.854810043300345, -3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.812673230167864, "mean_inference_ms": 8.237670816406196, "mean_action_processing_ms": 0.4155119598515538, "mean_env_wait_ms": 10.116950348804188, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1128408, "agent_timesteps_total": 1128408, "timers": {"sample_time_ms": 43385.977, "sample_throughput": 276.375, "load_time_ms": 7.599, "load_throughput": 1578039.334, "learn_time_ms": 35115.494, "learn_throughput": 341.468, "update_time_ms": 33.564}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004532485734671354, "policy_loss": 0.0002617976861074567, "vf_loss": 0.004270688630640507, "vf_explained_var": 0.18847812712192535, "kl": -2.1906108038649563e-09, "entropy": 2.7581090927124023, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1128408, "num_agent_steps_sampled": 1128408, "num_steps_trained": 1128408, "num_agent_steps_trained": 1128408}, "done": false, "episodes_total": 564, "training_iteration": 94, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-26-08", "timestamp": 1690845968, "time_this_iter_s": 78.91172981262207, "time_total_s": 7743.699966669083, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7743.699966669083, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 99.98035714285716, "ram_util_percent": 55.63928571428572}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.173078118834655, "episode_reward_mean": -3.9319587815955632, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8524766691809291, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.0794821124146408, "reward_component_totals/delta_v_min": -2.202081460058681, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.94821124146344, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 220.2081460058679, "constraint_violation.max_vel_constraint.steps_mean": 1125.11, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5629114674679967, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.756360453639621, -4.002524159961183, -4.173078118834655, -3.8974190962595845, -3.9465616334254268, -4.0008859055938935, -3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8132126793776453, "mean_inference_ms": 8.235467676663095, "mean_action_processing_ms": 0.4154809038384147, "mean_env_wait_ms": 10.115269676488353, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1140414, "agent_timesteps_total": 1140414, "timers": {"sample_time_ms": 43250.588, "sample_throughput": 277.24, "load_time_ms": 7.77, "load_throughput": 1543176.879, "learn_time_ms": 35030.819, "learn_throughput": 342.293, "update_time_ms": 35.463}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006012126803398132, "policy_loss": 0.0006515869754366577, "vf_loss": 0.005360540002584457, "vf_explained_var": 0.1758641004562378, "kl": -3.2821609874389424e-09, "entropy": 2.7031362056732178, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1140414, "num_agent_steps_sampled": 1140414, "num_steps_trained": 1140414, "num_agent_steps_trained": 1140414}, "done": false, "episodes_total": 570, "training_iteration": 95, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-27-25", "timestamp": 1690846045, "time_this_iter_s": 76.60530519485474, "time_total_s": 7820.305271863937, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7820.305271863937, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 99.98454545454545, "ram_util_percent": 55.672727272727265}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.933619466942604, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8537916704079105, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.0798277965347003, "reward_component_totals/delta_v_min": -2.138160193661846, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9827796534693, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 213.81601936618392, "constraint_violation.max_vel_constraint.steps_mean": 1135.08, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5678939762136239, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9164155453424563, -3.972561705639631, -4.099577455591362, -3.9723335538595386, -4.023408677303804, -3.763511370552064, -3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.813702667837332, "mean_inference_ms": 8.233343918211775, "mean_action_processing_ms": 0.4154338654561792, "mean_env_wait_ms": 10.1132067718624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1152420, "agent_timesteps_total": 1152420, "timers": {"sample_time_ms": 42942.298, "sample_throughput": 279.231, "load_time_ms": 5.644, "load_throughput": 2124481.39, "learn_time_ms": 35260.522, "learn_throughput": 340.063, "update_time_ms": 32.241}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004963254556059837, "policy_loss": -0.0007724216557107866, "vf_loss": 0.005735676269978285, "vf_explained_var": 0.3478236794471741, "kl": -1.349416356433153e-09, "entropy": 2.7017574310302734, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1152420, "num_agent_steps_sampled": 1152420, "num_steps_trained": 1152420, "num_agent_steps_trained": 1152420}, "done": false, "episodes_total": 576, "training_iteration": 96, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-28-43", "timestamp": 1690846123, "time_this_iter_s": 77.44018387794495, "time_total_s": 7897.745455741882, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7897.745455741882, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 99.98468468468468, "ram_util_percent": 55.48378378378375}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.929654996760348, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8496630325701459, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.079991964190208, "reward_component_totals/delta_v_min": -2.138160193661846, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9991964190201, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 213.81601936618392, "constraint_violation.max_vel_constraint.steps_mean": 1153.79, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.577244301051205, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9409748845445662, -3.8294915602640933, -3.991980870895554, -4.074921743157409, -3.7699431840745596, -3.95446109002713, -3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8131716172446708, "mean_inference_ms": 8.231425619195955, "mean_action_processing_ms": 0.41537165883176946, "mean_env_wait_ms": 10.110832603437578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1164426, "agent_timesteps_total": 1164426, "timers": {"sample_time_ms": 42807.883, "sample_throughput": 280.107, "load_time_ms": 5.327, "load_throughput": 2250933.635, "learn_time_ms": 35373.762, "learn_throughput": 338.974, "update_time_ms": 33.728}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005065470933914185, "policy_loss": -0.00023012487508822232, "vf_loss": 0.005295595154166222, "vf_explained_var": 0.2580455541610718, "kl": -1.7324602863411087e-09, "entropy": 2.7233872413635254, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1164426, "num_agent_steps_sampled": 1164426, "num_steps_trained": 1164426, "num_agent_steps_trained": 1164426}, "done": false, "episodes_total": 582, "training_iteration": 97, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-30-00", "timestamp": 1690846200, "time_this_iter_s": 76.75204157829285, "time_total_s": 7974.497497320175, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7974.497497320175, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 99.9880733944954, "ram_util_percent": 55.39999999999997}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.926975751564486, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.84682261362432, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.080153137940172, "reward_component_totals/delta_v_min": -2.138160193661846, "reward_component_totals/delta_v_max": -2.024356735944755, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0153137940164, "delta_v_total_min": 202.43567359447496, "delta_v_total_max": 213.81601936618392, "constraint_violation.max_vel_constraint.steps_mean": 1156.09, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5783937263385615, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9534840656201755, -4.029649452591689, -3.8780529853166157, -3.93901053471044, -3.9504005378274085, -3.9271699075024014, -4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.812608122079937, "mean_inference_ms": 8.229397405050955, "mean_action_processing_ms": 0.41528130073189795, "mean_env_wait_ms": 10.107965733539489, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1176432, "agent_timesteps_total": 1176432, "timers": {"sample_time_ms": 42831.638, "sample_throughput": 279.952, "load_time_ms": 5.37, "load_throughput": 2232954.629, "learn_time_ms": 35544.77, "learn_throughput": 337.344, "update_time_ms": 34.079}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004449077416211367, "policy_loss": 0.0005163997411727905, "vf_loss": 0.0039326781406998634, "vf_explained_var": 0.15222014486789703, "kl": -2.228164319717507e-09, "entropy": 2.767010450363159, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1176432, "num_agent_steps_sampled": 1176432, "num_steps_trained": 1176432, "num_agent_steps_trained": 1176432}, "done": false, "episodes_total": 588, "training_iteration": 98, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-31-17", "timestamp": 1690846277, "time_this_iter_s": 76.81353712081909, "time_total_s": 8051.311034440994, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8051.311034440994, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 99.97909090909091, "ram_util_percent": 55.489999999999995}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.9282432393254623, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8465925320373792, "reward_component_totals/dist_change_reward_min": -0.9947803643109878, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.081650707288089, "reward_component_totals/delta_v_min": -2.138160193661846, "reward_component_totals/delta_v_max": -2.027874913861357, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16507072880816, "delta_v_total_min": 202.78749138613537, "delta_v_total_max": 213.81601936618392, "constraint_violation.max_vel_constraint.steps_mean": 1154.74, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5777190636698957, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.071612979349021, -3.790595009638003, -3.892901849176601, -3.87613187973641, -3.8722637365477155, -3.9035681897154877, -3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8120846780853395, "mean_inference_ms": 8.227668682291371, "mean_action_processing_ms": 0.4151909299337618, "mean_env_wait_ms": 10.105190158687373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1188438, "agent_timesteps_total": 1188438, "timers": {"sample_time_ms": 43059.803, "sample_throughput": 278.469, "load_time_ms": 5.647, "load_throughput": 2123566.412, "learn_time_ms": 35431.282, "learn_throughput": 338.424, "update_time_ms": 31.928}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004632408730685711, "policy_loss": -0.0011803510133177042, "vf_loss": 0.005812759045511484, "vf_explained_var": 0.35495874285697937, "kl": -1.7875384505927627e-09, "entropy": 2.6890642642974854, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1188438, "num_agent_steps_sampled": 1188438, "num_steps_trained": 1188438, "num_agent_steps_trained": 1188438}, "done": false, "episodes_total": 594, "training_iteration": 99, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-32-35", "timestamp": 1690846355, "time_this_iter_s": 77.81378602981567, "time_total_s": 8129.12482047081, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8129.12482047081, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 99.97747747747746, "ram_util_percent": 55.5}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.6305799724006, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.9327039239404287, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8515250768152582, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.51860005764597, "reward_component_totals/delta_v_mean": -2.0811788471251758, "reward_component_totals/delta_v_min": -2.138160193661846, "reward_component_totals/delta_v_max": -2.027874913861357, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.11788471251685, "delta_v_total_min": 202.78749138613537, "delta_v_total_max": 213.81601936618392, "constraint_violation.max_vel_constraint.steps_mean": 1139.7, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5702028217908353, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.8362498821651334, -3.8323335045853146, -4.09942377608988, -3.8604231998358243, -3.6305799724006, -3.9064358532615326, -3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8116257077823397, "mean_inference_ms": 8.225930879390326, "mean_action_processing_ms": 0.41509244179535515, "mean_env_wait_ms": 10.102399340694776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1200444, "agent_timesteps_total": 1200444, "timers": {"sample_time_ms": 42935.695, "sample_throughput": 279.273, "load_time_ms": 5.674, "load_throughput": 2113402.434, "learn_time_ms": 35666.419, "learn_throughput": 336.193, "update_time_ms": 35.105}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0051760501228272915, "policy_loss": 0.00083739502588287, "vf_loss": 0.004338654689490795, "vf_explained_var": 0.18035884201526642, "kl": -3.5400271602981093e-09, "entropy": 2.747520923614502, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1200444, "num_agent_steps_sampled": 1200444, "num_steps_trained": 1200444, "num_agent_steps_trained": 1200444}, "done": false, "episodes_total": 600, "training_iteration": 100, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-33-53", "timestamp": 1690846433, "time_this_iter_s": 77.5994303226471, "time_total_s": 8206.724250793457, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8206.724250793457, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 99.98198198198196, "ram_util_percent": 55.4990990990991}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.782397606137536, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.936241282946615, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8563742843516187, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7084811833406549, "reward_component_totals/delta_v_mean": -2.0798669985950027, "reward_component_totals/delta_v_min": -2.138160193661846, "reward_component_totals/delta_v_max": -2.027874913861357, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98669985949948, "delta_v_total_min": 202.78749138613537, "delta_v_total_max": 213.81601936618392, "constraint_violation.max_vel_constraint.steps_mean": 1146.06, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5733812325854379, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.784643855111428, -4.048945525006483, -3.7833055621824556, -3.981622931004873, -3.8449257179445993, -3.90675646183115, -3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8120024581885388, "mean_inference_ms": 8.223733681787094, "mean_action_processing_ms": 0.41498207364288686, "mean_env_wait_ms": 10.099611993574833, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1212450, "agent_timesteps_total": 1212450, "timers": {"sample_time_ms": 42625.905, "sample_throughput": 281.303, "load_time_ms": 5.614, "load_throughput": 2135858.513, "learn_time_ms": 35697.911, "learn_throughput": 335.896, "update_time_ms": 34.387}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0045390622690320015, "policy_loss": 0.0003463714965619147, "vf_loss": 0.00419269036501646, "vf_explained_var": 0.1390705555677414, "kl": -2.1455468512954212e-09, "entropy": 2.7632696628570557, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1212450, "num_agent_steps_sampled": 1212450, "num_steps_trained": 1212450, "num_agent_steps_trained": 1212450}, "done": false, "episodes_total": 606, "training_iteration": 101, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-35-23", "timestamp": 1690846523, "time_this_iter_s": 89.60532784461975, "time_total_s": 8296.329578638077, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8296.329578638077, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 99.984375, "ram_util_percent": 55.49921875}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.782397606137536, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.9406039146145515, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8598259990141155, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7084811833406549, "reward_component_totals/delta_v_mean": -2.0807779156004425, "reward_component_totals/delta_v_min": -2.138160193661846, "reward_component_totals/delta_v_max": -2.027874913861357, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07779156004344, "delta_v_total_min": 202.78749138613537, "delta_v_total_max": 213.81601936618392, "constraint_violation.max_vel_constraint.steps_mean": 1158.09, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5793932265884364, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.858887396939375, -4.012771775488806, -3.788092822463347, -3.966000718677326, -3.782397606137536, -3.94803278774964, -4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8122861195721751, "mean_inference_ms": 8.221393258866701, "mean_action_processing_ms": 0.4148679596831684, "mean_env_wait_ms": 10.096586318649898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1224456, "agent_timesteps_total": 1224456, "timers": {"sample_time_ms": 42717.164, "sample_throughput": 281.058, "load_time_ms": 5.932, "load_throughput": 2023816.873, "learn_time_ms": 35932.875, "learn_throughput": 334.123, "update_time_ms": 35.729}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005368499085307121, "policy_loss": 0.0004688496410381049, "vf_loss": 0.004899649415165186, "vf_explained_var": 0.2149316668510437, "kl": -1.3093593986823748e-09, "entropy": 2.7467782497406006, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1224456, "num_agent_steps_sampled": 1224456, "num_steps_trained": 1224456, "num_agent_steps_trained": 1224456}, "done": false, "episodes_total": 612, "training_iteration": 102, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-36-42", "timestamp": 1690846602, "time_this_iter_s": 79.01884412765503, "time_total_s": 8375.348422765732, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8375.348422765732, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 99.98761061946905, "ram_util_percent": 55.49911504424779}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.784816977223758, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.9462201438482056, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8646043779716369, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7084811833406549, "reward_component_totals/delta_v_mean": -2.081615765876575, "reward_component_totals/delta_v_min": -2.138160193661846, "reward_component_totals/delta_v_max": -2.027874913861357, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16157658765667, "delta_v_total_min": 202.78749138613537, "delta_v_total_max": 213.81601936618392, "constraint_violation.max_vel_constraint.steps_mean": 1145.86, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5732812825604505, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.062006321647258, -3.794706134521646, -3.92408590688761, -4.032579986479127, -4.000449186901074, -3.9406606432387568, -3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.812379920703226, "mean_inference_ms": 8.21892707129708, "mean_action_processing_ms": 0.4147169839319368, "mean_env_wait_ms": 10.09308426256969, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1236462, "agent_timesteps_total": 1236462, "timers": {"sample_time_ms": 42737.787, "sample_throughput": 280.922, "load_time_ms": 6.073, "load_throughput": 1976885.691, "learn_time_ms": 36165.789, "learn_throughput": 331.971, "update_time_ms": 33.485}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005502203945070505, "policy_loss": 0.0006071482785046101, "vf_loss": 0.0048950533382594585, "vf_explained_var": 0.2721899151802063, "kl": -1.8501273846283084e-09, "entropy": 2.726284980773926, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1236462, "num_agent_steps_sampled": 1236462, "num_steps_trained": 1236462, "num_agent_steps_trained": 1236462}, "done": false, "episodes_total": 618, "training_iteration": 103, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-38-02", "timestamp": 1690846682, "time_this_iter_s": 79.87968516349792, "time_total_s": 8455.22810792923, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8455.22810792923, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 99.98684210526318, "ram_util_percent": 55.5}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.784816977223758, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.942119458748308, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.86157013566187, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7084811833406549, "reward_component_totals/delta_v_mean": -2.0805493230864442, "reward_component_totals/delta_v_min": -2.138160193661846, "reward_component_totals/delta_v_max": -2.027874913861357, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05493230864363, "delta_v_total_min": 202.78749138613537, "delta_v_total_max": 213.81601936618392, "constraint_violation.max_vel_constraint.steps_mean": 1159.59, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5801428517758428, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.9183105831195597, -3.9944851045664143, -3.784816977223758, -4.015173640580104, -4.021029498428562, -4.001465632499176, -3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8124675340007232, "mean_inference_ms": 8.216438533613925, "mean_action_processing_ms": 0.4145639956069831, "mean_env_wait_ms": 10.08958794744246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1248468, "agent_timesteps_total": 1248468, "timers": {"sample_time_ms": 42755.517, "sample_throughput": 280.806, "load_time_ms": 5.891, "load_throughput": 2037920.583, "learn_time_ms": 36272.421, "learn_throughput": 330.995, "update_time_ms": 32.047}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006866122595965862, "policy_loss": 0.0010280701098963618, "vf_loss": 0.005838053300976753, "vf_explained_var": 0.3225502669811249, "kl": -3.6827298988129087e-09, "entropy": 2.685487747192383, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1248468, "num_agent_steps_sampled": 1248468, "num_steps_trained": 1248468, "num_agent_steps_trained": 1248468}, "done": false, "episodes_total": 624, "training_iteration": 104, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-39-22", "timestamp": 1690846762, "time_this_iter_s": 80.14309430122375, "time_total_s": 8535.371202230453, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8535.371202230453, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 99.98695652173913, "ram_util_percent": 55.5}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7882305274496346, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.945455616072488, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8646394401134805, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7084811833406549, "reward_component_totals/delta_v_mean": -2.080816175959014, "reward_component_totals/delta_v_min": -2.138160193661846, "reward_component_totals/delta_v_max": -2.027874913861357, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.08161759590064, "delta_v_total_min": 202.78749138613537, "delta_v_total_max": 213.81601936618392, "constraint_violation.max_vel_constraint.steps_mean": 1129.12, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5649154654689962, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.855533683381297, -3.82667475711287, -3.8921122216165576, -4.045045263569492, -3.882735056673427, -3.991113756277055, -4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.812520089174617, "mean_inference_ms": 8.213904692246953, "mean_action_processing_ms": 0.4144202719510528, "mean_env_wait_ms": 10.085998809683451, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1260474, "agent_timesteps_total": 1260474, "timers": {"sample_time_ms": 42519.545, "sample_throughput": 282.364, "load_time_ms": 5.797, "load_throughput": 2071078.083, "learn_time_ms": 36468.331, "learn_throughput": 329.217, "update_time_ms": 30.579}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004184962250292301, "policy_loss": 0.0005486315349116921, "vf_loss": 0.003636330133304, "vf_explained_var": 0.16498719155788422, "kl": -1.339402144751034e-09, "entropy": 2.7926948070526123, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1260474, "num_agent_steps_sampled": 1260474, "num_steps_trained": 1260474, "num_agent_steps_trained": 1260474}, "done": false, "episodes_total": 630, "training_iteration": 105, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-40-39", "timestamp": 1690846839, "time_this_iter_s": 76.19935917854309, "time_total_s": 8611.570561408997, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8611.570561408997, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 99.98256880733945, "ram_util_percent": 55.49908256880734}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7882305274496346, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.9450695663453974, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8640330122537283, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7084811833406549, "reward_component_totals/delta_v_mean": -2.0810365540916753, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.027874913861357, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10365540916683, "delta_v_total_min": 202.78749138613537, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1114.16, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5574392035999307, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.033490222595001, -3.8697438735203957, -4.099611436545247, -3.8654443380604206, -4.09133487260941, -3.9125195876206065, -3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8125864090226222, "mean_inference_ms": 8.21109614807223, "mean_action_processing_ms": 0.4142705738631498, "mean_env_wait_ms": 10.08213606355921, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1272480, "agent_timesteps_total": 1272480, "timers": {"sample_time_ms": 42589.311, "sample_throughput": 281.902, "load_time_ms": 5.903, "load_throughput": 2033838.075, "learn_time_ms": 36658.443, "learn_throughput": 327.51, "update_time_ms": 29.756}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006537922192364931, "policy_loss": -1.5576199075439945e-05, "vf_loss": 0.006553498096764088, "vf_explained_var": 0.3461076021194458, "kl": -5.032146366268364e-10, "entropy": 2.664815902709961, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1272480, "num_agent_steps_sampled": 1272480, "num_steps_trained": 1272480, "num_agent_steps_trained": 1272480}, "done": false, "episodes_total": 636, "training_iteration": 106, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-41-59", "timestamp": 1690846919, "time_this_iter_s": 80.00712776184082, "time_total_s": 8691.577689170837, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8691.577689170837, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 99.98596491228069, "ram_util_percent": 55.49912280701754}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7882305274496346, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.940511880270051, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.859501204899361, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7084811833406549, "reward_component_totals/delta_v_mean": -2.0810106753706963, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.027874913861357, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10106753706884, "delta_v_total_min": 202.78749138613537, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1100.12, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5504227118458078, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.996397726938518, -4.027709131126177, -4.0183844302814045, -3.9397335746317768, -3.8268659919608483, -3.868705194235183, -4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8116458495618102, "mean_inference_ms": 8.208477225973587, "mean_action_processing_ms": 0.4140896167307815, "mean_env_wait_ms": 10.077826709104013, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1284486, "agent_timesteps_total": 1284486, "timers": {"sample_time_ms": 42609.649, "sample_throughput": 281.767, "load_time_ms": 6.267, "load_throughput": 1915771.258, "learn_time_ms": 36771.275, "learn_throughput": 326.505, "update_time_ms": 28.274}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0068629831075668335, "policy_loss": 0.0014962316490709782, "vf_loss": 0.00536675238981843, "vf_explained_var": 0.21808651089668274, "kl": -2.1130006633285348e-09, "entropy": 2.7232255935668945, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1284486, "num_agent_steps_sampled": 1284486, "num_steps_trained": 1284486, "num_agent_steps_trained": 1284486}, "done": false, "episodes_total": 642, "training_iteration": 107, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-43-17", "timestamp": 1690846997, "time_this_iter_s": 78.07422041893005, "time_total_s": 8769.651909589767, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8769.651909589767, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 99.98648648648648, "ram_util_percent": 55.5}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7882305274496346, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.9390208549222, "episode_len_mean": 1999.48, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8575829564214438, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7084811833406549, "reward_component_totals/delta_v_mean": -2.0814378985007638, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0364888725678165, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1437898500756, "delta_v_total_min": 203.64888725678085, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1137.25, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5689784339847382, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.059290678121359, -4.016598079219779, -3.8431018983335523, -3.812961337209255, -3.8824885994961496, -4.089315038432049, -3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845], "episode_lengths": [2001, 1849, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8106561724295198, "mean_inference_ms": 8.20557442707004, "mean_action_processing_ms": 0.41388376153673434, "mean_env_wait_ms": 10.073208556976095, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1296492, "agent_timesteps_total": 1296492, "timers": {"sample_time_ms": 42509.478, "sample_throughput": 282.431, "load_time_ms": 6.67, "load_throughput": 1799903.988, "learn_time_ms": 36683.571, "learn_throughput": 327.285, "update_time_ms": 27.5}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005207008682191372, "policy_loss": -0.00020310687250457704, "vf_loss": 0.005410115700215101, "vf_explained_var": 0.26610246300697327, "kl": -3.3823033263047364e-09, "entropy": 2.6991164684295654, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1296492, "num_agent_steps_sampled": 1296492, "num_steps_trained": 1296492, "num_agent_steps_trained": 1296492}, "done": false, "episodes_total": 648, "training_iteration": 108, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-44-32", "timestamp": 1690847072, "time_this_iter_s": 74.94282913208008, "time_total_s": 8844.594738721848, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8844.594738721848, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 99.98518518518519, "ram_util_percent": 55.5}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7882305274496346, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.9375889635009713, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8560731278333243, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7113632384031857, "reward_component_totals/delta_v_mean": -2.0815158356676533, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0364888725678165, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.15158356676457, "delta_v_total_min": 203.64888725678085, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1145.23, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5723288355822089, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.8032530392370196, -3.7882305274496346, -4.000320725583802, -3.998920494479634, -3.9781752608695045, -3.813542052350257, -3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8096446923494884, "mean_inference_ms": 8.202575875269556, "mean_action_processing_ms": 0.41366366083163686, "mean_env_wait_ms": 10.068544352476573, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1308498, "agent_timesteps_total": 1308498, "timers": {"sample_time_ms": 42331.468, "sample_throughput": 283.619, "load_time_ms": 6.543, "load_throughput": 1834993.671, "learn_time_ms": 36723.38, "learn_throughput": 326.931, "update_time_ms": 30.252}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004139794036746025, "policy_loss": -0.000285117857856676, "vf_loss": 0.004424911458045244, "vf_explained_var": 0.1960977166891098, "kl": -1.3243807162055532e-09, "entropy": 2.7506258487701416, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1308498, "num_agent_steps_sampled": 1308498, "num_steps_trained": 1308498, "num_agent_steps_trained": 1308498}, "done": false, "episodes_total": 654, "training_iteration": 109, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-45-50", "timestamp": 1690847150, "time_this_iter_s": 76.47406029701233, "time_total_s": 8921.06879901886, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8921.06879901886, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 99.98272727272727, "ram_util_percent": 55.493636363636355}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7939432919426492, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.9404317503103785, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8589659505406227, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7221161793035108, "reward_component_totals/delta_v_mean": -2.0814657997697625, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0364888725678165, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.14657997697552, "delta_v_total_min": 203.64888725678085, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1159.56, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5794902548725637, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.837836676452846, -4.000842672835743, -3.998871833627443, -4.05953310273695, -3.8927485949073506, -3.971893732262072, -4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8086173323454091, "mean_inference_ms": 8.199717459014867, "mean_action_processing_ms": 0.41345845841382606, "mean_env_wait_ms": 10.064025144181969, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1320504, "agent_timesteps_total": 1320504, "timers": {"sample_time_ms": 42527.481, "sample_throughput": 282.312, "load_time_ms": 6.579, "load_throughput": 1824912.348, "learn_time_ms": 36648.067, "learn_throughput": 327.603, "update_time_ms": 28.141}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005498725920915604, "policy_loss": 0.0006696775089949369, "vf_loss": 0.00482904864475131, "vf_explained_var": 0.26222455501556396, "kl": -2.6813078424225978e-09, "entropy": 2.725774049758911, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1320504, "num_agent_steps_sampled": 1320504, "num_steps_trained": 1320504, "num_agent_steps_trained": 1320504}, "done": false, "episodes_total": 660, "training_iteration": 110, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-47-09", "timestamp": 1690847229, "time_this_iter_s": 78.78247165679932, "time_total_s": 8999.85127067566, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8999.85127067566, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 99.97857142857144, "ram_util_percent": 55.399999999999984}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7939432919426492, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.938444907150314, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8567771160152047, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7221161793035108, "reward_component_totals/delta_v_mean": -2.0816677911351156, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.022826364139717, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16677911351078, "delta_v_total_min": 202.28263641397098, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1142.47, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5709495252373813, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.0255622625061775, -4.058320292669429, -3.83658535867233, -3.8514796816815187, -3.921463876646218, -3.9249750728601365, -3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8083130700775973, "mean_inference_ms": 8.196415610166726, "mean_action_processing_ms": 0.4132632725301566, "mean_env_wait_ms": 10.059542081463643, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1332510, "agent_timesteps_total": 1332510, "timers": {"sample_time_ms": 42311.54, "sample_throughput": 283.752, "load_time_ms": 6.516, "load_throughput": 1842661.776, "learn_time_ms": 36990.45, "learn_throughput": 324.57, "update_time_ms": 26.693}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0042205508798360825, "policy_loss": 0.00010921537614194676, "vf_loss": 0.004111334681510925, "vf_explained_var": 0.21544255316257477, "kl": -1.0940536254722133e-09, "entropy": 2.760370969772339, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1332510, "num_agent_steps_sampled": 1332510, "num_steps_trained": 1332510, "num_agent_steps_trained": 1332510}, "done": false, "episodes_total": 666, "training_iteration": 111, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-48-40", "timestamp": 1690847320, "time_this_iter_s": 90.81808948516846, "time_total_s": 9090.669360160828, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9090.669360160828, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 99.98923076923076, "ram_util_percent": 55.49461538461538}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.772343706759788, "episode_reward_min": -4.1138690381719965, "episode_reward_mean": -3.9360704251601244, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8560959782097716, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7221161793035108, "reward_component_totals/delta_v_mean": -2.07997444695036, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9974446950352, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1119.26, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5593503248375812, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.9363068216333748, -4.037151286910284, -4.00913180619637, -4.1138690381719965, -3.8211353590533648, -4.002148506940275, -3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8079666916555555, "mean_inference_ms": 8.193113448283928, "mean_action_processing_ms": 0.4130747070545724, "mean_env_wait_ms": 10.05501251923177, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1344516, "agent_timesteps_total": 1344516, "timers": {"sample_time_ms": 42240.805, "sample_throughput": 284.228, "load_time_ms": 6.25, "load_throughput": 1920952.672, "learn_time_ms": 36860.04, "learn_throughput": 325.719, "update_time_ms": 25.563}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004666964989155531, "policy_loss": -0.00028762975125573575, "vf_loss": 0.00495459558442235, "vf_explained_var": 0.24998261034488678, "kl": -2.9942521795334187e-09, "entropy": 2.723565101623535, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1344516, "num_agent_steps_sampled": 1344516, "num_steps_trained": 1344516, "num_agent_steps_trained": 1344516}, "done": false, "episodes_total": 672, "training_iteration": 112, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-49-58", "timestamp": 1690847398, "time_this_iter_s": 77.00815844535828, "time_total_s": 9167.677518606186, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9167.677518606186, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 99.98181818181818, "ram_util_percent": 55.5}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.772343706759788, "episode_reward_min": -4.092947510696653, "episode_reward_mean": -3.930659062644301, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8511097004343688, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7182702405831364, "reward_component_totals/delta_v_mean": -2.079549362209939, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.95493622099315, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1120.1, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5597701149425288, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.9464689175949035, -3.847365465479248, -3.889516102508896, -3.8447269384864753, -3.842513439754633, -3.831378521826215, -3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8076934889696432, "mean_inference_ms": 8.18995327178686, "mean_action_processing_ms": 0.4128784859159949, "mean_env_wait_ms": 10.050428955123795, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1356522, "agent_timesteps_total": 1356522, "timers": {"sample_time_ms": 42232.778, "sample_throughput": 284.282, "load_time_ms": 6.725, "load_throughput": 1785411.381, "learn_time_ms": 36690.478, "learn_throughput": 327.224, "update_time_ms": 25.919}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.851859946171657e-35, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005405461881309748, "policy_loss": -9.063594916369766e-05, "vf_loss": 0.005496095400303602, "vf_explained_var": 0.2856457531452179, "kl": -9.08790598330711e-10, "entropy": 2.702608108520508, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1356522, "num_agent_steps_sampled": 1356522, "num_steps_trained": 1356522, "num_agent_steps_trained": 1356522}, "done": false, "episodes_total": 678, "training_iteration": 113, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-51-16", "timestamp": 1690847476, "time_this_iter_s": 78.07103705406189, "time_total_s": 9245.748555660248, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9245.748555660248, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.549107142857146}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.772343706759788, "episode_reward_min": -4.092947510696653, "episode_reward_mean": -3.931075411847638, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8518946072945108, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7182702405831364, "reward_component_totals/delta_v_mean": -2.0791808045531344, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.91808045531266, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1120.58, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5600099950024987, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.878875549954511, -3.965962961025104, -3.857556108577194, -3.917562232239444, -3.910691110832288, -4.068647012290376, -3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.807395302735419, "mean_inference_ms": 8.187060057842027, "mean_action_processing_ms": 0.41269074386127846, "mean_env_wait_ms": 10.04580706950374, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1368528, "agent_timesteps_total": 1368528, "timers": {"sample_time_ms": 42073.916, "sample_throughput": 285.355, "load_time_ms": 6.795, "load_throughput": 1766961.547, "learn_time_ms": 36701.875, "learn_throughput": 327.122, "update_time_ms": 25.332}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005626150872558355, "policy_loss": 0.0004953559255227447, "vf_loss": 0.005130796227604151, "vf_explained_var": 0.19245551526546478, "kl": -2.834024570574911e-09, "entropy": 2.7378087043762207, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1368528, "num_agent_steps_sampled": 1368528, "num_steps_trained": 1368528, "num_agent_steps_trained": 1368528}, "done": false, "episodes_total": 684, "training_iteration": 114, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-52-35", "timestamp": 1690847555, "time_this_iter_s": 78.66768383979797, "time_total_s": 9324.416239500046, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9324.416239500046, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 99.98660714285714, "ram_util_percent": 55.356249999999996}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.772343706759788, "episode_reward_min": -4.092947510696653, "episode_reward_mean": -3.9305790292471436, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8505421005144541, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7182702405831364, "reward_component_totals/delta_v_mean": -2.0800369287326963, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00369287326888, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1134.71, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.567071464267866, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.873867200328225, -3.9769341681706125, -3.9756414280794843, -3.9987353399654646, -3.817641774746889, -3.94976952085345, -4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8070776993520636, "mean_inference_ms": 8.18404634103204, "mean_action_processing_ms": 0.41249098219716224, "mean_env_wait_ms": 10.041037431146282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1380534, "agent_timesteps_total": 1380534, "timers": {"sample_time_ms": 42035.011, "sample_throughput": 285.619, "load_time_ms": 6.771, "load_throughput": 1773046.087, "learn_time_ms": 36686.627, "learn_throughput": 327.258, "update_time_ms": 24.92}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.629649865429142e-36, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003637426532804966, "policy_loss": -0.000610237242653966, "vf_loss": 0.004247663542628288, "vf_explained_var": 0.0918613076210022, "kl": -1.0715216491874457e-09, "entropy": 2.7915196418762207, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1380534, "num_agent_steps_sampled": 1380534, "num_steps_trained": 1380534, "num_agent_steps_trained": 1380534}, "done": false, "episodes_total": 690, "training_iteration": 115, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-53-51", "timestamp": 1690847631, "time_this_iter_s": 75.63573956489563, "time_total_s": 9400.051979064941, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9400.051979064941, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 99.98055555555557, "ram_util_percent": 55.38518518518517}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.772343706759788, "episode_reward_min": -4.092947510696653, "episode_reward_mean": -3.930333502229788, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8507553742416119, "reward_component_totals/dist_change_reward_min": -0.9989304010706911, "reward_component_totals/dist_change_reward_max": -0.7182702405831364, "reward_component_totals/delta_v_mean": -2.0795781279881824, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9578127988175, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1134.6, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5670164917541229, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-4.044781931354385, -4.054961693912732, -3.9950750799312456, -3.9909121048610894, -4.021804764669275, -3.8274445620326163, -3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8067155255008316, "mean_inference_ms": 8.180833428197074, "mean_action_processing_ms": 0.4122823825997204, "mean_env_wait_ms": 10.036015044438978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1392540, "agent_timesteps_total": 1392540, "timers": {"sample_time_ms": 41988.273, "sample_throughput": 285.937, "load_time_ms": 6.84, "load_throughput": 1755369.582, "learn_time_ms": 36284.159, "learn_throughput": 330.888, "update_time_ms": 25.888}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004206649027764797, "policy_loss": -0.0002131532528437674, "vf_loss": 0.004419803153723478, "vf_explained_var": 0.1605176329612732, "kl": -2.240682084320156e-09, "entropy": 2.766352415084839, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1392540, "num_agent_steps_sampled": 1392540, "num_steps_trained": 1392540, "num_agent_steps_trained": 1392540}, "done": false, "episodes_total": 696, "training_iteration": 116, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-55-06", "timestamp": 1690847706, "time_this_iter_s": 75.47631001472473, "time_total_s": 9475.528289079666, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9475.528289079666, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 99.98504672897198, "ram_util_percent": 55.374766355140174}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.772343706759788, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.9284126735988396, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8498130953896224, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.078599578209224, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85995782092175, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1144.8, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1987, "constraint_violation.max_vel_constraint.ratio_mean": 0.5721139430284857, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9930034982508745}, "hist_stats": {"episode_reward": [-3.937818028342599, -3.951279898405155, -3.8525314693207227, -3.9283033661866513, -3.814932309852959, -4.052598613481138, -3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.805458845667147, "mean_inference_ms": 8.177846462828377, "mean_action_processing_ms": 0.41206771811199944, "mean_env_wait_ms": 10.030817321780908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1404546, "agent_timesteps_total": 1404546, "timers": {"sample_time_ms": 41940.842, "sample_throughput": 286.26, "load_time_ms": 6.656, "load_throughput": 1803843.398, "learn_time_ms": 36335.27, "learn_throughput": 330.423, "update_time_ms": 26.539}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4074124663572855e-36, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004983717575669289, "policy_loss": -0.00035759713500738144, "vf_loss": 0.005341315641999245, "vf_explained_var": 0.21185751259326935, "kl": -3.1044085080367267e-09, "entropy": 2.7109599113464355, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1404546, "num_agent_steps_sampled": 1404546, "num_steps_trained": 1404546, "num_agent_steps_trained": 1404546}, "done": false, "episodes_total": 702, "training_iteration": 117, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-56-25", "timestamp": 1690847785, "time_this_iter_s": 78.0642147064209, "time_total_s": 9553.592503786087, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9553.592503786087, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 99.97747747747748, "ram_util_percent": 55.30630630630631}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.772343706759788, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.929708970193721, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8511410939764589, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.078567876217269, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85678762172623, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1144.52, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5719740129935031, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.924511296371823, -4.092947510696653, -3.915318576866709, -3.9861549126053477, -3.946070090838731, -4.085283213317474, -4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8041839056286475, "mean_inference_ms": 8.174969728899768, "mean_action_processing_ms": 0.41185901190871443, "mean_env_wait_ms": 10.025494049869424, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1416552, "agent_timesteps_total": 1416552, "timers": {"sample_time_ms": 42071.76, "sample_throughput": 285.37, "load_time_ms": 6.275, "load_throughput": 1913201.922, "learn_time_ms": 36833.926, "learn_throughput": 325.95, "update_time_ms": 26.483}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2037062331786428e-36, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004938624333590269, "policy_loss": -0.00040381134022027254, "vf_loss": 0.005342436023056507, "vf_explained_var": 0.23447558283805847, "kl": -3.5375236073775795e-09, "entropy": 2.6993110179901123, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1416552, "num_agent_steps_sampled": 1416552, "num_steps_trained": 1416552, "num_agent_steps_trained": 1416552}, "done": false, "episodes_total": 708, "training_iteration": 118, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-57-46", "timestamp": 1690847866, "time_this_iter_s": 81.30480313301086, "time_total_s": 9634.897306919098, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9634.897306919098, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 99.9801724137931, "ram_util_percent": 55.36293103448274}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.772343706759788, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.9252250656817727, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8482743414689524, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.076950724212829, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.69507242128216, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1139.81, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5696201899050474, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-4.01249706354258, -3.9598942039048834, -4.041508810059855, -3.872552649157883, -3.905384289625645, -3.8098642521879196, -3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8029266059513258, "mean_inference_ms": 8.172150575348693, "mean_action_processing_ms": 0.41166632619832244, "mean_env_wait_ms": 10.020388447962247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1428558, "agent_timesteps_total": 1428558, "timers": {"sample_time_ms": 42377.347, "sample_throughput": 283.312, "load_time_ms": 6.229, "load_throughput": 1927467.143, "learn_time_ms": 36756.198, "learn_throughput": 326.639, "update_time_ms": 24.136}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005268696695566177, "policy_loss": 0.0006109799724072218, "vf_loss": 0.004657716024667025, "vf_explained_var": 0.24068008363246918, "kl": -1.8601415963104273e-09, "entropy": 2.728040933609009, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1428558, "num_agent_steps_sampled": 1428558, "num_steps_trained": 1428558, "num_agent_steps_trained": 1428558}, "done": false, "episodes_total": 714, "training_iteration": 119, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_16-59-05", "timestamp": 1690847945, "time_this_iter_s": 78.78198003768921, "time_total_s": 9713.679286956787, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9713.679286956787, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 99.98318584070796, "ram_util_percent": 55.38407079646016}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.772343706759788, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.9261473581922526, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8489941648858302, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.0771531933064296, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.71531933064227, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1144.78, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5721039480259871, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.9231187497997406, -3.9351484726099453, -3.8747498042277178, -3.896154101234735, -4.0862271944657955, -4.037763435987513, -4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.80169724227039, "mean_inference_ms": 8.169449735802823, "mean_action_processing_ms": 0.41150020478819527, "mean_env_wait_ms": 10.015536456739655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1440564, "agent_timesteps_total": 1440564, "timers": {"sample_time_ms": 42231.595, "sample_throughput": 284.29, "load_time_ms": 6.13, "load_throughput": 1958570.799, "learn_time_ms": 36996.573, "learn_throughput": 324.517, "update_time_ms": 25.101}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.009265582946607e-37, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003967995755374432, "policy_loss": -0.00044589873868972063, "vf_loss": 0.00441389624029398, "vf_explained_var": 0.2872157394886017, "kl": -2.506058915940912e-09, "entropy": 2.7435462474823, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1440564, "num_agent_steps_sampled": 1440564, "num_steps_trained": 1440564, "num_agent_steps_trained": 1440564}, "done": false, "episodes_total": 720, "training_iteration": 120, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-00-25", "timestamp": 1690848025, "time_this_iter_s": 79.853431224823, "time_total_s": 9793.53271818161, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9793.53271818161, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 99.98596491228072, "ram_util_percent": 55.39912280701753}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.772343706759788, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.925756670352282, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8484824752822177, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.0772741950700713, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.72741950700646, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1143.98, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.571704147926037, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-4.032804963479788, -3.8368922120761657, -4.04337271421547, -4.031836648610886, -3.92351471701606, -3.808568289841234, -3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.801174672500778, "mean_inference_ms": 8.166673737650115, "mean_action_processing_ms": 0.41133957242766306, "mean_env_wait_ms": 10.010756250348319, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1452570, "agent_timesteps_total": 1452570, "timers": {"sample_time_ms": 42813.636, "sample_throughput": 280.425, "load_time_ms": 6.299, "load_throughput": 1906148.202, "learn_time_ms": 37002.091, "learn_throughput": 324.468, "update_time_ms": 27.173}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5046327914733034e-37, "cur_lr": 9.999999960041972e-13, "total_loss": 0.002629079157486558, "policy_loss": -0.0020341572817415, "vf_loss": 0.004663235042244196, "vf_explained_var": 0.2677244544029236, "kl": -2.0804544753616483e-09, "entropy": 2.746281862258911, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1452570, "num_agent_steps_sampled": 1452570, "num_steps_trained": 1452570, "num_agent_steps_trained": 1452570}, "done": false, "episodes_total": 726, "training_iteration": 121, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-02-02", "timestamp": 1690848122, "time_this_iter_s": 96.71504735946655, "time_total_s": 9890.247765541077, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9890.247765541077, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 99.98489208633093, "ram_util_percent": 55.35539568345323}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.765351734863142, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.922401296565683, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8453281064493006, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.077073190116389, "reward_component_totals/delta_v_min": -2.1515885303914524, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.70731901163813, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 215.15885303914453, "constraint_violation.max_vel_constraint.steps_mean": 1142.7, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.571064467766117, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.9284949642497407, -3.968054222129301, -3.890723771520703, -3.935253801164543, -3.838825902676686, -3.7939432919426492, -3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8006517691707973, "mean_inference_ms": 8.1642981278768, "mean_action_processing_ms": 0.4111901216577939, "mean_env_wait_ms": 10.006060681191515, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1464576, "agent_timesteps_total": 1464576, "timers": {"sample_time_ms": 42971.228, "sample_throughput": 279.396, "load_time_ms": 6.333, "load_throughput": 1895714.564, "learn_time_ms": 37180.633, "learn_throughput": 322.91, "update_time_ms": 26.945}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.523163957366517e-38, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0034843480680137873, "policy_loss": -0.0010049697011709213, "vf_loss": 0.004489317070692778, "vf_explained_var": 0.2088988721370697, "kl": -2.2531998489228044e-09, "entropy": 2.7440185546875, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1464576, "num_agent_steps_sampled": 1464576, "num_steps_trained": 1464576, "num_agent_steps_trained": 1464576}, "done": false, "episodes_total": 732, "training_iteration": 122, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-03-23", "timestamp": 1690848203, "time_this_iter_s": 80.42058753967285, "time_total_s": 9970.66835308075, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9970.66835308075, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 99.98421052631579, "ram_util_percent": 55.383333333333304}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.765351734863142, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.9241529120874925, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8481642739074993, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.0759886381800015, "reward_component_totals/delta_v_min": -2.137065379321575, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.59886381799942, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 213.70653793215672, "constraint_violation.max_vel_constraint.steps_mean": 1127.62, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1846, "constraint_violation.max_vel_constraint.ratio_mean": 0.5635282358820589, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9225387306346826}, "hist_stats": {"episode_reward": [-3.8837351909839555, -4.016767242436927, -3.9900731559041978, -3.893030939472043, -3.927768115940453, -3.967910588056066, -3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.800124152122673, "mean_inference_ms": 8.161780957927792, "mean_action_processing_ms": 0.41102685319197074, "mean_env_wait_ms": 10.001278999493923, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1476582, "agent_timesteps_total": 1476582, "timers": {"sample_time_ms": 42987.71, "sample_throughput": 279.289, "load_time_ms": 5.803, "load_throughput": 2068814.786, "learn_time_ms": 37374.111, "learn_throughput": 321.238, "update_time_ms": 26.338}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.7615819786832586e-38, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006370299030095339, "policy_loss": 0.0006608475232496858, "vf_loss": 0.005709447432309389, "vf_explained_var": 0.3664107322692871, "kl": -3.3998281967484445e-09, "entropy": 2.6873245239257812, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1476582, "num_agent_steps_sampled": 1476582, "num_steps_trained": 1476582, "num_agent_steps_trained": 1476582}, "done": false, "episodes_total": 738, "training_iteration": 123, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-04-43", "timestamp": 1690848283, "time_this_iter_s": 80.2033941745758, "time_total_s": 10050.871747255325, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10050.871747255325, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 99.98333333333332, "ram_util_percent": 55.383333333333326}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.756824685147275, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.921814026700358, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8478849820568207, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.073929044643544, "reward_component_totals/delta_v_min": -2.137065379321575, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.39290446435373, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 213.70653793215672, "constraint_violation.max_vel_constraint.steps_mean": 1105.33, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1803, "constraint_violation.max_vel_constraint.ratio_mean": 0.5523888055972014, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9010494752623688}, "hist_stats": {"episode_reward": [-3.847925754023163, -3.9608957826353737, -4.010798464580965, -3.813394809152845, -3.9687245078247333, -3.9053587464908377, -3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7996481956369508, "mean_inference_ms": 8.159155343404347, "mean_action_processing_ms": 0.41087166586508067, "mean_env_wait_ms": 9.996710982663899, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1488588, "agent_timesteps_total": 1488588, "timers": {"sample_time_ms": 42903.847, "sample_throughput": 279.835, "load_time_ms": 5.784, "load_throughput": 2075765.016, "learn_time_ms": 37491.245, "learn_throughput": 320.235, "update_time_ms": 26.161}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006216088309884071, "policy_loss": 0.0010756872361525893, "vf_loss": 0.005140399560332298, "vf_explained_var": 0.23560187220573425, "kl": -1.945262395608438e-09, "entropy": 2.720797061920166, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1488588, "num_agent_steps_sampled": 1488588, "num_steps_trained": 1488588, "num_agent_steps_trained": 1488588}, "done": false, "episodes_total": 744, "training_iteration": 124, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-06-03", "timestamp": 1690848363, "time_this_iter_s": 79.04075527191162, "time_total_s": 10129.912502527237, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10129.912502527237, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 99.98407079646017, "ram_util_percent": 55.34867256637166}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.756824685147275, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.920348302419851, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.847044076950723, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.073304225469135, "reward_component_totals/delta_v_min": -2.137065379321575, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.3304225469129, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 213.70653793215672, "constraint_violation.max_vel_constraint.steps_mean": 1082.99, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5412243878060969, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.981350892233013, -3.931517573021029, -3.853213645533321, -3.9204011235862444, -4.052264730339119, -3.9475236617141647, -3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7991963021202784, "mean_inference_ms": 8.156804777029356, "mean_action_processing_ms": 0.41072142635702286, "mean_env_wait_ms": 9.99199570930688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1500594, "agent_timesteps_total": 1500594, "timers": {"sample_time_ms": 42861.626, "sample_throughput": 280.111, "load_time_ms": 5.85, "load_throughput": 2052163.704, "learn_time_ms": 37570.478, "learn_throughput": 319.559, "update_time_ms": 26.231}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0052078706212341785, "policy_loss": -1.8554348457655578e-07, "vf_loss": 0.005208055023103952, "vf_explained_var": 0.2531009912490845, "kl": -1.7349638392616384e-09, "entropy": 2.7173781394958496, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1500594, "num_agent_steps_sampled": 1500594, "num_steps_trained": 1500594, "num_agent_steps_trained": 1500594}, "done": false, "episodes_total": 750, "training_iteration": 125, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-07-19", "timestamp": 1690848439, "time_this_iter_s": 76.05724716186523, "time_total_s": 10205.969749689102, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10205.969749689102, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 99.98425925925925, "ram_util_percent": 55.38703703703701}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7311153950763876, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.916918219366608, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8431107708816143, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.0738074484850006, "reward_component_totals/delta_v_min": -2.137065379321575, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.38074484849935, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 213.70653793215672, "constraint_violation.max_vel_constraint.steps_mean": 1062.76, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5311144427786106, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.8909296995451204, -3.9883670441546517, -3.8505769639657363, -3.9370586811918167, -3.9073559653589895, -4.004225896508268, -3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7987100186106282, "mean_inference_ms": 8.15451818784687, "mean_action_processing_ms": 0.4105731644879689, "mean_env_wait_ms": 9.987282266918724, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1512600, "agent_timesteps_total": 1512600, "timers": {"sample_time_ms": 42889.943, "sample_throughput": 279.926, "load_time_ms": 5.662, "load_throughput": 2120617.268, "learn_time_ms": 37896.894, "learn_throughput": 316.807, "update_time_ms": 25.505}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.00327371247112751, "policy_loss": -0.0007171984179876745, "vf_loss": 0.003990910481661558, "vf_explained_var": 0.18951697647571564, "kl": -2.2607105076843936e-09, "entropy": 2.7715234756469727, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1512600, "num_agent_steps_sampled": 1512600, "num_steps_trained": 1512600, "num_agent_steps_trained": 1512600}, "done": false, "episodes_total": 756, "training_iteration": 126, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-08-38", "timestamp": 1690848518, "time_this_iter_s": 79.06129121780396, "time_total_s": 10285.031040906906, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10285.031040906906, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 99.98421052631579, "ram_util_percent": 55.374561403508764}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7311153950763876, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.916038668209451, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8420535411756644, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.0739851270337932, "reward_component_totals/delta_v_min": -2.137065379321575, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.39851270337863, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 213.70653793215672, "constraint_violation.max_vel_constraint.steps_mean": 1055.86, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5276661669165418, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.978145582879489, -3.927843308453454, -3.9280782335693307, -3.817393310046395, -3.825965553645578, -3.8109628894074588, -3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7974956253179173, "mean_inference_ms": 8.152234536211983, "mean_action_processing_ms": 0.41040952330265124, "mean_env_wait_ms": 9.982236548149986, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1524606, "agent_timesteps_total": 1524606, "timers": {"sample_time_ms": 42659.681, "sample_throughput": 281.437, "load_time_ms": 5.711, "load_throughput": 2102273.731, "learn_time_ms": 37939.081, "learn_throughput": 316.455, "update_time_ms": 24.412}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004968474619090557, "policy_loss": 0.0006552189588546753, "vf_loss": 0.00431325426325202, "vf_explained_var": 0.2930313050746918, "kl": -3.955617167150649e-09, "entropy": 2.7490499019622803, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1524606, "num_agent_steps_sampled": 1524606, "num_steps_trained": 1524606, "num_agent_steps_trained": 1524606}, "done": false, "episodes_total": 762, "training_iteration": 127, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-09-55", "timestamp": 1690848595, "time_this_iter_s": 76.22190713882446, "time_total_s": 10361.25294804573, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10361.25294804573, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 99.98518518518519, "ram_util_percent": 55.38333333333332}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7311153950763876, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.916962158672389, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8413467759240467, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.7092236055733797, "reward_component_totals/delta_v_mean": -2.075615382748349, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.0050568014383363, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5615382748342, "delta_v_total_min": 200.50568014383245, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1056.27, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5278710644677662, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.995843884621123, -3.935161216918343, -3.772343706759788, -4.040661094664585, -3.8409541554829634, -3.9580570456712207, -3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7962971816532658, "mean_inference_ms": 8.150015580328558, "mean_action_processing_ms": 0.4102535998837763, "mean_env_wait_ms": 9.977334485702858, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1536612, "agent_timesteps_total": 1536612, "timers": {"sample_time_ms": 42628.97, "sample_throughput": 281.639, "load_time_ms": 5.762, "load_throughput": 2083537.68, "learn_time_ms": 37705.875, "learn_throughput": 318.412, "update_time_ms": 24.985}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006600904278457165, "policy_loss": 0.0012605037773028016, "vf_loss": 0.00534039968624711, "vf_explained_var": 0.32011982798576355, "kl": -7.660879153270628e-10, "entropy": 2.7200093269348145, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1536612, "num_agent_steps_sampled": 1536612, "num_steps_trained": 1536612, "num_agent_steps_trained": 1536612}, "done": false, "episodes_total": 768, "training_iteration": 128, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-11-14", "timestamp": 1690848674, "time_this_iter_s": 78.63413596153259, "time_total_s": 10439.887084007263, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10439.887084007263, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 99.98318584070796, "ram_util_percent": 55.29999999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.9127107730082726, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8374287945719645, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.075281978436314, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.52819784363078, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1050.69, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5250824587706148, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.8412436275867963, -3.87359417428193, -3.928625889616625, -3.936131674683826, -3.9626802617355583, -3.944435438084274, -3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7951018588950343, "mean_inference_ms": 8.147948563661428, "mean_action_processing_ms": 0.41010835196672735, "mean_env_wait_ms": 9.972541493568764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1548618, "agent_timesteps_total": 1548618, "timers": {"sample_time_ms": 42363.783, "sample_throughput": 283.402, "load_time_ms": 5.987, "load_throughput": 2005232.963, "learn_time_ms": 38017.335, "learn_throughput": 315.803, "update_time_ms": 25.561}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0036799830850213766, "policy_loss": -0.0005359735223464668, "vf_loss": 0.0042159585282206535, "vf_explained_var": 0.13557274639606476, "kl": -3.3272249400084775e-09, "entropy": 2.7617597579956055, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1548618, "num_agent_steps_sampled": 1548618, "num_steps_trained": 1548618, "num_agent_steps_trained": 1548618}, "done": false, "episodes_total": 774, "training_iteration": 129, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-12-33", "timestamp": 1690848753, "time_this_iter_s": 79.24431014060974, "time_total_s": 10519.131394147873, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10519.131394147873, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 99.98407079646019, "ram_util_percent": 55.30707964601769}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.9133301326827903, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8385836082336046, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.0747465244491927, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4746524449186, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1052.64, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5260569715142429, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.8708206229027486, -3.8213466776449656, -3.790633863332432, -3.8536874422841416, -3.8840678320412207, -3.945614779555953, -3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7938711024582248, "mean_inference_ms": 8.145833842051877, "mean_action_processing_ms": 0.4099584787077004, "mean_env_wait_ms": 9.967848502079958, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1560624, "agent_timesteps_total": 1560624, "timers": {"sample_time_ms": 42245.864, "sample_throughput": 284.193, "load_time_ms": 6.332, "load_throughput": 1896035.763, "learn_time_ms": 37725.458, "learn_throughput": 318.247, "update_time_ms": 22.716}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0044479635544121265, "policy_loss": 0.00013524229871109128, "vf_loss": 0.0043127210810780525, "vf_explained_var": 0.17874331772327423, "kl": -6.659456874835712e-10, "entropy": 2.7546615600585938, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1560624, "num_agent_steps_sampled": 1560624, "num_steps_trained": 1560624, "num_agent_steps_trained": 1560624}, "done": false, "episodes_total": 780, "training_iteration": 130, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-13-49", "timestamp": 1690848829, "time_this_iter_s": 75.60956883430481, "time_total_s": 10594.740962982178, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10594.740962982178, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 99.98796296296297, "ram_util_percent": 55.324074074074076}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.9149644772599608, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8403663894619049, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.0745980877980625, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.45980877980548, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1043.91, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5216941529235383, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.9808071767205906, -3.874407343851889, -3.963197201184866, -3.901562381514915, -3.9195460519497045, -3.8377799950213403, -3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.793381062542144, "mean_inference_ms": 8.143388825627003, "mean_action_processing_ms": 0.4098152587300443, "mean_env_wait_ms": 9.963430602455407, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1572630, "agent_timesteps_total": 1572630, "timers": {"sample_time_ms": 42683.922, "sample_throughput": 281.277, "load_time_ms": 6.098, "load_throughput": 1968901.194, "learn_time_ms": 37437.644, "learn_throughput": 320.693, "update_time_ms": 23.739}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003919672220945358, "policy_loss": 0.00039264975930564106, "vf_loss": 0.0035270219668745995, "vf_explained_var": 0.08420512825250626, "kl": -1.0214505907768512e-09, "entropy": 2.795382499694824, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1572630, "num_agent_steps_sampled": 1572630, "num_steps_trained": 1572630, "num_agent_steps_trained": 1572630}, "done": false, "episodes_total": 786, "training_iteration": 131, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-15-27", "timestamp": 1690848927, "time_this_iter_s": 98.22965383529663, "time_total_s": 10692.970616817474, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10692.970616817474, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 99.98705035971223, "ram_util_percent": 55.32805755395684}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.096696060308243, "episode_reward_mean": -3.9137824367084044, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8395558115778343, "reward_component_totals/dist_change_reward_min": -0.9993330069963412, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.0742266251305774, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.42266251305705, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1040.6, "constraint_violation.max_vel_constraint.steps_min": 404, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5200399800099951, "constraint_violation.max_vel_constraint.ratio_min": 0.20189905047476261, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.928647091031415, -4.023500337340114, -3.920589338261423, -3.937973916804583, -4.000352541903276, -4.096696060308243, -3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7929040938173333, "mean_inference_ms": 8.140962087278796, "mean_action_processing_ms": 0.40966746740816906, "mean_env_wait_ms": 9.958974363788938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1584636, "agent_timesteps_total": 1584636, "timers": {"sample_time_ms": 42532.175, "sample_throughput": 282.28, "load_time_ms": 8.703, "load_throughput": 1379585.819, "learn_time_ms": 37369.597, "learn_throughput": 321.277, "update_time_ms": 24.01}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005748535506427288, "policy_loss": 0.001050825696438551, "vf_loss": 0.004697706550359726, "vf_explained_var": 0.16496485471725464, "kl": -2.854052993939149e-09, "entropy": 2.7516777515411377, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1584636, "num_agent_steps_sampled": 1584636, "num_steps_trained": 1584636, "num_agent_steps_trained": 1584636}, "done": false, "episodes_total": 792, "training_iteration": 132, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-16-46", "timestamp": 1690849006, "time_this_iter_s": 78.23882579803467, "time_total_s": 10771.209442615509, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10771.209442615509, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 99.9830357142857, "ram_util_percent": 55.356249999999996}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.093601552378612, "episode_reward_mean": -3.9113147018793297, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8371273583092409, "reward_component_totals/dist_change_reward_min": -0.9952008023217157, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.074187343570097, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.41873435700893, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1047.16, "constraint_violation.max_vel_constraint.steps_min": 404, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5233183408295852, "constraint_violation.max_vel_constraint.ratio_min": 0.20189905047476261, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.777279142071997, -3.803434085867673, -4.038494652259485, -4.026640791255845, -3.989534700454652, -4.012258759474593, -3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.79245272558643, "mean_inference_ms": 8.13841923085666, "mean_action_processing_ms": 0.40953046585663117, "mean_env_wait_ms": 9.954621068129438, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1596642, "agent_timesteps_total": 1596642, "timers": {"sample_time_ms": 42400.772, "sample_throughput": 283.155, "load_time_ms": 9.194, "load_throughput": 1305906.875, "learn_time_ms": 37259.619, "learn_throughput": 322.226, "update_time_ms": 24.478}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.00456753745675087, "policy_loss": -0.00046129460679367185, "vf_loss": 0.005028834100812674, "vf_explained_var": 0.31308770179748535, "kl": -3.469927678523277e-09, "entropy": 2.7155420780181885, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1596642, "num_agent_steps_sampled": 1596642, "num_steps_trained": 1596642, "num_agent_steps_trained": 1596642}, "done": false, "episodes_total": 798, "training_iteration": 133, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-18-04", "timestamp": 1690849084, "time_this_iter_s": 77.80655264854431, "time_total_s": 10849.015995264053, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10849.015995264053, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 99.98738738738739, "ram_util_percent": 55.38468468468465}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.093601552378612, "episode_reward_mean": -3.910070715016991, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8348097660341594, "reward_component_totals/dist_change_reward_min": -0.9952008023217157, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.075260948982839, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.52609489828308, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1038.53, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5190054972513743, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.8808647322580843, -3.9480408511209335, -3.876032505247844, -3.9603617965212017, -3.9707067677663694, -3.968509571210941, -3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7920232192871892, "mean_inference_ms": 8.135811410694332, "mean_action_processing_ms": 0.40940202333821124, "mean_env_wait_ms": 9.950416169310174, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1608648, "agent_timesteps_total": 1608648, "timers": {"sample_time_ms": 42482.919, "sample_throughput": 282.608, "load_time_ms": 9.199, "load_throughput": 1305192.689, "learn_time_ms": 37227.944, "learn_throughput": 322.5, "update_time_ms": 24.709}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005789099261164665, "policy_loss": -2.446338112349622e-05, "vf_loss": 0.005813563242554665, "vf_explained_var": 0.2312788963317871, "kl": -1.201706512077294e-09, "entropy": 2.6844186782836914, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1608648, "num_agent_steps_sampled": 1608648, "num_steps_trained": 1608648, "num_agent_steps_trained": 1608648}, "done": false, "episodes_total": 804, "training_iteration": 134, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-19-24", "timestamp": 1690849164, "time_this_iter_s": 79.52315425872803, "time_total_s": 10928.539149522781, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10928.539149522781, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 99.97982456140352, "ram_util_percent": 55.383333333333304}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.9114819711445348, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8366087816475445, "reward_component_totals/dist_change_reward_min": -0.9952008023217157, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.074873189496998, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.487318949699, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1027.91, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.5136981509245376, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.830115612759602, -4.05321257203789, -3.8506549524668108, -3.8286956732603983, -4.082775169795247, -3.861570631085427, -3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7916256586871366, "mean_inference_ms": 8.133171672758442, "mean_action_processing_ms": 0.4092667024121298, "mean_env_wait_ms": 9.946093863118382, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1620654, "agent_timesteps_total": 1620654, "timers": {"sample_time_ms": 42670.611, "sample_throughput": 281.365, "load_time_ms": 9.034, "load_throughput": 1328966.867, "learn_time_ms": 37541.727, "learn_throughput": 319.804, "update_time_ms": 26.591}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004909423179924488, "policy_loss": 0.0009384934091940522, "vf_loss": 0.003970930352807045, "vf_explained_var": 0.07521865516901016, "kl": -2.220653660955918e-09, "entropy": 2.787203311920166, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1620654, "num_agent_steps_sampled": 1620654, "num_steps_trained": 1620654, "num_agent_steps_trained": 1620654}, "done": false, "episodes_total": 810, "training_iteration": 135, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-20-45", "timestamp": 1690849245, "time_this_iter_s": 81.07351517677307, "time_total_s": 11009.612664699554, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11009.612664699554, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 99.97586206896553, "ram_util_percent": 55.41379310344826}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.9133335464559296, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.837443992642296, "reward_component_totals/dist_change_reward_min": -0.9939979006736968, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.0758895538136404, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.58895538136323, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1022.54, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5110144927536231, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.997777122619888, -3.876350555951675, -3.93446347179151, -3.940993568282922, -3.8245276147367524, -3.956352134412107, -4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7911831105039795, "mean_inference_ms": 8.130480018078993, "mean_action_processing_ms": 0.4091142208911085, "mean_env_wait_ms": 9.941504281296792, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1632660, "agent_timesteps_total": 1632660, "timers": {"sample_time_ms": 42548.98, "sample_throughput": 282.169, "load_time_ms": 9.456, "load_throughput": 1269722.51, "learn_time_ms": 37750.405, "learn_throughput": 318.036, "update_time_ms": 25.925}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004670635797083378, "policy_loss": 0.0002942828577943146, "vf_loss": 0.00437635462731123, "vf_explained_var": 0.1392558366060257, "kl": -1.0840394137900944e-09, "entropy": 2.758126974105835, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1632660, "num_agent_steps_sampled": 1632660, "num_steps_trained": 1632660, "num_agent_steps_trained": 1632660}, "done": false, "episodes_total": 816, "training_iteration": 136, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-22-05", "timestamp": 1690849325, "time_this_iter_s": 80.00428128242493, "time_total_s": 11089.61694598198, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11089.61694598198, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 99.98421052631579, "ram_util_percent": 55.369298245614026}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.9112902299504047, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8346828766023716, "reward_component_totals/dist_change_reward_min": -0.9939979006736968, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.0766073533480407, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6607353348033, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1013.88, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5066866566716641, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-4.034798213417771, -4.093601552378612, -3.841363521081234, -3.9634499383018635, -3.8429752537884303, -4.066526682105467, -3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7900452463460588, "mean_inference_ms": 8.128204314428055, "mean_action_processing_ms": 0.4089415054187372, "mean_env_wait_ms": 9.936879559642442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1644666, "agent_timesteps_total": 1644666, "timers": {"sample_time_ms": 43045.696, "sample_throughput": 278.913, "load_time_ms": 9.636, "load_throughput": 1245996.25, "learn_time_ms": 37628.072, "learn_throughput": 319.07, "update_time_ms": 26.595}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0034771878272295, "policy_loss": -0.0007087162812240422, "vf_loss": 0.004185901954770088, "vf_explained_var": 0.23007026314735413, "kl": -1.041479014141089e-09, "entropy": 2.7595434188842773, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1644666, "num_agent_steps_sampled": 1644666, "num_steps_trained": 1644666, "num_agent_steps_trained": 1644666}, "done": false, "episodes_total": 822, "training_iteration": 137, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-23-25", "timestamp": 1690849405, "time_this_iter_s": 80.0140221118927, "time_total_s": 11169.630968093872, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11169.630968093872, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 99.98333333333332, "ram_util_percent": 55.29999999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.9075130282005315, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8317397053903016, "reward_component_totals/dist_change_reward_min": -0.9939979006736968, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.0757733228102366, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.57733228102288, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1005.19, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.502343828085957, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.889745541879093, -3.977876700457716, -3.765351734863142, -3.798976253485842, -3.9140346305382288, -4.027834243741764, -3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7889012679245317, "mean_inference_ms": 8.125857586062729, "mean_action_processing_ms": 0.4087651579181528, "mean_env_wait_ms": 9.932151562677825, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1656672, "agent_timesteps_total": 1656672, "timers": {"sample_time_ms": 42850.357, "sample_throughput": 280.184, "load_time_ms": 9.74, "load_throughput": 1232643.468, "learn_time_ms": 37833.397, "learn_throughput": 317.339, "update_time_ms": 26.749}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005096151027828455, "policy_loss": 0.00013940966164227575, "vf_loss": 0.004956742282956839, "vf_explained_var": 0.3109515309333801, "kl": -1.3343949278876721e-09, "entropy": 2.7116191387176514, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1656672, "num_agent_steps_sampled": 1656672, "num_steps_trained": 1656672, "num_agent_steps_trained": 1656672}, "done": false, "episodes_total": 828, "training_iteration": 138, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-24-44", "timestamp": 1690849484, "time_this_iter_s": 78.70419716835022, "time_total_s": 11248.335165262222, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11248.335165262222, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 99.98018018018016, "ram_util_percent": 55.300000000000004}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.910137512396964, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8334800016380303, "reward_component_totals/dist_change_reward_min": -0.9939979006736968, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.0766575107589405, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6657510758932, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1033.97, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5167266366816592, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.963347067101986, -3.837942707713265, -3.9137683928486817, -3.87353046392072, -3.756824685147275, -4.009336514169432, -3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7877918092278349, "mean_inference_ms": 8.123418923773947, "mean_action_processing_ms": 0.40858941992424286, "mean_env_wait_ms": 9.927554046801973, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1668678, "agent_timesteps_total": 1668678, "timers": {"sample_time_ms": 42855.916, "sample_throughput": 280.148, "load_time_ms": 9.457, "load_throughput": 1269533.647, "learn_time_ms": 37773.766, "learn_throughput": 317.84, "update_time_ms": 28.483}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004922583699226379, "policy_loss": 0.000659637211356312, "vf_loss": 0.004262943752110004, "vf_explained_var": 0.20287083089351654, "kl": -2.728875181379209e-10, "entropy": 2.756380081176758, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1668678, "num_agent_steps_sampled": 1668678, "num_steps_trained": 1668678, "num_agent_steps_trained": 1668678}, "done": false, "episodes_total": 834, "training_iteration": 139, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-26-03", "timestamp": 1690849563, "time_this_iter_s": 78.67127633094788, "time_total_s": 11327.00644159317, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11327.00644159317, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 99.98318584070795, "ram_util_percent": 55.29999999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.2178769763196766, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.909485810356548, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8340452620836228, "reward_component_totals/dist_change_reward_min": -0.9939979006736968, "reward_component_totals/dist_change_reward_max": -0.15382880348814326, "reward_component_totals/delta_v_mean": -2.0754405482729315, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.54405482729237, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1043.08, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.52127936031984, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.9365588412499974, -3.9593354685354347, -3.9348881913496676, -3.8484529936283556, -3.9433487970262746, -3.9141399415192053, -3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7867268209145857, "mean_inference_ms": 8.121075690363565, "mean_action_processing_ms": 0.40842489628422274, "mean_env_wait_ms": 9.923182038100007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1680684, "agent_timesteps_total": 1680684, "timers": {"sample_time_ms": 42847.381, "sample_throughput": 280.204, "load_time_ms": 9.393, "load_throughput": 1278133.893, "learn_time_ms": 37904.925, "learn_throughput": 316.74, "update_time_ms": 29.901}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005957470741122961, "policy_loss": 0.0005782056832686067, "vf_loss": 0.005379265174269676, "vf_explained_var": 0.22411184012889862, "kl": -2.6813078424225978e-09, "entropy": 2.689589023590088, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1680684, "num_agent_steps_sampled": 1680684, "num_steps_trained": 1680684, "num_agent_steps_trained": 1680684}, "done": false, "episodes_total": 840, "training_iteration": 140, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-27-20", "timestamp": 1690849640, "time_this_iter_s": 76.91642451286316, "time_total_s": 11403.922866106033, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11403.922866106033, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 99.98272727272727, "ram_util_percent": 55.3}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.905554845067205, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8288046259540769, "reward_component_totals/dist_change_reward_min": -0.9939979006736968, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.0767502191131353, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.020241544296349, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.67502191131277, "delta_v_total_min": 202.02415442963445, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1055.84, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5276561719140429, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.870831480581885, -3.8066120188756747, -3.9360144792600797, -3.8895789193941255, -3.909628759886274, -3.7311153950763876, -3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7862851017492136, "mean_inference_ms": 8.118642659576984, "mean_action_processing_ms": 0.40828705315822, "mean_env_wait_ms": 9.91919532789783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1692690, "agent_timesteps_total": 1692690, "timers": {"sample_time_ms": 42569.353, "sample_throughput": 282.034, "load_time_ms": 9.385, "load_throughput": 1279302.838, "learn_time_ms": 38099.005, "learn_throughput": 315.126, "update_time_ms": 28.049}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.00472401175647974, "policy_loss": 0.0004138924996368587, "vf_loss": 0.0043101185001432896, "vf_explained_var": 0.09814569354057312, "kl": -1.8476238317077787e-09, "entropy": 2.7765238285064697, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1692690, "num_agent_steps_sampled": 1692690, "num_steps_trained": 1692690, "num_agent_steps_trained": 1692690}, "done": false, "episodes_total": 846, "training_iteration": 141, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-28-58", "timestamp": 1690849738, "time_this_iter_s": 97.35116839408875, "time_total_s": 11501.274034500122, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11501.274034500122, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 99.9863309352518, "ram_util_percent": 55.300000000000004}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.9112210588860523, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8345139763010585, "reward_component_totals/dist_change_reward_min": -0.9939979006736968, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.0767070825850014, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.0265960193673838, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6707082584993, "delta_v_total_min": 202.6596019367375, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1071.59, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.535527236381809, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.984627035806204, -4.058169866119594, -3.8071724217809946, -3.8525498424330844, -3.9460375653513404, -3.9187779089017427, -3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7859281130852838, "mean_inference_ms": 8.116275385750525, "mean_action_processing_ms": 0.4081482090539257, "mean_env_wait_ms": 9.915471816433566, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1704696, "agent_timesteps_total": 1704696, "timers": {"sample_time_ms": 42628.44, "sample_throughput": 281.643, "load_time_ms": 7.539, "load_throughput": 1592436.203, "learn_time_ms": 37993.682, "learn_throughput": 316.0, "update_time_ms": 29.383}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0032202505972236395, "policy_loss": -0.001176829100586474, "vf_loss": 0.0043970802798867226, "vf_explained_var": 0.1517976075410843, "kl": -1.587254105928082e-09, "entropy": 2.7487964630126953, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1704696, "num_agent_steps_sampled": 1704696, "num_steps_trained": 1704696, "num_agent_steps_trained": 1704696}, "done": false, "episodes_total": 852, "training_iteration": 142, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-30-16", "timestamp": 1690849816, "time_this_iter_s": 77.79197835922241, "time_total_s": 11579.066012859344, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11579.066012859344, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 99.98378378378378, "ram_util_percent": 55.339639639639614}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.9098425501817196, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8337520834022518, "reward_component_totals/dist_change_reward_min": -0.9939979006736968, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.0760904667794744, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.0265960193673838, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.60904667794665, "delta_v_total_min": 202.6596019367375, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1076.09, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.537776111944028, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.951413687932436, -3.9406935469909374, -3.9586621869404217, -3.7749742388920264, -3.8109549230403674, -3.9692200492325833, -3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7856501996852332, "mean_inference_ms": 8.114036196510284, "mean_action_processing_ms": 0.40802657980026225, "mean_env_wait_ms": 9.91201525642838, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1716702, "agent_timesteps_total": 1716702, "timers": {"sample_time_ms": 42699.091, "sample_throughput": 281.177, "load_time_ms": 7.253, "load_throughput": 1655428.605, "learn_time_ms": 37784.617, "learn_throughput": 317.748, "update_time_ms": 29.687}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.002710666274651885, "policy_loss": -0.0012309927260503173, "vf_loss": 0.003941662143915892, "vf_explained_var": 0.13480262458324432, "kl": -1.0640109904258566e-09, "entropy": 2.784438371658325, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1716702, "num_agent_steps_sampled": 1716702, "num_steps_trained": 1716702, "num_agent_steps_trained": 1716702}, "done": false, "episodes_total": 858, "training_iteration": 143, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-31-32", "timestamp": 1690849892, "time_this_iter_s": 76.44942378997803, "time_total_s": 11655.515436649323, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11655.515436649323, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 99.9834862385321, "ram_util_percent": 55.39999999999997}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.9120946517959463, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8356589789018278, "reward_component_totals/dist_change_reward_min": -0.9939979006736968, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.076435672894124, "reward_component_totals/delta_v_min": -2.1490848668416356, "reward_component_totals/delta_v_max": -2.0265960193673838, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.64356728941164, "delta_v_total_min": 202.6596019367375, "delta_v_total_max": 214.9084866841623, "constraint_violation.max_vel_constraint.steps_mean": 1086.38, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5429185407296352, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.910609955764367, -3.857975831894503, -3.871606239915514, -3.9603709244481724, -3.9327422628645965, -4.022396001890934, -3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.785416617215478, "mean_inference_ms": 8.11208241233331, "mean_action_processing_ms": 0.4079155222912988, "mean_env_wait_ms": 9.908666769768567, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1728708, "agent_timesteps_total": 1728708, "timers": {"sample_time_ms": 42791.63, "sample_throughput": 280.569, "load_time_ms": 7.373, "load_throughput": 1628452.963, "learn_time_ms": 37563.161, "learn_throughput": 319.622, "update_time_ms": 31.505}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0021806349977850914, "policy_loss": -0.0015363491838797927, "vf_loss": 0.003716985462233424, "vf_explained_var": 0.2548561990261078, "kl": -2.1730859334212482e-09, "entropy": 2.775623321533203, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1728708, "num_agent_steps_sampled": 1728708, "num_steps_trained": 1728708, "num_agent_steps_trained": 1728708}, "done": false, "episodes_total": 864, "training_iteration": 144, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-32-51", "timestamp": 1690849971, "time_this_iter_s": 78.21958899497986, "time_total_s": 11733.735025644302, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11733.735025644302, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 99.98303571428572, "ram_util_percent": 55.399999999999984}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.910311819519828, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8343567248689467, "reward_component_totals/dist_change_reward_min": -0.9939979006736968, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.0759550946508885, "reward_component_totals/delta_v_min": -2.1340987294415656, "reward_component_totals/delta_v_max": -2.0265960193673838, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.59550946508807, "delta_v_total_min": 202.6596019367375, "delta_v_total_max": 213.40987294415564, "constraint_violation.max_vel_constraint.steps_mean": 1082.12, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5407896051974014, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-3.9994056767761723, -3.938065515350561, -3.2178769763196766, -4.007396104504422, -4.065349758481958, -3.969314935147743, -4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.785195866178917, "mean_inference_ms": 8.110122057132452, "mean_action_processing_ms": 0.40780272984346316, "mean_env_wait_ms": 9.905290083972055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1740714, "agent_timesteps_total": 1740714, "timers": {"sample_time_ms": 42798.616, "sample_throughput": 280.523, "load_time_ms": 7.289, "load_throughput": 1647084.673, "learn_time_ms": 37369.504, "learn_throughput": 321.278, "update_time_ms": 29.386}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005308882333338261, "policy_loss": 0.0008646882488392293, "vf_loss": 0.0044441926293075085, "vf_explained_var": 0.1465398371219635, "kl": -1.6047789763717901e-09, "entropy": 2.753131866455078, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1740714, "num_agent_steps_sampled": 1740714, "num_steps_trained": 1740714, "num_agent_steps_trained": 1740714}, "done": false, "episodes_total": 870, "training_iteration": 145, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-34-10", "timestamp": 1690850050, "time_this_iter_s": 79.18809676170349, "time_total_s": 11812.923122406006, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11812.923122406006, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 99.97699115044247, "ram_util_percent": 55.47256637168141}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.913307872259483, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8373466996867136, "reward_component_totals/dist_change_reward_min": -0.9939979006736968, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.0759611725727756, "reward_component_totals/delta_v_min": -2.1340987294415656, "reward_component_totals/delta_v_max": -2.0267832226057902, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.59611725727677, "delta_v_total_min": 202.67832226057828, "delta_v_total_max": 213.40987294415564, "constraint_violation.max_vel_constraint.steps_mean": 1095.96, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5477061469265366, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-4.010860854191623, -3.816646440939383, -3.766398766106893, -3.920076278573265, -3.8509475169201552, -3.80734659280344, -4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7850293426401398, "mean_inference_ms": 8.108047214461507, "mean_action_processing_ms": 0.4076951634355124, "mean_env_wait_ms": 9.90201117479066, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1752720, "agent_timesteps_total": 1752720, "timers": {"sample_time_ms": 42987.608, "sample_throughput": 279.29, "load_time_ms": 7.311, "load_throughput": 1642239.595, "learn_time_ms": 36979.252, "learn_throughput": 324.669, "update_time_ms": 29.998}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0047382088378071785, "policy_loss": 0.0003482004685793072, "vf_loss": 0.004390006884932518, "vf_explained_var": 0.10405319184064865, "kl": -2.3333135423797557e-09, "entropy": 2.7526307106018066, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1752720, "num_agent_steps_sampled": 1752720, "num_steps_trained": 1752720, "num_agent_steps_trained": 1752720}, "done": false, "episodes_total": 876, "training_iteration": 146, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-35-28", "timestamp": 1690850128, "time_this_iter_s": 77.95904016494751, "time_total_s": 11890.882162570953, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11890.882162570953, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 99.97999999999999, "ram_util_percent": 55.40818181818179}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.9201904132238483, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8436012115743242, "reward_component_totals/dist_change_reward_min": -0.9967922078593673, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.07658920164953, "reward_component_totals/delta_v_min": -2.1340987294415656, "reward_component_totals/delta_v_max": -2.0267832226057902, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6589201649523, "delta_v_total_min": 202.67832226057828, "delta_v_total_max": 213.40987294415564, "constraint_violation.max_vel_constraint.steps_mean": 1111.2, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5553223388305847, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-4.009766678316433, -4.029393526602751, -3.7702002055928263, -3.8619511552428625, -3.866112728424372, -3.9614436894110767, -3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.784184474841702, "mean_inference_ms": 8.10608948448921, "mean_action_processing_ms": 0.4075903282214844, "mean_env_wait_ms": 9.898717023477605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1764726, "agent_timesteps_total": 1764726, "timers": {"sample_time_ms": 42862.575, "sample_throughput": 280.104, "load_time_ms": 7.159, "load_throughput": 1677140.482, "learn_time_ms": 37165.04, "learn_throughput": 323.046, "update_time_ms": 29.755}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004384434316307306, "policy_loss": 0.0004727354971691966, "vf_loss": 0.0039116982370615005, "vf_explained_var": 0.17484532296657562, "kl": 3.0543373386038297e-10, "entropy": 2.7827303409576416, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1764726, "num_agent_steps_sampled": 1764726, "num_steps_trained": 1764726, "num_agent_steps_trained": 1764726}, "done": false, "episodes_total": 882, "training_iteration": 147, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-36-49", "timestamp": 1690850209, "time_this_iter_s": 80.505211353302, "time_total_s": 11971.387373924255, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11971.387373924255, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 99.98521739130435, "ram_util_percent": 55.39999999999998}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.9185645536977476, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8422643929986613, "reward_component_totals/dist_change_reward_min": -0.9967922078593673, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.076300160699093, "reward_component_totals/delta_v_min": -2.1340987294415656, "reward_component_totals/delta_v_max": -2.0267832226057902, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.63001606990855, "delta_v_total_min": 202.67832226057828, "delta_v_total_max": 213.40987294415564, "constraint_violation.max_vel_constraint.steps_mean": 1106.53, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5529885057471264, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-3.8284778447386656, -3.9338412392946767, -3.947042845271767, -3.822177747947115, -3.873241889958967, -3.9710365876856315, -4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.783322054050557, "mean_inference_ms": 8.104316243467004, "mean_action_processing_ms": 0.40747801779680143, "mean_env_wait_ms": 9.895326574401786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1776732, "agent_timesteps_total": 1776732, "timers": {"sample_time_ms": 42935.333, "sample_throughput": 279.63, "load_time_ms": 7.256, "load_throughput": 1654585.517, "learn_time_ms": 36978.831, "learn_throughput": 324.672, "update_time_ms": 31.513}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.00310682225972414, "policy_loss": -0.0020676327403634787, "vf_loss": 0.005174456164240837, "vf_explained_var": 0.26828494668006897, "kl": -2.5761583977157443e-09, "entropy": 2.71112060546875, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1776732, "num_agent_steps_sampled": 1776732, "num_steps_trained": 1776732, "num_agent_steps_trained": 1776732}, "done": false, "episodes_total": 888, "training_iteration": 148, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-38-07", "timestamp": 1690850287, "time_this_iter_s": 77.6170802116394, "time_total_s": 12049.004454135895, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12049.004454135895, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 99.98288288288288, "ram_util_percent": 55.454954954954935}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.921880816082524, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8458747527915924, "reward_component_totals/dist_change_reward_min": -0.9967922078593673, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.076006063290937, "reward_component_totals/delta_v_min": -2.1340987294415656, "reward_component_totals/delta_v_max": -2.0267832226057902, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.600606329093, "delta_v_total_min": 202.67832226057828, "delta_v_total_max": 213.40987294415564, "constraint_violation.max_vel_constraint.steps_mean": 1114.92, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1981, "constraint_violation.max_vel_constraint.ratio_mean": 0.5571814092953522, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9900049975012494}, "hist_stats": {"episode_reward": [-4.059304751609858, -4.042434698200133, -3.966406407250152, -3.7485614680369084, -4.060310391027676, -3.8682599680408036, -3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7825006430654966, "mean_inference_ms": 8.102499270025854, "mean_action_processing_ms": 0.40737636271963173, "mean_env_wait_ms": 9.89210101716769, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1788738, "agent_timesteps_total": 1788738, "timers": {"sample_time_ms": 42705.281, "sample_throughput": 281.136, "load_time_ms": 7.397, "load_throughput": 1623182.872, "learn_time_ms": 37043.951, "learn_throughput": 324.101, "update_time_ms": 29.47}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004896841011941433, "policy_loss": 0.00019321376748848706, "vf_loss": 0.004703627899289131, "vf_explained_var": 0.3443688452243805, "kl": 1.2267420412825913e-10, "entropy": 2.7514569759368896, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1788738, "num_agent_steps_sampled": 1788738, "num_steps_trained": 1788738, "num_agent_steps_trained": 1788738}, "done": false, "episodes_total": 894, "training_iteration": 149, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-39-24", "timestamp": 1690850364, "time_this_iter_s": 77.07495212554932, "time_total_s": 12126.079406261444, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12126.079406261444, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 99.97727272727273, "ram_util_percent": 55.45999999999997}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.9181323686244345, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8419234111842795, "reward_component_totals/dist_change_reward_min": -0.9967922078593673, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.076208957440161, "reward_component_totals/delta_v_min": -2.1340987294415656, "reward_component_totals/delta_v_max": -2.0267832226057902, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6208957440154, "delta_v_total_min": 202.67832226057828, "delta_v_total_max": 213.40987294415564, "constraint_violation.max_vel_constraint.steps_mean": 1112.65, "constraint_violation.max_vel_constraint.steps_min": 236, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5560469765117442, "constraint_violation.max_vel_constraint.ratio_min": 0.11794102948525736, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.8730249627512046, -3.964656904693871, -3.964320257535355, -3.7926709611013365, -3.915417370424861, -4.018244235097697, -3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.781718962571369, "mean_inference_ms": 8.100786378368925, "mean_action_processing_ms": 0.4072834573580248, "mean_env_wait_ms": 9.88908833485912, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1800744, "agent_timesteps_total": 1800744, "timers": {"sample_time_ms": 42636.509, "sample_throughput": 281.59, "load_time_ms": 7.117, "load_throughput": 1686854.16, "learn_time_ms": 37148.939, "learn_throughput": 323.186, "update_time_ms": 28.169}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004109321627765894, "policy_loss": -0.00019992647867184132, "vf_loss": 0.004309248179197311, "vf_explained_var": 0.11217055469751358, "kl": -1.7174389688179303e-09, "entropy": 2.7685458660125732, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1800744, "num_agent_steps_sampled": 1800744, "num_steps_trained": 1800744, "num_agent_steps_trained": 1800744}, "done": false, "episodes_total": 900, "training_iteration": 150, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-40-41", "timestamp": 1690850441, "time_this_iter_s": 77.2253475189209, "time_total_s": 12203.304753780365, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12203.304753780365, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 99.98378378378378, "ram_util_percent": 55.39999999999996}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.115528533325432, "episode_reward_mean": -3.921110589132939, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8440148252971333, "reward_component_totals/dist_change_reward_min": -0.9967922078593673, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.0770957638358105, "reward_component_totals/delta_v_min": -2.1302531825502755, "reward_component_totals/delta_v_max": -2.0267832226057902, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7095763835804, "delta_v_total_min": 202.67832226057828, "delta_v_total_max": 213.02531825502618, "constraint_violation.max_vel_constraint.steps_mean": 1109.23, "constraint_violation.max_vel_constraint.steps_min": 496, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5543378310844579, "constraint_violation.max_vel_constraint.ratio_min": 0.2478760619690155, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9922115574108386, -4.115528533325432, -3.8776522058409677, -3.826587934780054, -3.881561247618671, -4.089793389335844, -3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7814634808165946, "mean_inference_ms": 8.098890156066714, "mean_action_processing_ms": 0.4072032486382707, "mean_env_wait_ms": 9.886137001190983, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1812750, "agent_timesteps_total": 1812750, "timers": {"sample_time_ms": 42231.253, "sample_throughput": 284.292, "load_time_ms": 7.378, "load_throughput": 1627284.719, "learn_time_ms": 37367.829, "learn_throughput": 321.292, "update_time_ms": 30.315}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004627818241715431, "policy_loss": 0.0005427653668448329, "vf_loss": 0.004085055086761713, "vf_explained_var": 0.14056353271007538, "kl": -1.4095016265258664e-09, "entropy": 2.7814486026763916, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1812750, "num_agent_steps_sampled": 1812750, "num_steps_trained": 1812750, "num_agent_steps_trained": 1812750}, "done": false, "episodes_total": 906, "training_iteration": 151, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-42-17", "timestamp": 1690850537, "time_this_iter_s": 95.56098675727844, "time_total_s": 12298.865740537643, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12298.865740537643, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 99.9875, "ram_util_percent": 55.459558823529406}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.110138733378581, "episode_reward_mean": -3.9174424235707117, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.840939006223343, "reward_component_totals/dist_change_reward_min": -0.9967922078593673, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.076503417347375, "reward_component_totals/delta_v_min": -2.1302531825502755, "reward_component_totals/delta_v_max": -2.0267832226057902, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.65034173473677, "delta_v_total_min": 202.67832226057828, "delta_v_total_max": 213.02531825502618, "constraint_violation.max_vel_constraint.steps_mean": 1134.47, "constraint_violation.max_vel_constraint.steps_min": 496, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5669515242378811, "constraint_violation.max_vel_constraint.ratio_min": 0.2478760619690155, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9065571150370046, -3.8266294799711593, -3.905107193318685, -4.082533717263411, -3.881706705597659, -3.859325399644117, -3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7812613972769176, "mean_inference_ms": 8.097356956618118, "mean_action_processing_ms": 0.4071214266986546, "mean_env_wait_ms": 9.883468332450867, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1824756, "agent_timesteps_total": 1824756, "timers": {"sample_time_ms": 42529.467, "sample_throughput": 282.298, "load_time_ms": 6.613, "load_throughput": 1815405.746, "learn_time_ms": 37606.134, "learn_throughput": 319.256, "update_time_ms": 29.601}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0067073809914290905, "policy_loss": 0.0008897666702978313, "vf_loss": 0.005817614495754242, "vf_explained_var": 0.21235084533691406, "kl": -2.551122868510447e-09, "entropy": 2.692869186401367, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1824756, "num_agent_steps_sampled": 1824756, "num_steps_trained": 1824756, "num_agent_steps_trained": 1824756}, "done": false, "episodes_total": 912, "training_iteration": 152, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-43-40", "timestamp": 1690850620, "time_this_iter_s": 83.03151106834412, "time_total_s": 12381.897251605988, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12381.897251605988, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 99.98739495798321, "ram_util_percent": 55.42100840336132}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.110138733378581, "episode_reward_mean": -3.918148690506082, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8425520981816089, "reward_component_totals/dist_change_reward_min": -0.9967922078593673, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.0755965923244784, "reward_component_totals/delta_v_min": -2.1302531825502755, "reward_component_totals/delta_v_max": -2.0267832226057902, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.55965923244716, "delta_v_total_min": 202.67832226057828, "delta_v_total_max": 213.02531825502618, "constraint_violation.max_vel_constraint.steps_mean": 1139.24, "constraint_violation.max_vel_constraint.steps_min": 506, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.569335332333833, "constraint_violation.max_vel_constraint.ratio_min": 0.25287356321839083, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.982792378853051, -3.8611109268238106, -3.9432142211876435, -3.797983185136142, -3.878649316429417, -3.942018760230518, -3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7810697835560005, "mean_inference_ms": 8.095798330879278, "mean_action_processing_ms": 0.407036708560322, "mean_env_wait_ms": 9.880668342617, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1836762, "agent_timesteps_total": 1836762, "timers": {"sample_time_ms": 42452.813, "sample_throughput": 282.808, "load_time_ms": 6.808, "load_throughput": 1763551.906, "learn_time_ms": 37757.621, "learn_throughput": 317.976, "update_time_ms": 30.056}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.00480897119268775, "policy_loss": 0.0009345742291770875, "vf_loss": 0.0038743987679481506, "vf_explained_var": 0.17492027580738068, "kl": -2.4735127279740254e-09, "entropy": 2.7760140895843506, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1836762, "num_agent_steps_sampled": 1836762, "num_steps_trained": 1836762, "num_agent_steps_trained": 1836762}, "done": false, "episodes_total": 918, "training_iteration": 153, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-44-58", "timestamp": 1690850698, "time_this_iter_s": 77.12459254264832, "time_total_s": 12459.021844148636, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12459.021844148636, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 99.98440366972478, "ram_util_percent": 55.48532110091742}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.110138733378581, "episode_reward_mean": -3.918987818877529, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8439827740312954, "reward_component_totals/dist_change_reward_min": -0.9967922078593673, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.0750050448462405, "reward_component_totals/delta_v_min": -2.1302531825502755, "reward_component_totals/delta_v_max": -2.0267832226057902, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.50050448462326, "delta_v_total_min": 202.67832226057828, "delta_v_total_max": 213.02531825502618, "constraint_violation.max_vel_constraint.steps_mean": 1129.51, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5644727636181909, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.920946984097985, -3.9084491260599576, -3.7903195378201726, -4.02461126144795, -3.8004616335869357, -3.9278483495299255, -4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.780875521643932, "mean_inference_ms": 8.094102916398128, "mean_action_processing_ms": 0.40696400398312876, "mean_env_wait_ms": 9.87791227389556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1848768, "agent_timesteps_total": 1848768, "timers": {"sample_time_ms": 42304.187, "sample_throughput": 283.802, "load_time_ms": 6.724, "load_throughput": 1785651.961, "learn_time_ms": 37902.727, "learn_throughput": 316.758, "update_time_ms": 27.687}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0056579760275781155, "policy_loss": 0.00032854938763193786, "vf_loss": 0.005329424515366554, "vf_explained_var": 0.3139481246471405, "kl": -1.4420478144927529e-09, "entropy": 2.7004997730255127, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1848768, "num_agent_steps_sampled": 1848768, "num_steps_trained": 1848768, "num_agent_steps_trained": 1848768}, "done": false, "episodes_total": 924, "training_iteration": 154, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-46-16", "timestamp": 1690850776, "time_this_iter_s": 78.23907589912415, "time_total_s": 12537.26092004776, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12537.26092004776, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 99.98839285714287, "ram_util_percent": 55.44196428571428}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.110138733378581, "episode_reward_mean": -3.9212902557082736, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8461273358044805, "reward_component_totals/dist_change_reward_min": -0.9967922078593673, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.075162919903798, "reward_component_totals/delta_v_min": -2.1302531825502755, "reward_component_totals/delta_v_max": -2.0267832226057902, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5162919903791, "delta_v_total_min": 202.67832226057828, "delta_v_total_max": 213.02531825502618, "constraint_violation.max_vel_constraint.steps_mean": 1147.75, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5735882058970515, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.040967831954307, -4.057359986469548, -3.786492540097866, -4.023137182970463, -3.8026156969865355, -3.8826181001377904, -3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7807341301588229, "mean_inference_ms": 8.092599969475467, "mean_action_processing_ms": 0.40689396471763645, "mean_env_wait_ms": 9.875337624395875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1860774, "agent_timesteps_total": 1860774, "timers": {"sample_time_ms": 42236.624, "sample_throughput": 284.256, "load_time_ms": 6.959, "load_throughput": 1725198.322, "learn_time_ms": 37746.551, "learn_throughput": 318.069, "update_time_ms": 27.807}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005337476264685392, "policy_loss": 0.0006097287405282259, "vf_loss": 0.004727745894342661, "vf_explained_var": 0.18036819994449615, "kl": -3.2721467757568234e-09, "entropy": 2.7352519035339355, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1860774, "num_agent_steps_sampled": 1860774, "num_steps_trained": 1860774, "num_agent_steps_trained": 1860774}, "done": false, "episodes_total": 930, "training_iteration": 155, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-47-33", "timestamp": 1690850853, "time_this_iter_s": 76.90248227119446, "time_total_s": 12614.163402318954, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12614.163402318954, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 99.98636363636363, "ram_util_percent": 55.52545454545457}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.1516785379843912, "episode_reward_min": -4.110138733378581, "episode_reward_mean": -3.922083368147984, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8472388270428539, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.03591455808252009, "reward_component_totals/delta_v_mean": -2.0748445411051346, "reward_component_totals/delta_v_min": -2.1302531825502755, "reward_component_totals/delta_v_max": -2.0267832226057902, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4844541105128, "delta_v_total_min": 202.67832226057828, "delta_v_total_max": 213.02531825502618, "constraint_violation.max_vel_constraint.steps_mean": 1160.35, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5798850574712644, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.8463690025156234, -3.9783492566830168, -3.896251828104469, -3.8833757424323103, -3.1516785379843912, -4.071561215062609, -4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7806226195052812, "mean_inference_ms": 8.091156558075117, "mean_action_processing_ms": 0.4068271248192778, "mean_env_wait_ms": 9.872843562490623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1872780, "agent_timesteps_total": 1872780, "timers": {"sample_time_ms": 42216.994, "sample_throughput": 284.388, "load_time_ms": 6.773, "load_throughput": 1772528.083, "learn_time_ms": 37757.072, "learn_throughput": 317.98, "update_time_ms": 28.424}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004431547597050667, "policy_loss": 0.00010977733472827822, "vf_loss": 0.004321770742535591, "vf_explained_var": 0.2459704428911209, "kl": -3.1169262726393754e-09, "entropy": 2.748933792114258, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1872780, "num_agent_steps_sampled": 1872780, "num_steps_trained": 1872780, "num_agent_steps_trained": 1872780}, "done": false, "episodes_total": 936, "training_iteration": 156, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-48-52", "timestamp": 1690850932, "time_this_iter_s": 77.88242554664612, "time_total_s": 12692.0458278656, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12692.0458278656, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 99.98198198198199, "ram_util_percent": 55.481981981981946}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.745226723342334, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.932289034283272, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8549091559783768, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.6646120192499919, "reward_component_totals/delta_v_mean": -2.077379878304902, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.029859956055885, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.73798783048943, "delta_v_total_min": 202.98599560558753, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1174.35, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5868892692223173, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.03869078015128, -3.9127807242077175, -3.966921111770228, -4.00199533519852, -4.097339946815625, -3.9237308216246896, -4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7799405102993253, "mean_inference_ms": 8.089868241759467, "mean_action_processing_ms": 0.4067502139949296, "mean_env_wait_ms": 9.870321946307747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1884784, "agent_timesteps_total": 1884784, "timers": {"sample_time_ms": 42203.114, "sample_throughput": 284.477, "load_time_ms": 6.75, "load_throughput": 1778571.2, "learn_time_ms": 37670.326, "learn_throughput": 318.707, "update_time_ms": 28.319}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.008225658908486366, "policy_loss": -0.0004341615131124854, "vf_loss": 0.008659820072352886, "vf_explained_var": 0.3380145728588104, "kl": -3.4473957022385093e-09, "entropy": 2.56333065032959, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1884784, "num_agent_steps_sampled": 1884784, "num_steps_trained": 1884784, "num_agent_steps_trained": 1884784}, "done": false, "episodes_total": 942, "training_iteration": 157, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-50-11", "timestamp": 1690851011, "time_this_iter_s": 79.56090950965881, "time_total_s": 12771.60673737526, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12771.60673737526, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 99.98771929824561, "ram_util_percent": 55.449999999999996}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.745226723342334, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.925299858868655, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8474141107033091, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.6646120192499919, "reward_component_totals/delta_v_mean": -2.077885748165352, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.029859956055885, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.78857481653452, "delta_v_total_min": 202.98599560558753, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1191.28, "constraint_violation.max_vel_constraint.steps_min": 407, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5953500388375098, "constraint_violation.max_vel_constraint.ratio_min": 0.20339830084957522, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.012838503040783, -3.998953182525003, -3.879225594506676, -3.7983143864463624, -4.051692002334383, -3.8867835882099726, -3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7792760417501519, "mean_inference_ms": 8.088644807754916, "mean_action_processing_ms": 0.4066714020081927, "mean_env_wait_ms": 9.86771010446525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1896790, "agent_timesteps_total": 1896790, "timers": {"sample_time_ms": 42303.329, "sample_throughput": 283.803, "load_time_ms": 6.584, "load_throughput": 1823434.783, "learn_time_ms": 37693.262, "learn_throughput": 318.513, "update_time_ms": 27.832}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004614146891981363, "policy_loss": 0.0006444540922529995, "vf_loss": 0.003969691228121519, "vf_explained_var": 0.13319098949432373, "kl": -1.880170019674665e-09, "entropy": 2.7683377265930176, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1896790, "num_agent_steps_sampled": 1896790, "num_steps_trained": 1896790, "num_agent_steps_trained": 1896790}, "done": false, "episodes_total": 948, "training_iteration": 158, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-51-31", "timestamp": 1690851091, "time_this_iter_s": 78.87964367866516, "time_total_s": 12850.486381053925, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12850.486381053925, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 99.98318584070796, "ram_util_percent": 55.40442477876105}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.745226723342334, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.9261737417942313, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8462228834625145, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.6646120192499919, "reward_component_totals/delta_v_mean": -2.079950858331723, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.029859956055885, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.99508583317163, "delta_v_total_min": 202.98599560558753, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1177.09, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5882585845646462, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.921848211241494, -3.745226723342334, -3.9247202421373957, -3.899213002694064, -4.001391827015103, -3.948005991041221, -3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7786005814883268, "mean_inference_ms": 8.08761806601882, "mean_action_processing_ms": 0.4065950313734465, "mean_env_wait_ms": 9.865204358786919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1908796, "agent_timesteps_total": 1908796, "timers": {"sample_time_ms": 42561.888, "sample_throughput": 282.079, "load_time_ms": 6.58, "load_throughput": 1824557.954, "learn_time_ms": 37903.281, "learn_throughput": 316.748, "update_time_ms": 28.893}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005420353263616562, "policy_loss": 0.0006415975512936711, "vf_loss": 0.004778753966093063, "vf_explained_var": 0.32140690088272095, "kl": -4.065773939743167e-09, "entropy": 2.7363784313201904, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1908796, "num_agent_steps_sampled": 1908796, "num_steps_trained": 1908796, "num_agent_steps_trained": 1908796}, "done": false, "episodes_total": 954, "training_iteration": 159, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-52-53", "timestamp": 1690851173, "time_this_iter_s": 81.7890100479126, "time_total_s": 12932.275391101837, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12932.275391101837, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 99.9863247863248, "ram_util_percent": 55.42307692307691}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7422076793294012, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.9253769108856296, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8450409574677156, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.0803359534179204, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.019084029992424, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.03359534179128, "delta_v_total_min": 201.9084029992418, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1170.01, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5847203536800885, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9537790631278833, -3.943414679405053, -3.7800139952366156, -4.004523238625471, -3.972269857796735, -3.780588472240101, -3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7778883597271147, "mean_inference_ms": 8.086534202562426, "mean_action_processing_ms": 0.4065109031150113, "mean_env_wait_ms": 9.862551890594563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1920802, "agent_timesteps_total": 1920802, "timers": {"sample_time_ms": 42582.477, "sample_throughput": 281.942, "load_time_ms": 6.601, "load_throughput": 1818877.052, "learn_time_ms": 38104.164, "learn_throughput": 315.078, "update_time_ms": 30.996}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005080359987914562, "policy_loss": -0.0003733720222953707, "vf_loss": 0.005453730002045631, "vf_explained_var": 0.27158886194229126, "kl": -4.2910937025908424e-09, "entropy": 2.6999731063842773, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1920802, "num_agent_steps_sampled": 1920802, "num_steps_trained": 1920802, "num_agent_steps_trained": 1920802}, "done": false, "episodes_total": 960, "training_iteration": 160, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-54-12", "timestamp": 1690851252, "time_this_iter_s": 79.47376370429993, "time_total_s": 13011.749154806137, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13011.749154806137, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 99.97964601769911, "ram_util_percent": 55.50973451327434}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7422076793294012, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.92720835066976, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8473529877140351, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.0798553629557324, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.019084029992424, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9855362955725, "delta_v_total_min": 201.9084029992418, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1173.21, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5863195540798887, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.883753110070036, -3.8381727218723825, -3.974285425695068, -3.928348401492104, -4.016325616770826, -3.893605871879469, -3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7776702109613733, "mean_inference_ms": 8.085296752114042, "mean_action_processing_ms": 0.4064389170258944, "mean_env_wait_ms": 9.860067973421955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1932808, "agent_timesteps_total": 1932808, "timers": {"sample_time_ms": 42615.887, "sample_throughput": 281.721, "load_time_ms": 6.312, "load_throughput": 1901969.54, "learn_time_ms": 37804.031, "learn_throughput": 317.58, "update_time_ms": 28.267}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005580733064562082, "policy_loss": 9.873229282675311e-05, "vf_loss": 0.005481999833136797, "vf_explained_var": 0.28389859199523926, "kl": -1.8526309375488381e-09, "entropy": 2.7032742500305176, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1932808, "num_agent_steps_sampled": 1932808, "num_steps_trained": 1932808, "num_agent_steps_trained": 1932808}, "done": false, "episodes_total": 966, "training_iteration": 161, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-55-45", "timestamp": 1690851345, "time_this_iter_s": 92.78805780410767, "time_total_s": 13104.537212610245, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13104.537212610245, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 99.98560606060605, "ram_util_percent": 55.44393939393938}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7422076793294012, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.925249107389958, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8462028816722974, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.079046225717667, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.015979856004322, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90462257176597, "delta_v_total_min": 201.5979856004318, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1166.63, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5830311982577996, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.8550891657153867, -3.8026048553944123, -4.055765411965398, -3.8736233188204343, -3.8871915526398912, -4.066635644631926, -4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.777452529560894, "mean_inference_ms": 8.084130277935333, "mean_action_processing_ms": 0.4063575355846342, "mean_env_wait_ms": 9.857689532969607, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1944814, "agent_timesteps_total": 1944814, "timers": {"sample_time_ms": 42510.346, "sample_throughput": 282.421, "load_time_ms": 6.402, "load_throughput": 1875434.351, "learn_time_ms": 37453.797, "learn_throughput": 320.55, "update_time_ms": 27.89}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005228578578680754, "policy_loss": 0.0003886331105604768, "vf_loss": 0.004839946050196886, "vf_explained_var": 0.2315918356180191, "kl": -2.4159307887572368e-09, "entropy": 2.7158048152923584, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1944814, "num_agent_steps_sampled": 1944814, "num_steps_trained": 1944814, "num_agent_steps_trained": 1944814}, "done": false, "episodes_total": 972, "training_iteration": 162, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-57-04", "timestamp": 1690851424, "time_this_iter_s": 78.56113123893738, "time_total_s": 13183.098343849182, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13183.098343849182, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 99.98303571428572, "ram_util_percent": 55.43660714285714}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7422076793294012, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.9247559677409622, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8438937936959205, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.0808621740450493, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.015979856004322, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0862174045042, "delta_v_total_min": 201.5979856004318, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1143.18, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5713120578280146, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.00134084591579, -4.068281734091448, -3.9317410869194145, -3.905339681772867, -4.011217025348776, -3.75608482042953, -3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.777263665860994, "mean_inference_ms": 8.082944378855885, "mean_action_processing_ms": 0.4062695947467435, "mean_env_wait_ms": 9.855173268233072, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1956820, "agent_timesteps_total": 1956820, "timers": {"sample_time_ms": 42567.931, "sample_throughput": 282.039, "load_time_ms": 5.991, "load_throughput": 2003978.628, "learn_time_ms": 37409.961, "learn_throughput": 320.925, "update_time_ms": 28.761}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005181044805794954, "policy_loss": 0.0006887518684379756, "vf_loss": 0.004492292646318674, "vf_explained_var": 0.2716558575630188, "kl": -5.032146366268364e-10, "entropy": 2.7605319023132324, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1956820, "num_agent_steps_sampled": 1956820, "num_steps_trained": 1956820, "num_agent_steps_trained": 1956820}, "done": false, "episodes_total": 978, "training_iteration": 163, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-58-22", "timestamp": 1690851502, "time_this_iter_s": 77.3089771270752, "time_total_s": 13260.407320976257, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13260.407320976257, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 99.98545454545454, "ram_util_percent": 55.39818181818179}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7422076793294012, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.9281387924628155, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8469494456268084, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.081189346836014, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.015979856004322, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1189346836006, "delta_v_total_min": 201.5979856004318, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1156.29, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5778637819659455, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.9302295010154156, -3.796429578527663, -3.868194230426215, -3.9741268752326633, -3.879685229751817, -3.9753042030087773, -4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.777105431786395, "mean_inference_ms": 8.081836057799002, "mean_action_processing_ms": 0.406184051461275, "mean_env_wait_ms": 9.852768789730582, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1968826, "agent_timesteps_total": 1968826, "timers": {"sample_time_ms": 42641.82, "sample_throughput": 281.55, "load_time_ms": 6.084, "load_throughput": 1973498.104, "learn_time_ms": 37315.33, "learn_throughput": 321.739, "update_time_ms": 30.381}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0036669832188636065, "policy_loss": -0.0005115249659866095, "vf_loss": 0.004178508184850216, "vf_explained_var": 0.18984322249889374, "kl": -1.3594305681152719e-09, "entropy": 2.760408401489258, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1968826, "num_agent_steps_sampled": 1968826, "num_steps_trained": 1968826, "num_agent_steps_trained": 1968826}, "done": false, "episodes_total": 984, "training_iteration": 164, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_17-59-40", "timestamp": 1690851580, "time_this_iter_s": 78.04225182533264, "time_total_s": 13338.44957280159, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13338.44957280159, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.495535714285715}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7422076793294012, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.9294767949691813, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8484175297465363, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.0810592652226516, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.015979856004322, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.10592652226438, "delta_v_total_min": 201.5979856004318, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1143.22, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.571332047833012, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-4.047135929667932, -3.9683381853946074, -3.8619795361495335, -3.975001309401736, -3.879913244178904, -3.814438463735236, -3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7769913408175249, "mean_inference_ms": 8.0807389639524, "mean_action_processing_ms": 0.40611303912294827, "mean_env_wait_ms": 9.850626294623124, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1980832, "agent_timesteps_total": 1980832, "timers": {"sample_time_ms": 42711.654, "sample_throughput": 281.09, "load_time_ms": 6.008, "load_throughput": 1998324.343, "learn_time_ms": 37236.102, "learn_throughput": 322.424, "update_time_ms": 32.076}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0024529411457479, "policy_loss": -0.001099830842576921, "vf_loss": 0.0035527730360627174, "vf_explained_var": 0.10962660610675812, "kl": -6.283923936756253e-10, "entropy": 2.798377275466919, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1980832, "num_agent_steps_sampled": 1980832, "num_steps_trained": 1980832, "num_agent_steps_trained": 1980832}, "done": false, "episodes_total": 990, "training_iteration": 165, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-00-57", "timestamp": 1690851657, "time_this_iter_s": 76.85163593292236, "time_total_s": 13415.301208734512, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13415.301208734512, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 99.97818181818181, "ram_util_percent": 55.43181818181818}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7422076793294012, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.928569022204906, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8470329296454132, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.0815360925594995, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.015979856004322, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.15360925594928, "delta_v_total_min": 201.5979856004318, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1152.45, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1996, "constraint_violation.max_vel_constraint.ratio_mean": 0.5759447414861854, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9975012493753124}, "hist_stats": {"episode_reward": [-3.8958483408039233, -3.8514451458995884, -3.931202729362625, -3.9975850143763934, -4.078528936679051, -3.975384360052197, -3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7769326611981326, "mean_inference_ms": 8.079781158600564, "mean_action_processing_ms": 0.4060413851936387, "mean_env_wait_ms": 9.848609930207644, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1992838, "agent_timesteps_total": 1992838, "timers": {"sample_time_ms": 42670.701, "sample_throughput": 281.359, "load_time_ms": 5.851, "load_throughput": 2052037.53, "learn_time_ms": 37185.22, "learn_throughput": 322.865, "update_time_ms": 32.053}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006202149670571089, "policy_loss": 0.0003657808993011713, "vf_loss": 0.005836370401084423, "vf_explained_var": 0.30222371220588684, "kl": -7.310381744396466e-10, "entropy": 2.683166742324829, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1992838, "num_agent_steps_sampled": 1992838, "num_steps_trained": 1992838, "num_agent_steps_trained": 1992838}, "done": false, "episodes_total": 996, "training_iteration": 166, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-02-14", "timestamp": 1690851734, "time_this_iter_s": 76.94084692001343, "time_total_s": 13492.242055654526, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13492.242055654526, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 99.98545454545456, "ram_util_percent": 55.43272727272724}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7422076793294012, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.925423366044896, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8445479849556498, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.080875381089253, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.015979856004322, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.08753810892463, "delta_v_total_min": 201.5979856004318, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1137.99, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5687183546795886, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.8404659784601414, -4.0661837609491, -3.856415998788164, -4.009177707526052, -3.827590500583358, -3.8949424489890534, -3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7763296212657078, "mean_inference_ms": 8.079216316340004, "mean_action_processing_ms": 0.4059599078791152, "mean_env_wait_ms": 9.846544814157053, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2004844, "agent_timesteps_total": 2004844, "timers": {"sample_time_ms": 42704.699, "sample_throughput": 281.14, "load_time_ms": 5.975, "load_throughput": 2009361.673, "learn_time_ms": 36709.053, "learn_throughput": 327.058, "update_time_ms": 34.339}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004302317276597023, "policy_loss": -0.0013922315556555986, "vf_loss": 0.005694548133760691, "vf_explained_var": 0.2399086058139801, "kl": -2.2506962960022747e-09, "entropy": 2.7006497383117676, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2004844, "num_agent_steps_sampled": 2004844, "num_steps_trained": 2004844, "num_agent_steps_trained": 2004844}, "done": false, "episodes_total": 1002, "training_iteration": 167, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-03-29", "timestamp": 1690851809, "time_this_iter_s": 75.11193466186523, "time_total_s": 13567.353990316391, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13567.353990316391, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 99.9747663551402, "ram_util_percent": 55.445794392523354}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7422076793294012, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.926501515891582, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8457577390208191, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.08074377687077, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.015979856004322, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07437768707638, "delta_v_total_min": 201.5979856004318, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1145.23, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5723365455841364, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.7840244878104343, -3.818050480852592, -3.9817716604751023, -4.110138733378581, -3.885478640623406, -4.0709752964309525, -3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7757888252242953, "mean_inference_ms": 8.078746699319304, "mean_action_processing_ms": 0.40588548956248105, "mean_env_wait_ms": 9.844742372418004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2016850, "agent_timesteps_total": 2016850, "timers": {"sample_time_ms": 42865.669, "sample_throughput": 280.084, "load_time_ms": 5.836, "load_throughput": 2057151.826, "learn_time_ms": 36758.54, "learn_throughput": 326.618, "update_time_ms": 34.026}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004480656702071428, "policy_loss": 0.0002979611454065889, "vf_loss": 0.004182697273790836, "vf_explained_var": 0.19052185118198395, "kl": -2.4935411513382633e-09, "entropy": 2.7623343467712402, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2016850, "num_agent_steps_sampled": 2016850, "num_steps_trained": 2016850, "num_agent_steps_trained": 2016850}, "done": false, "episodes_total": 1008, "training_iteration": 168, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-04-50", "timestamp": 1690851890, "time_this_iter_s": 80.9681749343872, "time_total_s": 13648.322165250778, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13648.322165250778, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 99.98333333333335, "ram_util_percent": 55.457017543859635}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7422076793294012, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.9240388891212534, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8432947195457848, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.080744169575476, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.015979856004322, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07441695754684, "delta_v_total_min": 201.5979856004318, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1153.11, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5762745765686441, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.8425913310609716, -3.8019615922209526, -3.95704001464859, -3.9744394293841587, -4.086479241825359, -3.9645853937504905, -3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7752214175218444, "mean_inference_ms": 8.078117620731067, "mean_action_processing_ms": 0.4058108098907561, "mean_env_wait_ms": 9.842897918754907, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2028856, "agent_timesteps_total": 2028856, "timers": {"sample_time_ms": 42745.031, "sample_throughput": 280.875, "load_time_ms": 6.089, "load_throughput": 1971645.576, "learn_time_ms": 36689.844, "learn_throughput": 327.23, "update_time_ms": 33.651}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005331734661012888, "policy_loss": 0.00024322932586073875, "vf_loss": 0.005088505335152149, "vf_explained_var": 0.1124429777264595, "kl": -8.612230373294949e-10, "entropy": 2.72654390335083, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2028856, "num_agent_steps_sampled": 2028856, "num_steps_trained": 2028856, "num_agent_steps_trained": 2028856}, "done": false, "episodes_total": 1014, "training_iteration": 169, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-06-11", "timestamp": 1690851971, "time_this_iter_s": 79.88019871711731, "time_total_s": 13728.202363967896, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13728.202363967896, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 99.98608695652173, "ram_util_percent": 55.39913043478259}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.733817077483103, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.9197523712718807, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8396784979566295, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.0800738733152575, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00738733152505, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1167.77, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5836009134002285, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-3.9311474030687608, -3.8674595019363744, -3.7987835761355804, -3.8412265090887816, -4.050693090403344, -3.8420492840051814, -4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7746980183654415, "mean_inference_ms": 8.077597788205725, "mean_action_processing_ms": 0.4057398608671615, "mean_env_wait_ms": 9.841249613421326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2040862, "agent_timesteps_total": 2040862, "timers": {"sample_time_ms": 42803.438, "sample_throughput": 280.491, "load_time_ms": 6.259, "load_throughput": 1918091.76, "learn_time_ms": 36570.968, "learn_throughput": 328.293, "update_time_ms": 33.274}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005570680368691683, "policy_loss": 0.0009634371381253004, "vf_loss": 0.004607243463397026, "vf_explained_var": 0.19954200088977814, "kl": -2.2431856372406855e-09, "entropy": 2.734806776046753, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2040862, "num_agent_steps_sampled": 2040862, "num_steps_trained": 2040862, "num_agent_steps_trained": 2040862}, "done": false, "episodes_total": 1020, "training_iteration": 170, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-07-30", "timestamp": 1690852050, "time_this_iter_s": 78.80903339385986, "time_total_s": 13807.011397361755, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13807.011397361755, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 99.9857142857143, "ram_util_percent": 55.3955357142857}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.733817077483103, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.9208618940404505, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8395584306167067, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.081303463423752, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.13034634237442, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1166.59, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5830112082528021, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-4.015530273931235, -4.028288231531001, -3.8096966336092706, -3.8566230621372415, -3.8353167333686127, -3.830958215439499, -4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7746907310653675, "mean_inference_ms": 8.076991973254826, "mean_action_processing_ms": 0.40568206104666493, "mean_env_wait_ms": 9.839820882544018, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2052868, "agent_timesteps_total": 2052868, "timers": {"sample_time_ms": 43008.139, "sample_throughput": 279.156, "load_time_ms": 6.362, "load_throughput": 1887083.149, "learn_time_ms": 36649.305, "learn_throughput": 327.591, "update_time_ms": 35.931}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004647828172892332, "policy_loss": -0.00011230092059122398, "vf_loss": 0.004760130308568478, "vf_explained_var": 0.27901342511177063, "kl": -1.5897576588486118e-09, "entropy": 2.7277255058288574, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2052868, "num_agent_steps_sampled": 2052868, "num_steps_trained": 2052868, "num_agent_steps_trained": 2052868}, "done": false, "episodes_total": 1026, "training_iteration": 171, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-09-06", "timestamp": 1690852146, "time_this_iter_s": 95.73957061767578, "time_total_s": 13902.750967979431, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13902.750967979431, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 99.98175182481752, "ram_util_percent": 55.479562043795625}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.733817077483103, "episode_reward_min": -4.114484184006767, "episode_reward_mean": -3.922824231841702, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8412069614594607, "reward_component_totals/dist_change_reward_min": -0.9987213127724818, "reward_component_totals/dist_change_reward_max": -0.7075956421448779, "reward_component_totals/delta_v_mean": -2.0816172703822486, "reward_component_totals/delta_v_min": -2.17208595092098, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.16172703822417, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 217.20859509209703, "constraint_violation.max_vel_constraint.steps_mean": 1133.16, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1946, "constraint_violation.max_vel_constraint.ratio_mean": 0.5663045615761404, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9725137431284357}, "hist_stats": {"episode_reward": [-4.030957512668792, -4.023910751781183, -4.05341360970462, -3.8979457596247893, -3.9675088664114, -4.114484184006767, -4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7747466161103875, "mean_inference_ms": 8.07646162499238, "mean_action_processing_ms": 0.4056351150808949, "mean_env_wait_ms": 9.838678689497158, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2064874, "agent_timesteps_total": 2064874, "timers": {"sample_time_ms": 42980.195, "sample_throughput": 279.338, "load_time_ms": 6.34, "load_throughput": 1893632.983, "learn_time_ms": 36644.054, "learn_throughput": 327.638, "update_time_ms": 36.18}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003860639641061425, "policy_loss": -0.0007173559861257672, "vf_loss": 0.004577993415296078, "vf_explained_var": 0.25230374932289124, "kl": -3.166997553094575e-09, "entropy": 2.736311674118042, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2064874, "num_agent_steps_sampled": 2064874, "num_steps_trained": 2064874, "num_agent_steps_trained": 2064874}, "done": false, "episodes_total": 1032, "training_iteration": 172, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-10-24", "timestamp": 1690852224, "time_this_iter_s": 78.24521374702454, "time_total_s": 13980.996181726456, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13980.996181726456, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 99.97857142857143, "ram_util_percent": 55.39910714285713}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.08944857405055, "episode_reward_mean": -3.9127678299782485, "episode_len_mean": 2000.98, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8322220101210324, "reward_component_totals/dist_change_reward_min": -0.9963727932628189, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.080545819857223, "reward_component_totals/delta_v_min": -2.1571023815870296, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05458198572157, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 215.71023815870214, "constraint_violation.max_vel_constraint.steps_mean": 1103.55, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1943, "constraint_violation.max_vel_constraint.ratio_mean": 0.5515069603767401, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9710144927536232}, "hist_stats": {"episode_reward": [-4.08944857405055, -3.968491827457684, -3.853581546821937, -3.8546371975630436, -3.800073662385741, -3.779927651027172, -3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401], "episode_lengths": [2001, 2001, 1999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7748249626745258, "mean_inference_ms": 8.07596182026684, "mean_action_processing_ms": 0.4055888664623518, "mean_env_wait_ms": 9.837672020258141, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2076880, "agent_timesteps_total": 2076880, "timers": {"sample_time_ms": 43162.791, "sample_throughput": 278.156, "load_time_ms": 6.563, "load_throughput": 1829453.811, "learn_time_ms": 36418.63, "learn_throughput": 329.666, "update_time_ms": 34.747}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004850306082516909, "policy_loss": 0.0010458150645717978, "vf_loss": 0.0038044892717152834, "vf_explained_var": 0.16285789012908936, "kl": -3.229586320596667e-10, "entropy": 2.779696226119995, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2076880, "num_agent_steps_sampled": 2076880, "num_steps_trained": 2076880, "num_agent_steps_trained": 2076880}, "done": false, "episodes_total": 1038, "training_iteration": 173, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-11-41", "timestamp": 1690852301, "time_this_iter_s": 76.89319467544556, "time_total_s": 14057.889376401901, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14057.889376401901, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 99.97636363636363, "ram_util_percent": 55.45181818181818}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.0880464855786345, "episode_reward_mean": -3.9148824086920597, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8351595392342622, "reward_component_totals/dist_change_reward_min": -0.9963727932628189, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.0797228694578043, "reward_component_totals/delta_v_min": -2.1571023815870296, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9722869457797, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 215.71023815870214, "constraint_violation.max_vel_constraint.steps_mean": 1091.11, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5452823588205897, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9272356176976957, -3.8275873792062236, -4.087761630836274, -3.8199552371532004, -4.0479535913494, -4.0155204440852135, -3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.774934706946552, "mean_inference_ms": 8.075734162555454, "mean_action_processing_ms": 0.40554927525550744, "mean_env_wait_ms": 9.836893875261445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2088886, "agent_timesteps_total": 2088886, "timers": {"sample_time_ms": 43461.906, "sample_throughput": 276.242, "load_time_ms": 6.287, "load_throughput": 1909668.549, "learn_time_ms": 36288.768, "learn_throughput": 330.846, "update_time_ms": 33.637}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005923350807279348, "policy_loss": 0.001015200512483716, "vf_loss": 0.004908150527626276, "vf_explained_var": 0.20829042792320251, "kl": -4.195958691610713e-09, "entropy": 2.7320027351379395, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2088886, "num_agent_steps_sampled": 2088886, "num_steps_trained": 2088886, "num_agent_steps_trained": 2088886}, "done": false, "episodes_total": 1044, "training_iteration": 174, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-13-01", "timestamp": 1690852381, "time_this_iter_s": 79.7226243019104, "time_total_s": 14137.612000703812, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14137.612000703812, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 99.97807017543862, "ram_util_percent": 55.41052631578946}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.0880464855786345, "episode_reward_mean": -3.912948548714169, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8349295104258775, "reward_component_totals/dist_change_reward_min": -0.9963727932628189, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.078019038288298, "reward_component_totals/delta_v_min": -2.1571023815870296, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.80190382882915, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 215.71023815870214, "constraint_violation.max_vel_constraint.steps_mean": 1076.41, "constraint_violation.max_vel_constraint.steps_min": 284, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5379360319840081, "constraint_violation.max_vel_constraint.ratio_min": 0.14192903548225888, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.8565024670680477, -3.97815722470623, -3.9684404081096694, -3.848621414302255, -3.911914907681596, -3.9973314643261197, -3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.775082649298289, "mean_inference_ms": 8.075509275083697, "mean_action_processing_ms": 0.4055180925856635, "mean_env_wait_ms": 9.836403102291191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2100892, "agent_timesteps_total": 2100892, "timers": {"sample_time_ms": 43718.792, "sample_throughput": 274.619, "load_time_ms": 6.227, "load_throughput": 1928138.739, "learn_time_ms": 36334.231, "learn_throughput": 330.432, "update_time_ms": 31.65}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0035666213370859623, "policy_loss": -0.00027529284125193954, "vf_loss": 0.0038419144693762064, "vf_explained_var": 0.06432724744081497, "kl": -9.36329680456538e-10, "entropy": 2.7925825119018555, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2100892, "num_agent_steps_sampled": 2100892, "num_steps_trained": 2100892, "num_agent_steps_trained": 2100892}, "done": false, "episodes_total": 1050, "training_iteration": 175, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-14-21", "timestamp": 1690852461, "time_this_iter_s": 79.86725687980652, "time_total_s": 14217.479257583618, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14217.479257583618, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 99.98070175438598, "ram_util_percent": 55.41315789473683}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.0880464855786345, "episode_reward_mean": -3.912107744138437, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8363958461393923, "reward_component_totals/dist_change_reward_min": -0.9963727932628189, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.075711897999052, "reward_component_totals/delta_v_min": -2.1366405177116397, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.57118979990437, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 213.66405177116272, "constraint_violation.max_vel_constraint.steps_mean": 1085.24, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5423488255872063, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9654701016533114, -3.7422076793294012, -3.8364135232894263, -3.9073852303315446, -4.021941976454627, -4.040369145471795, -3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7753013165650418, "mean_inference_ms": 8.075291711667727, "mean_action_processing_ms": 0.40549466057759587, "mean_env_wait_ms": 9.83623647603003, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2112898, "agent_timesteps_total": 2112898, "timers": {"sample_time_ms": 43975.992, "sample_throughput": 273.013, "load_time_ms": 6.38, "load_throughput": 1881681.731, "learn_time_ms": 36374.116, "learn_throughput": 330.07, "update_time_ms": 32.697}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004566958639770746, "policy_loss": -0.0006136221345514059, "vf_loss": 0.0051805805414915085, "vf_explained_var": 0.2862965166568756, "kl": -2.037894075712643e-09, "entropy": 2.7130556106567383, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2112898, "num_agent_steps_sampled": 2112898, "num_steps_trained": 2112898, "num_agent_steps_trained": 2112898}, "done": false, "episodes_total": 1056, "training_iteration": 176, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-15-42", "timestamp": 1690852542, "time_this_iter_s": 80.00159239768982, "time_total_s": 14297.480849981308, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14297.480849981308, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 99.98230088495576, "ram_util_percent": 55.44424778761061}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.0880464855786345, "episode_reward_mean": -3.9091562733449594, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.831222452533056, "reward_component_totals/dist_change_reward_min": -0.9963727932628189, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.077933820811911, "reward_component_totals/delta_v_min": -2.1366405177116397, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.79338208119032, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 213.66405177116272, "constraint_violation.max_vel_constraint.steps_mean": 1111.81, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5556271864067966, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.8266851863357543, -3.9657855168030087, -3.909140974421932, -3.853810485357898, -3.9165282433017867, -3.989885792973964, -3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7750728054332827, "mean_inference_ms": 8.075214399921414, "mean_action_processing_ms": 0.4054763904432036, "mean_env_wait_ms": 9.8362233481697, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2124904, "agent_timesteps_total": 2124904, "timers": {"sample_time_ms": 43964.734, "sample_throughput": 273.083, "load_time_ms": 6.426, "load_throughput": 1868367.962, "learn_time_ms": 36600.13, "learn_throughput": 328.032, "update_time_ms": 30.322}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005743840243667364, "policy_loss": 0.0010900767520070076, "vf_loss": 0.004653763025999069, "vf_explained_var": 0.15193220973014832, "kl": -2.61371169152369e-09, "entropy": 2.751007556915283, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2124904, "num_agent_steps_sampled": 2124904, "num_steps_trained": 2124904, "num_agent_steps_trained": 2124904}, "done": false, "episodes_total": 1062, "training_iteration": 177, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-16-59", "timestamp": 1690852619, "time_this_iter_s": 77.2985029220581, "time_total_s": 14374.779352903366, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14374.779352903366, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 99.98018018018017, "ram_util_percent": 55.452252252252244}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.0880464855786345, "episode_reward_mean": -3.908158650264348, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8292967279515743, "reward_component_totals/dist_change_reward_min": -0.9963727932628189, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.0788619223127793, "reward_component_totals/delta_v_min": -2.1421428655087964, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.88619223127725, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 214.21428655087882, "constraint_violation.max_vel_constraint.steps_mean": 1115.54, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5574912543728135, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.956651103431838, -3.8156928945496444, -3.7976317342146824, -3.862177051327645, -4.007946708673295, -4.074973731361092, -3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.774879423394974, "mean_inference_ms": 8.075112116108647, "mean_action_processing_ms": 0.4054617189706927, "mean_env_wait_ms": 9.836356830478246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2136910, "agent_timesteps_total": 2136910, "timers": {"sample_time_ms": 43974.332, "sample_throughput": 273.023, "load_time_ms": 6.344, "load_throughput": 1892622.358, "learn_time_ms": 36249.683, "learn_throughput": 331.203, "update_time_ms": 30.122}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004466014448553324, "policy_loss": 0.0001208070752909407, "vf_loss": 0.004345206543803215, "vf_explained_var": 0.25791069865226746, "kl": -1.5747363413254334e-09, "entropy": 2.7471113204956055, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2136910, "num_agent_steps_sampled": 2136910, "num_steps_trained": 2136910, "num_agent_steps_trained": 2136910}, "done": false, "episodes_total": 1068, "training_iteration": 178, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-18-17", "timestamp": 1690852697, "time_this_iter_s": 77.50771117210388, "time_total_s": 14452.28706407547, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14452.28706407547, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 99.98738738738739, "ram_util_percent": 55.40450450450448}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.0880464855786345, "episode_reward_mean": -3.9027842960025168, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8248721449156933, "reward_component_totals/dist_change_reward_min": -0.9963727932628189, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.0779121510868297, "reward_component_totals/delta_v_min": -2.1421428655087964, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7912151086823, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 214.21428655087882, "constraint_violation.max_vel_constraint.steps_mean": 1127.95, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5636931534232884, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9167561035738796, -3.89225559485352, -3.7902476940415237, -3.8094161517646628, -4.081468742782974, -4.0880464855786345, -4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7746863598160698, "mean_inference_ms": 8.075031249403468, "mean_action_processing_ms": 0.40545507396827335, "mean_env_wait_ms": 9.836662573455305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2148916, "agent_timesteps_total": 2148916, "timers": {"sample_time_ms": 44174.206, "sample_throughput": 271.788, "load_time_ms": 5.95, "load_throughput": 2017710.732, "learn_time_ms": 36171.267, "learn_throughput": 331.921, "update_time_ms": 31.83}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005165689624845982, "policy_loss": 0.0008216540445573628, "vf_loss": 0.004344036336988211, "vf_explained_var": 0.15456536412239075, "kl": -1.0214505907768512e-09, "entropy": 2.77458119392395, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2148916, "num_agent_steps_sampled": 2148916, "num_steps_trained": 2148916, "num_agent_steps_trained": 2148916}, "done": false, "episodes_total": 1074, "training_iteration": 179, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-19-38", "timestamp": 1690852778, "time_this_iter_s": 81.01972484588623, "time_total_s": 14533.306788921356, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14533.306788921356, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 99.97652173913043, "ram_util_percent": 55.46173913043477}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.0829652820175255, "episode_reward_mean": -3.904336436948681, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8258835284387149, "reward_component_totals/dist_change_reward_min": -0.9884808746197453, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.078452908509973, "reward_component_totals/delta_v_min": -2.1425738146901128, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8452908509966, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 214.25738146901048, "constraint_violation.max_vel_constraint.steps_mean": 1129.45, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5644427786106945, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.002482967046748, -3.816806517727868, -4.023449384903971, -4.000033568622882, -3.9029001216815775, -3.827870957756265, -4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7744988991600648, "mean_inference_ms": 8.074910198189501, "mean_action_processing_ms": 0.4054539259654763, "mean_env_wait_ms": 9.83701580938108, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2160922, "agent_timesteps_total": 2160922, "timers": {"sample_time_ms": 44227.638, "sample_throughput": 271.459, "load_time_ms": 6.024, "load_throughput": 1993168.881, "learn_time_ms": 36114.109, "learn_throughput": 332.446, "update_time_ms": 33.337}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.00608548941090703, "policy_loss": 0.0006204280070960522, "vf_loss": 0.005465061869472265, "vf_explained_var": 0.27405524253845215, "kl": -1.802559768115941e-09, "entropy": 2.7130422592163086, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2160922, "num_agent_steps_sampled": 2160922, "num_steps_trained": 2160922, "num_agent_steps_trained": 2160922}, "done": false, "episodes_total": 1080, "training_iteration": 180, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-20-57", "timestamp": 1690852857, "time_this_iter_s": 78.8585913181305, "time_total_s": 14612.165380239487, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14612.165380239487, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 99.98053097345134, "ram_util_percent": 55.48318584070797}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.0829652820175255, "episode_reward_mean": -3.903588493032766, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8244167770564704, "reward_component_totals/dist_change_reward_min": -0.9884808746197453, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.079171715976301, "reward_component_totals/delta_v_min": -2.1425738146901128, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.91717159762942, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 214.25738146901048, "constraint_violation.max_vel_constraint.steps_mean": 1124.96, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5621989005497252, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.015428755432551, -4.00252491288727, -3.957366386419052, -3.851678734422443, -3.817380296633351, -3.886564574745255, -4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.774783416070825, "mean_inference_ms": 8.074941106090188, "mean_action_processing_ms": 0.4054635372489363, "mean_env_wait_ms": 9.83759987098035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2172928, "agent_timesteps_total": 2172928, "timers": {"sample_time_ms": 44421.656, "sample_throughput": 270.274, "load_time_ms": 6.023, "load_throughput": 1993200.438, "learn_time_ms": 35957.626, "learn_throughput": 333.893, "update_time_ms": 31.676}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0036008034367114305, "policy_loss": -3.7993155274307355e-05, "vf_loss": 0.003638798836618662, "vf_explained_var": 0.11713194102048874, "kl": -6.283923936756253e-10, "entropy": 2.8003921508789062, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2172928, "num_agent_steps_sampled": 2172928, "num_steps_trained": 2172928, "num_agent_steps_trained": 2172928}, "done": false, "episodes_total": 1086, "training_iteration": 181, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-22-34", "timestamp": 1690852954, "time_this_iter_s": 96.08442831039429, "time_total_s": 14708.249808549881, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14708.249808549881, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 99.9861313868613, "ram_util_percent": 55.453284671532835}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9034403578153274, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8233827082322093, "reward_component_totals/dist_change_reward_min": -0.9929432591465518, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.0800576495831247, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00576495831172, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1133.56, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5664967516241879, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.028616448554267, -4.048590938028696, -3.7743062720975376, -3.9005708620412967, -4.0829652820175255, -4.0173569904791515, -3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.775094843906144, "mean_inference_ms": 8.075084233053367, "mean_action_processing_ms": 0.4054791751803822, "mean_env_wait_ms": 9.838310173854433, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2184934, "agent_timesteps_total": 2184934, "timers": {"sample_time_ms": 44611.509, "sample_throughput": 269.123, "load_time_ms": 5.829, "load_throughput": 2059532.847, "learn_time_ms": 35936.85, "learn_throughput": 334.086, "update_time_ms": 31.197}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005180101841688156, "policy_loss": 0.0006148573593236506, "vf_loss": 0.0045652431435883045, "vf_explained_var": 0.16114367544651031, "kl": -3.652687263766552e-09, "entropy": 2.7627363204956055, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2184934, "num_agent_steps_sampled": 2184934, "num_steps_trained": 2184934, "num_agent_steps_trained": 2184934}, "done": false, "episodes_total": 1092, "training_iteration": 182, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-23-54", "timestamp": 1690853034, "time_this_iter_s": 79.9116325378418, "time_total_s": 14788.161441087723, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14788.161441087723, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 99.98521739130435, "ram_util_percent": 55.46260869565217}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9023478674772316, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8230234728175371, "reward_component_totals/dist_change_reward_min": -0.9929432591465518, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.0793243946597015, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93243946596937, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1131.37, "constraint_violation.max_vel_constraint.steps_min": 390, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5654022988505747, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.8270769532015487, -3.921236389509689, -3.7961139526898693, -3.770679343274989, -3.8189637752921595, -4.048217881931453, -3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7753867986551406, "mean_inference_ms": 8.075181825145672, "mean_action_processing_ms": 0.4055072592350967, "mean_env_wait_ms": 9.839208274526623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2196940, "agent_timesteps_total": 2196940, "timers": {"sample_time_ms": 44699.209, "sample_throughput": 268.595, "load_time_ms": 5.542, "load_throughput": 2166275.793, "learn_time_ms": 36287.884, "learn_throughput": 330.854, "update_time_ms": 32.097}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.006171907763928175, "policy_loss": 0.0008712132112123072, "vf_loss": 0.0053006974048912525, "vf_explained_var": 0.2737809121608734, "kl": -8.487052727268463e-10, "entropy": 2.7172060012817383, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2196940, "num_agent_steps_sampled": 2196940, "num_steps_trained": 2196940, "num_agent_steps_trained": 2196940}, "done": false, "episodes_total": 1098, "training_iteration": 183, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-25-15", "timestamp": 1690853115, "time_this_iter_s": 81.33649921417236, "time_total_s": 14869.497940301895, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14869.497940301895, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 99.98608695652173, "ram_util_percent": 55.470434782608706}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9070502365518074, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8275878723952662, "reward_component_totals/dist_change_reward_min": -0.9929432591465518, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.079462364156548, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.94623641565406, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1134.52, "constraint_violation.max_vel_constraint.steps_min": 350, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.566976511744128, "constraint_violation.max_vel_constraint.ratio_min": 0.17491254372813594, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.892891434545966, -4.0210849948475476, -3.8489060886075848, -3.9725272047397877, -3.910989170783256, -3.7844020180823126, -3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7757015111784675, "mean_inference_ms": 8.075169919230934, "mean_action_processing_ms": 0.4055305034732414, "mean_env_wait_ms": 9.84004798539729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2208946, "agent_timesteps_total": 2208946, "timers": {"sample_time_ms": 44428.292, "sample_throughput": 270.233, "load_time_ms": 6.495, "load_throughput": 1848621.296, "learn_time_ms": 36231.066, "learn_throughput": 331.373, "update_time_ms": 32.092}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.003170737763866782, "policy_loss": -0.0011268866946920753, "vf_loss": 0.0042976257391273975, "vf_explained_var": 0.20891332626342773, "kl": -1.2693025519538992e-09, "entropy": 2.7522003650665283, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2208946, "num_agent_steps_sampled": 2208946, "num_steps_trained": 2208946, "num_agent_steps_trained": 2208946}, "done": false, "episodes_total": 1104, "training_iteration": 184, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-26-32", "timestamp": 1690853192, "time_this_iter_s": 76.46411800384521, "time_total_s": 14945.96205830574, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14945.96205830574, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 99.98165137614679, "ram_util_percent": 55.477064220183465}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.908177315038092, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8281032445109389, "reward_component_totals/dist_change_reward_min": -0.9929432591465518, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.0800740705271594, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00740705271525, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1124.19, "constraint_violation.max_vel_constraint.steps_min": 312, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5618140929535231, "constraint_violation.max_vel_constraint.ratio_min": 0.15592203898050974, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.8946525611731238, -3.9406526913647344, -3.986835713584937, -3.8866444675498633, -3.945563194239809, -3.838441436684803, -4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.776052758906636, "mean_inference_ms": 8.075202002201786, "mean_action_processing_ms": 0.4055584651030067, "mean_env_wait_ms": 9.84105992186854, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2220952, "agent_timesteps_total": 2220952, "timers": {"sample_time_ms": 44350.619, "sample_throughput": 270.706, "load_time_ms": 7.035, "load_throughput": 1706536.279, "learn_time_ms": 36105.026, "learn_throughput": 332.53, "update_time_ms": 35.798}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005509618669748306, "policy_loss": 0.0006989098037593067, "vf_loss": 0.004810706712305546, "vf_explained_var": 0.25429567694664, "kl": -5.177352324636786e-09, "entropy": 2.730752944946289, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2220952, "num_agent_steps_sampled": 2220952, "num_steps_trained": 2220952, "num_agent_steps_trained": 2220952}, "done": false, "episodes_total": 1110, "training_iteration": 185, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-27-50", "timestamp": 1690853270, "time_this_iter_s": 77.85758447647095, "time_total_s": 15023.819642782211, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15023.819642782211, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 99.97946428571429, "ram_util_percent": 55.45624999999999}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9057437676809603, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8258751906114239, "reward_component_totals/dist_change_reward_min": -0.9929432591465518, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.0798685770695444, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.014443927158913, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9868577069537, "delta_v_total_min": 201.44439271589096, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1104.73, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5520889555222389, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-4.023676727426849, -3.813615461771691, -3.84333132034695, -3.733817077483103, -3.866753368860043, -4.00105132454574, -3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7764228266675246, "mean_inference_ms": 8.075279937049226, "mean_action_processing_ms": 0.4056003118396038, "mean_env_wait_ms": 9.842253572498779, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2232958, "agent_timesteps_total": 2232958, "timers": {"sample_time_ms": 44158.073, "sample_throughput": 271.887, "load_time_ms": 6.897, "load_throughput": 1740866.057, "learn_time_ms": 35960.51, "learn_throughput": 333.866, "update_time_ms": 34.005}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004814870189875364, "policy_loss": -0.00033020813134498894, "vf_loss": 0.005145078059285879, "vf_explained_var": 0.2626008987426758, "kl": -2.3458313069824044e-09, "entropy": 2.723909854888916, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2232958, "num_agent_steps_sampled": 2232958, "num_steps_trained": 2232958, "num_agent_steps_trained": 2232958}, "done": false, "episodes_total": 1116, "training_iteration": 186, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-29-07", "timestamp": 1690853347, "time_this_iter_s": 76.50190830230713, "time_total_s": 15100.321551084518, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15100.321551084518, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 99.9788990825688, "ram_util_percent": 55.417431192660544}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.907006524698225, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8274998286900836, "reward_component_totals/dist_change_reward_min": -0.9929432591465518, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.079506696008149, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.025699925373003, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.95066960081422, "delta_v_total_min": 202.56999253729984, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1076.31, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1941, "constraint_violation.max_vel_constraint.ratio_mean": 0.5378860569715141, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9700149925037481}, "hist_stats": {"episode_reward": [-3.9192837141732424, -3.8718594012771623, -3.895590650473012, -3.887773182165885, -3.892489221937384, -4.028147743901019, -3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.776322729421721, "mean_inference_ms": 8.075390509974655, "mean_action_processing_ms": 0.4056358274821087, "mean_env_wait_ms": 9.843404814457358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2244964, "agent_timesteps_total": 2244964, "timers": {"sample_time_ms": 44018.84, "sample_throughput": 272.747, "load_time_ms": 6.477, "load_throughput": 1853691.008, "learn_time_ms": 35836.893, "learn_throughput": 335.018, "update_time_ms": 33.546}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004295630380511284, "policy_loss": -0.00046494603157043457, "vf_loss": 0.0047605750150978565, "vf_explained_var": 0.2209053486585617, "kl": -3.0768694259108997e-09, "entropy": 2.7326626777648926, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2244964, "num_agent_steps_sampled": 2244964, "num_steps_trained": 2244964, "num_agent_steps_trained": 2244964}, "done": false, "episodes_total": 1122, "training_iteration": 187, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-30-22", "timestamp": 1690853422, "time_this_iter_s": 74.61680483818054, "time_total_s": 15174.938355922699, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15174.938355922699, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 99.98130841121495, "ram_util_percent": 55.48971962616824}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.905237120491542, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8260901450005992, "reward_component_totals/dist_change_reward_min": -0.9929432591465518, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.0791469754909513, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.025699925373003, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.91469754909443, "delta_v_total_min": 202.56999253729984, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1102.16, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5508045977011494, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.8279753725668684, -3.997280594627372, -3.9445139257490633, -3.88224007136023, -3.800515443556052, -3.9376530041640745, -3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7762483857417366, "mean_inference_ms": 8.075557395828259, "mean_action_processing_ms": 0.40567571875159186, "mean_env_wait_ms": 9.844627907365386, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2256970, "agent_timesteps_total": 2256970, "timers": {"sample_time_ms": 44025.75, "sample_throughput": 272.704, "load_time_ms": 6.756, "load_throughput": 1777169.683, "learn_time_ms": 35768.808, "learn_throughput": 335.656, "update_time_ms": 33.126}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0035143340937793255, "policy_loss": -0.0005410707672126591, "vf_loss": 0.004055402707308531, "vf_explained_var": 0.1879330575466156, "kl": -3.9806530294228537e-10, "entropy": 2.7569713592529297, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2256970, "num_agent_steps_sampled": 2256970, "num_steps_trained": 2256970, "num_agent_steps_trained": 2256970}, "done": false, "episodes_total": 1128, "training_iteration": 188, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-31-39", "timestamp": 1690853499, "time_this_iter_s": 76.9239068031311, "time_total_s": 15251.86226272583, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15251.86226272583, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 99.97636363636363, "ram_util_percent": 55.54}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.603675791001484, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9060222634565878, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8266116389500187, "reward_component_totals/dist_change_reward_min": -0.9932254113544218, "reward_component_totals/dist_change_reward_max": -0.5239520598711281, "reward_component_totals/delta_v_mean": -2.079410624506577, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9410624506569, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1130.38, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5649075462268865, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.8137770920907985, -3.8702254844213773, -3.603675791001484, -4.056733682618401, -3.930473992803757, -3.8342810025211547, -4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.776129839971772, "mean_inference_ms": 8.07593796951512, "mean_action_processing_ms": 0.40571335942317915, "mean_env_wait_ms": 9.845764528762937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2268976, "agent_timesteps_total": 2268976, "timers": {"sample_time_ms": 44043.033, "sample_throughput": 272.597, "load_time_ms": 6.613, "load_throughput": 1815431.925, "learn_time_ms": 35561.79, "learn_throughput": 337.61, "update_time_ms": 33.643}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0043886280618608, "policy_loss": -0.0001975338818738237, "vf_loss": 0.004586161579936743, "vf_explained_var": 0.14876383543014526, "kl": -4.2986045833970365e-09, "entropy": 2.7471041679382324, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2268976, "num_agent_steps_sampled": 2268976, "num_steps_trained": 2268976, "num_agent_steps_trained": 2268976}, "done": false, "episodes_total": 1134, "training_iteration": 189, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-32-58", "timestamp": 1690853578, "time_this_iter_s": 79.16542363166809, "time_total_s": 15331.027686357498, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15331.027686357498, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 99.98053097345134, "ram_util_percent": 55.54690265486727}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7082447207777927, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9078136890438873, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8287816089230495, "reward_component_totals/dist_change_reward_min": -0.9932254113544218, "reward_component_totals/dist_change_reward_max": -0.6186277564673754, "reward_component_totals/delta_v_mean": -2.0790320801208453, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90320801208378, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1125.37, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5624037981009495, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-4.062962725631258, -3.8493384068501437, -4.0369372041037215, -3.8436249987772366, -4.061974872316213, -4.026560792310746, -3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916, -3.753782278173643, -3.789405258176907, -3.9417078766532283, -3.8228473265121057, -3.9514533854472043, -4.029113479223847], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7759966495150852, "mean_inference_ms": 8.076345791982519, "mean_action_processing_ms": 0.40574907165632945, "mean_env_wait_ms": 9.846869485451384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2280982, "agent_timesteps_total": 2280982, "timers": {"sample_time_ms": 44158.924, "sample_throughput": 271.882, "load_time_ms": 6.317, "load_throughput": 1900529.654, "learn_time_ms": 35355.046, "learn_throughput": 339.584, "update_time_ms": 30.519}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0056018042378127575, "policy_loss": 0.0007994548068381846, "vf_loss": 0.004802349954843521, "vf_explained_var": 0.255585640668869, "kl": -2.8540531049614515e-10, "entropy": 2.73030948638916, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2280982, "num_agent_steps_sampled": 2280982, "num_steps_trained": 2280982, "num_agent_steps_trained": 2280982}, "done": false, "episodes_total": 1140, "training_iteration": 190, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-34-16", "timestamp": 1690853656, "time_this_iter_s": 77.91338181495667, "time_total_s": 15408.941068172455, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15408.941068172455, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 99.97837837837838, "ram_util_percent": 55.52432432432435}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7082447207777927, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.90435957858749, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8252946176989693, "reward_component_totals/dist_change_reward_min": -0.9932254113544218, "reward_component_totals/dist_change_reward_max": -0.6186277564673754, "reward_component_totals/delta_v_mean": -2.0790649608885277, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90649608885212, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1132.58, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5660069965017491, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.8399005569972564, -3.8277696984014873, -3.8950016335059594, -3.881420349007292, -3.967349031131285, -4.002718464184605, -3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916, -3.753782278173643, -3.789405258176907, -3.9417078766532283, -3.8228473265121057, -3.9514533854472043, -4.029113479223847, -4.027688876949378, -3.925204723956151, -3.8351076589731954, -3.857497358307369, -3.9967021571170633, -3.8937871790464706], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7763808534278893, "mean_inference_ms": 8.076526627540023, "mean_action_processing_ms": 0.40578719742011465, "mean_env_wait_ms": 9.847997646342238, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2292988, "agent_timesteps_total": 2292988, "timers": {"sample_time_ms": 44252.543, "sample_throughput": 271.306, "load_time_ms": 6.093, "load_throughput": 1970534.568, "learn_time_ms": 35144.446, "learn_throughput": 341.619, "update_time_ms": 29.466}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.0052733649499714375, "policy_loss": -4.452923576536705e-07, "vf_loss": 0.005273810122162104, "vf_explained_var": 0.2185547947883606, "kl": -2.671293408695874e-09, "entropy": 2.7098617553710938, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2292988, "num_agent_steps_sampled": 2292988, "num_steps_trained": 2292988, "num_agent_steps_trained": 2292988}, "done": false, "episodes_total": 1146, "training_iteration": 191, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-35-51", "timestamp": 1690853751, "time_this_iter_s": 94.88762736320496, "time_total_s": 15503.82869553566, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15503.82869553566, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 99.98432835820896, "ram_util_percent": 55.55}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7082447207777927, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9028757009881327, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8246255453678601, "reward_component_totals/dist_change_reward_min": -0.9932254113544218, "reward_component_totals/dist_change_reward_max": -0.6186277564673754, "reward_component_totals/delta_v_mean": -2.0782501556202804, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8250155620273, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1142.07, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1935, "constraint_violation.max_vel_constraint.ratio_mean": 0.5707496251874064, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.967016491754123}, "hist_stats": {"episode_reward": [-3.9461332057077945, -3.7744715985824007, -3.965192060408013, -3.821023068606602, -3.83376788684411, -3.9280877605872364, -3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916, -3.753782278173643, -3.789405258176907, -3.9417078766532283, -3.8228473265121057, -3.9514533854472043, -4.029113479223847, -4.027688876949378, -3.925204723956151, -3.8351076589731954, -3.857497358307369, -3.9967021571170633, -3.8937871790464706, -3.789814869615804, -3.8794505819503957, -3.891090376163107, -3.8795321053444747, -3.819988536211058, -4.005895504007326], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7767502636161812, "mean_inference_ms": 8.076709221301767, "mean_action_processing_ms": 0.405826440674503, "mean_env_wait_ms": 9.849059950934445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2304994, "agent_timesteps_total": 2304994, "timers": {"sample_time_ms": 43970.69, "sample_throughput": 273.046, "load_time_ms": 6.096, "load_throughput": 1969617.388, "learn_time_ms": 35182.279, "learn_throughput": 341.251, "update_time_ms": 30.85}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005751070100814104, "policy_loss": 0.0010172320762649179, "vf_loss": 0.004733838606625795, "vf_explained_var": 0.2711176574230194, "kl": -2.771435747561668e-09, "entropy": 2.73038387298584, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2304994, "num_agent_steps_sampled": 2304994, "num_steps_trained": 2304994, "num_agent_steps_trained": 2304994}, "done": false, "episodes_total": 1152, "training_iteration": 192, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-37-09", "timestamp": 1690853829, "time_this_iter_s": 77.51359057426453, "time_total_s": 15581.342286109924, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15581.342286109924, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 99.98288288288289, "ram_util_percent": 55.6063063063063}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7082447207777927, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9042316207543917, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8259564869320346, "reward_component_totals/dist_change_reward_min": -0.9932254113544218, "reward_component_totals/dist_change_reward_max": -0.6186277564673754, "reward_component_totals/delta_v_mean": -2.078275133822365, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.82751338223582, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1152.71, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5760669665167416, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.98259722259544, -3.826339097488665, -3.84506691171954, -3.8027816979474154, -3.853004613347802, -3.884097161156709, -3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916, -3.753782278173643, -3.789405258176907, -3.9417078766532283, -3.8228473265121057, -3.9514533854472043, -4.029113479223847, -4.027688876949378, -3.925204723956151, -3.8351076589731954, -3.857497358307369, -3.9967021571170633, -3.8937871790464706, -3.789814869615804, -3.8794505819503957, -3.891090376163107, -3.8795321053444747, -3.819988536211058, -4.005895504007326, -3.8198747934813504, -3.8495686000337885, -3.859242646435975, -4.026551263557873, -4.048785546252785, -3.800244707600298], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7771109672746366, "mean_inference_ms": 8.076804716355868, "mean_action_processing_ms": 0.4058681428595012, "mean_env_wait_ms": 9.850071371643214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2317000, "agent_timesteps_total": 2317000, "timers": {"sample_time_ms": 43804.478, "sample_throughput": 274.082, "load_time_ms": 6.027, "load_throughput": 1992112.296, "learn_time_ms": 34988.671, "learn_throughput": 343.14, "update_time_ms": 33.408}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004827259574085474, "policy_loss": 9.491542732575908e-05, "vf_loss": 0.004732341505587101, "vf_explained_var": 0.1533374935388565, "kl": -2.561137080192566e-09, "entropy": 2.742772340774536, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2317000, "num_agent_steps_sampled": 2317000, "num_steps_trained": 2317000, "num_agent_steps_trained": 2317000}, "done": false, "episodes_total": 1158, "training_iteration": 193, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-38-27", "timestamp": 1690853907, "time_this_iter_s": 77.77121877670288, "time_total_s": 15659.113504886627, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15659.113504886627, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 99.97567567567569, "ram_util_percent": 55.53693693693694}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7082447207777927, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9047743031377133, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8284811852807376, "reward_component_totals/dist_change_reward_min": -0.999019090924035, "reward_component_totals/dist_change_reward_max": -0.6186277564673754, "reward_component_totals/delta_v_mean": -2.076293117856983, "reward_component_totals/delta_v_min": -2.146585826575758, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.62931178569758, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 214.65858265757515, "constraint_violation.max_vel_constraint.steps_mean": 1139.02, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5692253873063469, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.830935777524634, -4.004991397223884, -3.807301313148036, -3.9817436287319663, -3.8257037248430583, -3.849461636082697, -3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916, -3.753782278173643, -3.789405258176907, -3.9417078766532283, -3.8228473265121057, -3.9514533854472043, -4.029113479223847, -4.027688876949378, -3.925204723956151, -3.8351076589731954, -3.857497358307369, -3.9967021571170633, -3.8937871790464706, -3.789814869615804, -3.8794505819503957, -3.891090376163107, -3.8795321053444747, -3.819988536211058, -4.005895504007326, -3.8198747934813504, -3.8495686000337885, -3.859242646435975, -4.026551263557873, -4.048785546252785, -3.800244707600298, -3.8532456453387516, -3.7988370019176987, -3.8711155164310105, -4.043831119034056, -3.810341732155552, -3.870783927710571], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7774758789479992, "mean_inference_ms": 8.076884693803287, "mean_action_processing_ms": 0.40590773072561476, "mean_env_wait_ms": 9.851094886887497, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2329006, "agent_timesteps_total": 2329006, "timers": {"sample_time_ms": 43960.533, "sample_throughput": 273.109, "load_time_ms": 5.454, "load_throughput": 2201467.759, "learn_time_ms": 35630.266, "learn_throughput": 336.961, "update_time_ms": 33.497}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005982027389109135, "policy_loss": 0.00039528487832285464, "vf_loss": 0.005586741492152214, "vf_explained_var": 0.30433282256126404, "kl": -1.4846083251640607e-09, "entropy": 2.6915152072906494, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2329006, "num_agent_steps_sampled": 2329006, "num_steps_trained": 2329006, "num_agent_steps_trained": 2329006}, "done": false, "episodes_total": 1164, "training_iteration": 194, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-39-52", "timestamp": 1690853992, "time_this_iter_s": 84.37517857551575, "time_total_s": 15743.488683462143, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15743.488683462143, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 99.98181818181817, "ram_util_percent": 55.60826446280992}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.7082447207777927, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9079638755516304, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8300030932422612, "reward_component_totals/dist_change_reward_min": -0.999019090924035, "reward_component_totals/dist_change_reward_max": -0.6186277564673754, "reward_component_totals/delta_v_mean": -2.0779607823093764, "reward_component_totals/delta_v_min": -2.189034778823453, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.79607823093696, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 218.9034778823447, "constraint_violation.max_vel_constraint.steps_mean": 1143.69, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5715592203898051, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.7082447207777927, -3.8608083298934086, -3.9277888908734138, -3.80563049490482, -4.0418165239416215, -3.9215017252871096, -3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916, -3.753782278173643, -3.789405258176907, -3.9417078766532283, -3.8228473265121057, -3.9514533854472043, -4.029113479223847, -4.027688876949378, -3.925204723956151, -3.8351076589731954, -3.857497358307369, -3.9967021571170633, -3.8937871790464706, -3.789814869615804, -3.8794505819503957, -3.891090376163107, -3.8795321053444747, -3.819988536211058, -4.005895504007326, -3.8198747934813504, -3.8495686000337885, -3.859242646435975, -4.026551263557873, -4.048785546252785, -3.800244707600298, -3.8532456453387516, -3.7988370019176987, -3.8711155164310105, -4.043831119034056, -3.810341732155552, -3.870783927710571, -3.9668885842221764, -4.094343989460796, -3.8393307891647677, -4.035862559154376, -3.8072930891235104, -3.8753757078204125], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7778162081821887, "mean_inference_ms": 8.077000396200644, "mean_action_processing_ms": 0.40593661872027625, "mean_env_wait_ms": 9.851798913359989, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2341012, "agent_timesteps_total": 2341012, "timers": {"sample_time_ms": 44104.901, "sample_throughput": 272.215, "load_time_ms": 5.164, "load_throughput": 2325112.145, "learn_time_ms": 35466.909, "learn_throughput": 338.513, "update_time_ms": 30.115}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005310481414198875, "policy_loss": -0.000419443822465837, "vf_loss": 0.005729925353080034, "vf_explained_var": 0.30122122168540955, "kl": -2.268221166445983e-09, "entropy": 2.693739414215088, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2341012, "num_agent_steps_sampled": 2341012, "num_steps_trained": 2341012, "num_agent_steps_trained": 2341012}, "done": false, "episodes_total": 1170, "training_iteration": 195, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-41-10", "timestamp": 1690854070, "time_this_iter_s": 77.65334248542786, "time_total_s": 15821.14202594757, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15821.14202594757, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 99.98288288288289, "ram_util_percent": 55.599099099099085}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.753782278173643, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.911104811153861, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8340606802250512, "reward_component_totals/dist_change_reward_min": -0.999019090924035, "reward_component_totals/dist_change_reward_max": -0.6285389558707433, "reward_component_totals/delta_v_mean": -2.0770441309288175, "reward_component_totals/delta_v_min": -2.189034778823453, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.70441309288108, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 218.9034778823447, "constraint_violation.max_vel_constraint.steps_mean": 1116.31, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5578760619690154, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.896012185457325, -3.928414498795094, -3.982771194118122, -3.9628887396123202, -3.885519295613639, -3.8670990956411844, -3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916, -3.753782278173643, -3.789405258176907, -3.9417078766532283, -3.8228473265121057, -3.9514533854472043, -4.029113479223847, -4.027688876949378, -3.925204723956151, -3.8351076589731954, -3.857497358307369, -3.9967021571170633, -3.8937871790464706, -3.789814869615804, -3.8794505819503957, -3.891090376163107, -3.8795321053444747, -3.819988536211058, -4.005895504007326, -3.8198747934813504, -3.8495686000337885, -3.859242646435975, -4.026551263557873, -4.048785546252785, -3.800244707600298, -3.8532456453387516, -3.7988370019176987, -3.8711155164310105, -4.043831119034056, -3.810341732155552, -3.870783927710571, -3.9668885842221764, -4.094343989460796, -3.8393307891647677, -4.035862559154376, -3.8072930891235104, -3.8753757078204125, -3.786738992684061, -3.8761236805122694, -3.994598934273659, -4.037082491655781, -3.8779454872343573, -4.007394659541111], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.778188511514539, "mean_inference_ms": 8.077224447734906, "mean_action_processing_ms": 0.40597583998984715, "mean_env_wait_ms": 9.852577065026573, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2353018, "agent_timesteps_total": 2353018, "timers": {"sample_time_ms": 44141.795, "sample_throughput": 271.987, "load_time_ms": 5.095, "load_throughput": 2356370.409, "learn_time_ms": 35512.74, "learn_throughput": 338.076, "update_time_ms": 31.001}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005710258148610592, "policy_loss": 0.000763743300922215, "vf_loss": 0.004946516826748848, "vf_explained_var": 0.28355541825294495, "kl": -4.856897106719771e-09, "entropy": 2.7220754623413086, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2353018, "num_agent_steps_sampled": 2353018, "num_steps_trained": 2353018, "num_agent_steps_trained": 2353018}, "done": false, "episodes_total": 1176, "training_iteration": 196, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-42-27", "timestamp": 1690854147, "time_this_iter_s": 77.27133321762085, "time_total_s": 15898.413359165192, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15898.413359165192, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 99.98727272727272, "ram_util_percent": 55.12818181818181}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.753782278173643, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9090728408381836, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8341636643693389, "reward_component_totals/dist_change_reward_min": -0.999019090924035, "reward_component_totals/dist_change_reward_max": -0.6285389558707433, "reward_component_totals/delta_v_mean": -2.0749091764688528, "reward_component_totals/delta_v_min": -2.189034778823453, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.49091764688458, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 218.9034778823447, "constraint_violation.max_vel_constraint.steps_mean": 1121.73, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.560584707646177, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.99566088982992, -3.9130535275568032, -3.843468557145107, -3.993947760361068, -3.994846809758264, -3.8348231464737084, -3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916, -3.753782278173643, -3.789405258176907, -3.9417078766532283, -3.8228473265121057, -3.9514533854472043, -4.029113479223847, -4.027688876949378, -3.925204723956151, -3.8351076589731954, -3.857497358307369, -3.9967021571170633, -3.8937871790464706, -3.789814869615804, -3.8794505819503957, -3.891090376163107, -3.8795321053444747, -3.819988536211058, -4.005895504007326, -3.8198747934813504, -3.8495686000337885, -3.859242646435975, -4.026551263557873, -4.048785546252785, -3.800244707600298, -3.8532456453387516, -3.7988370019176987, -3.8711155164310105, -4.043831119034056, -3.810341732155552, -3.870783927710571, -3.9668885842221764, -4.094343989460796, -3.8393307891647677, -4.035862559154376, -3.8072930891235104, -3.8753757078204125, -3.786738992684061, -3.8761236805122694, -3.994598934273659, -4.037082491655781, -3.8779454872343573, -4.007394659541111, -3.943847041679405, -3.808538556135431, -3.9765302383602275, -3.883471966659333, -3.7964192124553273, -3.910700962380198], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7780443137767943, "mean_inference_ms": 8.077297805377098, "mean_action_processing_ms": 0.4059987470455411, "mean_env_wait_ms": 9.852824323921345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2365024, "agent_timesteps_total": 2365024, "timers": {"sample_time_ms": 43807.823, "sample_throughput": 274.061, "load_time_ms": 5.305, "load_throughput": 2262973.321, "learn_time_ms": 35507.619, "learn_throughput": 338.125, "update_time_ms": 32.388}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.005570603534579277, "policy_loss": -4.850135519518517e-05, "vf_loss": 0.005619105417281389, "vf_explained_var": 0.27263134717941284, "kl": -2.7664286417206085e-09, "entropy": 2.686671733856201, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2365024, "num_agent_steps_sampled": 2365024, "num_steps_trained": 2365024, "num_agent_steps_trained": 2365024}, "done": false, "episodes_total": 1182, "training_iteration": 197, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-43-38", "timestamp": 1690854218, "time_this_iter_s": 71.21781158447266, "time_total_s": 15969.631170749664, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15969.631170749664, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 99.9813725490196, "ram_util_percent": 51.78627450980393}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.753782278173643, "episode_reward_min": -4.139529085722307, "episode_reward_mean": -3.9089280979091785, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8332236317922573, "reward_component_totals/dist_change_reward_min": -0.999019090924035, "reward_component_totals/dist_change_reward_max": -0.6285389558707433, "reward_component_totals/delta_v_mean": -2.075704466116928, "reward_component_totals/delta_v_min": -2.189034778823453, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.57044661169212, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 218.9034778823447, "constraint_violation.max_vel_constraint.steps_mean": 1117.68, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5585607196401798, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.8366801918371984, -3.7741304775939506, -3.9361204274106747, -4.139529085722307, -4.038757865395755, -3.820301940677837, -4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916, -3.753782278173643, -3.789405258176907, -3.9417078766532283, -3.8228473265121057, -3.9514533854472043, -4.029113479223847, -4.027688876949378, -3.925204723956151, -3.8351076589731954, -3.857497358307369, -3.9967021571170633, -3.8937871790464706, -3.789814869615804, -3.8794505819503957, -3.891090376163107, -3.8795321053444747, -3.819988536211058, -4.005895504007326, -3.8198747934813504, -3.8495686000337885, -3.859242646435975, -4.026551263557873, -4.048785546252785, -3.800244707600298, -3.8532456453387516, -3.7988370019176987, -3.8711155164310105, -4.043831119034056, -3.810341732155552, -3.870783927710571, -3.9668885842221764, -4.094343989460796, -3.8393307891647677, -4.035862559154376, -3.8072930891235104, -3.8753757078204125, -3.786738992684061, -3.8761236805122694, -3.994598934273659, -4.037082491655781, -3.8779454872343573, -4.007394659541111, -3.943847041679405, -3.808538556135431, -3.9765302383602275, -3.883471966659333, -3.7964192124553273, -3.910700962380198, -3.8771364747190624, -4.041906595450563, -4.031391410128357, -3.8036191034146674, -3.8730027241985496, -3.9342700903130856], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7778445984079991, "mean_inference_ms": 8.077050948869715, "mean_action_processing_ms": 0.40600436075531976, "mean_env_wait_ms": 9.852580320314345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2377030, "agent_timesteps_total": 2377030, "timers": {"sample_time_ms": 43320.933, "sample_throughput": 277.141, "load_time_ms": 5.65, "load_throughput": 2124831.801, "learn_time_ms": 35486.088, "learn_throughput": 338.33, "update_time_ms": 33.162}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.007245223503559828, "policy_loss": 0.00038811631384305656, "vf_loss": 0.006857110187411308, "vf_explained_var": 0.3683331310749054, "kl": -3.1369546960036132e-09, "entropy": 2.6563706398010254, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2377030, "num_agent_steps_sampled": 2377030, "num_steps_trained": 2377030, "num_agent_steps_trained": 2377030}, "done": false, "episodes_total": 1188, "training_iteration": 198, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-44-50", "timestamp": 1690854290, "time_this_iter_s": 71.80562686920166, "time_total_s": 16041.436797618866, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16041.436797618866, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 99.9735294117647, "ram_util_percent": 51.793137254901964}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.753782278173643, "episode_reward_min": -4.094343989460796, "episode_reward_mean": -3.910021709547479, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8342675043305195, "reward_component_totals/dist_change_reward_min": -0.999019090924035, "reward_component_totals/dist_change_reward_max": -0.6285389558707433, "reward_component_totals/delta_v_mean": -2.0757542052169673, "reward_component_totals/delta_v_min": -2.189034778823453, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.57542052169603, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 218.9034778823447, "constraint_violation.max_vel_constraint.steps_mean": 1094.13, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.546791604197901, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-4.030905834023612, -3.9492831702691786, -3.9126116204024064, -3.9912973286402025, -3.871763009807141, -3.833413756774201, -4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916, -3.753782278173643, -3.789405258176907, -3.9417078766532283, -3.8228473265121057, -3.9514533854472043, -4.029113479223847, -4.027688876949378, -3.925204723956151, -3.8351076589731954, -3.857497358307369, -3.9967021571170633, -3.8937871790464706, -3.789814869615804, -3.8794505819503957, -3.891090376163107, -3.8795321053444747, -3.819988536211058, -4.005895504007326, -3.8198747934813504, -3.8495686000337885, -3.859242646435975, -4.026551263557873, -4.048785546252785, -3.800244707600298, -3.8532456453387516, -3.7988370019176987, -3.8711155164310105, -4.043831119034056, -3.810341732155552, -3.870783927710571, -3.9668885842221764, -4.094343989460796, -3.8393307891647677, -4.035862559154376, -3.8072930891235104, -3.8753757078204125, -3.786738992684061, -3.8761236805122694, -3.994598934273659, -4.037082491655781, -3.8779454872343573, -4.007394659541111, -3.943847041679405, -3.808538556135431, -3.9765302383602275, -3.883471966659333, -3.7964192124553273, -3.910700962380198, -3.8771364747190624, -4.041906595450563, -4.031391410128357, -3.8036191034146674, -3.8730027241985496, -3.9342700903130856, -4.058352665216784, -3.9491418567116603, -3.8710774677312516, -3.8468990513412242, -4.084935927240542, -3.84447418422638], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.777600554018473, "mean_inference_ms": 8.076522270249708, "mean_action_processing_ms": 0.4059947638113171, "mean_env_wait_ms": 9.851905843649702, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2389036, "agent_timesteps_total": 2389036, "timers": {"sample_time_ms": 42744.007, "sample_throughput": 280.881, "load_time_ms": 5.72, "load_throughput": 2099127.691, "learn_time_ms": 35022.79, "learn_throughput": 342.805, "update_time_ms": 29.555}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004323399160057306, "policy_loss": 0.00011867989815073088, "vf_loss": 0.004204718861728907, "vf_explained_var": 0.2314894050359726, "kl": -1.2267420412825913e-10, "entropy": 2.77401065826416, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2389036, "num_agent_steps_sampled": 2389036, "num_steps_trained": 2389036, "num_agent_steps_trained": 2389036}, "done": false, "episodes_total": 1194, "training_iteration": 199, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-45-59", "timestamp": 1690854359, "time_this_iter_s": 68.68321967124939, "time_total_s": 16110.120017290115, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16110.120017290115, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 99.98673469387757, "ram_util_percent": 51.54795918367348}, "trial_id": "41a83_00000"}
{"episode_reward_max": -3.753782278173643, "episode_reward_min": -4.094343989460796, "episode_reward_mean": -3.9065308660772984, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8314752698831355, "reward_component_totals/dist_change_reward_min": -0.999019090924035, "reward_component_totals/dist_change_reward_max": -0.6285389558707433, "reward_component_totals/delta_v_mean": -2.0750555961941712, "reward_component_totals/delta_v_min": -2.189034778823453, "reward_component_totals/delta_v_max": -2.023254210849604, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.50555961941637, "delta_v_total_min": 202.32542108495986, "delta_v_total_max": 218.9034778823447, "constraint_violation.max_vel_constraint.steps_mean": 1099.3, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1962, "constraint_violation.max_vel_constraint.ratio_mean": 0.5493753123438281, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9805097451274363}, "hist_stats": {"episode_reward": [-4.034414301531029, -4.018421047773579, -4.021002976600333, -3.873510110870911, -3.8265517673833394, -3.875197680435272, -3.8874129859159754, -3.915144900751069, -3.99080522127296, -4.048396204476297, -3.9760847287780203, -3.7928000103852386, -3.836660987776803, -3.8397716755144073, -3.9567107290932224, -3.8474071973364983, -3.9172402650604647, -3.8749156032480796, -3.88105999184687, -3.824348377905107, -3.8722305061012, -4.038726237999137, -3.7946609879483058, -3.861170330189207, -3.795624162529147, -3.885763904665524, -4.0122991842545135, -3.968684923672745, -3.8987915929217536, -3.790417382501327, -3.9483716500031623, -3.897087510154822, -3.8555314796661624, -4.078493093280916, -3.753782278173643, -3.789405258176907, -3.9417078766532283, -3.8228473265121057, -3.9514533854472043, -4.029113479223847, -4.027688876949378, -3.925204723956151, -3.8351076589731954, -3.857497358307369, -3.9967021571170633, -3.8937871790464706, -3.789814869615804, -3.8794505819503957, -3.891090376163107, -3.8795321053444747, -3.819988536211058, -4.005895504007326, -3.8198747934813504, -3.8495686000337885, -3.859242646435975, -4.026551263557873, -4.048785546252785, -3.800244707600298, -3.8532456453387516, -3.7988370019176987, -3.8711155164310105, -4.043831119034056, -3.810341732155552, -3.870783927710571, -3.9668885842221764, -4.094343989460796, -3.8393307891647677, -4.035862559154376, -3.8072930891235104, -3.8753757078204125, -3.786738992684061, -3.8761236805122694, -3.994598934273659, -4.037082491655781, -3.8779454872343573, -4.007394659541111, -3.943847041679405, -3.808538556135431, -3.9765302383602275, -3.883471966659333, -3.7964192124553273, -3.910700962380198, -3.8771364747190624, -4.041906595450563, -4.031391410128357, -3.8036191034146674, -3.8730027241985496, -3.9342700903130856, -4.058352665216784, -3.9491418567116603, -3.8710774677312516, -3.8468990513412242, -4.084935927240542, -3.84447418422638, -4.0260562983384, -3.820032421660873, -3.906732675563054, -3.8124013114717785, -3.8766113657563355, -3.798356300108274], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7773196358233838, "mean_inference_ms": 8.075842126317124, "mean_action_processing_ms": 0.40597125728643463, "mean_env_wait_ms": 9.850863194774758, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2401042, "agent_timesteps_total": 2401042, "timers": {"sample_time_ms": 42237.641, "sample_throughput": 284.249, "load_time_ms": 5.718, "load_throughput": 2099679.1, "learn_time_ms": 34630.966, "learn_throughput": 346.684, "update_time_ms": 28.937}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999960041972e-13, "total_loss": 0.004969830624759197, "policy_loss": 0.000674885290209204, "vf_loss": 0.004294946789741516, "vf_explained_var": 0.09295757114887238, "kl": -1.937751736846849e-09, "entropy": 2.7525081634521484, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2401042, "num_agent_steps_sampled": 2401042, "num_steps_trained": 2401042, "num_agent_steps_trained": 2401042}, "done": true, "episodes_total": 1200, "training_iteration": 200, "experiment_id": "b71a9b5460f246b3b789645c5e4ba5b4", "date": "2023-07-31_18-47-08", "timestamp": 1690854428, "time_this_iter_s": 68.8746976852417, "time_total_s": 16178.994714975357, "pid": 3556148, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-12, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16178.994714975357, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 99.9765306122449, "ram_util_percent": 50.537755102040826}, "trial_id": "41a83_00000"}
